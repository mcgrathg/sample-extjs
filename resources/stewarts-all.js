Ext.define("sl.override.HashMapOverride",{override:"Ext.util.HashMap",addRecords:function(a,b,c){var d=this;a=Ext.Array.from(a)||[];Ext.Array.forEach(a,function(h,f,i){var g=h.get(b),e=h.get(c);if(!Ext.isEmpty(g)&&!Ext.isEmpty(e)){d.add(g,e)}})},removeRecords:function(a,b){var c=this;a=Ext.Array.from(a)||[];Ext.Array.forEach(a,function(e,d,f){b=b||e.clientIdProperty;c.removeAtKey(e.get(b))})},findKeysByValue:function(c){var a,d=this.map,b=[];for(a in d){if(d.hasOwnProperty(a)&&d[a]===c){b.push(a)}}return b}});Ext.define("sl.override.AjaxOverride",{override:"Ext.Ajax",uses:["Ext.util.Format"]},function(){var c=this,d=Ext.isString(c.url)?c.url:"../Ext.JsonRequest.cls",b=300000,a=Math.max(Ext.isNumeric(c.timeout?c.timeout:0),b),e=Ext.apply({AuthToken:Ext.Object.fromQueryString(location.search.substr(1)).AuthToken},Ext.isFunction(c.getExtraParams)?c.getExtraParams():c.extraParams);if(Ext.isFunction(c.setExtraParams)){c.setExtraParams(e)}else{c.extraParams=e}if(Ext.isFunction(c.setUrl)){c.setUrl(d)}else{c.url=d}if(Ext.isFunction(c.setTimeout)){c.setTimeout(a)}else{c.timeout=a}c.on({scope:c,beforerequest:function(j,f,g){try{var k=f.callback||Ext.emptyFn;var h=function(l,t,p){try{k.call((l.scope||this),l,t,p)}catch(o){var r="Unexpected Error In Request Callback<br/>Contact the Help Desk<br/><br/>Error: ",q=r+o.message,s=r+Ext.util.Format.ellipsis(o.message,200,true),m=Ext.apply({},p);Ext.MessageBox.show({title:"Request Error",msg:s,width:300,buttons:Ext.Msg.OK,multiline:false,icon:Ext.MessageBox.ERROR});console.error("Server Request Callback Exception",{"Error Msg":q,"Error Obj":o,opts:l,success:t,response:m});var n=Ext.encode({success:false,error:{Msg:s}});Ext.apply(p,{responseText:n});k.call((l.scope||this),l,t,p)}};Ext.apply(f,{callback:h.bind(f.scope||document)})}catch(i){console.warn("Ajax BeforeRequest Exception",{Exception:i,Conn:j,Opts:f,eOpts:g})}return true},requestexception:function(m,i,j,l){var k=false,h=(j||{}).dontTestResponse,g=Ext.isDefined(h)?h:false,f;i=Ext.isDefined(i)?i:{};if(!g){i=Ext.isDefined(i)?i:{};if(Ext.isString(i.responseText)){f=Ext.JSON.decode(i.responseText);if(!f.success){if(f.error.code==="JS101"){Ext.Msg.alert("Server Request Falure",f.error.Msg,function(){if(parent.locaton===window.location){window.location=window.location}else{parent.location=parent.location}});console.error("Server Request Falure",{connection:m,response:i,options:j,result:f,errorMsg:f.error.Msg});k=true}}}if(!k&&!i.aborted){if(Ext.isString(i.statusText)){Ext.Msg.alert("Server Request Failure/Timeout",i.statusText,function(){Ext.get(document.body).unmask()});console.error("Server Request Failure/Timeout",{response:i,statusText:i.statusText,connection:m,options:j})}else{console.error("Server Request Exception",{response:i,statusText:"Unknown",connection:m,options:j})}}}}})});Ext.define("sl.override.ElementOverride",{override:"Ext.dom.Element",requires:["Ext.dom.Helper"],mask:function(a,j,g){var e=document,d=Ext.baseCSSPrefix+"masked",l=Ext.baseCSSPrefix+"masked-relative",h=Ext.baseCSSPrefix+"mask-msg",m=/^body/i;var k=this,c=k.dom,f=k.getData(),i=f.maskEl,b;if(!(m.test(c.tagName)&&k.getStyle("position")==="static")){k.addCls(l)}if(i){i.destroy()}i=Ext.DomHelper.append(c,{role:"presentation",cls:Ext.baseCSSPrefix+"mask "+Ext.baseCSSPrefix+"border-box",children:{role:"presentation",cls:j?h+" "+j:h,cn:{tag:"div",role:"presentation",cls:Ext.baseCSSPrefix+"mask-msg-inner",cn:{tag:"div",role:"presentation",cls:Ext.baseCSSPrefix+(j&&j==="x-mask-loading"?"":"stewarts-")+"mask-msg-text",html:a||""}}}},true);b=Ext.get(i.dom.firstChild);f.maskEl=i;k.addCls(d);i.setDisplayed(true);if(typeof a==="string"){b.setDisplayed(true);b.center(k)}else{b.setDisplayed(false)}if(c===e.body){i.addCls(Ext.baseCSSPrefix+"mask-fixed")}else{k.saveTabbableState()}k.saveChildrenTabbableState();if(Ext.isIE9m&&c!==e.body&&k.isStyle("height","auto")){i.setSize(undefined,g||k.getHeight())}return i}});Ext.define("sl.override.ComponentOverride",{override:"Ext.Component",constructor:function(a){this.callParent(arguments)}});Ext.define("sl.override.CollectionOverride",{override:"Ext.util.Collection",_aggregators:{average:function(c,d,b,e,a){var f=b-d;return f&&this._aggregators.sum.call(this,c,d,b,e,a)/f},bounds:function(e,a,b,j,f){for(var h,g,c,d=a;d<b;++d){h=e[d];h=(f?h[f]:h)[j];if(!(h<g)){g=h}if(!(h>c)){c=h}}return[c,g]},count:function(a){return a.length},extremes:function(f,a,c,l,j){var g=null,b=null,e,m,h,d,k;for(e=a;e<c;++e){m=f[e];k=(j?m[j]:m)[l];if(!(k<h)){h=k;g=m}if(!(k>d)){d=k;b=m}}return[b,g]},max:function(e,f,d,g,c){var a=this._aggregators.bounds.call(this,e,f,d,g,c);return a[1]},maxItem:function(e,f,d,g,c){var a=this._aggregators.extremes.call(this,e,f,d,g,c);return a[1]},min:function(e,f,d,g,c){var a=this._aggregators.bounds.call(this,e,f,d,g,c);return a[0]},minItem:function(e,f,d,g,c){var a=this._aggregators.extremes.call(this,e,f,d,g,c);return a[0]},sum:function(c,f,b,h,a){for(var g,e=0,d=f;d<b;++d){g=c[d];g=(a?g[a]:g)[h];if(!Ext.isEmpty(g)){e+=g}}return e}}});Ext.define("sl.utils.Toast",{uses:["Ext.util.Format"],singleton:true,showActionToast:function(e,g,b,a,f){var c=this,j=false,i="",h="",d;b=b||1000;a=a||"";if(!Ext.isEmpty(e)){d=Ext.util.Format.capitalize(e)+" Successful";if(!Ext.isEmpty(g)&&Number(g)>0){i=g===1?"record was":"records were";h=g+" "+i+" "}h+=e+"d."+a;j=c.showToast(d,h,b,f)}return j},showToast:function(h,c,e,a,d){var g=this,f=Ext.valueFrom(g.latestToast,false),b=f?f.initialConfig:false;h=Ext.valueFrom(h,"");c=Ext.valueFrom(c,"");a=Ext.valueFrom(a,"b");e=Ext.valueFrom(e,3000);if(f&&b.title===h&&b.html===c&&b.align===a&&b.componentCls===d&&f.isVisible()){g.latestToast.closeTask.delay(e)}else{g.latestToast=Ext.toast({html:c,title:h,align:a,autoCloseDelay:e,hideDuration:100,slideBackDuration:100,slideInDuration:100,slideInAnimation:"easeIn",slideBackAnimation:"easeOut",width:300,componentCls:d,shadow:true})}return g.latestToast},showSuccessToast:function(d,b,c,a){a=a||"t";return this.showToast(d,b,c,a,"success-toast")},showWarningToast:function(d,b,c,a){a=a||"b";return this.showToast(d,b,c,a,"warning-toast")},showErrorToast:function(d,b,c,a){c=c||7500;a=a||"b";return this.showToast(d,b,c,a,"error-toast")}});Ext.define("sl.override.StoreOverride",{override:"Ext.data.AbstractStore",requires:["Ext.util.Collection","sl.utils.Toast"],config:{autoSort:false,searchedText:"",filteredText:"",filteredTextArray:""},commitChanges:function(b){var d=this,e=Ext.isArray(b)?b:d.getModifiedRecords(),a=e.length,c=0;Ext.suspendLayouts();d.beginUpdate();for(;c<a;c++){e[c].commit()}d.cleanRemoved();d.endUpdate();Ext.resumeLayouts(true)},setExtraParam:function(d,c){var b=this,a=(b.getSource?b.getSource():b).getProxy();if(a&&Ext.isFunction(a.setExtraParam)){if(Ext.isDate(c)){c=c.toLocaleDateString()}return a.setExtraParam(d,c)}else{console.error("["+b.$className+"] Proxy not configured correctly");return false}},setExtraParams:function(b){var a=this;Ext.Object.each(b,function(c,d){a.setExtraParam(c,d)})},getExtraParams:function(){var b=this,a=(b.getSource?b.getSource():b).getProxy(),c;if(!Ext.isDefined(a)){console.error("["+b.$className+"] No Proxy Defined",{store:b});c={}}else{if(!Ext.isFunction(a.getExtraParams)){console.error("["+b.$className+"] Proxy Does Not Have `getExtraParams` function",{store:b,proxy:a});c={}}else{c=a.getExtraParams()}}return c},getExtraParam:function(c){var a=this,b=a.getExtraParams()[c];return b},getIDProperty:function(a){a=a||{};var b=this,c=a.clientIdProperty||(Ext.isDefined(b.model)?b.model.prototype.clientIdProperty:undefined)||"ID";if(c==="id"){c="ID"}return c},updateModelIDProperty:function(a,c){var b=this;if(b&&b.model&&b.model.prototype){if(!b.model.prototype.fieldsMap||!Ext.isDefined(b.model.prototype.fieldsMap[a])){console.error("["+b.$className+"] New ID Property is not a field in the store",{newIdProperty:a,store:b,model:b.model,fields:b.model.prototype.fields});return false}b.model.prototype.clientIdProperty=a}if(c){c=Ext.Array.from(c)||[];Ext.Array.forEach(c,function(e,d,f){e.clientIdProperty=a})}},getRecordCollection:function(b,c){c=Ext.isDefined(c)?c:false;var a=this,d;b=Ext.Array.from(b)||[];if(b.length>0){d=Ext.create("Ext.util.Collection");d.add(b)}else{if(!c&&a.isFiltered()){d=a.getData().getSource()}else{d=a.getData()}if(Ext.isEmpty(d)){d=Ext.create("Ext.util.Collection")}}return d},getRecords:function(c){c=Ext.isDefined(c)?c:false;var b,a=this;if(a.buffered){b=a.data.getRange(0,this.getCount()-1);if(c){}}else{b=a.getRecordCollection(undefined,c).getRange()}return b},filterDirty:function(a){return a.dirty},filterInvalid:function(a){return !a.isValid()},filterValid:function(a){return a.isValid()},filterForceValidation:function(a){return a.isValid()},getDirtyRecords:function(a){return this.getRecordCollection(a).createFiltered(this.filterDirty).getRange()},getInvalidRecords:function(a){return this.getRecordCollection(a).createFiltered(this.filterInvalid).getRange()},getValidRecords:function(b,a){a=a||false;return this.getRecordCollection(b).createFiltered(a?this.filterForceValidation:this.filterValid).getRange()},getUnsavedRecords:function(b,a){b=b||this.getRecords();a=Ext.isDefined(a)?a:true;var c=this.getDirtyRecords(b);if(!a){c=Ext.Array.merge(c,this.getInvalidRecords(b))}return c},getModifiedRecords:function(a){return[].concat(this.getNewRecords(a),this.getUpdatedRecords(a))},getNewRecords:function(a){return this.getRecordCollection(a).createFiltered(this.filterNew).getRange()},getNewOnlyRecords:function(a){return this.getRecordCollection(a).createFiltered(this.filterNewOnly).getRange()},getUpdatedRecords:function(a){return this.getRecordCollection(a).createFiltered(this.filterUpdated).getRange()},getRejectRecords:function(a){return this.getRecordCollection(a).createFiltered(this.filterRejects).getRange()},getRemovedRecords:function(a){var b=this.callParent(arguments);return(Ext.isArray(a)?Ext.Array.intersect(a,b):b)},getPhantomRemovedRecords:function(a){var b=this.removedphantom;return(Ext.isArray(a)?Ext.Array.intersect(a,b):b)},createNewRecord:function(b,d){b=b||{};d=d||{};var a=this,c;if(a.fireEvent("beforerecordcreated",a,b,d)!==false){c=a.model.prototype.createNewRecord.apply(a.model,[b,d]);if(c){a.fireEvent("recordcreated",a,c,b)}}return c},canRecordBeAdded:function(a,e){e=e||{};var b=this,h=true,f=-1,g=false,c=e.duplicateHandlerType||"Allow",d=(c!=="Allow")||false;if(d){f=b.getDuplicateRecordIndex(a);g=(f>=0);if(g){h=b.canDuplicateRecordBeAdded(c);if(!h){a=b.getAt(f)}}}return h},canDuplicateRecordBeAdded:function(a){var b=true;a=Ext.isDefined(a)?a:"Allow";switch(a){case"Notify":sl.utils.Toast.showToast("Error","Record already exists",2500);b=false;break;case"Block":b=false;break;case"Allow":b=true;break}return b},getDuplicateRecordIndex:function(a,c){c=c||{};var b=this,d=b.findBy(function(e,k){var h;if(a.getId()===k){return false}for(var g=0;g<b.model.prototype.fields.items.length;g++){if(h!==false){var j=b.model.prototype.fields.items[g],f=j.name;if(b.getIDProperty()!==f){h=e.get(f)===a.get(f)}}else{return false}}return h});return d},getRecordIDs:function(b,d){var a=this,e=[],c;d=d||{};Ext.Array.forEach(b,function(g,f,h){c=d.idField||a.getIDProperty(g);e.push(g.get(c))});return e},getSum:function(b,e){var d=0,c=0,a=b.length;for(;c<a;++c){d+=b[c].get(e)}return d===0?"":d},abortPreviousRequests:function(){var a=this,b=Ext.Ajax.requests;if(a.loading&&Ext.isObject(a.lastOptions)){Ext.Object.each(b,function(g,f,e){var d=f.options||{},c=d.params||{};if(c.CacheClassName===a.getExtraParam("CacheClassName")&&(c.CacheQueryName===a.getExtraParam("CacheQueryName")||c.CacheMethodName===a.getExtraParam("CacheMethodName"))){Ext.Ajax.abort(f)}})}},validateOnStoreLoad:function(a,b){a.validateRecords()},validateOnRecordChange:function(c,a,b,e,d){if(b===Ext.data.Model.EDIT){c.validateRecords([a])}},validateOnRecordAdded:function(b,a,c,d){b.validateRecords(a)},validateRecords:function(b){var a=this,c=[];b=Ext.Array.from((!Ext.isEmpty(b)?b:a.getRecords()));Ext.Array.forEach(b,function(d,e,f){if(!d.isValid()){c.push(d)}a.fireEvent("recordvalidated",a,d)});a.fireEvent("recordsvalidated",a,b,c);return c},findByValue:function(e,d,a){var c=this,b;d=(!Ext.isEmpty(d)?d:c.getIDProperty());a=c.getRecordCollection(a);b=a.findBy(function(f){if(sl.utils.areValuesEquivalent(f.get(d),e)){return f}});return Ext.isEmpty(b)?undefined:b},findNewInstanceOfRecords:function(h,m){var k=this,a=k.getRecords(),l=[],f,b,c,g;m=m||k.model.prototype.clientIdProperty;h=Ext.Array.from(h);for(var e=0;e<h.length;e++){f=h[e];if(!Ext.isFunction(f.get)){continue}b=f.get(m);for(var d=0;d<a.length;d++){c=a[d];if(!Ext.isFunction(c.get)){continue}g=c.get(m);if(b===g){l.push(c);break}}}return l},getFieldsToSearch:function(){var a=this;return a.getExtraParam("fields")},setSortRanking:function(d,c,f,b){var a=this,e=false;b=Ext.Array.from((!Ext.isEmpty(b)?b:a.getRecords()));if(!Ext.isArray(f)){c=Ext.Array.from(c||a.getFieldsToSearch())||[]}Ext.Array.forEach(b,function(h,i,k){var j=h.setSortRanking(d,c,f[i]),g=!Ext.Object.isEmpty(j);e=e||g});return e},sortRankedRecords:function(){var b=this,a=b.configureRankingSorters(),c;c=Ext.Array.merge([],a);b.sort(c,"append")},configureRankingSorters:function(){return[{property:"_sort_best_word_match_location",direction:"ASC",_isRankingSorter:true},{property:"_sort_match_count",direction:"DESC",_isRankingSorter:true},{property:"_sort_character_index",direction:"ASC",_isRankingSorter:true},{property:"_sort_col_index",direction:"ASC",_isRankingSorter:true},{property:"_sort_average_match_location",direction:"ASC",_isRankingSorter:true},{property:"_sort_best_word_match_total_length",direction:"ASC",_isRankingSorter:true}]},getRankingSorters:function(){var a=this,b=Ext.Array.from((a.getSorters()||{}).items),c=[];Ext.Array.forEach(b,function(f,d,e){if(f._isRankingSorter){c.push(f)}});return c},removeSorters:function(){var a=this,b=a.getSorters();if(b.getCount()){b.removeAll();a.fireEvent("refresh",a)}},updateFilteredText:function(b,a){this.setFilteredTextArray(sl.utils.splitStringOnWordsAndQuotes(b))}});Ext.define("sl.data.ValidatorOverride",{override:"Ext.data.validator.Validator",findField:function(a){var b=this;return a.getFields().find(function(c){return c._validators.find(function(d){return d===b})})},getAdditionalFieldValues:function(b){var c=this,a=Ext.Array.from(c.getAdditionalFields());return a.map(function(d){return b.get(d)})}});Ext.define("sl.override.IntegerFieldOverride",{override:"Ext.data.field.Integer",allowNull:true});Ext.define("sl.override.ModelOverride",{override:"Ext.data.Model",requires:["Ext.util.Format"],clientIdProperty:"ID",idProperty:"_unique_internal_model_id",config:{txtToSearch:"",txtToSearchWords:[],txtToSearch_upper:"",txtToSearch_stripped:"",txtToSearch_stripped_nospaces:"",txtToFind:"",txtToFind_upper:"",txtToFind_stripped:"",txtToFind_stripped_nospaces:"",txtToFind_regex:""},applyTxtToSearch:function(a){return String(Ext.isDefined(a)?a:"")},updateTxtToSearch:function(b,a){var c=this;c.setTxtToSearch_upper(b.toUpperCase());c.setTxtToSearch_stripped(sl.utils.stripNonAlphanumericChars(c.getTxtToSearch_upper()));c.setTxtToSearchWords(Ext.String.splitWords(c.getTxtToSearch_stripped()));c.setTxtToSearch_stripped_nospaces(sl.utils.stripNonAlphanumericChars(c.getTxtToSearch_stripped(),true))},updateTxtToFind:function(b,a){var c=this;c.setTxtToFind_upper(b.toUpperCase());c.setTxtToFind_stripped(sl.utils.stripNonAlphanumericChars(c.getTxtToFind_upper()));c.setTxtToFind_stripped_nospaces(sl.utils.stripNonAlphanumericChars(c.getTxtToFind_stripped()));c.setTxtToFind_regex(sl.utils.convertToIgnoreNonAlphanumericInRegEx(c.getTxtToFind_stripped_nospaces()))},constructor:function(c,d){var b=this,a=b.fields;a=Ext.Array.from(a)||[];Ext.Array.forEach(a,function(f,e,g){if(f.validations&&Ext.isEmpty(f.validators)){f.validators=f.validations}});b.callParent(arguments)},isSaving:function(){return !this.dirty&&!sl.utils.IsObjEmpty(this.getBeforeCommitProperties())},isSaved:function(){return !this.dirty&&sl.utils.IsObjEmpty(this.getBeforeCommitProperties())&&this.getCurrentSaveSessionID()},isInSaveSession:function(b){var c=this,a=false;if(Ext.isFunction((c.saveSessions||{}).get)){a=!Ext.isEmpty(c.saveSessions.get(b))}return a},hadSuccessfulSave:function(a){return this.getSaveSessionResult(a)===true},hadSaveFailure:function(b){var a=this.getSaveSessionResult(b);return !Ext.isEmpty(a)&&a!==true},isDeleting:function(){return this.deleting},isNotDeleted:function(){var c=this,b=c.isDeleting(),a=c.isValid();return b&&a},addSaveSession:function(b){var a=this;if(b){a.saveSessions=Ext.isDefined(a.saveSessions)?a.saveSessions:Ext.create("Ext.util.Collection");a.saveSessions.add({id:b,result:false})}return b},updateSaveSessionResult:function(d,a){var e=this,b,c=false;a=Ext.isString(a)?[a]:a;if(d){b=(Ext.isFunction((e.saveSessions||{}).get)?e.saveSessions.get(d):undefined);if(Ext.isObject(b)){if(!Ext.isBoolean(b.result)){b.result=Ext.Array.merge(b.result,a)}else{b.result=a}c=true}}return c},addValidationErrorsToSaveSession:function(b){var e=this,d=e.getValidation().getErrors(),c=[],a=false;Ext.Array.forEach(d,function(g,f,h){c.push(g.id+":  "+g.msg)});if(c.length>0){a=true;e.updateSaveSessionResult(b,c)}return a},getSaveSessionResult:function(b){var c=this,a;b=b||c.getCurrentSaveSessionID();if(b){a=(Ext.isFunction((c.saveSessions||{}).get)?(c.saveSessions.get(b)||{}).result:undefined)}return a},getCurrentSaveSessionID:function(){var c=false,b=this.saveSessions,a;if(Ext.isFunction((b||{}).last)){a=b.last();if(a){c=b.getKey(a)}}return c},initBeforeSave:function(a){var b=this;b.addSaveSession(a);b.setBeforeCommitProperties();return a},setBeforeCommitProperties:function(a){var b=this;a=a||{modified:Ext.clone(b.modified),dirty:b.dirty,phantom:b.phantom};b._beforecommit=a},clearBeforeCommitProperties:function(){this._beforecommit=undefined},getBeforeCommitProperties:function(){return this._beforecommit},restoreBeforeCommitProperties:function(){var c=this,b=false,a=c.getBeforeCommitProperties();if(a){Ext.apply(c,a);c.clearBeforeCommitProperties();b=true}return b},createNewRecord:function(i,f){i=Ext.apply({},i);f=f||{};var e=this,g=f.modelName||e.getName(),j=f.includeID||false,c=f.idField||e.prototype.clientIdProperty,b,d,h=e.getProxy(),a={};Ext.Array.forEach(e.fields.items,function(m,k,l){b=i[m.name]||m.defaultValue||m.value;if(b){i[m.name]=b;a[m.name]=undefined}});if(j){i[c]=f.idValue||i[c]}else{delete i[c]}if(c!==e.idProperty){delete i[e.idProperty]}if(h){d=h.getReader().extractRecordData(i);if(!j){d.modified=Ext.apply({},d.modified,a);d.phantom=true;d.dirty=true}else{d.set(c,i[c])}}else{d=Ext.create(g);Ext.Object.each(i,function(k,m,l){d.set(k,m)})}return d},formatBeforeSave:function(){var a=this;a.getFields().forEach(function(e,b,d){var c=e.getName(),f=a.get(c);if(!Ext.isEmpty(f)&&(Ext.isDate(f)||e.getType()==="date")){a.data[c]=Ext.util.Format.date(f,e.format||"m/d/Y")}});return a.getData({persist:true})},getFormattedPropertiesBeforeSave:function(d,b){var a=this,c=a.formatBeforeSave();d=d||"ID";b=b||"ID";if(Ext.isEmpty(c[d])){c[d]=c[b]}return c},getFieldsToSearch:function(a){a=Ext.isDefined(a)?a:false;var e=this,d=e.fields.items,c=[],b=[];Ext.Array.forEach(d,function(g,f,h){if(g.search){c.push(g.name)}if(a){b.push(g.name)}});if(a&&c.length===0){c=b}return c},setSortRanking:function(b,a,f){var d=this,e=d,c={};if(Ext.isArray(f)&&f.length){c=d.getRankingStatsForTextArray(f,b)}else{c=d.getRankingStatsForRecord(a,b)}e.data=Ext.apply(e.data,{_sort_best_word_match_location:c.beginningOfWordLocation,_sort_match_count:c.count,_sort_character_index:c.lowestCharIndex,_sort_col_index:c.lowestColIndex,_sort_average_match_location:Ext.Array.sum(c.allMatchLocs||[])/(c.allMatchLocs||[]).length,_sort_best_word_match_total_length:c.beginningOfWordLength});return c},getRankingStatsForRecord:function(b,a){var d=this,e=d,f=[],c={};b=Ext.Array.from(b)||[];a=Ext.isArray(a)?a:Ext.String.splitWords(a)||[];if(b.length===0){Ext.Array.forEach(e.fields.items,function(h,g,i){b.push(h.name)})}if(a.length>0){Ext.Array.forEach(b,function(j,g,k){var i=Ext.isDefined(e.get(j))?e.get(j):"",h;h=sl.utils.doesStringContainAllPieces(i,a);if(h){f.push({txt:i,index:g})}});c=d.getRankingStatsForTextArray(f,a)}return c},getRankingStatsForTextArray:function(e,b){var d=this,c={},a;Ext.Array.forEach(e,function(h,g,j){var f,i;if(Ext.isObject(h)){i=h.txt;f=h.index}else{i=h;f=g}if(!Ext.isEmpty(i)){if(Ext.isDate(i)&&Ext.isFunction(i.toLocaleDateString)){i=i.toLocaleDateString()}a=d.getRankingStatsForText(i,b);c=d.updateBestMatch(c,a,f)}});return c},getRankingStatsForText:function(h,d){var n=this,q,j,c,o=0,b=Number.MAX_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,g=Number.MAX_SAFE_INTEGER,p=[],m=false,l={},f,k,a,e;n.setTxtToSearch(h);q=n.getTxtToSearch_stripped_nospaces();j=n.getTxtToSearch_stripped();c=n.getTxtToSearchWords();d=Ext.isArray(d)?d:Ext.String.splitWords(d);Ext.Array.forEach(d,function(r,v,u){var s,t;if(!Ext.isEmpty(r)){n.setTxtToFind(r);f=n.getTxtToFind_stripped();k=n.getTxtToFind_stripped_nospaces();t=sl.utils.getAllMatchesInString(f,(f.indexOf(" ")>=0?j:q));if(t.length>0){o+=t.length;s=(q).indexOf(f);s=t[0].index;if(s>=0){b=Math.min(b,s);p.push(s);for(e=0;e<c.length;e++){a=c[e];if(a.indexOf(f)===0){i=Math.min(i,e);break}}}g=Math.min(g,h.length);m=true}}});if(m){l={count:o,length:g,firstWordIndex:i,firstMatchIndex:b,allMatchLocs:p}}return l},updateBestMatch:function(g,e,d){var i=e||{},a=g||{},h,c=function(f,b){a[f]=Ext.isNumeric(a[f])?a[f]:b};if(i.count>=0){h=Number(i.firstWordIndex+"."+(d<10?"0":"")+d);c("count",0);c("lowestCharIndex",Number.MAX_SAFE_INTEGER);c("lowestColIndex",Number.MAX_SAFE_INTEGER);c("beginningOfWordLocation",Number.MAX_SAFE_INTEGER);c("beginningOfWordLength",Number.MAX_SAFE_INTEGER);a.count+=i.count;a.lowestCharIndex=Math.min(a.lowestCharIndex,i.firstMatchIndex);a.lowestColIndex=Math.min(a.lowestColIndex,d);a.beginningOfWordLocation=Math.min(a.beginningOfWordLocation,h);a.beginningOfWordLength=Math.min(a.beginningOfWordLength,i.length);a.allMatchLocs=(a.allMatchLocs||[]).concat(i.allMatchLocs)}return g},getSortRankingValues:function(){var c=this,b={},a=function(d){b[d]=c.get(d)};a("_sort_best_word_match_location");a("_sort_match_count");a("_sort_character_index");a("_sort_col_index");a("_sort_best_match_all_locations");a("_sort_best_word_match_total_length");return b}});Ext.define("sl.app.ViewModelOverride",{override:"Ext.app.ViewModel",set:function(f,e,a){var c=this,d=false,b=c;a=Ext.valueFrom(a,false);if(a){do{if(b.hadValue&&b.hadValue[f]){break}}while(b=b.getParent())}b=b||c;b.callParent([f,e])}});Ext.define("sl.data.ValidationOverride",{override:"Ext.data.Validation",getErrors:function(){var b=[],a=this.getData();Ext.Object.each(a,function(d,c){if(true!==c){b.push({id:d,msg:c})}});return b}});Ext.define("sl.override.BoundValidatorOverride",{override:"Ext.data.validator.Bound",validate:function(f){var e=this,c=e.hasMin,h=e.hasMax,d=e.getMin(),b=e.getMax(),g=true,a;if(g!==true){return g}f=e.getValue(f);if(c&&h){if(f<d||f>b){g=e._bothMsg}}else{if(c){if(f<d){g=e._minMsg}}else{if(h){if(f>b){g=e._maxMsg}}}}return g}});Ext.define("sl.override.LengthValidatorOverride",{override:"Ext.data.validator.Length",getValue:function(a){return String(a||"").length}});Ext.define("sl.override.EditorOverride",{override:"Ext.Editor",uses:["Ext.mixin.Observable","Ext.util.DelayedTask"],initComponent:function(){var a=this;Ext.mixin.Observable.capture(a,function(c){var e=["specialkey","beforerender","render"],d=a.field;if(e.indexOf(c)<0){var b=Ext.Array.replace(Ext.Array.clone(arguments),1,1,[d])||[];d.fireEvent.apply(d,b)}});a.callParent()},onSpecialKey:function(l,c){var k=this,m=c.getKey(),e=k.completeOnEnter&&m===c.ENTER,n=k.cancelOnEsc&&m===c.ESC,f=k.specialKeyTask;var h=k.field,b=h.getParentGrid(),g=k.ownerCt||{},a,j,i,o,d;if(h&&b&&b.moveEditorOnEnter){switch(m){case c.ENTER:j=Ext.isFunction(g.getSelectionModel)?g.getSelectionModel():{};i=j.onKeyEnter;o=Ext.isFunction(b.getSelectionModel)?b.getSelectionModel():{};d=o.onKeyEnter;if(Ext.isFunction(i)&&i!==Ext.emptyFn){e=false}else{if(Ext.isFunction(d)&&d!==Ext.emptyFn){e=false}else{if(Ext.isBoolean(h.completeOnEnter)){e=h.completeOnEnter}}}break;case c.ESC:a=Ext.isDefined(h.isExpanded)?h.isExpanded:true;if(a&&Ext.isFunction(h.onEsc)&&h.onEsc!==Ext.emptyFn){n=false}else{if(Ext.isBoolean(h.cancelOnEsc)){n=h.cancelOnEsc}}break;default:break}}if(e||n){c.stopEvent();if(!f){k.specialKeyTask=f=new Ext.util.DelayedTask()}f.delay(k.specialKeyDelay,e?k.completeEdit:k.cancelEdit,k)}k.fireEvent("specialkey",k,l,c)},onKeyEnter:function(b){var a=this.field;if(a&&Ext.isFunction(a.onKeyEnter)){a.onKeyEnter.apply(a,arguments)}}});Ext.define("sl.override.SplitterOverride",{override:"Ext.resizer.Splitter",onRender:function(){var a=this;if(a.collapseOnDblClick&&!a.renderData.collapsible){a.collapseOnDblClick=false}a.callParent(arguments)}});Ext.define("sl.override.PanelOverride",{override:"Ext.panel.Panel",requires:["Ext.toolbar.Toolbar"],uses:["sl.utils.Utilities"],config:{defaultTitle:""},isForwardingEvents:true,forwardedEvents:["float","unfloat","expand","collapse","show","hide"],initComponent:function(){var a=this;a.setDefaultTitle(a.getDefaultTitle()||a.getTitle());a.callParent();if(a.floatable){a.on({scope:a,priority:1,"float":a.setZIndexOnFloat,unfloat:a.restoreZIndexOnUnfloat})}if(a.isForwardingEvents){a.on({scope:a,priority:100,destroy:a.unbindForwardedListeners});a.bindForwardedListeners()}},setZIndexOnFloat:function(a){var c;try{c=a.getEl();if(c){a._oldZIndex=c.getStyle("z-index");c.setStyle("z-index","19000")}}catch(b){console.error("[`float` panel] Set Z-Index on `float`",{error:b,args:arguments,panel:a,panelEl:c,scopeClassName:this.$className,scope:this})}},restoreZIndexOnUnfloat:function(a){var c;try{c=a.getEl();if(c){c.setStyle("z-index",a._oldZIndex);delete a._oldZIndex}}catch(b){console.error("[`unfloat` panel] Restore Z-Index on `unfloat`",{error:b,args:arguments,panel:a,panelEl:c,scopeClassName:this.$className,scope:this})}},bindForwardedListeners:function(){var a=this;a.forwardedEventsTask=new Ext.util.DelayedTask(a.onForwardedEvent,a);a.forwardedListeners=Ext.apply({},a.forwardedListeners);a.forwardedEvents.forEach(function(b){if(!a.forwardedListeners[b]){a.forwardedListeners[b]={fn:a.onPanelSizing,eventName:b}}});a.on(a.forwardedListeners)},unbindForwardedListeners:function(){var a=this;if(a.forwardedListeners){a.un(a.forwardedListeners)}a.forwardedEventsTask.cancel()},onPanelSizing:function(a,b){this.forwardedEventsTask.delay(50,undefined,undefined,[a,b.eventName,b])},onForwardedEvent:function(b,a,c){if(b.rendered){b.query("panel[rendered]").forEach(function(d){d.fireEvent("ancestorresize",d,b,a,c)})}},isCollapsed:function(c){var a=this,b=(a.collapsed!==false);if(!b&&c){b=!Ext.isEmpty(a.up("panel[collapsed]"))}return b},getBottomToolbar:function(a){return this.getToolbar("bottom",a)},getBottomToolbars:function(){return this.getToolbars("bottom")},getTopToolbar:function(a){return this.getToolbar("top",a)},getTopToolbars:function(){return this.getToolbars("top")},getRightToolbar:function(a){return this.getToolbar("right",a)},getRightToolbars:function(){return this.getToolbars("right")},getLeftToolbar:function(a){return this.getToolbar("left",a)},getLeftToolbars:function(){return this.getToolbars("left")},getToolbar:function(a,b){b=b||0;var c=this.getToolbars(a);if(c&&c.length>0){if(b>c.length-1){b=c.length-1}return c[b]}return undefined},getToolbars:function(a){return this.getDockedItems('toolbar[dock="'+a+'"]')},getMatchingToolbar:function(c,e,f){var d=this,b,a,g;c=Ext.valueFrom(c,"");e=Ext.valueFrom(e,"");f=Ext.valueFrom(f,true);if(c){g='{0}[id="{2}"]{1},{0}[reference="{2}"]{1},{0}[itemId="{2}"]{1},{0}[name="{2}"]{1}'}else{g="{0}{1}"}b=Ext.String.format(g,"toolbar",Ext.isDefined(e)?'[dock="'+e+'"]':"",c);if(b){a=d.getDockedItems(b)[0]}if(!a&&f){a=d.addDocked({xtype:"toolbar",dock:e||"bottom",enableOverflow:true,items:[]})[0]}return a}});Ext.define("sl.override.ViewportOverride",{override:"Ext.container.Viewport",config:{queryString:"",corporation:"",division:"",procGroup:"",username:"",userID:"",uprofile:"",AuthToken:"",menuitem:""},constructor:function(a){var b=this;a=a||{};b.initQueryStringProperties(a.queryString||Ext.Object.fromQueryString(window.location.search));b.callParent(arguments)},initComponent:function(){var b=this,a=b.getViewModel();if(a){a.set("corporation",b.getCorporation());a.set("division",b.getDivision());a.set("procGroup",b.getCorporation());a.set("username",b.getUsername());a.set("userID",b.getUserID());a.set("uprofile",b.getUprofile());a.set("AuthToken",b.getAuthToken());a.set("menuitem",b.getMenuitem())}b.on({beforerender:function(){var c=Ext.get("stewarts-splashscreen");if(c){c.destroy()}}});b.callParent()},initQueryStringProperties:function(b){var a=this;a.setQueryString(b);a.setCorporation(a.corporation||b.ucorp);a.setDivision(a.division||b.udivision);a.setProcGroup(a.procGroup||b.uprocgroup);a.setUsername(a.username||b.uid);a.setUserID(a.userID||b.userid);a.setUprofile(a.uprofile||b.uprofile);a.setAuthToken(a.AuthToken||b.AuthToken);a.setMenuitem(a.menuitem||b.menuitem);sl.setQueryString=a.setQueryString.bind(a);sl.setCorporation=a.setCorporation.bind(a);sl.setDivision=a.setDivision.bind(a);sl.setProcGroup=a.setProcGroup.bind(a);sl.setUsername=a.setUsername.bind(a);sl.setUserID=a.setUserID.bind(a);sl.setUprofile=a.setUprofile.bind(a);sl.setAuthToken=a.setAuthToken.bind(a);sl.setMenuitem=a.setMenuitem.bind(a);sl.getQueryString=a.getQueryString.bind(a);sl.getCorporation=a.getCorporation.bind(a);sl.getDivision=a.getDivision.bind(a);sl.getProcGroup=a.getProcGroup.bind(a);sl.getUsername=a.getUsername.bind(a);sl.getUserID=a.getUserID.bind(a);sl.getUprofile=a.getUprofile.bind(a);sl.getAuthToken=a.getAuthToken.bind(a);sl.getMenuitem=a.getMenuitem.bind(a)}});Ext.define("sl.field.utils.ValueToDisplayHash",{mixins:["Ext.util.StoreHolder"],mixinId:"valuetodisplayhash",requires:["Ext.util.HashMap"],getValueToDisplayHash:function(){var a=this;a.valueToDisplayHash=(Ext.isDefined(a.valueToDisplayHash)?a.valueToDisplayHash:a.createValueToDisplayHash());return a.valueToDisplayHash},createValueToDisplayHash:function(){var b=this,a;b.valueToDisplayHash=Ext.create("Ext.util.HashMap");b.configureEditorStoreBinding();if(b.store){b.bindStore(b.store)}if(b.isGridEditor()){a=b.getParentGrid();a.on({scope:b,reconfigure:b.onGridReconfigure});b.bindGridStoreListeners()}return b.valueToDisplayHash},configureEditorStoreBinding:function(){var a=this,b=function(d,c){var e;if(Ext.isFunction(d)){e=Ext.Function.createSequence(d,c)}else{e=c}return e};a.bindStoreListeners=b(a.bindStoreListeners,a.bindEditorStoreListeners);a.unbindStoreListeners=b(a.unbindStoreListeners,a.unbindEditorStoreListeners);a.onBindStore=b(a.onBindStore,a.onBindEditorStore);a.onUnbindStore=b(a.onUnbindStore,a.onUnbindEditorStore)},getEditorStoreListeners:function(b){var c=this,a;if(!b.isEmptyStore){a={scope:c,priority:100,save:c.addLastSavedEditorStoreRecords,datachanged:c.addEditorStoreRecords}}return a},getGridStoreListeners:function(b){var c=this,a;if(!b.isEmptyStore){a={scope:c,priority:100,save:c.addLastSavedGridStoreRecords,datachanged:c.addGridStoreRecords}}return a},bindGridStoreListeners:function(){var d=this,a=d.getParentGrid(),c=a.getStore(),b=d.getGridStoreListeners(c);if(b){b=Ext.apply({},b);if(!b.scope){b.scope=d}d.gridStoreListeners=b;c.on(b);d.addGridStoreRecords()}},onGridReconfigure:function(e,a,d,g,b,c){var f=this;if(a&&g!==a){f.unbindGridStoreListeners(g);f.bindGridStoreListeners()}},unbindGridStoreListeners:function(a){var b=this.gridStoreListeners;if(b){a.un(b)}},onBindEditorStore:function(a,b){this.addEditorStoreRecords(a)},unbindEditorStoreListeners:function(a){var b=this.editorStoreListeners;if(b){a.un(b)}},bindEditorStoreListeners:function(a){var b=this.getEditorStoreListeners(a);if(b){b=Ext.apply({},b);if(!b.scope){b.scope=this}this.editorStoreListeners=b;a.on(b)}},onUnbindEditorStore:Ext.emptyFn,addRecords:function(a,b,c){var d=this,e=d.valueToDisplayHash;e.addRecords(a,b,c)},addEditorStoreRecords:function(c){var a=this,b=a.valueToDisplayHash;if(c){b.addRecords(c.getRecords(),a.valueField,a.displayField)}},addGridStoreRecords:function(){var e=this,g=e.valueToDisplayHash,a=e.gridDisplayField,c=e.getGridValueField(),b=e.getParentGrid(),d=b.getStore(),f=!Ext.isEmpty(d.model.getFieldsMap()[a]);if(f){g.addRecords(d.getRecords(),c,a)}else{if(!f&&a){}}},addLastSavedEditorStoreRecords:function(a){this.addRecords(a.getLastSavedRecords(),this.valueField,this.displayField)},addLastSavedGridStoreRecords:function(a){this.addRecords(a.getLastSavedRecords(),this.getGridValueField(),this.gridDisplayField)},removeRecords:function(a,b){var c=this,d=c.valueToDisplayHash;d.removeRecords(a,b)},removeDeletedEditorStoreRecords:function(a){this.removeRecords(a.getDeletedRecords(),this.valueField)},removeDeletedGridStoreRecords:function(a){this.removeRecords(a.getDeletedRecords(),this.getGridValueField())}});Ext.define("sl.panel.grid.GridEditorFunctions",{mixins:["sl.field.utils.ValueToDisplayHash"],getActiveRecord:function(c){c=Ext.isDefined(c)?c:false;var b=this.getParentGrid(),d=false,a;if(b){a=b.getEditingPlugin();if(a){d=a.getActiveRecord()}if(!d&&c){d=Ext.isFunction(a.getLastActiveRecord)?a.getLastActiveRecord():false}}return d},getGridValueField:function(){var b=this,c,a;a=Ext.isFunction(b.getColumn)?b.getColumn():false;if(a){c=a.dataIndex}return c},getColumn:function(){return this.column},getParentGrid:function(){var c=this,a=Ext.isFunction(c.getColumn)?c.getColumn():false,b=false;if(a){b=a.up("tablepanel[isLocked=undefined]")}return b}});Ext.define("sl.override.BaseFieldOverride",{override:"Ext.form.field.Base",requires:["sl.panel.grid.GridEditorFunctions"],config:{validness:undefined},constructor:function(a){var c=this,b;c.column=Ext.isDefined(c.column)?c.column:(a||{}).column;if(c.isGridEditor()){c.self.mixin("gridfunctions",sl.panel.grid.GridEditorFunctions);c.mixins.gridfunctions.constructor.call(c)}c.callParent(arguments)},isGridEditor:function(){return Ext.isDefined(this.column)},publishValue:function(){var a=this;if(a.rendered){a.publishState("value",a.getValue())}},initField:function(){this.callParent(arguments);this.on("validitychange",this.onValidityChange,this)},onValidityChange:function(b,a){this.setValidness(a)},setValidness:function(b){var a=this,c=a.validness;b=Ext.valueFrom(b,true);if(c===undefined||c!==b){a.validness=b;if(a.rendered&&a.reference){a.publishState("validness",b)}}return b}});Ext.define("sl.override.BasicFormOverride",{override:"Ext.form.Basic",reset:function(c){var d=this,b=d.owner;if(d.fireEvent("beforereset",d)!==false&&b.fireEvent("beforereset",b)!==false){Ext.suspendLayouts();var a=d.getFields().items,e,g=a.length;for(e=0;e<g;e++){a[e].reset()}Ext.resumeLayouts(true);if(c===true){delete d._record}}d.fireEvent("reset",d);b.fireEvent("reset",b);return d}});Ext.define("sl.override.CheckboxOverride",{override:"Ext.form.field.Checkbox",initField:function(){this.callParent(arguments);if(this.isGridEditor()){this.on("change",this.onCheckboxEditorChange,this)}},onCheckboxEditorChange:function(g,i,b){var a=g.getParentGrid(),h=g.dataIndex||(d||{}).dataIndex,c=a?a.getEditingPlugin():false,e=c?c.getActiveRecord():false,d,f;if(e&&h){d=g.getColumn();f=a.getStore().indexOf(e);if(d.fireEvent("beforecheckchange",d,f,i)){e.set(h,i);d.fireEvent("checkchange",d,f,i)}else{g.suspendEvent("change");g.setValue(b);g.resumeEvent("change")}}}});Ext.define("sl.override.TableOverride",{override:"Ext.panel.Table",requires:["Ext.util.Format"],isEditable:false,getEditingPlugin:function(){return this.editingPlugin},isColumnEditable:function(b,a){var c=true;if(Ext.isDefined(b.isEditable)){if(Ext.isFunction(b.isEditable)){c=b.isEditable(a)}else{if(Ext.isBoolean(b.isEditable)){c=b.isEditable}}}return c},getColumnIndexByProperty:function(j,g,e){var a=this;e=e||false;var d=a.getColumns(),h=-1;for(var f=0;f<d.length;f++){var c=d[f],b=Ext.isDefined(c[j]);if(b&&(c[j]===g||e)){h=f;break}else{if(sl.utils.matchesComponent(c,Ext.grid.column.Template)&&Ext.isDefined(c.tpl)){if(Ext.isDefined(c.tpl.html)){if(-1!==c.tpl.html.indexOf("{"+g+"}")){h=f;break}}}}}return h},getColumnIndexByDataIndex:function(a){if(a){return this.getColumnIndexByProperty("dataIndex",a)}},getColumnForDataIndex:function(d){var c=this,b=c.getColumns(),a=c.getColumnIndexByDataIndex(d);return b[a]},getColumnIndex:function(d){var c=this,a=c.getView(),b=-1;if(d){if(a.isLockingView){a=a.getViewForColumn(d)}b=a.getHeaderCt().getHeaderIndex(d)}else{sl.consoleWarn("["+c.$className+":getColumnIndex] Required param `column` is missing.")}return b},getColumnsBy:function(g,f){var e=this,d=e.getColumns(),h=d.length,a=[],b,j;for(b=0;b<h;b++){j=d[b];if(g.call(f||e,j,b)===true){a[a.length]=j}}return a},getColumns:function(f,h){f=f||false;h=h||false;var d=this,c=[],g=function(i){return i.filter(function(j){return !j.hidden})},a=function(j){var i=[];if(Ext.isArray(d.columns)){i=Ext.Array.clone(d.columns)}else{if(Ext.isObject(d.columns)){if(Ext.isArray(d.columns.items)){i=Ext.Array.clone(d.columns.items)}}}if(j){i=g(i)}return i},e=function(j){var i=Ext.Array.clone(j);Ext.Array.forEach(j,function(l,k,m){if(l.columns||l.isGroupHeader){Ext.Array.forEach(l.columns,function(o,n,p){o.headerCol=l});Ext.Array.insert(i,k,l.columns);Ext.Array.remove(i,l)}});return i},b=function(j){var i=[];j.forEach(function(k){var l=(k.headerCol?k.headerCol:k);if(i.indexOf(l)<0){i.push(l)}});i=Ext.Array.unique(i);return i};if(d.headerCt){c=f?d.headerCt.getVisibleGridColumns():d.headerCt.getGridColumns();if(h){c=b(c)}}else{c=a(f);if(!h){c=e(c)}}return c},getColumnsToSearch:function(a){a=Ext.isDefined(a)?a:false;var c=this.getColumns(false,false),b=c.filter(function(d){return d.search});if(a&&b.length===0){b=c}return b},getColumnAt:function(a){var c=this,b=c.getColumns(false,false);return b[a]},getIndexOfNextEditor:function(d){var b=this,c=b.getNextColumnWithEditor(d),a=b.getColumnIndex(c);return Ext.isDefined(a)?a:-1},getNextColumnWithEditor:function(b,h){var a=this,g,d=Ext.Array.from(a.getColumns()),k,j,c,f;b=Ext.isNumeric(b)?b:0;h=Ext.isNumeric(h)?h:d.length-1;k=Ext.isNumber(b)?b:a.getColumnIndex(b);j=Ext.isNumber(h)?h:a.getColumnIndex(h);for(var e=k;e<=j;e++){c=d[e];f=c.getColumnEditor();if(f){g=c;break}}return g},getPreviousColumnWithEditor:function(b,h){var a=this,g,d=Ext.Array.from(a.getColumns());b=b||d.length-1;h=h||0;var k=Ext.isNumber(b)?b:a.getColumnIndex(b),j=Ext.isNumber(h)?h:a.getColumnIndex(h);for(var e=k;e>=j;e--){var c=d[e],f=c.getColumnEditor();if(f){g=c;break}}return g},getEditors:function(){var b=this,a=Ext.Array.from(b.getColumns()),c=[];Ext.Array.forEach(a,function(e,d,g){var f=e.getColumnEditor();if(f){c.push(f)}});return c},getDataIndexes:function(){var b=this,a=b.getColumns(),c=[];Ext.Array.forEach(a,function(d){if(d.isGroupHeader){Ext.Array.forEach(d.items.items,function(e){c.push(e.dataIndex)})}else{c.push(d.dataIndex)}});return c},getIndexForSelectedRow:function(){var b=this,a=-1,c=Ext.isEmpty(b)?"":b.selModel.getSelection();if(!Ext.isEmpty(c)){a=b.getIndexForRecord(c[0])}return a},getIndexForRecord:function(a){var b=this;return b.getStore().indexOf(a)},getPropertyForSelectedRow:function(e){e=e||"ID";var b=this,d="",a=b.getIndexForSelectedRow();if(a!==-1){var c=b.getStore().getAt(a);if(Ext.isFunction(c.get)){d=c.get(e)}else{if(Ext.isDefined(c.data)){d=c.data[e]}else{d=c[e]}}}return d},setColumnsAsEditable:function(a,c){var b=this;c=c||b.getColumns();Ext.Msg.alert("column.setEditable functionality hasn't been included yet...");Ext.Array.forEach(c,function(e,d,g){var f=e.getColumnEditor();if(f){console.error("column.setEditable functionality hasn't been included yet...")}})},setColumnsAsVisible:function(a,c){var b=this;c=c||b.getColumns();Ext.Array.forEach(c,function(e,d,f){e.setVisible(a)})},getRenderedTextInCell:function(f,h){var e=this,d=e.getColumnIndex(f),b={row:h,column:d},c=e.getView(),g=false,a;if(c.isLockingView){c=c.getViewForColumn(f)}a=c.getCellByPosition(b);if(a){g=Ext.util.Format.stripTags(Ext.util.Format.htmlDecode(a.getHtml()));g=g.replace(/&nbsp;/g," ")}return g},getTextInCell:function(e,f){var b=this,j=b.getView(),m=b.getStore(),g,i,h=Ext.apply({},j.cellValues),c,d,l,a,k;if(Ext.isString(e)){k=e;e=b.getColumnIndexByDataIndex(k)}if(Ext.isNumeric(e)){g=e;e=b.getColumnAt(g)}if(Ext.isEmpty(g)){g=b.getColumnIndex(e)}if(Ext.isNumeric(f)){i=f;f=m.getAt(f)}if(Ext.isEmpty(i)){i=m.indexOf(f)}h.record=f;h.column=e;h.recordIndex=i;h.rowIndex=i;h.columnIndex=g;h.cellIndex=g;h.align=e.align;h.tdCls=e.tdCls;h.innerCls=e.innerCls;h.tdCls=h.tdStyle=h.tdAttr=h.style="";h.style=h.tdAttr="";h.unselectableAttr=j.enableTextSelection?"":'unselectable="on"';k=k||(e||{}).dataIndex||"";c=f.data[k];if(Ext.isFunction(e.isRecordChecked)){l=e.isRecordChecked(f)}else{a=b.getRenderedTextInCell(e,i);if(a!==false){l=a}else{if(e.renderer&&e.renderer.call){d=j.ownerCt.columnManager.getHeaderIndex(e);l=e.renderer.call(e.usingDefaultRenderer?e:e.scope||j.ownerCt,c,h,f,i,d,j.dataSource,j);if(h.css){f.cssWarning=true;h.tdCls+=" "+h.css;h.css=null}l=Ext.util.Format.stripTags(l)}else{l=c}}l=(l==null||l==="")?e.emptyCellText:l}return l},findFeature:function(b){var a=this.getView();return Ext.isFunction(a.findFeature)?a.findFeature(b):null},refreshGridData:function(g,d){var e=this,c=e.getSelectionModel(),f=c.getSelection(),b=e.getStore(),a={};if(g&&!Ext.Object.isEmpty(g)){a.params=g}b.reload(Ext.apply({callback:function(){if(c.getSelection().length===0&&f.length>0){f=b.findNewInstanceOfRecords(f);c.select(f)}if(d){Ext.callback(d,e)}}},a))},isFirstVisibleColumn:function(c){var b=this,a=b.getColumns(true,false).filter(function(d){return !Ext.isDefined(d.isCheckerHd)});return a.indexOf(c)===0},scrollToRecord:function(b,g,d){d=Ext.apply({},d);var c=this,a=c.getView(),e=d.scope,f;if(a.isLockingView){a=a.normalView}if(a.bufferedRenderer){a.bufferedRenderer.scrollTo(b,{callback:g})}else{a.scrollRowIntoView(b);if(g){f=c.getStore().indexOf(b);g.call(e||c,f,b)}}}},function(a){var b=a.prototype;b.bufferedScollToRecord=a.bufferedScollToRecord=Ext.Function.createBuffered(b.scrollToRecord,100)});Ext.define("sl.override.HeaderContainerOverride",{override:"Ext.grid.header.Container",requires:["Ext.menu.CheckItem","Ext.menu.Separator","Ext.util.Format"],sortClearText:"Clear Sort",menuSortClearCls:Ext.baseCSSPrefix+"hmenu-sort-clear",getMenuItems:function(){var c=this,b=[],a=c.enableColumnHide?c.getColumnMenu(c):null;if(c.sortable){b=[{itemId:"ascItem",text:c.sortAscText,iconCls:c.menuSortAscCls,handler:c.onSortAscClick,scope:c},{itemId:"descItem",text:c.sortDescText,iconCls:c.menuSortDescCls,handler:c.onSortDescClick,scope:c},{itemId:"clearItem",text:c.sortClearText,iconCls:c.menuSortClearCls,handler:c.onSortClearClick,scope:c}]}if(a&&a.length){if(c.sortable){b.push({itemId:"columnItemSeparator",xtype:"menuseparator"})}b.push({itemId:"columnItem",text:c.columnsText,iconCls:c.menuColsIcon,menu:a,hideOnClick:false})}return b},getColumnMenu:function(f){var c=[],b=0,e,a=f.query(">gridcolumn[hideable]"),g=a.length,d;for(;b<g;b++){e=a[b];d=new Ext.menu.CheckItem({text:(e.menuText||e.text||"").replace(Ext.util.Format.stripTagsRe," "),checked:!e.hidden,hideOnClick:false,headerId:e.id,menu:e.isGroupHeader?this.getColumnMenu(e):undefined,checkHandler:this.onColumnCheckChange,scope:this});c.push(d)}return c.length?c:null},showMenuBy:function(a,c,h){var e=this.getMenu(),g=e.down("#ascItem"),d=e.down("#descItem"),b,f=e.down("#clearItem");e.activeHeader=e.ownerCmp=h;h.setMenuActive(e);b=h.sortable?"enable":"disable";if(g){g[b]()}if(d){d[b]()}if(f){f[b]()}e.autoFocus=!a||!a.pointerType;e.showBy(c,"tl-bl?");if(!e.isVisible()){this.onMenuHide(e)}},onSortClearClick:function(){var c=this.getMenu(),a=c.activeHeader,b=a.up("tablepanel[isLocked=undefined]").store;if(!a.isGroupHeader){b.getSorters().remove(a.getSortParam());b.fireEvent("refresh",b)}}});Ext.define("sl.override.ColumnOverride",{override:"Ext.grid.column.Column",applyColumnState:function(b){var a=this;a.applyColumnsState(b.columns);if(b.hidden!=null){a.hidden=b.hidden;if(a.rendered){if(b.hidden){a.hide()}else{a.show()}}}if(b.locked!=null){a.locked=b.locked}if(b.sortable!=null){a.sortable=b.sortable}if(b.width!=null){a.flex=null;a.width=b.width}else{if(b.flex!=null){a.width=null;a.flex=b.flex}}},getSortParam:function(){var b=this.dataIndex,a=this.getColumnEditor();if(a){b=a.gridDisplayField||a.gridValueField||b}return b},getColumnEditor:function(){var a=this;return(Ext.isFunction(a.getEditor)?a.getEditor():(a.editor||a.field))}});Ext.define("sl.override.CheckColumnOverride",{override:"Ext.grid.column.Check",config:{readOnly:false},processEvent:function(k,m,p,f,l,i,g,r){var j=this,o=k==="keydown"&&i.getKey(),c=k==="mousedown",d=j.disabled,h,n;var a=m.ownerGrid||j.up("tablepanel"),b=a?Ext.isDefined(a.getEditingPlugin()):false,q=b&&!j.getReadOnly()&&a.isColumnEditable(j,g);i.stopSelection=!o&&j.stopSelection;if(!d&&q&&(c||(o===i.ENTER||o===i.SPACE))){n=!j.isRecordChecked(g);if(j.fireEvent("beforecheckchange",j,f,n)!==false){j.setRecordCheck(g,n,p,r,i);j.fireEvent("checkchange",j,f,n)}}else{h=j.callSuper(arguments)}return h}});Ext.define("sl.override.CellEditingOverride",{override:"Ext.grid.plugin.CellEditing",onEditComplete:function(g,m,c){var i=this,a=i.getActiveColumn(),h=i.getActiveEditor(),b=i.context,k,f,d,e;if(h){k=b.view;f=b.record;i.setActiveEditor(null);i.setActiveColumn(null);i.setActiveRecord(null);b.value=m;if(!i.validateEdit()){i.editing=false;return}if(h.el.contains(Ext.Element.getActiveElement())||h.currentlyFocused){d=k.getSelectionModel();e=d.getSelectionMode()==="MULTI"&&(d.getSelection().length>1||!d.isSelected(f));k.getNavigationModel().setPosition(b,null,null,null,e);h.currentlyFocused=null}if(!sl.utils.areValuesEquivalent(m,c)){f.set(a.dataIndex,m);b.rowIdx=k.indexOf(f);var l=g.field,j;if(l.gridDisplayField){if(Ext.isFunction(l.findRecordByValue)){j=l.findRecordByValue(m)}else{console.error("["+i.$className+"] Not Configured Yet to Update Grid Record with Field's Raw Value",{editingPlugin:i,field:l,context:b})}if(j){f.set(l.gridDisplayField,j.get(l.displayField))}}}i.fireEvent("edit",i,b);i.editing=false}},setLastActiveEditor:function(a){this.lastActiveEditor=a;if(this.lockingPartner){this.lockingPartner.lastActiveEditor=a}},getLastActiveEditor:function(){return this.lastActiveEditor},setLastActiveColumn:function(a){this.lastActiveColumn=a;if(this.lockingPartner){this.lockingPartner.lastActiveColumn=a}},getLastActiveColumn:function(){return this.lastActiveColumn},setLastActiveRecord:function(a){this.lastActiveRecord=a;if(this.lockingPartner){this.lockingPartner.lastActiveRecord=a}},getLastActiveRecord:function(){return this.lastActiveRecord}});Ext.define("sl.override.RowModelOverride",{override:"Ext.selection.RowModel",onKeyEnter:function(c,g){var d=this,f=g.shiftKey?"up":"down",h=c.context,b=h.view.walkCells(h,f,g,d.preventWrap),a=Ext.valueFrom((c.grid||{}).moveEditorOnEnter,true);if(b&&a){if(c.startEdit(b.record,b.column)){d.wasEditing=false}else{b.view.getNavigationModel().setPosition(b,null,g);d.wasEditing=true}}}});Ext.define("sl.override.CellModelOverride",{override:"Ext.selection.CellModel",onKeyEnter:function(c,g){var d=this,f=g.shiftKey?"up":"down",h=c.context,b=h.view.walkCells(h,f,g,d.preventWrap),a=Ext.valueFrom((c.grid||{}).moveEditorOnEnter,true);if(b&&a){if(c.startEdit(b.record,b.column)){d.wasEditing=false}else{b.view.getNavigationModel().setPosition(b,null,g);d.wasEditing=true}}}});Ext.define("Ext.ux.BoxReorderer",{requires:["Ext.dd.DD"],mixins:{observable:"Ext.util.Observable"},itemSelector:".x-box-item",animate:100,constructor:function(){this.mixins.observable.constructor.apply(this,arguments)},init:function(a){var b=this;b.container=a;b.animatePolicy={};b.animatePolicy[a.getLayout().names.x]=true;b.container.on({scope:b,boxready:b.onBoxReady,beforedestroy:b.onContainerDestroy})},onContainerDestroy:function(){var a=this.dd;if(a){a.unreg();this.dd=null}},onBoxReady:function(){var c=this,b=c.container.getLayout(),d=b.names,a;a=c.dd=new Ext.dd.DD(b.innerCt,c.container.id+"-reorderer");Ext.apply(a,{animate:c.animate,reorderer:c,container:c.container,getDragCmp:c.getDragCmp,clickValidator:Ext.Function.createInterceptor(a.clickValidator,c.clickValidator,c,false),onMouseDown:c.onMouseDown,startDrag:c.startDrag,onDrag:c.onDrag,endDrag:c.endDrag,getNewIndex:c.getNewIndex,doSwap:c.doSwap,findReorderable:c.findReorderable});a.dim=d.width;a.startAttr=d.beforeX;a.endAttr=d.afterX},getDragCmp:function(a){return this.container.getChildByElement(a.getTarget(this.itemSelector,10))},clickValidator:function(b){var a=this.getDragCmp(b);return !!(a&&a.reorderable!==false)},onMouseDown:function(g){var f=this,a=f.container,d,b,c;f.dragCmp=f.getDragCmp(g);if(f.dragCmp){b=f.dragCmp.getEl();f.startIndex=f.curIndex=a.items.indexOf(f.dragCmp);c=b.getBox();f.lastPos=c[f.startAttr];d=a.el.getBox();if(f.dim==="width"){f.minX=d.left;f.maxX=d.right-c.width;f.minY=f.maxY=c.top;f.deltaX=g.getX()-c.left}else{f.minY=d.top;f.maxY=d.bottom-c.height;f.minX=f.maxX=c.left;f.deltaY=g.getY()-c.top}f.constrainY=f.constrainX=true}},startDrag:function(){var b=this,a=b.dragCmp;if(a){a.setPosition=Ext.emptyFn;a.animate=false;if(b.animate){b.container.getLayout().animatePolicy=b.reorderer.animatePolicy}b.dragElId=a.getEl().id;b.reorderer.fireEvent("StartDrag",b,b.container,a,b.curIndex);a.suspendEvents();a.disabled=true;a.el.setStyle("zIndex",100)}else{b.dragElId=null}},findReorderable:function(c){var d=this,a=d.container.items,b;if(a.getAt(c).reorderable===false){b=a.getAt(c);if(c>d.startIndex){while(b&&b.reorderable===false){c++;b=a.getAt(c)}}else{while(b&&b.reorderable===false){c--;b=a.getAt(c)}}}c=Math.min(Math.max(c,0),a.getCount()-1);if(a.getAt(c).reorderable===false){return -1}return c},doSwap:function(d){var f=this,b=f.container.items,a=f.container,e=f.container._isLayoutRoot,h,c,g;d=f.findReorderable(d);if(d===-1){return}f.reorderer.fireEvent("ChangeIndex",f,a,f.dragCmp,f.startIndex,d);h=b.getAt(f.curIndex);c=b.getAt(d);b.remove(h);g=Math.min(Math.max(d,0),b.getCount()-1);b.insert(g,h);b.remove(c);b.insert(f.curIndex,c);a._isLayoutRoot=true;a.updateLayout();a._isLayoutRoot=e;f.curIndex=d},onDrag:function(c){var b=this,a;a=b.getNewIndex(c.getPoint());if((a!==undefined)){b.reorderer.fireEvent("Drag",b,b.container,b.dragCmp,b.startIndex,b.curIndex);b.doSwap(a)}},endDrag:function(d){if(d){d.stopEvent()}var c=this,b=c.container.getLayout(),a;if(c.dragCmp){delete c.dragElId;delete c.dragCmp.setPosition;c.dragCmp.animate=true;c.dragCmp.lastBox[b.names.x]=c.dragCmp.getPosition(true)[b.names.widthIndex];c.container._isLayoutRoot=true;c.container.updateLayout();c.container._isLayoutRoot=undefined;a=Ext.fx.Manager.getFxQueue(c.dragCmp.el.id)[0];if(a){a.on({afteranimate:c.reorderer.afterBoxReflow,scope:c})}else{Ext.Function.defer(c.reorderer.afterBoxReflow,1,c)}if(c.animate){delete b.animatePolicy}c.reorderer.fireEvent("drop",c,c.container,c.dragCmp,c.startIndex,c.curIndex)}},afterBoxReflow:function(){var a=this;a.dragCmp.el.setStyle("zIndex","");a.dragCmp.disabled=false;a.dragCmp.resumeEvents()},getNewIndex:function(h){var g=this,a=g.getDragEl(),b=Ext.fly(a).getBox(),l,f,k,d=0,c=g.container.items.items,e=c.length,j=g.lastPos;g.lastPos=b[g.startAttr];for(;d<e;d++){l=c[d].getEl();if(l.is(g.reorderer.itemSelector)){f=l.getBox();k=f[g.startAttr]+(f[g.dim]>>1);if(d<g.curIndex){if((b[g.startAttr]<j)&&(b[g.startAttr]<(k-5))){return d}}else{if(d>g.curIndex){if((b[g.startAttr]>j)&&(b[g.endAttr]>(k+5))){return d}}}}}}});Ext.define("Ext.ux.CellDragDrop",{extend:"Ext.plugin.Abstract",alias:"plugin.celldragdrop",uses:["Ext.view.DragZone"],enforceType:false,applyEmptyText:false,emptyText:"",dropBackgroundColor:"green",noDropBackgroundColor:"red",dragText:"{0} selected row{1}",ddGroup:"GridDD",enableDrop:true,enableDrag:true,containerScroll:false,init:function(a){var b=this;a.on("render",b.onViewRender,b,{single:true})},destroy:function(){var a=this;Ext.destroy(a.dragZone,a.dropZone)},enable:function(){var a=this;if(a.dragZone){a.dragZone.unlock()}if(a.dropZone){a.dropZone.unlock()}a.callParent()},disable:function(){var a=this;if(a.dragZone){a.dragZone.lock()}if(a.dropZone){a.dropZone.lock()}a.callParent()},onViewRender:function(a){var b=this,c;if(b.enableDrag){if(b.containerScroll){c=a.getEl()}b.dragZone=new Ext.view.DragZone({view:a,ddGroup:b.dragGroup||b.ddGroup,dragText:b.dragText,containerScroll:b.containerScroll,scrollEl:c,getDragData:function(j){var h=this.view,i=j.getTarget(h.getItemSelector()),g=h.getRecord(i),f=j.getTarget(h.getCellSelector()),d,k;if(i){d=document.createElement("div");d.className="x-form-text";d.appendChild(document.createTextNode(f.textContent||f.innerText));k=h.getHeaderByCell(f);return{event:new Ext.EventObjectImpl(j),ddel:d,item:j.target,columnName:k.dataIndex,record:g}}},onInitDrag:function(e,k){var h=this,j=h.dragData,g=h.view,d=g.getSelectionModel(),f=j.record,i=j.ddel;if(!d.isSelected(f)){d.select(f,true)}Ext.fly(h.ddel).update(i.textContent||i.innerText);h.proxy.update(h.ddel);h.onStartDrag(e,k);return true}})}if(b.enableDrop){b.dropZone=new Ext.dd.DropZone(a.el,{view:a,ddGroup:b.dropGroup||b.ddGroup,containerScroll:true,getTargetFromEvent:function(h){var g=this,f=g.view,d=h.getTarget(f.cellSelector),i,j;if(d){i=f.findItemByChild(d);j=f.getHeaderByCell(d);if(i&&j){return{node:d,record:f.getRecord(i),columnName:j.dataIndex}}}},onNodeEnter:function(k,d,j,i){var f=this,h=k.record.getField(k.columnName).type.toUpperCase(),g=i.record.getField(i.columnName).type.toUpperCase();delete f.dropOK;if(!k||k.node===i.item.parentNode){return}if(b.enforceType&&h!==g){f.dropOK=false;if(b.noDropCls){Ext.fly(k.node).addCls(b.noDropCls)}else{Ext.fly(k.node).applyStyles({backgroundColor:b.noDropBackgroundColor})}return false}f.dropOK=true;if(b.dropCls){Ext.fly(k.node).addCls(b.dropCls)}else{Ext.fly(k.node).applyStyles({backgroundColor:b.dropBackgroundColor})}},onNodeOver:function(h,d,g,f){return this.dropOK?this.dropAllowed:this.dropNotAllowed},onNodeOut:function(i,d,h,g){var f=this.dropOK?b.dropCls:b.noDropCls;if(f){Ext.fly(i.node).removeCls(f)}else{Ext.fly(i.node).applyStyles({backgroundColor:""})}},onNodeDrop:function(h,d,g,f){if(this.dropOK){h.record.set(h.columnName,f.record.get(f.columnName));if(b.applyEmptyText){f.record.set(f.columnName,b.emptyText)}return true}},onCellDrop:Ext.emptyFn})}}});Ext.define("Ext.ux.DataTip",function(e){function c(){var f=this.isXType("panel")?this.body:this.el;if(this.dataTip.renderToTarget){this.dataTip.render(f)}this.dataTip.setTarget(f)}function a(g,f){if(g.rendered){if(g.host.fireEvent("beforeshowtip",g.eventHost,g,f)===false){return false}g.update(f)}else{if(Ext.isString(f)){g.html=f}else{g.data=f}}}function d(g){var h=this.view.getRecord(g.triggerElement),f;if(h){f=g.initialConfig.data?Ext.apply(g.initialConfig.data,h.data):h.data;return a(g,f)}else{return false}}function b(f){var g=Ext.getCmp(f.triggerElement.id);if(g&&(g.tooltip||f.tpl)){return a(f,g.tooltip||g)}else{return false}}return{extend:"Ext.tip.ToolTip",mixins:{plugin:"Ext.plugin.Abstract"},alias:"plugin.datatip",lockableScope:"both",constructor:function(f){var g=this;g.callParent([f]);g.mixins.plugin.constructor.call(g,f)},init:function(g){var f=this;f.mixins.plugin.init.call(f,g);g.dataTip=f;f.host=g;if(g.isXType("tablepanel")){f.view=g.getView();if(g.ownerLockable){f.host=g.ownerLockable}f.delegate=f.delegate||f.view.rowSelector;f.on("beforeshow",d)}else{if(g.isXType("dataview")){f.view=f.host;f.delegate=f.delegate||g.itemSelector;f.on("beforeshow",d)}else{if(g.isXType("form")){f.delegate="."+Ext.form.Labelable.prototype.formItemCls;f.on("beforeshow",b)}else{if(g.isXType("combobox")){f.view=g.getPicker();f.delegate=f.delegate||f.view.getItemSelector();f.on("beforeshow",d)}}}}if(g.rendered){c.call(g)}else{g.onRender=Ext.Function.createSequence(g.onRender,c)}}}});Ext.ux.DataViewTransition=Ext.extend(Object,{defaults:{duration:750,idProperty:"id"},constructor:function(a){Ext.apply(this,a||{},this.defaults)},init:function(a){this.dataview=a;var b=this.idProperty;a.blockRefresh=true;a.updateIndexes=Ext.Function.createSequence(a.updateIndexes,function(){this.getTargetEl().select(this.itemSelector).each(function(d,e,c){d.id=d.dom.id=Ext.util.Format.format("{0}-{1}",a.id,a.store.getAt(c).get(b))},this)},a);this.dataviewID=a.id;this.cachedStoreData={};this.cacheStoreData(a.store.snapshot);a.store.on("datachanged",function(l){var j=a.getTargetEl(),f=l.getAt(0),n=this.getAdded(l),v=this.getRemoved(l),g=this.getRemaining(l),s=Ext.apply({},g,n);Ext.each(v,function(A){Ext.fly(this.dataviewID+"-"+A.get(this.idProperty)).animate({remove:false,duration:c,opacity:0,useDisplay:true})},this);if(f==undefined){this.cacheStoreData(l);return}var e=Ext.get(this.dataviewID+"-"+f.get(this.idProperty));var x=l.getCount(),i=e.getMargin("lr")+e.getWidth(),t=e.getMargin("bt")+e.getHeight(),p=j.getWidth(),d=Math.floor(p/i),o=Math.ceil(x/d),y=Math.ceil(this.getExistingCount()/d);j.applyStyles({display:"block",position:"relative"});var h={},z={},q={};Ext.iterate(g,function(C,B){var C=B.get(this.idProperty),A=q[C]=Ext.get(this.dataviewID+"-"+C);h[C]={top:A.getY()-j.getY()-A.getMargin("t")-j.getPadding("t"),left:A.getX()-j.getX()-A.getMargin("l")-j.getPadding("l")}},this);Ext.iterate(g,function(D,C){var A=h[D],B=q[D];if(B.getStyle("position")!="absolute"){q[D].applyStyles({position:"absolute",left:A.left+"px",top:A.top+"px",width:B.getWidth(!Ext.isIE||Ext.isStrict),height:B.getHeight(!Ext.isIE||Ext.isStrict)})}});var m=0;Ext.iterate(l.data.items,function(C){var G=C.get(b),B=q[G];var A=m%d,F=Math.floor(m/d),E=F*t,D=A*i;z[G]={top:E,left:D};m++},this);var r=new Date(),c=this.duration,k=this.dataviewID;var w=function(){var J=new Date()-r,L=J/c;if(L>=1){for(var A in z){Ext.fly(k+"-"+A).applyStyles({top:z[A].top+"px",left:z[A].left+"px"})}Ext.TaskManager.stop(u)}else{for(var A in z){if(!g[A]){continue}var D=h[A],G=z[A],E=D.top,H=G.top,C=D.left,I=G.left,F=L*Math.abs(E-H),K=L*Math.abs(C-I),M=E>H?E-F:E+F,B=C>I?C-K:C+K;Ext.fly(k+"-"+A).applyStyles({top:M+"px",left:B+"px"})}}};var u={run:w,interval:20,scope:this};Ext.TaskManager.start(u);Ext.iterate(n,function(B,A){Ext.fly(this.dataviewID+"-"+A.get(this.idProperty)).applyStyles({top:z[A.get(this.idProperty)].top+"px",left:z[A.get(this.idProperty)].left+"px"});Ext.fly(this.dataviewID+"-"+A.get(this.idProperty)).animate({remove:false,duration:c,opacity:1})},this);this.cacheStoreData(l)},this)},cacheStoreData:function(a){this.cachedStoreData={};a.each(function(b){this.cachedStoreData[b.get(this.idProperty)]=b},this)},getExisting:function(){return this.cachedStoreData},getExistingCount:function(){var c=0,b=this.getExisting();for(var a in b){c++}return c},getAdded:function(a){var b={};a.each(function(c){if(this.cachedStoreData[c.get(this.idProperty)]==undefined){b[c.get(this.idProperty)]=c}},this);return b},getRemoved:function(a){var b=[];for(var c in this.cachedStoreData){if(a.findExact(this.idProperty,Number(c))==-1){b.push(this.cachedStoreData[c])}}return b},getRemaining:function(a){var b={};a.each(function(c){if(this.cachedStoreData[c.get(this.idProperty)]!=undefined){b[c.get(this.idProperty)]=c}},this);return b}});Ext.define("Ext.ux.DataView.Animated",{defaults:{duration:750,idProperty:"id"},constructor:function(a){Ext.apply(this,a||{},this.defaults)},init:function(a){var e=this,d=a.store,c=a.all,b={interval:20},g=e.duration;e.dataview=a;a.blockRefresh=true;a.updateIndexes=Ext.Function.createSequence(a.updateIndexes,function(){this.getTargetEl().select(this.itemSelector).each(function(i,j,h){i.dom.id=Ext.util.Format.format("{0}-{1}",a.id,d.getAt(h).internalId)},this)},a);e.dataviewID=a.id;e.cachedStoreData={};e.cacheStoreData(d.data||d.snapshot);a.on("resize",function(){var h=a.store;if(h.getCount()>0){}},this);a.store.on({datachanged:f,scope:this,buffer:50});function f(){var k=a.getTargetEl(),p=k.getY(),q=k.getPadding("t"),m=e.getAdded(d),w=e.getRemoved(d),r=e.getRemaining(d),y,v,t,o=new Ext.dom.Fly(),l=e.dataview.getInherited().rtl,u,h,n=l?"right":"left",s={};if(!k){return}Ext.iterate(w,function(A,i){t=e.dataviewID+"-"+A;Ext.fx.Manager.stopAnimation(t);i.dom=Ext.getDom(t);if(!i.dom){delete w[A]}});e.cacheStoreData(d);var j={},z={};Ext.iterate(r,function(A,i){if(o.attach(Ext.getDom(e.dataviewID+"-"+A))){u=j[A]={top:o.getY()-p-o.getMargin("t")-q};u[n]=e.getItemX(o)}else{delete r[A]}});a.refresh();Ext.iterate(w,function(A,i){k.dom.appendChild(i.dom);o.attach(i.dom).animate({duration:g,opacity:0,callback:function(C){var B=Ext.get(C.target.id);if(B){B.destroy()}}});delete i.dom});if(!d.getCount()){return}y=c.slice();for(v=y.length-1;v>=0;v--){t=d.getAt(v).internalId;o.attach(y[v]);z[t]={dom:o.dom,top:o.getY()-p-o.getMargin("t")-q};z[t][n]=e.getItemX(o);h=j[t]||z[t];s.position="absolute";s.top=h.top+"px";s[n]=h.left+"px";o.applyStyles(s)}var x=function(){var H=new Date()-b.taskStartTime,J=H/g;if(J>=1){s.position=s.top=s[n]="";for(t in z){o.attach(z[t].dom).applyStyles(s)}Ext.TaskManager.stop(b)}else{for(t in r){var B=j[t],E=z[t],C=B.top,F=E.top,A=B[n],G=E[n],D=J*Math.abs(C-F),I=J*Math.abs(A-G),K=C>F?C-D:C+D,i=A>G?A-I:A+I;s.top=K+"px";s[n]=i+"px";o.attach(E.dom).applyStyles(s)}}};Ext.iterate(m,function(A,i){if(o.attach(Ext.getDom(e.dataviewID+"-"+A))){o.setOpacity(0);o.animate({duration:g,opacity:1})}});Ext.TaskManager.stop(b);b.run=x;Ext.TaskManager.start(b);e.cacheStoreData(d)}},getItemX:function(b){var c=this.dataview.getInherited().rtl,a=b.up("");if(c){return a.getViewRegion().right-b.getRegion().right+b.getMargin("r")}else{return b.getX()-a.getX()-b.getMargin("l")-a.getPadding("l")}},cacheStoreData:function(a){var b=this.cachedStoreData={};a.each(function(c){b[c.internalId]=c})},getExisting:function(){return this.cachedStoreData},getExistingCount:function(){var c=0,b=this.getExisting();for(var a in b){c++}return c},getAdded:function(a){var c=this.cachedStoreData,b={};a.each(function(d){if(c[d.internalId]==null){b[d.internalId]=d}});return b},getRemoved:function(a){var b=this.cachedStoreData,c={},d;for(d in b){if(a.findBy(function(e){return e.internalId==d})==-1){c[d]=b[d]}}return c},getRemaining:function(a){var c=this.cachedStoreData,b={};a.each(function(d){if(c[d.internalId]!=null){b[d.internalId]=d}});return b}});Ext.define("Ext.ux.DataView.DragSelector",{requires:["Ext.dd.DragTracker","Ext.util.Region"],init:function(a){this.dataview=a;a.mon(a,{beforecontainerclick:this.cancelClick,scope:this,render:{fn:this.onRender,scope:this,single:true}})},onRender:function(){this.tracker=Ext.create("Ext.dd.DragTracker",{dataview:this.dataview,el:this.dataview.el,dragSelector:this,onBeforeStart:this.onBeforeStart,onStart:this.onStart,onDrag:this.onDrag,onEnd:this.onEnd});this.dragRegion=Ext.create("Ext.util.Region")},onBeforeStart:function(a){return a.target==this.dataview.getEl().dom},onStart:function(b){var c=this.dragSelector,a=this.dataview;this.dragging=true;c.fillRegions();c.getProxy().show();a.getSelectionModel().deselectAll()},cancelClick:function(){return !this.tracker.dragging},onDrag:function(l){var b=this.dragSelector,k=b.dataview.getSelectionModel(),q=b.dragRegion,p=b.bodyRegion,n=b.getProxy(),g=b.regions,c=g.length,m=this.startXY,s=this.getXY(),f=Math.min(m[0],s[0]),d=Math.min(m[1],s[1]),a=Math.abs(m[0]-s[0]),r=Math.abs(m[1]-s[1]),o,h,j;Ext.apply(q,{top:d,left:f,right:f+a,bottom:d+r});q.constrainTo(p);n.setBox(q);for(j=0;j<c;j++){o=g[j];h=q.intersect(o);if(h){k.select(j,true)}else{k.deselect(j)}}},onEnd:Ext.Function.createDelayed(function(c){var a=this.dataview,b=a.getSelectionModel(),d=this.dragSelector;this.dragging=false;d.getProxy().hide()},1),getProxy:function(){if(!this.proxy){this.proxy=this.dataview.getEl().createChild({tag:"div",cls:"x-view-selector"})}return this.proxy},fillRegions:function(){var a=this.dataview,b=this.regions=[];a.all.each(function(c){b.push(c.getRegion())});this.bodyRegion=a.getEl().getRegion()}});Ext.define("Ext.ux.DataView.Draggable",{requires:"Ext.dd.DragZone",ghostCls:"x-dataview-draggable-ghost",ghostTpl:['<tpl for=".">',"{title}","</tpl>"],init:function(a,b){this.dataview=a;a.on("render",this.onRender,this);Ext.apply(this,{itemSelector:a.itemSelector,ghostConfig:{}},b||{});Ext.applyIf(this.ghostConfig,{itemSelector:"img",cls:this.ghostCls,tpl:this.ghostTpl})},onRender:function(){var a=Ext.apply({},this.ddConfig||{},{dvDraggable:this,dataview:this.dataview,getDragData:this.getDragData,getTreeNode:this.getTreeNode,afterRepair:this.afterRepair,getRepairXY:this.getRepairXY});this.dragZone=Ext.create("Ext.dd.DragZone",this.dataview.getEl(),a)},getDragData:function(h){var a=this.dvDraggable,b=this.dataview,c=b.getSelectionModel(),g=h.getTarget(a.itemSelector),d,f;if(g){if(!b.isSelected(g)){c.select(b.getRecord(g))}d=b.getSelectedNodes();f={copy:true,nodes:d,records:c.getSelection(),item:true};if(d.length===1){f.single=true;f.ddel=g}else{f.multi=true;f.ddel=a.prepareGhost(c.getSelection())}return f}return false},getTreeNode:function(){},afterRepair:function(){this.dragging=false;var a=this.dragData.nodes,c=a.length,b;for(b=0;b<c;b++){Ext.get(a[b]).frame("#8db2e3",1)}},getRepairXY:function(c){if(this.dragData.multi){return false}else{var a=Ext.get(this.dragData.ddel),b=a.getXY();b[0]+=a.getPadding("t")+a.getMargin("t");b[1]+=a.getPadding("l")+a.getMargin("l");return b}},prepareGhost:function(a){return this.createGhost(a).getEl().dom},createGhost:function(b){var c=this,a;if(c.ghost){(a=c.ghost.store).loadRecords(b)}else{a=Ext.create("Ext.data.Store",{model:b[0].self});a.loadRecords(b);c.ghost=Ext.create("Ext.view.View",Ext.apply({renderTo:document.createElement("div"),store:a},c.ghostConfig));c.ghost.container.skipGarbageCollection=c.ghost.el.skipGarbageCollection=true}a.clearData();return c.ghost},destroy:function(){if(this.ghost){this.ghost.container.destroy();this.ghost.destroy()}}});Ext.define("Ext.ux.DataView.LabelEditor",{extend:"Ext.Editor",alignment:"tl-tl",completeOnEnter:true,cancelOnEsc:true,shim:false,autoSize:{width:"boundEl",height:"field"},labelSelector:"x-editable",requires:["Ext.form.field.Text"],constructor:function(a){a.field=a.field||Ext.create("Ext.form.field.Text",{allowOnlyWhitespace:false,selectOnFocus:true});this.callParent([a])},init:function(a){this.view=a;this.mon(a,"afterrender",this.bindEvents,this);this.on("complete",this.onSave,this)},bindEvents:function(){this.mon(this.view.getEl(),{click:{fn:this.onClick,scope:this}})},onClick:function(f,d){var c=this,b,a;if(Ext.fly(d).hasCls(c.labelSelector)&&!c.editing&&!f.ctrlKey&&!f.shiftKey){f.stopEvent();b=c.view.findItemByChild(d);a=c.view.store.getAt(c.view.indexOf(b));c.startEdit(d,a.data[c.dataIndex]);c.activeRecord=a}else{if(c.editing){c.field.blur();f.preventDefault()}}},onSave:function(a,b){this.activeRecord.set(this.dataIndex,b)}});Ext.define("Ext.ux.Explorer",{extend:"Ext.panel.Panel",xtype:"explorer",requires:["Ext.layout.container.Border","Ext.toolbar.Breadcrumb","Ext.tree.Panel"],config:{breadcrumb:{dock:"top",xtype:"breadcrumb",reference:"breadcrumb"},contentView:{xtype:"dataview",reference:"contentView",region:"center",cls:Ext.baseCSSPrefix+"explorer-view",itemSelector:"."+Ext.baseCSSPrefix+"explorer-item",tpl:'<tpl for="."><div class="'+Ext.baseCSSPrefix+'explorer-item"><div class="{iconCls}"><div class="'+Ext.baseCSSPrefix+'explorer-node-icon{[values.leaf ? " '+Ext.baseCSSPrefix+'explorer-leaf-icon" : ""]}"></div><div class="'+Ext.baseCSSPrefix+'explorer-item-text">{text}</div></div></div></tpl>'},store:null,tree:{xtype:"treepanel",reference:"tree",region:"west",width:200}},renderConfig:{selection:null},layout:"border",referenceHolder:true,defaultListenerScope:true,cls:Ext.baseCSSPrefix+"explorer",initComponent:function(){var b=this,a=b.getStore();b.dockedItems=[b.getBreadcrumb()];b.items=[b.getTree(),b.getContentView()];b.callParent()},applyBreadcrumb:function(b){var a=this.getStore();b=Ext.create(Ext.apply({store:a,selection:a.getRoot()},b));b.on("selectionchange","_onBreadcrumbSelectionChange",this);return b},applyContentView:function(a){var b=this.contentStore=new Ext.data.Store({model:this.getStore().model});a=Ext.create(Ext.apply({store:b},a));return a},applyTree:function(a){a=Ext.create(Ext.apply({store:this.getStore()},a));a.on("selectionchange","_onTreeSelectionChange",this);return a},updateSelection:function(b){var f=this,h=f.getReferences(),e=h.breadcrumb,i=h.tree,d=i.getSelectionModel(),g=f.contentStore,c,a;if(e.getSelection()!==b){e.setSelection(b)}if(d.getSelection()[0]!==b){d.select([b]);c=b.parentNode;if(c){c.expand()}a=i.getView();a.scrollRowIntoView(a.getRow(b))}g.removeAll();g.add(b.hasChildNodes()?b.childNodes:[b])},updateStore:function(a){this.getBreadcrumb().setStore(a)},privates:{_onTreeSelectionChange:function(a,b){this.setSelection(b[0])},_onBreadcrumbSelectionChange:function(b,a){this.setSelection(a)}}});Ext.define("Ext.ux.FieldReplicator",{alias:"plugin.fieldreplicator",init:function(a){if(!a.replicatorId){a.replicatorId=Ext.id()}a.on("blur",this.onBlur,this)},onBlur:function(e){var b=e.ownerCt,d=e.replicatorId,g=Ext.isEmpty(e.getRawValue()),f=b.query("[replicatorId="+d+"]"),c=f[f.length-1]===e,h,a;if(g&&!c){Ext.Function.defer(e.destroy,10,e)}else{if(!g&&c){if(e.onReplicate){e.onReplicate()}h=e.cloneConfig({replicatorId:d});a=b.items.indexOf(e);b.add(a+1,h)}}}});Ext.define("Ext.ux.GMapPanel",{extend:"Ext.panel.Panel",alias:"widget.gmappanel",requires:["Ext.window.MessageBox"],initComponent:function(){Ext.applyIf(this,{plain:true,gmapType:"map",border:false});this.callParent()},onBoxReady:function(){var a=this.center;this.callParent(arguments);if(a){if(a.geoCodeAddr){this.lookupCode(a.geoCodeAddr,a.marker)}else{this.createMap(a)}}else{Ext.Error.raise("center is required")}},createMap:function(a,b){var c=Ext.apply({},this.mapOptions);c=Ext.applyIf(c,{zoom:14,center:a,mapTypeId:google.maps.MapTypeId.HYBRID});this.gmap=new google.maps.Map(this.body.dom,c);if(b){this.addMarker(Ext.applyIf(b,{position:a}))}Ext.each(this.markers,this.addMarker,this);this.fireEvent("mapready",this,this.gmap)},addMarker:function(a){a=Ext.apply({map:this.gmap},a);if(!a.position){a.position=new google.maps.LatLng(a.lat,a.lng)}var b=new google.maps.Marker(a);Ext.Object.each(a.listeners,function(c,d){google.maps.event.addListener(b,c,d)});return b},lookupCode:function(b,a){this.geocoder=new google.maps.Geocoder();this.geocoder.geocode({address:b},Ext.Function.bind(this.onLookupComplete,this,[a],true))},onLookupComplete:function(c,b,a){if(b!="OK"){Ext.MessageBox.alert("Error",'An error occured: "'+b+'"');return}this.createMap(c[0].geometry.location,a)},afterComponentLayout:function(a,b){this.callParent(arguments);this.redraw()},redraw:function(){var a=this.gmap;if(a){google.maps.event.trigger(a,"resize")}}});Ext.define("Ext.ux.GroupTabRenderer",{extend:"Ext.plugin.Abstract",alias:"plugin.grouptabrenderer",tableTpl:new Ext.XTemplate('<div id="{view.id}-body" class="'+Ext.baseCSSPrefix+"{view.id}-table "+Ext.baseCSSPrefix+'grid-table-resizer" style="{tableStyle}">',"{%","values.view.renderRows(values.rows, values.viewStartIndex, out);","%}","</div>",{priority:5}),rowTpl:new Ext.XTemplate("{%",'Ext.Array.remove(values.itemClasses, "',Ext.baseCSSPrefix+'grid-row");','var dataRowCls = values.recordIndex === -1 ? "" : " '+Ext.baseCSSPrefix+'grid-data-row";',"%}",'<div {[values.rowId ? ("id=\\"" + values.rowId + "\\"") : ""]} ','data-boundView="{view.id}" ','data-recordId="{record.internalId}" ','data-recordIndex="{recordIndex}" ','class="'+Ext.baseCSSPrefix+'grouptab-row {[values.itemClasses.join(" ")]} {[values.rowClasses.join(" ")]}{[dataRowCls]}" ',"{rowAttr:attributes}>",'<tpl for="columns">{%',"parent.view.renderCell(values, parent.record, parent.recordIndex, parent.rowIndex, xindex - 1, out, parent)","%}","</tpl>","</div>",{priority:5}),cellTpl:new Ext.XTemplate('{%values.tdCls = values.tdCls.replace(" '+Ext.baseCSSPrefix+'grid-cell "," ");%}','<div class="'+Ext.baseCSSPrefix+'grouptab-cell {tdCls}" {tdAttr}>','<div {unselectableAttr} class="'+Ext.baseCSSPrefix+'grid-cell-inner" style="text-align: {align}; {style};">{value}</div>','<div class="x-grouptabs-corner x-grouptabs-corner-top-left"></div>','<div class="x-grouptabs-corner x-grouptabs-corner-bottom-left"></div>',"</div>",{priority:5}),selectors:{bodySelector:"div."+Ext.baseCSSPrefix+"grid-table-resizer",nodeContainerSelector:"div."+Ext.baseCSSPrefix+"grid-table-resizer",itemSelector:"div."+Ext.baseCSSPrefix+"grouptab-row",rowSelector:"div."+Ext.baseCSSPrefix+"grouptab-row",cellSelector:"div."+Ext.baseCSSPrefix+"grouptab-cell",getCellSelector:function(a){return a?a.getCellSelector():this.cellSelector}},init:function(b){var a=b.getView(),c=this;a.addTpl(c.tableTpl);a.addRowTpl(c.rowTpl);a.addCellTpl(c.cellTpl);Ext.apply(a,c.selectors)}});Ext.define("Ext.ux.GroupTabPanel",{extend:"Ext.Container",alias:"widget.grouptabpanel",requires:["Ext.tree.Panel","Ext.ux.GroupTabRenderer"],baseCls:Ext.baseCSSPrefix+"grouptabpanel",initComponent:function(a){var b=this;Ext.apply(b,a);b.store=b.createTreeStore();b.layout={type:"hbox",align:"stretch"};b.defaults={border:false};b.items=[{xtype:"treepanel",cls:"x-tree-panel x-grouptabbar",width:150,rootVisible:false,store:b.store,hideHeaders:true,animate:false,processEvent:Ext.emptyFn,border:false,plugins:[{ptype:"grouptabrenderer"}],viewConfig:{overItemCls:"",getRowClass:b.getRowClass},columns:[{xtype:"treecolumn",sortable:false,dataIndex:"text",flex:1,renderer:function(j,d,i,h,g,f,c){var e="";if(i.parentNode&&i.parentNode.parentNode===null){e+=" x-grouptab-first";if(i.previousSibling){e+=" x-grouptab-prev"}if(!i.get("expanded")||i.firstChild==null){e+=" x-grouptab-last"}}else{if(i.nextSibling===null){e+=" x-grouptab-last"}else{e+=" x-grouptab-center"}}if(i.data.activeTab){e+=" x-active-tab"}d.tdCls="x-grouptab"+e;return j}}]},{xtype:"container",flex:1,layout:"card",activeItem:b.mainItem,baseCls:Ext.baseCSSPrefix+"grouptabcontainer",items:b.cards}];b.callParent(arguments);b.setActiveTab(b.activeTab);b.setActiveGroup(b.activeGroup);b.mon(b.down("treepanel").getSelectionModel(),"select",b.onNodeSelect,b)},getRowClass:function(d,e,c,b){var a="";if(d.data.activeGroup){a+=" x-active-group"}return a},onNodeSelect:function(a,e){var d=this,b=d.store.getRootNode(),c;if(e.parentNode&&e.parentNode.parentNode===null){c=e}else{c=e.parentNode}if(d.setActiveGroup(c.get("id"))===false||d.setActiveTab(e.get("id"))===false){return false}while(b){b.set("activeTab",false);b.set("activeGroup",false);b=b.firstChild||b.nextSibling||b.parentNode.nextSibling}c.set("activeGroup",true);c.eachChild(function(f){f.set("activeGroup",true)});e.set("activeTab",true);a.view.refresh()},setActiveTab:function(b){var a=this,d=b,c;if(Ext.isString(b)){d=Ext.getCmp(d)}if(d===a.activeTab){return false}c=a.activeTab;if(a.fireEvent("beforetabchange",a,d,c)!==false){a.activeTab=d;if(a.rendered){a.down("container[baseCls="+Ext.baseCSSPrefix+"grouptabcontainer]").getLayout().setActiveItem(d)}a.fireEvent("tabchange",a,d,c)}return true},setActiveGroup:function(c){var b=this,d=c,a;if(Ext.isString(c)){d=Ext.getCmp(d)}if(d===b.activeGroup){return true}a=b.activeGroup;if(b.fireEvent("beforegroupchange",b,d,a)!==false){b.activeGroup=d;b.fireEvent("groupchange",b,d,a)}else{return false}return true},createTreeStore:function(){var b=this,a=b.prepareItems(b.items),c={text:".",children:[]},d=b.cards=[];b.activeGroup=b.activeGroup||0;Ext.each(a,function(g,e){var h=g.items.items,f=(h[g.mainItem]||h[0]),i={children:[]};i.id=f.id;i.text=f.title;i.iconCls=f.iconCls;i.expanded=true;i.activeGroup=(b.activeGroup===e);i.activeTab=i.activeGroup?true:false;if(i.activeTab){b.activeTab=i.id}if(i.activeGroup){b.mainItem=g.mainItem||0;b.activeGroup=i.id}Ext.each(h,function(j){if(j.id!==i.id){var k={id:j.id,leaf:true,text:j.title,iconCls:j.iconCls,activeGroup:i.activeGroup,activeTab:false};i.children.push(k)}delete j.title;delete j.iconCls;d.push(j)});c.children.push(i)});return Ext.create("Ext.data.TreeStore",{fields:["id","text","activeGroup","activeTab"],root:{expanded:true},proxy:{type:"memory",data:c}})},getActiveTab:function(){return this.activeTab},getActiveGroup:function(){return this.activeGroup}});Ext.define("Ext.ux.IFrame",{extend:"Ext.Component",alias:"widget.uxiframe",loadMask:"Loading...",src:"about:blank",renderTpl:['<iframe src="{src}" id="{id}-iframeEl" data-ref="iframeEl" name="{frameName}" width="100%" height="100%" frameborder="0"></iframe>'],childEls:["iframeEl"],initComponent:function(){this.callParent();this.frameName=this.frameName||this.id+"-frame"},initEvents:function(){var a=this;a.callParent();a.iframeEl.on("load",a.onLoad,a)},initRenderData:function(){return Ext.apply(this.callParent(),{src:this.src,frameName:this.frameName})},getBody:function(){var a=this.getDoc();return a.body||a.documentElement},getDoc:function(){try{return this.getWin().document}catch(a){return null}},getWin:function(){var b=this,a=b.frameName,c=Ext.isIE?b.iframeEl.dom.contentWindow:window.frames[a];return c},getFrame:function(){var a=this;return a.iframeEl.dom},beforeDestroy:function(){this.cleanupListeners(true);this.callParent()},cleanupListeners:function(c){var b,d;if(this.rendered){try{b=this.getDoc();if(b){Ext.get(b).un(this._docListeners);if(c){for(d in b){if(b.hasOwnProperty&&b.hasOwnProperty(d)){delete b[d]}}}}}catch(a){}}},onLoad:function(){var b=this,d=b.getDoc(),a=b.onRelayedEvent;if(d){try{Ext.get(d).on(b._docListeners={mousedown:a,mousemove:a,mouseup:a,click:a,dblclick:a,scope:b})}catch(c){}Ext.get(this.getWin()).on("beforeunload",b.cleanupListeners,b);this.el.unmask();this.fireEvent("load",this)}else{if(b.src){this.el.unmask();this.fireEvent("error",this)}}},onRelayedEvent:function(c){var b=this.iframeEl,d=b.getTrueXY(),e=c.getXY(),a=c.getTrueXY();c.xy=[d[0]+a[0],d[1]+a[1]];c.injectEvent(b);c.xy=e},load:function(d){var a=this,c=a.loadMask,b=a.getFrame();if(a.fireEvent("beforeload",a,d)!==false){if(c&&a.el){a.el.mask(c)}b.src=a.src=(d||a.src)}}});Ext.define("Ext.ux.statusbar.StatusBar",{extend:"Ext.toolbar.Toolbar",alternateClassName:"Ext.ux.StatusBar",alias:"widget.statusbar",requires:["Ext.toolbar.TextItem"],cls:"x-statusbar",busyIconCls:"x-status-busy",busyText:"Loading...",autoClear:5000,emptyText:"&#160;",activeThreadId:0,initComponent:function(){var a=this.statusAlign==="right";this.callParent(arguments);this.currIconCls=this.iconCls||this.defaultIconCls;this.statusEl=Ext.create("Ext.toolbar.TextItem",{cls:"x-status-text "+(this.currIconCls||""),text:this.text||this.defaultText||""});if(a){this.cls+=" x-status-right";this.add("->");this.add(this.statusEl)}else{this.insert(0,this.statusEl);this.insert(1,"->")}},setStatus:function(e){var a=this;e=e||{};Ext.suspendLayouts();if(Ext.isString(e)){e={text:e}}if(e.text!==undefined){a.setText(e.text)}if(e.iconCls!==undefined){a.setIcon(e.iconCls)}if(e.clear){var f=e.clear,d=a.autoClear,b={useDefaults:true,anim:true};if(Ext.isObject(f)){f=Ext.applyIf(f,b);if(f.wait){d=f.wait}}else{if(Ext.isNumber(f)){d=f;f=b}else{if(Ext.isBoolean(f)){f=b}}}f.threadId=this.activeThreadId;Ext.defer(a.clearStatus,d,a,[f])}Ext.resumeLayouts(true);return a},clearStatus:function(e){e=e||{};var c=this,b=c.statusEl;if(e.threadId&&e.threadId!==c.activeThreadId){return c}var d=e.useDefaults?c.defaultText:c.emptyText,a=e.useDefaults?(c.defaultIconCls?c.defaultIconCls:""):"";if(e.anim){b.el.puff({remove:false,useDisplay:true,callback:function(){b.el.show();c.setStatus({text:d,iconCls:a})}})}else{c.setStatus({text:d,iconCls:a})}return c},setText:function(b){var a=this;a.activeThreadId++;a.text=b||"";if(a.rendered){a.statusEl.setText(a.text)}return a},getText:function(){return this.text},setIcon:function(a){var b=this;b.activeThreadId++;a=a||"";if(b.rendered){if(b.currIconCls){b.statusEl.removeCls(b.currIconCls);b.currIconCls=null}if(a.length>0){b.statusEl.addCls(a);b.currIconCls=a}}else{b.currIconCls=a}return b},showBusy:function(a){if(Ext.isString(a)){a={text:a}}a=Ext.applyIf(a||{},{text:this.busyText,iconCls:this.busyIconCls});return this.setStatus(a)}});Ext.define("Ext.ux.LiveSearchGridPanel",{extend:"Ext.grid.Panel",requires:["Ext.toolbar.TextItem","Ext.form.field.Checkbox","Ext.form.field.Text","Ext.ux.statusbar.StatusBar"],searchValue:null,matches:[],currentIndex:null,searchRegExp:null,caseSensitive:false,regExpMode:false,matchCls:"x-livesearch-match",defaultStatusText:"Nothing Found",initComponent:function(){var a=this;a.tbar=["Search",{xtype:"textfield",name:"searchField",hideLabel:true,width:200,listeners:{change:{fn:a.onTextFieldChange,scope:this,buffer:500}}},{xtype:"button",text:"&lt;",tooltip:"Find Previous Row",handler:a.onPreviousClick,scope:a},{xtype:"button",text:"&gt;",tooltip:"Find Next Row",handler:a.onNextClick,scope:a},"-",{xtype:"checkbox",hideLabel:true,margin:"0 0 0 4px",handler:a.regExpToggle,scope:a},"Regular expression",{xtype:"checkbox",hideLabel:true,margin:"0 0 0 4px",handler:a.caseSensitiveToggle,scope:a},"Case sensitive"];a.bbar=new Ext.ux.StatusBar({defaultText:a.defaultStatusText,name:"searchStatusBar"});a.callParent(arguments)},afterRender:function(){var a=this;a.callParent(arguments);a.textField=a.down("textfield[name=searchField]");a.statusBar=a.down("statusbar[name=searchStatusBar]");a.view.on("cellkeydown",a.focusTextField,a)},focusTextField:function(b,i,c,a,f,h,g,d){if(g.getKey()===g.S){g.preventDefault();this.textField.focus()}},tagsRe:/<[^>]*>/gm,tagsProtect:"\x0f",getSearchValue:function(){var b=this,c=b.textField.getValue();if(c===""){return null}if(!b.regExpMode){c=Ext.String.escapeRegex(c)}else{try{new RegExp(c)}catch(a){b.statusBar.setStatus({text:a.message,iconCls:"x-status-error"});return null}if(c==="^"||c==="$"){return null}}return c},onTextFieldChange:function(){var f=this,e=0,b=f.view,a=b.cellSelector,c=b.innerSelector,d=f.visibleColumnManager.getColumns();b.refresh();f.statusBar.setStatus({text:f.defaultStatusText,iconCls:""});f.searchValue=f.getSearchValue();f.matches=[];f.currentIndex=null;if(f.searchValue!==null){f.searchRegExp=new RegExp(f.getSearchValue(),"g"+(f.caseSensitive?"":"i"));f.store.each(function(h,g){var i=b.getNode(h);if(i){Ext.Array.forEach(d,function(l){var j=Ext.fly(i).down(l.getCellInnerSelector(),true),n,m,k;if(j){n=j.innerHTML.match(f.tagsRe);m=j.innerHTML.replace(f.tagsRe,f.tagsProtect);m=m.replace(f.searchRegExp,function(o){++e;if(!k){f.matches.push({record:h,column:l});k=true}return'<span class="'+f.matchCls+'">'+o+"</span>"},f);Ext.each(n,function(o){m=m.replace(f.tagsProtect,o)});j.innerHTML=m}})}},f);if(e){f.currentIndex=0;f.gotoCurrent();f.statusBar.setStatus({text:Ext.String.format("{0} match{1} found.",e,e===1?"es":""),iconCls:"x-status-valid"})}}if(f.currentIndex===null){f.getSelectionModel().deselectAll();f.textField.focus()}},onPreviousClick:function(){var c=this,d=c.matches,b=d.length,a=c.currentIndex;if(b){c.currentIndex=a===0?b-1:a-1;c.gotoCurrent()}},onNextClick:function(){var c=this,d=c.matches,b=d.length,a=c.currentIndex;if(b){c.currentIndex=a===b-1?0:a+1;c.gotoCurrent()}},caseSensitiveToggle:function(b,a){this.caseSensitive=a;this.onTextFieldChange()},regExpToggle:function(b,a){this.regExpMode=a;this.onTextFieldChange()},privates:{gotoCurrent:function(){var a=this.matches[this.currentIndex];this.getNavigationModel().setPosition(a.record,a.column);this.getSelectionModel().select(a.record)}}});Ext.define("Ext.ux.PreviewPlugin",{extend:"Ext.plugin.Abstract",alias:"plugin.preview",requires:["Ext.grid.feature.RowBody"],hideBodyCls:"x-grid-row-body-hidden",bodyField:"",previewExpanded:true,setCmp:function(f){this.callParent(arguments);var d=this,c=d.cmp=f.isXType("gridview")?f.grid:f,a=d.bodyField,g=d.hideBodyCls,b=Ext.create("Ext.grid.feature.RowBody",{grid:c,getAdditionalData:function(l,i,j,m){var h=Ext.grid.feature.RowBody.prototype.getAdditionalData,k={rowBody:l[a],rowBodyCls:c.getView().previewExpanded?"":g};if(Ext.isFunction(h)){Ext.apply(k,h.apply(this,arguments))}return k}}),e=function(i,h){h.previewExpanded=d.previewExpanded;h.featuresMC.add(b);b.init(i)};if(c.view){e(c,c.view)}else{c.on({viewcreated:e,single:true})}},toggleExpanded:function(b){var c=this.getCmp(),a=c&&c.getView(),e=a.bufferedRenderer,d=a.scrollManager;if(c&&a&&b!==a.previewExpanded){this.previewExpanded=a.previewExpanded=!!b;a.refreshView();if(d){if(e){e.stretchView(a,e.getScrollHeight(true))}else{d.refresh(true)}}}}});Ext.define("Ext.ux.ProgressBarPager",{requires:["Ext.ProgressBar"],width:225,defaultText:"Loading...",defaultAnimCfg:{duration:1000,easing:"bounceOut"},constructor:function(a){if(a){Ext.apply(this,a)}},init:function(b){var a;if(b.displayInfo){this.parent=b;a=b.child("#displayItem");if(a){b.remove(a,true)}this.progressBar=Ext.create("Ext.ProgressBar",{text:this.defaultText,width:this.width,animate:this.defaultAnimCfg,style:{cursor:"pointer"},listeners:{el:{scope:this,click:this.handleProgressBarClick}}});b.displayItem=this.progressBar;b.add(b.displayItem);Ext.apply(b,this.parentOverrides)}},handleProgressBarClick:function(i){var f=this.parent,c=f.displayItem,g=this.progressBar.getBox(),h=i.getXY(),b=h[0]-g.x,a=Math.ceil(f.store.getTotalCount()/f.pageSize),d=Math.max(Math.ceil(b/(c.width/a)),1);f.store.loadPage(d)},parentOverrides:{updateInfo:function(){if(this.displayItem){var d=this.store.getCount(),b=this.getPageData(),c=d===0?this.emptyMsg:Ext.String.format(this.displayMsg,b.fromRecord,b.toRecord,this.store.getTotalCount()),a=b.pageCount>0?(b.currentPage/b.pageCount):0;this.displayItem.updateProgress(a,c,this.animate||this.defaultAnimConfig)}}}});Ext.define("Ext.ux.RowExpander",{extend:"Ext.grid.plugin.RowExpander"});Ext.define("Ext.ux.SlidingPager",{requires:["Ext.slider.Single","Ext.slider.Tip"],constructor:function(a){if(a){Ext.apply(this,a)}},init:function(b){var a=b.items.indexOf(b.child("#inputItem")),c;Ext.each(b.items.getRange(a-2,a+2),function(d){d.hide()});c=Ext.create("Ext.slider.Single",{width:114,minValue:1,maxValue:1,hideLabel:true,tipText:function(d){return Ext.String.format("Page <b>{0}</b> of <b>{1}</b>",d.value,d.slider.maxValue)},listeners:{changecomplete:function(e,d){b.store.loadPage(d)}}});b.insert(a+1,c);b.on({change:function(d,e){c.setMaxValue(e.pageCount);c.setValue(e.currentPage)}})}});Ext.define("Ext.ux.Spotlight",{baseCls:"x-spotlight",animate:true,duration:250,easing:null,active:false,constructor:function(a){Ext.apply(this,a)},createElements:function(){var c=this,b=c.baseCls,a=Ext.getBody();c.right=a.createChild({cls:b});c.left=a.createChild({cls:b});c.top=a.createChild({cls:b});c.bottom=a.createChild({cls:b});c.all=Ext.create("Ext.CompositeElement",[c.right,c.left,c.top,c.bottom])},show:function(b,d,a){var c=this;c.el=Ext.get(b);if(!c.right){c.createElements()}if(!c.active){c.all.setDisplayed("");c.active=true;Ext.on("resize",c.syncSize,c);c.applyBounds(c.animate,false)}else{c.applyBounds(false,false)}},hide:function(c,a){var b=this;Ext.un("resize",b.syncSize,b);b.applyBounds(b.animate,true)},syncSize:function(){this.applyBounds(false,false)},applyBounds:function(a,g){var j=this,e=j.el.getBox(),f=Ext.Element.getViewportWidth(),c=Ext.Element.getViewportHeight(),d=0,b=false,l,k,h;l={right:{x:e.right,y:c,width:(f-e.right),height:0},left:{x:0,y:0,width:e.x,height:0},top:{x:f,y:0,width:0,height:e.y},bottom:{x:0,y:(e.y+e.height),width:0,height:(c-(e.y+e.height))+"px"}};k={right:{x:e.right,y:e.y,width:(f-e.right)+"px",height:(c-e.y)+"px"},left:{x:0,y:0,width:e.x+"px",height:(e.y+e.height)+"px"},top:{x:e.x,y:0,width:(f-e.x)+"px",height:e.y+"px"},bottom:{x:0,y:(e.y+e.height),width:(e.x+e.width)+"px",height:(c-(e.y+e.height))+"px"}};if(g){h=Ext.clone(l);l=k;k=h}if(a){Ext.Array.forEach(["right","left","top","bottom"],function(i){j[i].setBox(l[i]);j[i].animate({duration:j.duration,easing:j.easing,to:k[i]})},this)}else{Ext.Array.forEach(["right","left","top","bottom"],function(i){j[i].setBox(Ext.apply(l[i],k[i]));j[i].repaint()},this)}},destroy:function(){var a=this;Ext.destroy(a.right,a.left,a.top,a.bottom);delete a.el;delete a.all}});Ext.define("Ext.ux.TabCloseMenu",{extend:"Ext.plugin.Abstract",alias:"plugin.tabclosemenu",mixins:{observable:"Ext.util.Observable"},closeTabText:"Close Tab",showCloseOthers:true,closeOthersTabsText:"Close Other Tabs",showCloseAll:true,closeAllTabsText:"Close All Tabs",extraItemsHead:null,extraItemsTail:null,constructor:function(a){this.callParent([a]);this.mixins.observable.constructor.call(this,a)},init:function(a){this.tabPanel=a;this.tabBar=a.down("tabbar");this.mon(this.tabPanel,{scope:this,afterlayout:this.onAfterLayout,single:true})},onAfterLayout:function(){this.mon(this.tabBar.el,{scope:this,contextmenu:this.onContextMenu,delegate:".x-tab"})},destroy:function(){this.callParent();Ext.destroy(this.menu)},onContextMenu:function(d,f){var c=this,g=c.createMenu(),e=true,h=true,b=c.tabBar.getChildByElement(f),a=c.tabBar.items.indexOf(b);c.item=c.tabPanel.getComponent(a);g.child("#close").setDisabled(!c.item.closable);if(c.showCloseAll||c.showCloseOthers){c.tabPanel.items.each(function(i){if(i.closable){e=false;if(i!==c.item){h=false;return false}}return true});if(c.showCloseAll){g.child("#closeAll").setDisabled(e)}if(c.showCloseOthers){g.child("#closeOthers").setDisabled(h)}}d.preventDefault();c.fireEvent("beforemenu",g,c.item,c);g.showAt(d.getXY())},createMenu:function(){var b=this;if(!b.menu){var a=[{itemId:"close",text:b.closeTabText,scope:b,handler:b.onClose}];if(b.showCloseAll||b.showCloseOthers){a.push("-")}if(b.showCloseOthers){a.push({itemId:"closeOthers",text:b.closeOthersTabsText,scope:b,handler:b.onCloseOthers})}if(b.showCloseAll){a.push({itemId:"closeAll",text:b.closeAllTabsText,scope:b,handler:b.onCloseAll})}if(b.extraItemsHead){a=b.extraItemsHead.concat(a)}if(b.extraItemsTail){a=a.concat(b.extraItemsTail)}b.menu=Ext.create("Ext.menu.Menu",{items:a,listeners:{hide:b.onHideMenu,scope:b}})}return b.menu},onHideMenu:function(){var a=this;a.fireEvent("aftermenu",a.menu,a)},onClose:function(){this.tabPanel.remove(this.item)},onCloseOthers:function(){this.doClose(true)},onCloseAll:function(){this.doClose(false)},doClose:function(b){var a=[];this.tabPanel.items.each(function(c){if(c.closable){if(!b||c!==this.item){a.push(c)}}},this);Ext.suspendLayouts();Ext.Array.forEach(a,function(c){this.tabPanel.remove(c)},this);Ext.resumeLayouts(true)}});Ext.define("Ext.ux.TabReorderer",{extend:"Ext.ux.BoxReorderer",alias:"plugin.tabreorderer",itemSelector:"."+Ext.baseCSSPrefix+"tab",init:function(b){var a=this;a.callParent([b.getTabBar()]);b.onAdd=Ext.Function.createSequence(b.onAdd,a.onAdd)},onBoxReady:function(){var c,a,b=0,d;this.callParent(arguments);for(c=this.container.items.items,a=c.length;b<a;b++){d=c[b];if(d.card){d.reorderable=d.card.reorderable}}},onAdd:function(b,a){b.tab.reorderable=b.reorderable},afterBoxReflow:function(){var a=this;Ext.ux.BoxReorderer.prototype.afterBoxReflow.apply(a,arguments);if(a.dragCmp){a.container.tabPanel.setActiveTab(a.dragCmp.card);a.container.tabPanel.move(a.dragCmp.card,a.curIndex)}}});Ext.ns("Ext.ux");Ext.define("Ext.ux.TabScrollerMenu",{alias:"plugin.tabscrollermenu",requires:["Ext.menu.Menu"],pageSize:10,maxText:15,menuPrefixText:"Items",constructor:function(a){Ext.apply(this,a)},init:function(b){var a=this;a.tabPanel=b;b.on({render:function(){a.tabBar=b.tabBar;a.layout=a.tabBar.layout;a.layout.overflowHandler.handleOverflow=Ext.Function.bind(a.showButton,a);a.layout.overflowHandler.clearOverflow=Ext.Function.createSequence(a.layout.overflowHandler.clearOverflow,a.hideButton,a)},destroy:a.destroy,scope:a,single:true})},showButton:function(){var c=this,a=Ext.getClass(c.layout.overflowHandler).prototype.handleOverflow.apply(c.layout.overflowHandler,arguments),b=c.menuButton;if(c.tabPanel.items.getCount()>1){if(!b){b=c.menuButton=c.tabBar.body.createChild({cls:Ext.baseCSSPrefix+"tab-tabmenu-right"},c.tabBar.body.child("."+Ext.baseCSSPrefix+"box-scroller-right"));b.addClsOnOver(Ext.baseCSSPrefix+"tab-tabmenu-over");b.on("click",c.showTabsMenu,c)}b.setVisibilityMode(Ext.dom.Element.DISPLAY);b.show();a.reservedSpace+=b.getWidth()}else{c.hideButton()}return a},hideButton:function(){var a=this;if(a.menuButton){a.menuButton.hide()}},getPageSize:function(){return this.pageSize},setPageSize:function(a){this.pageSize=a},getMaxText:function(){return this.maxText},setMaxText:function(a){this.maxText=a},getMenuPrefixText:function(){return this.menuPrefixText},setMenuPrefixText:function(a){this.menuPrefixText=a},showTabsMenu:function(d){var a=this;if(a.tabsMenu){a.tabsMenu.removeAll()}else{a.tabsMenu=new Ext.menu.Menu()}a.generateTabMenuItems();var c=Ext.get(d.getTarget()),b=c.getXY();b[1]+=24;a.tabsMenu.showAt(b)},generateTabMenuItems:function(){var l=this,h=l.tabPanel,a=h.getActiveTab(),j=h.items.getRange(),m=l.getPageSize(),e=l.tabsMenu,q,d,o,f,k,b,n,p,c,g;e.suspendLayouts();j=Ext.Array.filter(j,function(i){if(i.id==a.id){return false}return i.hidden?!!i.hiddenByLayout:true});q=j.length;d=Math.floor(q/m);o=q%m;if(q>m){for(f=0;f<d;f++){k=(f+1)*m;b=[];for(n=0;n<m;n++){g=n+k-m;p=j[g];b.push(l.autoGenMenuItem(p))}e.add({text:l.getMenuPrefixText()+" "+(k-m+1)+" - "+k,menu:b})}if(o>0){c=d*m;b=[];for(f=c;f<q;f++){p=j[f];b.push(l.autoGenMenuItem(p))}l.tabsMenu.add({text:l.menuPrefixText+" "+(c+1)+" - "+(c+b.length),menu:b})}}else{for(f=0;f<q;++f){e.add(l.autoGenMenuItem(j[f]))}}e.resumeLayouts(true)},autoGenMenuItem:function(b){var a=this.getMaxText(),c=Ext.util.Format.ellipsis(b.title,a);return{text:c,handler:this.showTabFromMenu,scope:this,disabled:b.disabled,tabToShow:b,iconCls:b.iconCls}},showTabFromMenu:function(a){this.tabPanel.setActiveTab(a.tabToShow)},destroy:function(){Ext.destroy(this.tabsMenu,this.menuButton)}});Ext.define("Ext.ux.ToolbarDroppable",{constructor:function(a){Ext.apply(this,a)},init:function(a){this.toolbar=a;this.toolbar.on({scope:this,render:this.createDropTarget})},createDropTarget:function(){this.dropTarget=Ext.create("Ext.dd.DropTarget",this.toolbar.getEl(),{notifyOver:Ext.Function.bind(this.notifyOver,this),notifyDrop:Ext.Function.bind(this.notifyDrop,this)})},addDDGroup:function(a){this.dropTarget.addToGroup(a)},calculateEntryIndex:function(h){var j=0,k=this.toolbar,i=k.items.items,f=i.length,b=h.getXY()[0],g=0,c,d,a,l;for(;g<f;g++){c=i[g].getEl();d=c.getXY()[0];a=c.getWidth();l=d+a/2;if(b<l){j=g;break}else{j=g+1}}return j},canDrop:function(a){return true},notifyOver:function(a,b,c){return this.canDrop.apply(this,arguments)?this.dropTarget.dropAllowed:this.dropTarget.dropNotAllowed},notifyDrop:function(a,d,e){var c=this.canDrop(a,d,e),f=this.toolbar;if(c){var b=this.calculateEntryIndex(d);f.insert(b,this.createItem(e));f.doLayout();this.afterLayout()}return c},createItem:function(a){},afterLayout:Ext.emptyFn});Ext.define("Ext.ux.TreePicker",{extend:"Ext.form.field.Picker",xtype:"treepicker",uses:["Ext.tree.Panel"],triggerCls:Ext.baseCSSPrefix+"form-arrow-trigger",config:{store:null,displayField:null,columns:null,selectOnTab:true,maxPickerHeight:300,minPickerHeight:100},editable:false,initComponent:function(){var a=this;a.callParent(arguments);a.mon(a.store,{scope:a,load:a.onLoad,update:a.onUpdate})},createPicker:function(){var c=this,b=new Ext.tree.Panel({shrinkWrapDock:2,store:c.store,floating:true,displayField:c.displayField,columns:c.columns,minHeight:c.minPickerHeight,maxHeight:c.maxPickerHeight,manageHeight:false,shadow:false,listeners:{scope:c,itemclick:c.onItemClick},viewConfig:{listeners:{scope:c,render:c.onViewRender}}}),a=b.getView();if(Ext.isIE9&&Ext.isStrict){a.on({scope:c,highlightitem:c.repaintPickerView,unhighlightitem:c.repaintPickerView,afteritemexpand:c.repaintPickerView,afteritemcollapse:c.repaintPickerView})}return b},onViewRender:function(a){a.getEl().on("keypress",this.onPickerKeypress,this)},repaintPickerView:function(){var a=this.picker.getView().getEl().dom.style;a.display=a.display},onItemClick:function(b,a,c,f,d){this.selectItem(a)},onPickerKeypress:function(c,b){var a=c.getKey();if(a===c.ENTER||(a===c.TAB&&this.selectOnTab)){this.selectItem(this.picker.getSelectionModel().getSelection()[0])}},selectItem:function(a){var b=this;b.setValue(a.getId());b.fireEvent("select",b,a);b.collapse()},onExpand:function(){var d=this,b=d.picker,a=b.store,e=d.value,c;if(e){c=a.getNodeById(e)}if(!c){c=a.getRoot()}b.selectPath(c.getPath())},setValue:function(c){var b=this,a;b.value=c;if(b.store.loading){return b}a=c?b.store.getNodeById(c):b.store.getRoot();if(c===undefined){a=b.store.getRoot();b.value=a.getId()}else{a=b.store.getNodeById(c)}b.setRawValue(a?a.get(b.displayField):"");return b},getSubmitValue:function(){return this.value},getValue:function(){return this.value},onLoad:function(){var a=this.value;if(a){this.setValue(a)}},onUpdate:function(a,e,b,c){var d=this.displayField;if(b==="edit"&&c&&Ext.Array.contains(c,d)&&this.value===e.getId()){this.setRawValue(e.get(d))}}});Ext.define("Ext.ux.ajax.Simlet",function(){var d=/([^?#]*)(#.*)?$/,a=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)Z$/,b=/^[+-]?\d+$/,c=/^[+-]?\d+\.\d+$/;function e(g){var f;if(Ext.isDefined(g)){g=decodeURIComponent(g);if(b.test(g)){g=parseInt(g,10)}else{if(c.test(g)){g=parseFloat(g)}else{if(!!(f=a.test(g))){g=new Date(Date.UTC(+f[1],+f[2]-1,+f[3],+f[4],+f[5],+f[6]))}}}}return g}return{alias:"simlet.basic",isSimlet:true,responseProps:["responseText","responseXML","status","statusText"],status:200,statusText:"OK",constructor:function(f){Ext.apply(this,f)},doGet:function(f){var h=this,g={};Ext.Array.forEach(h.responseProps,function(i){if(i in h){g[i]=h[i]}});return g},doPost:function(f){var h=this,g={};Ext.Array.forEach(h.responseProps,function(i){if(i in h){g[i]=h[i]}});return g},doRedirect:function(f){return false},doDelete:function(f){var h=this,i=f.xhr,g=i.options.records;h.removeFromData(f,g)},exec:function(i){var h=this,f={},j="do"+Ext.String.capitalize(i.method.toLowerCase()),g=h[j];if(g){f=g.call(h,h.getCtx(i.method,i.url,i))}else{f={status:405,statusText:"Method Not Allowed"}}return f},getCtx:function(h,f,g){return{method:h,params:this.parseQueryString(f),url:f,xhr:g}},openRequest:function(l,h,g,i){var f=this.getCtx(l,h),k=this.doRedirect(f),j;if(g.action==="destroy"){l="delete"}if(k){j=k}else{j=new Ext.ux.ajax.SimXhr({mgr:this.manager,simlet:this,options:g});j.open(l,h,i)}return j},parseQueryString:function(o){var g=d.exec(o),l={},q,p,k,f;if(g&&g[1]){var j,h=g[1].split("&");for(k=0,f=h.length;k<f;++k){if((j=h[k].split("="))[0]){q=decodeURIComponent(j.shift());p=e((j.length>1)?j.join("="):j[0]);if(!(q in l)){l[q]=p}else{if(Ext.isArray(l[q])){l[q].push(p)}else{l[q]=[l[q],p]}}}}}return l},redirect:function(h,f,g){switch(arguments.length){case 2:if(typeof f=="string"){break}g=f;case 1:f=h;h="GET";break}if(g){f=Ext.urlAppend(f,Ext.Object.toQueryString(g))}return this.manager.openRequest(h,f)},removeFromData:function(f,g){var j=this,k=j.getData(f),i=(f.xhr.options.proxy&&f.xhr.options.proxy.getModel())||{},h=i.idProperty||"id";Ext.each(g,function(l){var n=l.get(h);for(var m=k.length;m-->0;){if(k[m][h]===n){j.deleteRecord(m);break}}})}}}());Ext.define("Ext.ux.ajax.DataSimlet",function(){function b(f,e){var c=f.direction,d=(c&&c.toUpperCase()==="DESC")?-1:1;return function(h,i){var g=h[f.property],k=i[f.property],j=(g<k)?-1:((k<g)?1:0);if(j||!e){return j*d}return e(h,i)}}function a(c,e){for(var f=e,d=c&&c.length;d;){f=b(c[--d],f)}return f}return{extend:"Ext.ux.ajax.Simlet",buildNodes:function(g,l){var k=this,d={data:[]},j=g.length,f,h,e,c;k.nodes[l]=d;for(h=0;h<j;++h){d.data.push(e=g[h]);c=e.text||e.title;e.id=l?l+"/"+c:c;f=e.children;if(!(e.leaf=!f)){delete e.children;k.buildNodes(f,e.id)}}},deleteRecord:function(c){if(this.data&&typeof this.data!=="function"){Ext.Array.removeAt(this.data,c)}},fixTree:function(d,c){var g=this,f=d.params.node,e;if(!(e=g.nodes)){g.nodes=e={};g.buildNodes(c,"")}f=e[f];if(f){if(g.node){g.node.sortedData=g.sortedData;g.node.currentOrder=g.currentOrder}g.node=f;g.data=f.data;g.sortedData=f.sortedData;g.currentOrder=f.currentOrder}else{g.data=null}},getData:function(k){var i=this,f=k.params,e=(f.filter||"")+(f.group||"")+"-"+(f.sort||"")+"-"+(f.dir||""),l=i.tree,c,g,h,j;if(l){i.fixTree(k,l)}g=i.data;if(typeof g==="function"){c=true;g=g.call(this,k)}if(!g||e==="--"){return g||[]}if(!c&&e==i.currentOrder){return i.sortedData}k.filterSpec=f.filter&&Ext.decode(f.filter);k.groupSpec=f.group&&Ext.decode(f.group);h=f.sort;if(f.dir){h=[{direction:f.dir,property:h}]}else{h=Ext.decode(f.sort)}if(k.filterSpec){var d=new Ext.util.FilterCollection();d.add(this.processFilters(k.filterSpec));g=Ext.Array.filter(g,d.getFilterFn())}j=a((k.sortSpec=h));if(k.groupSpec){j=a([k.groupSpec],j)}g=Ext.isArray(g)?g.slice(0):g;if(j){Ext.Array.sort(g,j)}i.sortedData=g;i.currentOrder=e;return g},processFilters:Ext.identityFn,getPage:function(d,g){var e=g,f=g.length,h=d.params.start||0,c=d.params.limit?Math.min(f,h+d.params.limit):f;if(h||c<f){e=e.slice(h,c)}return e},getGroupSummary:function(d,e,c){return e[0]},getSummary:function(m,g,h){var j=this,c=m.groupSpec.property,k,f={},i=[],d,e;Ext.each(h,function(n){d=n[c];f[d]=true});function l(){if(k){i.push(j.getGroupSummary(c,k,m));k=null}}Ext.each(g,function(n){d=n[c];if(e!==d){l();e=d}if(!f[d]){return !i.length}if(k){k.push(n)}else{k=[n]}return true});l();return i}}}());Ext.define("Ext.ux.ajax.JsonSimlet",{extend:"Ext.ux.ajax.DataSimlet",alias:"simlet.json",doGet:function(c){var f=this,h=f.getData(c),g=f.getPage(c,h),a=c.xhr.options.proxy&&c.xhr.options.proxy.getReader(),b=a&&a.getRootProperty(),e=f.callParent(arguments),d={};if(b&&Ext.isArray(g)){d[b]=g;d[a.getTotalProperty()]=h.length}else{d=g}if(c.groupSpec){d.summaryData=f.getSummary(c,h,g)}e.responseText=Ext.encode(d);return e},doPost:function(a){return this.doGet(a)}});Ext.define("Ext.ux.ajax.SimXhr",{readyState:0,mgr:null,simlet:null,constructor:function(a){var b=this;Ext.apply(b,a);b.requestHeaders={}},abort:function(){var a=this;if(a.timer){clearTimeout(a.timer);a.timer=null}a.aborted=true},getAllResponseHeaders:function(){var a=[];if(Ext.isObject(this.responseHeaders)){Ext.Object.each(this.responseHeaders,function(b,c){a.push(b+": "+c)})}return a.join("\r\n")},getResponseHeader:function(b){var a=this.responseHeaders;return(a&&a[b])||null},open:function(f,c,d,a,b){var e=this;e.method=f;e.url=c;e.async=d!==false;e.user=a;e.password=b;e.setReadyState(1)},overrideMimeType:function(a){this.mimeType=a},schedule:function(){var b=this,a=b.mgr.delay;if(a){b.timer=setTimeout(function(){b.onTick()},a)}else{b.onTick()}},send:function(a){var b=this;b.body=a;if(b.async){b.schedule()}else{b.onComplete()}},setReadyState:function(b){var a=this;if(a.readyState!=b){a.readyState=b;a.onreadystatechange()}},setRequestHeader:function(b,a){this.requestHeaders[b]=a},onreadystatechange:Ext.emptyFn,onComplete:function(){var me=this,callback;me.readyState=4;Ext.apply(me,me.simlet.exec(me));callback=me.jsonpCallback;if(callback){var text=callback+"("+me.responseText+")";eval(text)}},onTick:function(){var a=this;a.timer=null;a.onComplete();a.onreadystatechange&&a.onreadystatechange()}});Ext.define("Ext.ux.ajax.SimManager",{singleton:true,requires:["Ext.data.Connection","Ext.ux.ajax.SimXhr","Ext.ux.ajax.Simlet","Ext.ux.ajax.JsonSimlet"],defaultType:"basic",delay:150,ready:false,constructor:function(){this.simlets=[]},getSimlet:function(a){var g=this,e=a.indexOf("?"),b=g.simlets,f=b.length,c,j,h,d;if(e<0){e=a.indexOf("#")}if(e>0){a=a.substring(0,e)}for(c=0;c<f;++c){j=b[c];h=j.url;if(h instanceof RegExp){d=h.test(a)}else{d=h===a}if(d){return j}}return g.defaultSimlet},getXhr:function(e,b,a,c){var d=this.getSimlet(b);if(d){return d.openRequest(e,b,a,c)}return null},init:function(a){var b=this;Ext.apply(b,a);if(!b.ready){b.ready=true;if(!("defaultSimlet" in b)){b.defaultSimlet=new Ext.ux.ajax.Simlet({status:404,statusText:"Not Found"})}b._openRequest=Ext.data.Connection.prototype.openRequest;Ext.data.Connection.override({openRequest:function(d,c,e){var f=!d.nosim&&b.getXhr(c.method,c.url,d,e);if(!f){f=this.callParent(arguments)}return f}});if(Ext.data.JsonP){Ext.data.JsonP.self.override({createScript:function(f,g,e){var c=Ext.urlAppend(f,Ext.Object.toQueryString(g)),d=!e.nosim&&b.getXhr("GET",c,e,true);if(!d){d=this.callParent(arguments)}return d},loadScript:function(d){var c=d.script;if(c.simlet){c.jsonpCallback=d.params[d.callbackKey];c.send(null);d.script=document.createElement("script")}else{this.callParent(arguments)}}})}}return b},openRequest:function(d,a,c){var b={method:d,url:a};return this._openRequest.call(Ext.data.Connection.prototype,{},b,c)},register:function(c){var b=this;b.init();function a(d){var e=d;if(!e.isSimlet){e=Ext.create("simlet."+(e.type||e.stype||b.defaultType),d)}b.simlets.push(e);e.manager=b}if(Ext.isArray(c)){Ext.each(c,a)}else{if(c.isSimlet||c.url){a(c)}else{Ext.Object.each(c,function(d,e){e.url=d;a(e)})}}return b}});Ext.define("Ext.ux.ajax.XmlSimlet",{extend:"Ext.ux.ajax.DataSimlet",alias:"simlet.xml",xmlTpl:["<{root}>\n",'<tpl for="data">',"    <{parent.record}>\n",'<tpl for="parent.fields">',"        <{name}>{[parent[values.name]]}</{name}>\n","</tpl>","    </{parent.record}>\n","</tpl>","</{root}>"],doGet:function(l){var j=this,b=j.getData(l),h=j.getPage(l,b),i=l.xhr.options.operation.getProxy(),e=i&&i.getReader(),d=e&&e.getModel(),g=j.callParent(arguments),a={data:h,reader:e,fields:d&&d.fields,root:e&&e.getRootProperty(),record:e&&e.record},f,c,k;if(l.groupSpec){a.summaryData=j.getSummary(l,b,h)}if(j.xmlTpl){f=Ext.XTemplate.getTpl(j,"xmlTpl");c=f.apply(a)}else{c=b}if(typeof DOMParser!="undefined"){k=(new DOMParser()).parseFromString(c,"text/xml")}else{k=new ActiveXObject("Microsoft.XMLDOM");k.async=false;k.loadXML(c)}g.responseText=c;g.responseXML=k;return g},fixTree:function(){this.callParent(arguments);var a=[];this.buildTreeXml(this.data,a);this.data=a.join("")},buildTreeXml:function(c,b){var a=this.rootProperty,d=this.recordProperty;b.push("<",a,">");Ext.Array.forEach(c,function(f){b.push("<",d,">");for(var e in f){if(e=="children"){this.buildTreeXml(f.children,b)}else{b.push("<",e,">",f[e],"</",e,">")}}b.push("</",d,">")});b.push("</",a,">")}});Ext.define("Ext.ux.google.Api",{mixins:["Ext.mixin.Mashup"],requiredScripts:["//www.google.com/jsapi"],statics:{loadedModules:{}},onClassExtended:function(c,d,a){var e=a.onBeforeCreated,b=this;a.onBeforeCreated=function(q,j){var n=this,k=[],o=Ext.Array.from(j.requiresGoogle),m=b.loadedModules,g=0,p=function(){if(!--g){e.call(n,q,j,a)}Ext.env.Ready.unblock()},l,h,f;f=o.length;for(h=0;h<f;++h){if(Ext.isString(l=o[h])){k.push({api:l})}else{if(Ext.isObject(l)){k.push(Ext.apply({},l))}}}Ext.each(k,function(t){var r=t.api,i=String(t.version||"1.x"),s=m[r];if(!s){++g;Ext.env.Ready.block();m[r]=s=[p].concat(t.callback||[]);delete t.api;delete t.version;google.load(r,i,Ext.applyIf({callback:function(){m[r]=true;for(var u=s.length;u-->0;){s[u]()}}},t))}else{if(s!==true){s.push(p)}}});if(!g){e.call(n,q,j,a)}}}});Ext.define("Ext.ux.google.Feeds",{extend:"Ext.ux.google.Api",requiresGoogle:{api:"feeds",nocss:true}});Ext.define("Ext.ux.dashboard.GoogleRssView",{extend:"Ext.Component",requires:["Ext.tip.ToolTip","Ext.ux.google.Feeds"],feedCls:Ext.baseCSSPrefix+"dashboard-googlerss",previewCls:Ext.baseCSSPrefix+"dashboard-googlerss-preview",closeDetailsCls:Ext.baseCSSPrefix+"dashboard-googlerss-close",nextCls:Ext.baseCSSPrefix+"dashboard-googlerss-next",prevCls:Ext.baseCSSPrefix+"dashboard-googlerss-prev",feedUrl:null,scrollable:true,maxFeedEntries:10,previewTips:false,mode:"detail",closeDetailsGlyph:"8657@",prevGlyph:"9664@",nextGlyph:"9654@",detailTpl:'<tpl for="entries[currentEntry]"><div class="'+Ext.baseCSSPrefix+'dashboard-googlerss-detail-header"><div class="'+Ext.baseCSSPrefix+'dashboard-googlerss-detail-nav"><tpl if="parent.hasPrev"><span class="'+Ext.baseCSSPrefix+"dashboard-googlerss-prev "+Ext.baseCSSPrefix+'dashboard-googlerss-glyph">{parent.prevGlyph}</span> </tpl> {[parent.currentEntry+1]}/{parent.numEntries} <span class="'+Ext.baseCSSPrefix+"dashboard-googlerss-next "+Ext.baseCSSPrefix+'dashboard-googlerss-glyph"<tpl if="!parent.hasNext"> style="visibility:hidden"</tpl>> {parent.nextGlyph}</span> <span class="'+Ext.baseCSSPrefix+"dashboard-googlerss-close "+Ext.baseCSSPrefix+'dashboard-googlerss-glyph"> {parent.closeGlyph}</span> </div><div class="'+Ext.baseCSSPrefix+'dashboard-googlerss-title"><a href="{link}" target=_blank>{title}</a></div><div class="'+Ext.baseCSSPrefix+'dashboard-googlerss-author">By {author} - {publishedDate:this.date}</div></div><div class="'+Ext.baseCSSPrefix+'dashboard-googlerss-detail">{content}</div></tpl>',summaryTpl:'<tpl for="entries"><div class="'+Ext.baseCSSPrefix+'dashboard-googlerss"><span class="'+Ext.baseCSSPrefix+'dashboard-googlerss-title"><a href="{link}" target=_blank>{title}</a></span> <img src="'+Ext.BLANK_IMAGE_URL+'" data-index="{#}" class="'+Ext.baseCSSPrefix+'dashboard-googlerss-preview"><br><span class="'+Ext.baseCSSPrefix+'dashboard-googlerss-author">By {author} - {publishedDate:this.date}</span><br><span class="'+Ext.baseCSSPrefix+'dashboard-googlerss-snippet">{contentSnippet}</span><br></div></tpl>',initComponent:function(){var a=this;a.feedMgr=new google.feeds.Feed(a.feedUrl);a.callParent()},afterRender:function(){var a=this;a.callParent();if(a.feedMgr){a.refresh()}a.el.on({click:a.onClick,scope:a});if(a.previewTips){a.tip=new Ext.tip.ToolTip({target:a.el,delegate:"."+a.previewCls,maxWidth:800,showDelay:750,autoHide:false,scrollable:true,anchor:"top",listeners:{beforeshow:"onBeforeShowTip",scope:a}})}},formatDate:function(b){if(!b){return""}b=new Date(b);var a=new Date(),e=Ext.Date.clearTime(a,true),c=Ext.Date.clearTime(b,true).getTime();if(c===e.getTime()){return"Today "+Ext.Date.format(b,"g:i a")}e=Ext.Date.add(e,"d",-6);if(e.getTime()<=c){return Ext.Date.format(b,"D g:i a")}if(e.getYear()===a.getYear()){return Ext.Date.format(b,"D M d \\a\\t g:i a")}return Ext.Date.format(b,"D M d, Y \\a\\t g:i a")},getTitle:function(){var a=this.data;return a&&a.title},onBeforeShowTip:function(c){if(this.mode!=="summary"){return false}var b=c.triggerElement,a=parseInt(b.getAttribute("data-index"),10);c.maxHeight=Ext.Element.getViewportHeight()/2;c.update(this.data.entries[a-1].content)},onClick:function(d){var b=this,a=b.data.currentEntry,c=Ext.fly(d.getTarget());if(c.hasCls(b.nextCls)){b.setCurrentEntry(a+1)}else{if(c.hasCls(b.prevCls)){b.setCurrentEntry(a-1)}else{if(c.hasCls(b.closeDetailsCls)){b.setMode("summary")}else{if(c.hasCls(b.previewCls)){b.setMode("detail",parseInt(c.getAttribute("data-index"),10))}}}}},refresh:function(){var a=this;if(!a.feedMgr){return}a.fireEvent("beforeload",a);a.feedMgr.setNumEntries(a.maxFeedEntries);a.feedMgr.load(function(b){a.setFeedData(b.feed);a.fireEvent("load",a)})},setCurrentEntry:function(a){this.setMode(this.mode,a)},setFeedData:function(b){var d=this,a=b.entries,c=a&&a.length||0,e=Ext.apply({numEntries:c,closeGlyph:d.wrapGlyph(d.closeDetailsGlyph),prevGlyph:d.wrapGlyph(d.prevGlyph),nextGlyph:d.wrapGlyph(d.nextGlyph),currentEntry:0},b);d.data=e;d.setMode(d.mode)},setMode:function(e,a){var b=this,c=b.data,d=(a===undefined)?c.currentEntry:a;b.tpl=b.getTpl(e+"Tpl");b.tpl.date=b.formatDate;b.mode=e;c.currentEntry=d;c.hasNext=d+1<c.numEntries;c.hasPrev=d>0;b.update(c);b.el.dom.scrollTop=0},wrapGlyph:function(c){var d=Ext._glyphFontFamily,b,a;if(typeof c==="string"){b=c.split("@");c=b[0];d=b[1]}a="&#"+c+";";if(d){a='<span style="font-family:'+d+'">'+a+"</span>"}return a},beforeDestroy:function(){Ext.destroy(this.tip);this.callParent()}});Ext.define("Ext.ux.dashboard.GoogleRssPart",{extend:"Ext.dashboard.Part",alias:"part.google-rss",requires:["Ext.window.MessageBox","Ext.ux.dashboard.GoogleRssView"],viewTemplate:{layout:"fit",items:{xclass:"Ext.ux.dashboard.GoogleRssView",feedUrl:"{feedUrl}"}},type:"google-rss",config:{suggestedFeed:"http://rss.slashdot.org/Slashdot/slashdot"},formTitleAdd:"Add RSS Feed",formTitleEdit:"Edit RSS Feed",formLabel:"RSS Feed URL",displayForm:function(a,b,g,d){var e=this,c=b?b.feedUrl:e.getSuggestedFeed(),f=a?e.formTitleEdit:e.formTitleAdd;Ext.Msg.prompt(f,e.formLabel,function(h,i){if(h==="ok"){g.call(d||e,{feedUrl:i})}},e,false,c)}});Ext.define("Ext.ux.data.PagingMemoryProxy",{extend:"Ext.data.proxy.Memory",alias:"proxy.pagingmemory",alternateClassName:"Ext.data.PagingMemoryProxy",constructor:function(){Ext.log.warn("Ext.ux.data.PagingMemoryProxy functionality has been merged into Ext.data.proxy.Memory by using the enablePaging flag.");this.callParent(arguments)},read:function(c,g,h){var d=this.getReader(),i=d.read(this.data),e,a,f,b;h=h||this;a=c.filters;if(a.length>0){b=[];Ext.each(i.records,function(j){var o=true,p=a.length,k;for(k=0;k<p;k++){var n=a[k],m=n.filterFn,l=n.scope;o=o&&m.call(l,j)}if(o){b.push(j)}},this);i.records=b;i.totalRecords=i.total=b.length}e=c.sorters;if(e.length>0){f=function(l,k){var j=e[0].sort(l,k),n=e.length,m;for(m=1;m<n;m++){j=j||e[m].sort.call(this,l,k)}return j};i.records.sort(f)}if(c.start!==undefined&&c.limit!==undefined){i.records=i.records.slice(c.start,c.start+c.limit);i.count=i.records.length}Ext.apply(c,{resultSet:i});c.setCompleted();c.setSuccessful();Ext.Function.defer(function(){Ext.callback(g,h,[c])},10)}});Ext.define("Ext.ux.dd.CellFieldDropZone",{extend:"Ext.dd.DropZone",constructor:function(a){a=a||{};if(a.onCellDrop){this.onCellDrop=a.onCellDrop}if(a.ddGroup){this.ddGroup=a.ddGroup}},init:function(a){var b=this;if(a.rendered){b.grid=a;a.getView().on({render:function(c){b.view=c;Ext.ux.dd.CellFieldDropZone.superclass.constructor.call(b,b.view.el)},single:true})}else{a.on("render",b.init,b,{single:true})}},containerScroll:true,getTargetFromEvent:function(f){var d=this,b=d.view;var a=f.getTarget(b.getCellSelector());if(a){var g=b.findItemByChild(a),c=a.cellIndex;if(g&&Ext.isDefined(c)){return{node:a,record:b.getRecord(g),fieldName:d.grid.getVisibleColumnManager().getColumns()[c].dataIndex}}}},onNodeEnter:function(h,a,g,d){delete this.dropOK;if(!h){return}var b=d.field;if(!b){return}var c=h.record.fieldsMap[h.fieldName];if(c.isNumeric){if(!b.isXType("numberfield")){return}}else{if(c.isDateField){if(!b.isXType("datefield")){return}}else{if(c.isBooleanField){if(!b.isXType("checkbox")){return}}}}this.dropOK=true;Ext.fly(h.node).addCls("x-drop-target-active")},onNodeOver:function(d,a,c,b){return this.dropOK?this.dropAllowed:this.dropNotAllowed},onNodeOut:function(d,a,c,b){Ext.fly(d.node).removeCls("x-drop-target-active")},onNodeDrop:function(f,a,d,c){if(this.dropOK){var b=c.field.getValue();f.record.set(f.fieldName,b);this.onCellDrop(f.fieldName,b);return true}},onCellDrop:Ext.emptyFn});Ext.define("Ext.ux.dd.PanelFieldDragZone",{extend:"Ext.dd.DragZone",constructor:function(a){a=a||{};if(a.ddGroup){this.ddGroup=a.ddGroup}},init:function(a){if(a.nodeType){Ext.ux.dd.PanelFieldDragZone.superclass.init.apply(this,arguments)}else{if(a.rendered){Ext.ux.dd.PanelFieldDragZone.superclass.constructor.call(this,a.getEl())}else{a.on("afterrender",this.init,this,{single:true})}}},scroll:false,getDragData:function(f){var c=f.getTarget("label",null,true),g,b,d,a;if(c){d=Ext.getCmp(c.up("."+Ext.form.Labelable.prototype.formItemCls).id);b=d.preventMark;d.preventMark=true;if(d.isValid()){d.preventMark=b;a=document.createElement("div");a.className=Ext.baseCSSPrefix+"form-text";g=d.getRawValue();a.innerHTML=Ext.isEmpty(g)?"&#160;":g;Ext.fly(a).setWidth(d.getEl().getWidth());return{field:d,ddel:a}}else{f.stopEvent()}d.preventMark=b}},getRepairXY:function(){return this.dragData.field.getEl().getXY()}});
/*!
 * Ext JS Library
 * Copyright(c) 2006-2014 Sencha Inc.
 * licensing@sencha.com
 * http://www.sencha.com/license
 */
Ext.define("Ext.ux.desktop.Desktop",{extend:"Ext.panel.Panel",alias:"widget.desktop",uses:["Ext.util.MixedCollection","Ext.menu.Menu","Ext.view.View","Ext.window.Window","Ext.ux.desktop.TaskBar","Ext.ux.desktop.Wallpaper"],activeWindowCls:"ux-desktop-active-win",inactiveWindowCls:"ux-desktop-inactive-win",lastActiveWindow:null,border:false,html:"&#160;",layout:"fit",xTickSize:1,yTickSize:1,app:null,shortcuts:null,shortcutItemSelector:"div.ux-desktop-shortcut",shortcutTpl:['<tpl for=".">','<div class="ux-desktop-shortcut" id="{name}-shortcut">','<div class="ux-desktop-shortcut-icon {iconCls}">','<img src="',Ext.BLANK_IMAGE_URL,'" title="{name}">',"</div>",'<span class="ux-desktop-shortcut-text">{name}</span>',"</div>","</tpl>",'<div class="x-clear"></div>'],taskbarConfig:null,windowMenu:null,initComponent:function(){var b=this;b.windowMenu=new Ext.menu.Menu(b.createWindowMenu());b.bbar=b.taskbar=new Ext.ux.desktop.TaskBar(b.taskbarConfig);b.taskbar.windowMenu=b.windowMenu;b.windows=new Ext.util.MixedCollection();b.contextMenu=new Ext.menu.Menu(b.createDesktopMenu());b.items=[{xtype:"wallpaper",id:b.id+"_wallpaper"},b.createDataView()];b.callParent();b.shortcutsView=b.items.getAt(1);b.shortcutsView.on("itemclick",b.onShortcutItemClick,b);var a=b.wallpaper;b.wallpaper=b.items.getAt(0);if(a){b.setWallpaper(a,b.wallpaperStretch)}},afterRender:function(){var a=this;a.callParent();a.el.on("contextmenu",a.onDesktopMenu,a)},createDataView:function(){var a=this;return{xtype:"dataview",overItemCls:"x-view-over",trackOver:true,itemSelector:a.shortcutItemSelector,store:a.shortcuts,style:{position:"absolute"},x:0,y:0,tpl:new Ext.XTemplate(a.shortcutTpl)}},createDesktopMenu:function(){var b=this,a={items:b.contextMenuItems||[]};if(a.items.length){a.items.push("-")}a.items.push({text:"Tile",handler:b.tileWindows,scope:b,minWindows:1},{text:"Cascade",handler:b.cascadeWindows,scope:b,minWindows:1});return a},createWindowMenu:function(){var a=this;return{defaultAlign:"br-tr",items:[{text:"Restore",handler:a.onWindowMenuRestore,scope:a},{text:"Minimize",handler:a.onWindowMenuMinimize,scope:a},{text:"Maximize",handler:a.onWindowMenuMaximize,scope:a},"-",{text:"Close",handler:a.onWindowMenuClose,scope:a}],listeners:{beforeshow:a.onWindowMenuBeforeShow,hide:a.onWindowMenuHide,scope:a}}},onDesktopMenu:function(b){var a=this,c=a.contextMenu;b.stopEvent();if(!c.rendered){c.on("beforeshow",a.onDesktopMenuBeforeShow,a)}c.showAt(b.getXY());c.doConstrain()},onDesktopMenuBeforeShow:function(c){var b=this,a=b.windows.getCount();c.items.each(function(e){var d=e.minWindows||0;e.setDisabled(a<d)})},onShortcutItemClick:function(e,a){var c=this,b=c.app.getModule(a.data.module),d=b&&b.createWindow();if(d){c.restoreWindow(d)}},onWindowClose:function(b){var a=this;a.windows.remove(b);a.taskbar.removeTaskButton(b.taskButton);a.updateActiveWindow()},onWindowMenuBeforeShow:function(c){var a=c.items.items,b=c.theWin;a[0].setDisabled(b.maximized!==true&&b.hidden!==true);a[1].setDisabled(b.minimized===true);a[2].setDisabled(b.maximized===true||b.hidden===true)},onWindowMenuClose:function(){var a=this,b=a.windowMenu.theWin;b.close()},onWindowMenuHide:function(a){Ext.defer(function(){a.theWin=null},1)},onWindowMenuMaximize:function(){var a=this,b=a.windowMenu.theWin;b.maximize();b.toFront()},onWindowMenuMinimize:function(){var a=this,b=a.windowMenu.theWin;b.minimize()},onWindowMenuRestore:function(){var a=this,b=a.windowMenu.theWin;a.restoreWindow(b)},getWallpaper:function(){return this.wallpaper.wallpaper},setTickSize:function(b,c){var e=this,a=e.xTickSize=b,d=e.yTickSize=(arguments.length>1)?c:a;e.windows.each(function(g){var f=g.dd,h=g.resizer;f.xTickSize=a;f.yTickSize=d;h.widthIncrement=a;h.heightIncrement=d})},setWallpaper:function(b,a){this.wallpaper.setWallpaper(b,a);return this},cascadeWindows:function(){var a=0,c=0,b=this.getDesktopZIndexManager();b.eachBottomUp(function(d){if(d.isWindow&&d.isVisible()&&!d.maximized){d.setPosition(a,c);a+=20;c+=20}})},createWindow:function(c,b){var d=this,e,a=Ext.applyIf(c||{},{stateful:false,isWindow:true,constrainHeader:true,minimizable:true,maximizable:true});b=b||Ext.window.Window;e=d.add(new b(a));d.windows.add(e);e.taskButton=d.taskbar.addTaskButton(e);e.animateTarget=e.taskButton.el;e.on({activate:d.updateActiveWindow,beforeshow:d.updateActiveWindow,deactivate:d.updateActiveWindow,minimize:d.minimizeWindow,destroy:d.onWindowClose,scope:d});e.on({boxready:function(){e.dd.xTickSize=d.xTickSize;e.dd.yTickSize=d.yTickSize;if(e.resizer){e.resizer.widthIncrement=d.xTickSize;e.resizer.heightIncrement=d.yTickSize}},single:true});e.doClose=function(){e.doClose=Ext.emptyFn;e.el.disableShadow();e.el.fadeOut({listeners:{afteranimate:function(){e.destroy()}}})};return e},getActiveWindow:function(){var b=null,a=this.getDesktopZIndexManager();if(a){a.eachTopDown(function(c){if(c.isWindow&&!c.hidden){b=c;return false}return true})}return b},getDesktopZIndexManager:function(){var a=this.windows;return(a.getCount()&&a.getAt(0).zIndexManager)||null},getWindow:function(a){return this.windows.get(a)},minimizeWindow:function(a){a.minimized=true;a.hide()},restoreWindow:function(a){if(a.isVisible()){a.restore();a.toFront()}else{a.show()}return a},tileWindows:function(){var b=this,e=b.body.getWidth(true);var a=b.xTickSize,d=b.yTickSize,c=d;b.windows.each(function(g){if(g.isVisible()&&!g.maximized){var f=g.el.getWidth();if(a>b.xTickSize&&a+f>e){a=b.xTickSize;d=c}g.setPosition(a,d);a+=f+b.xTickSize;c=Math.max(c,d+g.el.getHeight()+b.yTickSize)}})},updateActiveWindow:function(){var b=this,c=b.getActiveWindow(),a=b.lastActiveWindow;if(a&&a.isDestroyed){b.lastActiveWindow=null;return}if(c===a){return}if(a){if(a.el.dom){a.addCls(b.inactiveWindowCls);a.removeCls(b.activeWindowCls)}a.active=false}b.lastActiveWindow=c;if(c){c.addCls(b.activeWindowCls);c.removeCls(b.inactiveWindowCls);c.minimized=false;c.active=true}b.taskbar.setActiveButton(c&&c.taskButton)}});Ext.define("Ext.ux.desktop.App",{mixins:{observable:"Ext.util.Observable"},requires:["Ext.container.Viewport","Ext.ux.desktop.Desktop"],isReady:false,modules:null,useQuickTips:true,constructor:function(a){var b=this;b.mixins.observable.constructor.call(this,a);if(Ext.isReady){Ext.Function.defer(b.init,10,b)}else{Ext.onReady(b.init,b)}},init:function(){var b=this,a;if(b.useQuickTips){Ext.QuickTips.init()}b.modules=b.getModules();if(b.modules){b.initModules(b.modules)}a=b.getDesktopConfig();b.desktop=new Ext.ux.desktop.Desktop(a);b.viewport=new Ext.container.Viewport({layout:"fit",items:[b.desktop]});Ext.getWin().on("beforeunload",b.onUnload,b);b.isReady=true;b.fireEvent("ready",b)},getDesktopConfig:function(){var b=this,a={app:b,taskbarConfig:b.getTaskbarConfig()};Ext.apply(a,b.desktopConfig);return a},getModules:Ext.emptyFn,getStartConfig:function(){var b=this,a={app:b,menu:[]},c;Ext.apply(a,b.startConfig);Ext.each(b.modules,function(d){c=d.launcher;if(c){c.handler=c.handler||Ext.bind(b.createWindow,b,[d]);a.menu.push(d.launcher)}});return a},createWindow:function(a){var b=a.createWindow();b.show()},getTaskbarConfig:function(){var b=this,a={app:b,startConfig:b.getStartConfig()};Ext.apply(a,b.taskbarConfig);return a},initModules:function(a){var b=this;Ext.each(a,function(c){c.app=b})},getModule:function(d){var c=this.modules;for(var e=0,b=c.length;e<b;e++){var a=c[e];if(a.id==d||a.appType==d){return a}}return null},onReady:function(b,a){if(this.isReady){b.call(a,this)}else{this.on({ready:b,scope:a,single:true})}},getDesktop:function(){return this.desktop},onUnload:function(a){if(this.fireEvent("beforeunload",this)===false){a.stopEvent()}}});
/*!
 * Ext JS Library
 * Copyright(c) 2006-2014 Sencha Inc.
 * licensing@sencha.com
 * http://www.sencha.com/license
 */
Ext.define("Ext.ux.desktop.Module",{mixins:{observable:"Ext.util.Observable"},constructor:function(a){this.mixins.observable.constructor.call(this,a);this.init()},init:Ext.emptyFn});
/*!
 * Ext JS Library
 * Copyright(c) 2006-2014 Sencha Inc.
 * licensing@sencha.com
 * http://www.sencha.com/license
 */
Ext.define("Ext.ux.desktop.ShortcutModel",{extend:"Ext.data.Model",fields:[{name:"name"},{name:"iconCls"},{name:"module"}]});Ext.define("Ext.ux.desktop.StartMenu",{extend:"Ext.menu.Menu",baseCls:Ext.baseCSSPrefix+"panel",cls:"x-menu ux-start-menu",bodyCls:"ux-start-menu-body",defaultAlign:"bl-tl",iconCls:"user",bodyBorder:true,width:300,initComponent:function(){var a=this;a.layout.align="stretch";a.items=a.menu;a.callParent();a.toolbar=new Ext.toolbar.Toolbar(Ext.apply({dock:"right",cls:"ux-start-menu-toolbar",vertical:true,width:100,layout:{align:"stretch"}},a.toolConfig));a.addDocked(a.toolbar);delete a.toolItems},addMenuItem:function(){var a=this.menu;a.add.apply(a,arguments)},addToolItem:function(){var a=this.toolbar;a.add.apply(a,arguments)}});
/*!
 * Ext JS Library
 * Copyright(c) 2006-2014 Sencha Inc.
 * licensing@sencha.com
 * http://www.sencha.com/license
 */
Ext.define("Ext.ux.desktop.TaskBar",{extend:"Ext.toolbar.Toolbar",requires:["Ext.button.Button","Ext.resizer.Splitter","Ext.menu.Menu","Ext.ux.desktop.StartMenu"],alias:"widget.taskbar",cls:"ux-taskbar",startBtnText:"Start",initComponent:function(){var a=this;a.startMenu=new Ext.ux.desktop.StartMenu(a.startConfig);a.quickStart=new Ext.toolbar.Toolbar(a.getQuickStart());a.windowBar=new Ext.toolbar.Toolbar(a.getWindowBarConfig());a.tray=new Ext.toolbar.Toolbar(a.getTrayConfig());a.items=[{xtype:"button",cls:"ux-start-button",iconCls:"ux-start-button-icon",menu:a.startMenu,menuAlign:"bl-tl",text:a.startBtnText},a.quickStart,{xtype:"splitter",html:"&#160;",height:14,width:2,cls:"x-toolbar-separator x-toolbar-separator-horizontal"},a.windowBar,"-",a.tray];a.callParent()},afterLayout:function(){var a=this;a.callParent();a.windowBar.el.on("contextmenu",a.onButtonContextMenu,a)},getQuickStart:function(){var b=this,a={minWidth:20,width:Ext.themeName==="neptune"?70:60,items:[],enableOverflow:true};Ext.each(this.quickStart,function(c){a.items.push({tooltip:{text:c.name,align:"bl-tl"},overflowText:c.name,iconCls:c.iconCls,module:c.module,handler:b.onQuickStartClick,scope:b})});return a},getTrayConfig:function(){var a={items:this.trayItems};delete this.trayItems;return a},getWindowBarConfig:function(){return{flex:1,cls:"ux-desktop-windowbar",items:["&#160;"],layout:{overflowHandler:"Scroller"}}},getWindowBtnFromEl:function(a){var b=this.windowBar.getChildByElement(a);return b||null},onQuickStartClick:function(b){var a=this.app.getModule(b.module),c;if(a){c=a.createWindow();c.show()}},onButtonContextMenu:function(d){var c=this,b=d.getTarget(),a=c.getWindowBtnFromEl(b);if(a){d.stopEvent();c.windowMenu.theWin=a.win;c.windowMenu.showBy(b)}},onWindowBtnClick:function(a){var b=a.win;if(b.minimized||b.hidden){a.disable();b.show(null,function(){a.enable()})}else{if(b.active){a.disable();b.on("hide",function(){a.enable()},null,{single:true});b.minimize()}else{b.toFront()}}},addTaskButton:function(c){var a={iconCls:c.iconCls,enableToggle:true,toggleGroup:"all",width:140,margin:"0 2 0 3",text:Ext.util.Format.ellipsis(c.title,20),listeners:{click:this.onWindowBtnClick,scope:this},win:c};var b=this.windowBar.add(a);b.toggle(true);return b},removeTaskButton:function(a){var c,b=this;b.windowBar.items.each(function(d){if(d===a){c=d}return !c});if(c){b.windowBar.remove(c)}return c},setActiveButton:function(a){if(a){a.toggle(true)}else{this.windowBar.items.each(function(b){if(b.isButton){b.toggle(false)}})}}});Ext.define("Ext.ux.desktop.TrayClock",{extend:"Ext.toolbar.TextItem",alias:"widget.trayclock",cls:"ux-desktop-trayclock",html:"&#160;",timeFormat:"g:i A",tpl:"{time}",initComponent:function(){var a=this;a.callParent();if(typeof(a.tpl)=="string"){a.tpl=new Ext.XTemplate(a.tpl)}},afterRender:function(){var a=this;Ext.Function.defer(a.updateTime,100,a);a.callParent()},onDestroy:function(){var a=this;if(a.timer){window.clearTimeout(a.timer);a.timer=null}a.callParent()},updateTime:function(){var a=this,b=Ext.Date.format(new Date(),a.timeFormat),c=a.tpl.apply({time:b});if(a.lastText!=c){a.setText(c);a.lastText=c}a.timer=Ext.Function.defer(a.updateTime,10000,a)}});
/*!
* Ext JS Library
* Copyright(c) 2006-2014 Sencha Inc.
* licensing@sencha.com
* http://www.sencha.com/license
*/
Ext.define("Ext.ux.desktop.Video",{extend:"Ext.panel.Panel",alias:"widget.video",layout:"fit",autoplay:false,controls:true,bodyStyle:"background-color:#000;color:#fff",html:"",tpl:['<video id="{id}-video" autoPlay="{autoplay}" controls="{controls}" poster="{poster}" start="{start}" loopstart="{loopstart}" loopend="{loopend}" autobuffer="{autobuffer}" loop="{loop}" style="width:100%;height:100%">','<tpl for="src">','<source src="{src}" type="{type}"/>',"</tpl>","{html}","</video>"],initComponent:function(){var e=this,f,c,b,d;if(e.fallbackHTML){f=e.fallbackHTML}else{f="Your browser does not support HTML5 Video. ";if(Ext.isChrome){f+="Upgrade Chrome."}else{if(Ext.isGecko){f+="Upgrade to Firefox 3.5 or newer."}else{var a='<a href="http://www.google.com/chrome">Chrome</a>';f+='Please try <a href="http://www.mozilla.com">Firefox</a>';if(Ext.isIE){f+=", "+a+' or <a href="http://www.apple.com/safari/">Safari</a>.'}else{f+=" or "+a+"."}}}}e.fallbackHTML=f;b=e.data=Ext.copyTo({tag:"video",html:f},e,"id,poster,start,loopstart,loopend,playcount,autobuffer,loop");if(e.autoplay){b.autoplay=1}if(e.controls){b.controls=1}if(Ext.isArray(e.src)){b.src=e.src}else{b.src=[{src:e.src}]}e.callParent()},afterRender:function(){var a=this;a.callParent();a.video=a.body.getById(a.id+"-video");el=a.video.dom;a.supported=(el&&el.tagName.toLowerCase()=="video");if(a.supported){a.video.on("error",a.onVideoError,a)}},getFallback:function(){return'<h1 style="background-color:#ff4f4f;padding: 10px;">'+this.fallbackHTML+"</h1>"},onVideoError:function(){var a=this;a.video.remove();a.supported=false;a.body.createChild(a.getFallback())},onDestroy:function(){var c=this;var b=c.video;if(c.supported&&b){var a=b.dom;if(a&&a.pause){a.pause()}b.remove();c.video=null}c.callParent()}});
/*!
 * Ext JS Library
 * Copyright(c) 2006-2014 Sencha Inc.
 * licensing@sencha.com
 * http://www.sencha.com/license
 */
Ext.define("Ext.ux.desktop.Wallpaper",{extend:"Ext.Component",alias:"widget.wallpaper",cls:"ux-wallpaper",html:'<img src="'+Ext.BLANK_IMAGE_URL+'">',stretch:false,wallpaper:null,stateful:true,stateId:"desk-wallpaper",afterRender:function(){var a=this;a.callParent();a.setWallpaper(a.wallpaper,a.stretch)},applyState:function(){var b=this,a=b.wallpaper;b.callParent(arguments);if(a!=b.wallpaper){b.setWallpaper(b.wallpaper)}},getState:function(){return this.wallpaper&&{wallpaper:this.wallpaper}},setWallpaper:function(b,a){var c=this,e,d;c.stretch=(a!==false);c.wallpaper=b;if(c.rendered){e=c.el.dom.firstChild;if(!b||b==Ext.BLANK_IMAGE_URL){Ext.fly(e).hide()}else{if(c.stretch){e.src=b;c.el.removeCls("ux-wallpaper-tiled");Ext.fly(e).setStyle({width:"100%",height:"100%"}).show()}else{Ext.fly(e).hide();d="url("+b+")";c.el.addCls("ux-wallpaper-tiled")}}c.el.setStyle({backgroundImage:d||""});if(c.stateful){c.saveState()}}return c}});Ext.define("Ext.ux.event.Driver",{extend:"Ext.util.Observable",active:null,specialKeysByName:{PGUP:33,PGDN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40},specialKeysByCode:{},getTextSelection:function(d){var e=d.ownerDocument,c,a,f,b;if(typeof d.selectionStart==="number"){f=d.selectionStart;b=d.selectionEnd}else{if(e.selection){c=e.selection.createRange();a=d.createTextRange();a.setEndPoint("EndToStart",c);f=a.text.length;b=f+c.text.length}}return[f,b]},getTime:function(){return new Date().getTime()},getTimestamp:function(){var a=this.getTime();return a-this.startTime},onStart:function(){},onStop:function(){},start:function(){var a=this;if(!a.active){a.active=new Date();a.startTime=a.getTime();a.onStart();a.fireEvent("start",a)}},stop:function(){var a=this;if(a.active){a.active=null;a.onStop();a.fireEvent("stop",a)}}},function(){var a=this.prototype;Ext.Object.each(a.specialKeysByName,function(b,c){a.specialKeysByCode[c]=b})});Ext.define("Ext.ux.event.Maker",{eventQueue:[],startAfter:500,timerIncrement:500,currentTiming:0,constructor:function(a){var b=this;b.currentTiming=b.startAfter;if(!Ext.isArray(a)){a=[a]}Ext.Array.each(a,function(c){c.el=c.el||"el";Ext.Array.each(Ext.ComponentQuery.query(c.cmpQuery),function(g){var f={},d,h,e;if(!c.domQuery){e=g[c.el]}else{e=g.el.down(c.domQuery)}f.target="#"+e.dom.id;f.type=c.type;f.button=a.button||0;d=e.getX()+(e.getWidth()/2);h=e.getY()+(e.getHeight()/2);f.xy=[d,h];f.ts=b.currentTiming;b.currentTiming+=b.timerIncrement;b.eventQueue.push(f)});if(c.screenshot){b.eventQueue[b.eventQueue.length-1].screenshot=true}});return b.eventQueue}});Ext.define("Ext.ux.event.Player",function(d){var h={},c={},a={},g,b={},f={resize:1,reset:1,submit:1,change:1,select:1,error:1,abort:1};Ext.each(["click","dblclick","mouseover","mouseout","mousedown","mouseup","mousemove"],function(i){f[i]=h[i]=c[i]={bubbles:true,cancelable:(i!="mousemove"),detail:1,screenX:0,screenY:0,clientX:0,clientY:0,ctrlKey:false,altKey:false,shiftKey:false,metaKey:false,button:0}});Ext.each(["keydown","keyup","keypress"],function(i){f[i]=h[i]=a[i]={bubbles:true,cancelable:true,ctrlKey:false,altKey:false,shiftKey:false,metaKey:false,keyCode:0,charCode:0}});Ext.each(["blur","change","focus","resize","scroll","select"],function(i){h[i]=b[i]={bubbles:(i in f),cancelable:false,detail:1}});var e={8:function(j,k,i){if(k<i){j.value=j.value.substring(0,k)+j.value.substring(i)}else{if(k>0){j.value=j.value.substring(0,--k)+j.value.substring(i)}}this.setTextSelection(j,k,k)},46:function(j,k,i){if(k<i){j.value=j.value.substring(0,k)+j.value.substring(i)}else{if(k<j.value.length-1){j.value=j.value.substring(0,k)+j.value.substring(k+1)}}this.setTextSelection(j,k,k)}};return{extend:"Ext.ux.event.Driver",keyFrameEvents:{click:true},pauseForAnimations:true,speed:1,stallTime:0,_inputSpecialKeys:{INPUT:e,TEXTAREA:Ext.apply({},e)},tagPathRegEx:/(\w+)(?:\[(\d+)\])?/,constructor:function(i){var j=this;j.callParent(arguments);j.timerFn=function(){j.onTick()};j.attachTo=j.attachTo||window;g=j.attachTo.document},getElementFromXPath:function(s){var t=this,p=s.split("/"),u=t.tagPathRegEx,q,l,o,r,v,k,j=t.attachTo.document;j=(p[0]=="~")?j.body:j.getElementById(p[0].substring(1));for(q=1,l=p.length;j&&q<l;++q){o=u.exec(p[q]);r=o[2]?parseInt(o[2],10):1;v=o[1].toUpperCase();for(k=j.firstChild;k;k=k.nextSibling){if(k.tagName==v){if(r==1){break}--r}}j=k}return j},offsetToRangeCharacterMove:function(i,j){return j-(i.value.slice(0,j).split("\r\n").length-1)},setTextSelection:function(m,i,l){if(i<0){i+=m.value.length}if(l==null){l=i}if(l<0){l+=m.value.length}if(typeof m.selectionStart==="number"){m.selectionStart=i;m.selectionEnd=l}else{var k=m.createTextRange();var j=this.offsetToRangeCharacterMove(m,i);k.collapse(true);if(i==l){k.move("character",j)}else{k.moveEnd("character",this.offsetToRangeCharacterMove(m,l));k.moveStart("character",j)}k.select()}},getTimeIndex:function(){var i=this.getTimestamp()-this.stallTime;return i*this.speed},makeToken:function(i,l){var j=this,k;i[l]=true;i.defer=function(){i[l]=false;k=j.getTime()};i.finish=function(){i[l]=true;j.stallTime+=j.getTime()-k;j.schedule()}},nextEvent:function(j){var k=this,i=++k.queueIndex;if(k.keyFrameEvents[j.type]){Ext.Array.insert(k.eventQueue,i,[{keyframe:true,ts:j.ts}])}},peekEvent:function(){return this.eventQueue[this.queueIndex]||null},replaceEvent:function(j,m){for(var l,k=0,o=m.length;k<o;++k){if(k){l=m[k-1];delete l.afterplay;delete l.screenshot;delete m[k].beforeplay}}Ext.Array.replace(this.eventQueue,(j==null)?this.queueIndex:j,1,m)},processEvents:function(){var j=this,k=j.pauseForAnimations&&j.attachTo.Ext.fx.Manager.items,i;while((i=j.peekEvent())!==null){if(k&&k.getCount()){return true}if(i.keyframe){if(!j.processKeyFrame(i)){return false}j.nextEvent(i)}else{if(i.ts<=j.getTimeIndex()&&j.fireEvent("beforeplay",j,i)!==false&&j.playEvent(i)){j.nextEvent(i)}else{return true}}}j.stop();return false},processKeyFrame:function(i){var j=this;if(!i.defer){j.makeToken(i,"done");j.fireEvent("keyframe",j,i)}return i.done},injectEvent:function(n,m){var l=this,k=m.type,i=Ext.apply({},m,h[k]),j;if(k==="type"){j=l._inputSpecialKeys[n.tagName];if(j){return l.injectTypeInputEvent(n,m,j)}return l.injectTypeEvent(n,m)}if(k==="focus"&&n.focus){n.focus();return true}if(k==="blur"&&n.blur){n.blur();return true}if(k==="scroll"){n.scrollLeft=m.pos[0];n.scrollTop=m.pos[1];return true}if(k==="mduclick"){return l.injectEvent(n,Ext.applyIf({type:"mousedown"},m))&&l.injectEvent(n,Ext.applyIf({type:"mouseup"},m))&&l.injectEvent(n,Ext.applyIf({type:"click"},m))}if(c[k]){return d.injectMouseEvent(n,i,l.attachTo)}if(a[k]){return d.injectKeyEvent(n,i,l.attachTo)}if(b[k]){return d.injectUIEvent(n,k,i.bubbles,i.cancelable,i.view||l.attachTo,i.detail)}return false},injectTypeEvent:function(r,k){var t=this,v=k.text,p=[],j,o,q,m,l,u,s;if(v){delete k.text;u=v.toUpperCase();for(q=0,m=v.length;q<m;++q){j=v.charCodeAt(q);o=u.charCodeAt(q);p.push(Ext.applyIf({type:"keydown",charCode:o,keyCode:o},k),Ext.applyIf({type:"keypress",charCode:j,keyCode:j},k),Ext.applyIf({type:"keyup",charCode:o,keyCode:o},k))}}else{p.push(Ext.applyIf({type:"keydown",charCode:k.keyCode},k),Ext.applyIf({type:"keyup",charCode:k.keyCode},k))}for(q=0,m=p.length;q<m;++q){t.injectEvent(r,p[q])}return true},injectTypeInputEvent:function(m,k,i){var j=this,o=k.text,l,p;if(i){l=j.getTextSelection(m);if(o){p=l[0];m.value=m.value.substring(0,p)+o+m.value.substring(l[1]);p+=o.length;j.setTextSelection(m,p,p)}else{if(!(i=i[k.keyCode])){if("caret" in k){j.setTextSelection(m,k.caret,k.caret)}else{if(k.selection){j.setTextSelection(m,k.selection[0],k.selection[1])}}return j.injectTypeEvent(m,k)}i.call(this,m,l[0],l[1]);return true}}return true},playEvent:function(i){var k=this,l=k.getElementFromXPath(i.target),j;if(!l){return false}if(!k.playEventHook(i,"beforeplay")){return false}if(!i.injected){i.injected=true;j=k.translateEvent(i,l);k.injectEvent(l,j)}return k.playEventHook(i,"afterplay")},playEventHook:function(k,j){var l=this,i=j+".done",n=j+".fired",m=k[j];if(m&&!k[i]){if(!k[n]){k[n]=true;l.makeToken(k,i);if(l.eventScope&&Ext.isString(m)){m=l.eventScope[m]}if(m){m.call(l.eventScope||l,k)}}return false}return true},schedule:function(){var i=this;if(!i.timer){i.timer=setTimeout(i.timerFn,10)}},_translateAcross:["type","button","charCode","keyCode","caret","pos","text","selection"],translateEvent:function(q,m){var o=this,j={},p=q.modKeys||"",n=o._translateAcross,l=n.length,k,r;while(l--){k=n[l];if(k in q){j[k]=q[k]}}j.altKey=p.indexOf("A")>0;j.ctrlKey=p.indexOf("C")>0;j.metaKey=p.indexOf("M")>0;j.shiftKey=p.indexOf("S")>0;if(m&&"x" in q){r=Ext.fly(m).getXY();r[0]+=q.x;r[1]+=q.y}else{if("x" in q){r=[q.x,q.y]}else{if("px" in q){r=[q.px,q.py]}}}if(r){j.clientX=j.screenX=r[0];j.clientY=j.screenY=r[1]}if(q.key){j.keyCode=o.specialKeysByName[q.key]}if(q.type==="wheel"){if("onwheel" in o.attachTo.document){j.wheelX=q.dx;j.wheelY=q.dy}else{j.type="mousewheel";j.wheelDeltaX=-40*q.dx;j.wheelDeltaY=j.wheelDelta=-40*q.dy}}return j},onStart:function(){var i=this;i.queueIndex=0;i.schedule()},onStop:function(){var i=this;if(i.timer){clearTimeout(i.timer);i.timer=null}},onTick:function(){var i=this;i.timer=null;if(i.processEvents()){i.schedule()}},statics:{ieButtonCodeMap:{0:1,1:4,2:2},injectKeyEvent:function(n,j,i){var m=j.type,l=null;if(m==="textevent"){m="keypress"}i=i||window;if(g.createEvent){try{l=g.createEvent("KeyEvents");l.initKeyEvent(m,j.bubbles,j.cancelable,i,j.ctrlKey,j.altKey,j.shiftKey,j.metaKey,j.keyCode,j.charCode)}catch(k){try{l=g.createEvent("Events")}catch(o){l=g.createEvent("UIEvents")}finally{l.initEvent(m,j.bubbles,j.cancelable);l.view=i;l.altKey=j.altKey;l.ctrlKey=j.ctrlKey;l.shiftKey=j.shiftKey;l.metaKey=j.metaKey;l.keyCode=j.keyCode;l.charCode=j.charCode}}n.dispatchEvent(l)}else{if(g.createEventObject){l=g.createEventObject();l.bubbles=j.bubbles;l.cancelable=j.cancelable;l.view=i;l.ctrlKey=j.ctrlKey;l.altKey=j.altKey;l.shiftKey=j.shiftKey;l.metaKey=j.metaKey;l.keyCode=(j.charCode>0)?j.charCode:j.keyCode;n.fireEvent("on"+m,l)}else{return false}}return true},injectMouseEvent:function(m,j,i){var l=j.type,k=null;i=i||window;if(g.createEvent){k=g.createEvent("MouseEvents");if(k.initMouseEvent){k.initMouseEvent(l,j.bubbles,j.cancelable,i,j.detail,j.screenX,j.screenY,j.clientX,j.clientY,j.ctrlKey,j.altKey,j.shiftKey,j.metaKey,j.button,j.relatedTarget)}else{k=g.createEvent("UIEvents");k.initEvent(l,j.bubbles,j.cancelable);k.view=i;k.detail=j.detail;k.screenX=j.screenX;k.screenY=j.screenY;k.clientX=j.clientX;k.clientY=j.clientY;k.ctrlKey=j.ctrlKey;k.altKey=j.altKey;k.metaKey=j.metaKey;k.shiftKey=j.shiftKey;k.button=j.button;k.relatedTarget=j.relatedTarget}if(j.relatedTarget&&!k.relatedTarget){if(l=="mouseout"){k.toElement=j.relatedTarget}else{if(l=="mouseover"){k.fromElement=j.relatedTarget}}}m.dispatchEvent(k)}else{if(g.createEventObject){k=g.createEventObject();k.bubbles=j.bubbles;k.cancelable=j.cancelable;k.view=i;k.detail=j.detail;k.screenX=j.screenX;k.screenY=j.screenY;k.clientX=j.clientX;k.clientY=j.clientY;k.ctrlKey=j.ctrlKey;k.altKey=j.altKey;k.metaKey=j.metaKey;k.shiftKey=j.shiftKey;k.button=d.ieButtonCodeMap[j.button]||0;k.relatedTarget=j.relatedTarget;m.fireEvent("on"+l,k)}else{return false}}return true},injectUIEvent:function(l,j,i){var k=null;i=i||window;if(g.createEvent){k=g.createEvent("UIEvents");k.initUIEvent(j.type,j.bubbles,j.cancelable,i,j.detail);l.dispatchEvent(k)}else{if(g.createEventObject){k=g.createEventObject();k.bubbles=j.bubbles;k.cancelable=j.cancelable;k.view=i;k.detail=j.detail;l.fireEvent("on"+j.type,k)}else{return false}}return true}}}});Ext.define("Ext.ux.event.Recorder",function(c){function a(){var f=arguments,j=f.length,h={kind:"other"},g;for(g=0;g<j;++g){Ext.apply(h,arguments[g])}if(h.alt&&!h.event){h.event=h.alt}return h}function d(f){return a({kind:"keyboard",modKeys:true,key:true},f)}function b(f){return a({kind:"mouse",button:true,modKeys:true,xy:true},f)}var e={keydown:d(),keypress:d(),keyup:d(),dragmove:b({alt:"mousemove",pageCoords:true,whileDrag:true}),mousemove:b({pageCoords:true}),mouseover:b(),mouseout:b(),click:b(),wheel:b({wheel:true}),mousedown:b({press:true}),mouseup:b({release:true}),scroll:a({listen:false}),focus:a(),blur:a()};for(var d in e){if(!e[d].event){e[d].event=d}}e.wheel.event=null;return{extend:"Ext.ux.event.Driver",eventsToRecord:e,ignoreIdRegEx:/ext-gen(?:\d+)/,inputRe:/^(input|textarea)$/i,constructor:function(f){var h=this,g=f&&f.eventsToRecord;if(g){h.eventsToRecord=Ext.apply(Ext.apply({},h.eventsToRecord),g);delete f.eventsToRecord}h.callParent(arguments);h.clear();h.modKeys=[];h.attachTo=h.attachTo||window},clear:function(){this.eventsRecorded=[]},listenToEvent:function(j){var i=this,h=i.attachTo.document.body,g=function(){return i.onEvent.apply(i,arguments)},f={};if(h.attachEvent&&h.ownerDocument.documentMode<10){j="on"+j;h.attachEvent(j,g);f.destroy=function(){if(g){h.detachEvent(j,g);g=null}}}else{h.addEventListener(j,g,true);f.destroy=function(){if(g){h.removeEventListener(j,g,true);g=null}}}return f},coalesce:function(m,k){var j=this,g=j.eventsRecorded,i=g.length,f=i&&g[i-1],l=(i>1)&&g[i-2],h=(i>2)&&g[i-3];if(!f){return false}if(m.type==="mousemove"){if(f.type==="mousemove"&&m.ts-f.ts<200){m.ts=f.ts;g[i-1]=m;return true}}else{if(m.type==="click"){if(l&&f.type==="mouseup"&&l.type==="mousedown"){if(m.button==f.button&&m.button==l.button&&m.target==f.target&&m.target==l.target&&j.samePt(m,f)&&j.samePt(m,l)){g.pop();l.type="mduclick";return true}}}else{if(m.type==="keyup"){if(l&&f.type==="keypress"&&l.type==="keydown"){if(m.target===f.target&&m.target===l.target){g.pop();l.type="type";l.text=String.fromCharCode(f.charCode);delete l.charCode;delete l.keyCode;if(h&&h.type==="type"){if(h.text&&h.target===l.target){h.text+=l.text;g.pop()}}return true}}else{if(j.completeKeyStroke(f,m)){f.type="type";j.completeSpecialKeyStroke(k.target,f,m);return true}else{if(f.type==="scroll"&&j.completeKeyStroke(l,m)){l.type="type";j.completeSpecialKeyStroke(k.target,l,m);g.pop();g.pop();g.push(f,l);return true}}}}}}return false},completeKeyStroke:function(g,f){if(g&&g.type==="keydown"&&g.keyCode===f.keyCode){delete g.charCode;return true}return false},completeSpecialKeyStroke:function(h,i,f){var g=this.specialKeysByCode[f.keyCode];if(g&&this.inputRe.test(h.tagName)){delete i.keyCode;i.key=g;i.selection=this.getTextSelection(h);if(i.selection[0]===i.selection[1]){i.caret=i.selection[0];delete i.selection}return true}return false},getElementXPath:function(j){var m=this,l=false,g=[],k,i,h,f;for(h=j;h;h=h.parentNode){if(h==m.attachTo.document.body){g.unshift("~");l=true;break}if(h.id&&!m.ignoreIdRegEx.test(h.id)){g.unshift("#"+h.id);l=true;break}for(k=1,i=h;!!(i=i.previousSibling);){if(i.tagName==h.tagName){++k}}f=h.tagName.toLowerCase();if(k<2){g.unshift(f)}else{g.unshift(f+"["+k+"]")}}return l?g.join("/"):null},getRecordedEvents:function(){return this.eventsRecorded},onEvent:function(k){var j=this,h=new Ext.event.Event(k),f=j.eventsToRecord[h.type],l,m,i,g={type:h.type,ts:j.getTimestamp(),target:j.getElementXPath(h.target)},n;if(!f||!g.target){return}l=h.target.ownerDocument;l=l.defaultView||l.parentWindow;if(l!==j.attachTo){return}if(j.eventsToRecord.scroll){j.syncScroll(h.target)}if(f.xy){n=h.getXY();if(f.pageCoords||!g.target){g.px=n[0];g.py=n[1]}else{i=Ext.fly(h.getTarget()).getXY();n[0]-=i[0];n[1]-=i[1];g.x=n[0];g.y=n[1]}}if(f.button){if("buttons" in k){g.button=k.buttons}else{g.button=k.button}if(!g.button&&f.whileDrag){return}}if(f.wheel){g.type="wheel";if(f.event==="wheel"){g.dx=k.deltaX;g.dy=k.deltaY}else{if(typeof k.wheelDeltaX==="number"){g.dx=-1/40*k.wheelDeltaX;g.dy=-1/40*k.wheelDeltaY}else{if(k.wheelDelta){g.dy=-1/40*k.wheelDelta}else{if(k.detail){g.dy=k.detail}}}}}if(f.modKeys){j.modKeys[0]=h.altKey?"A":"";j.modKeys[1]=h.ctrlKey?"C":"";j.modKeys[2]=h.metaKey?"M":"";j.modKeys[3]=h.shiftKey?"S":"";m=j.modKeys.join("");if(m){g.modKeys=m}}if(f.key){g.charCode=h.getCharCode();g.keyCode=h.getKey()}if(j.coalesce(g,h)){j.fireEvent("coalesce",j,g)}else{j.eventsRecorded.push(g);j.fireEvent("add",j,g)}},onStart:function(){var h=this,i=h.attachTo.Ext.dd.DragDropManager,f=h.attachTo.Ext.EventObjectImpl.prototype,g=[];c.prototype.eventsToRecord.wheel.event=("onwheel" in h.attachTo.document)?"wheel":"mousewheel";h.listeners=[];Ext.Object.each(h.eventsToRecord,function(j,k){if(k&&k.listen!==false){if(!k.event){k.event=j}if(k.alt&&k.alt!==j){if(!h.eventsToRecord[k.alt]){g.push(k)}}else{h.listeners.push(h.listenToEvent(k.event))}}});Ext.each(g,function(j){h.eventsToRecord[j.alt]=j;h.listeners.push(h.listenToEvent(j.alt))});h.ddmStopEvent=i.stopEvent;i.stopEvent=Ext.Function.createSequence(i.stopEvent,function(j){h.onEvent(j)});h.evStopEvent=f.stopEvent;f.stopEvent=Ext.Function.createSequence(f.stopEvent,function(){h.onEvent(this)})},onStop:function(){var f=this;Ext.destroy(f.listeners);f.listeners=null;f.attachTo.Ext.dd.DragDropManager.stopEvent=f.ddmStopEvent;f.attachTo.Ext.EventObjectImpl.prototype.stopEvent=f.evStopEvent},samePt:function(g,f){return g.x==f.x&&g.y==f.y},syncScroll:function(h){var k=this,j=k.getTimestamp(),o,n,m,l,g,i;for(var f=h;f;f=f.parentNode){o=f.$lastScrollLeft;n=f.$lastScrollTop;m=f.scrollLeft;l=f.scrollTop;g=false;if(o!==m){if(m){g=true}f.$lastScrollLeft=m}if(n!==l){if(l){g=true}f.$lastScrollTop=l}if(g){k.eventsRecorded.push(i={type:"scroll",target:k.getElementXPath(f),ts:j,pos:[m,l]});k.fireEvent("add",k,i)}if(f.tagName==="BODY"){break}}}}});Ext.define("Ext.ux.event.RecorderManager",{extend:"Ext.panel.Panel",alias:"widget.eventrecordermanager",uses:["Ext.ux.event.Recorder","Ext.ux.event.Player"],layout:"fit",buttonAlign:"left",eventsToIgnore:{mousemove:1,mouseover:1,mouseout:1},bodyBorder:false,playSpeed:1,initComponent:function(){var b=this;b.recorder=new Ext.ux.event.Recorder({attachTo:b.attachTo,listeners:{add:b.updateEvents,coalesce:b.updateEvents,buffer:200,scope:b}});b.recorder.eventsToRecord=Ext.apply({},b.recorder.eventsToRecord);function c(e,d){return{text:e,speed:d,group:"speed",checked:d==b.playSpeed,handler:b.onPlaySpeed,scope:b}}b.tbar=[{text:"Record",xtype:"splitbutton",whenIdle:true,handler:b.onRecord,scope:b,menu:b.makeRecordButtonMenu()},{text:"Play",xtype:"splitbutton",whenIdle:true,handler:b.onPlay,scope:b,menu:[c("Qarter Speed (0.25x)",0.25),c("Half Speed (0.5x)",0.5),c("3/4 Speed (0.75x)",0.75),"-",c("Recorded Speed (1x)",1),c("Double Speed (2x)",2),c("Quad Speed (4x)",4),"-",c("Full Speed",1000)]},{text:"Clear",whenIdle:true,handler:b.onClear,scope:b},"->",{text:"Stop",whenActive:true,disabled:true,handler:b.onStop,scope:b}];var a=b.attachTo&&b.attachTo.testEvents;b.items=[{xtype:"textarea",itemId:"eventView",fieldStyle:"font-family: monospace",selectOnFocus:true,emptyText:"Events go here!",value:a?b.stringifyEvents(a):"",scrollToBottom:function(){var d=this.inputEl.dom;d.scrollTop=d.scrollHeight}}];b.fbar=[{xtype:"tbtext",text:"Attached To: "+(b.attachTo&&b.attachTo.location.href)}];b.callParent()},makeRecordButtonMenu:function(){var b=[],c={},e=this.recorder.eventsToRecord,d=this.eventsToIgnore;Ext.Object.each(e,function(f,h){var g=c[h.kind];if(!g){c[h.kind]=g=[];b.push({text:h.kind,menu:g})}g.push({text:f,checked:true,handler:function(i){if(i.checked){e[f]=h}else{delete e[f]}}});if(d[f]){g[g.length-1].checked=false;Ext.Function.defer(function(){delete e[f]},1)}});function a(f,g){return(f.text<g.text)?-1:((g.text<f.text)?1:0)}b.sort(a);Ext.Array.each(b,function(f){f.menu.sort(a)});return b},getEventView:function(){return this.down("#eventView")},onClear:function(){var a=this.getEventView();a.setValue("")},onPlay:function(){var c=this,a=c.getEventView(),b=a.getValue();if(b){b=Ext.decode(b);if(b.length){c.player=Ext.create("Ext.ux.event.Player",{attachTo:window.opener,eventQueue:b,speed:c.playSpeed,listeners:{stop:c.onPlayStop,scope:c}});c.player.start();c.syncBtnUI()}}},onPlayStop:function(){this.player=null;this.syncBtnUI()},onPlaySpeed:function(a){this.playSpeed=a.speed},onRecord:function(){this.recorder.start();this.syncBtnUI()},onStop:function(){var a=this;if(a.player){a.player.stop();a.player=null}else{a.recorder.stop()}a.syncBtnUI();a.updateEvents()},syncBtnUI:function(){var c=this,b=!c.player&&!c.recorder.active;Ext.each(c.query("[whenIdle]"),function(d){d.setDisabled(!b)});Ext.each(c.query("[whenActive]"),function(d){d.setDisabled(b)});var a=c.getEventView();a.setReadOnly(!b)},stringifyEvents:function(c){var b,a=[];Ext.each(c,function(d){b=[];Ext.Object.each(d,function(e,f){if(b.length){b.push(", ")}else{b.push("  { ")}b.push(e,": ");b.push(Ext.encode(f))});b.push(" }");a.push(b.join(""))});return"[\n"+a.join(",\n")+"\n]"},updateEvents:function(){var b=this,c=b.stringifyEvents(b.recorder.getRecordedEvents()),a=b.getEventView();a.setValue(c);a.scrollToBottom()}});Ext.define("Ext.ux.form.MultiSelect",{extend:"Ext.form.FieldContainer",mixins:["Ext.util.StoreHolder","Ext.form.field.Field"],alternateClassName:"Ext.ux.Multiselect",alias:["widget.multiselectfield","widget.multiselect"],requires:["Ext.panel.Panel","Ext.view.BoundList","Ext.layout.container.Fit"],uses:["Ext.view.DragZone","Ext.view.DropZone"],layout:"anchor",ddReorder:false,appendOnly:false,displayField:"text",allowBlank:true,minSelections:0,maxSelections:Number.MAX_VALUE,blankText:"This field is required",minSelectionsText:"Minimum {0} item(s) required",maxSelectionsText:"Maximum {0} item(s) required",delimiter:",",dragText:"{0} Item{1}",ignoreSelectChange:0,initComponent:function(){var a=this;a.items=a.setupItems();a.bindStore(a.store,true);if(a.store.autoCreated){a.valueField=a.displayField="field1";if(!a.store.expanded){a.displayField="field2"}}if(!Ext.isDefined(a.valueField)){a.valueField=a.displayField}a.callParent();a.initField()},setupItems:function(){var a=this;a.boundList=Ext.create("Ext.view.BoundList",Ext.apply({anchor:"none 100%",border:1,multiSelect:true,store:a.store,displayField:a.displayField,disabled:a.disabled},a.listConfig));a.boundList.getSelectionModel().on("selectionchange",a.onSelectChange,a);a.boundList.pickerField=a;if(!a.title){return a.boundList}a.boundList.border=false;return{border:true,anchor:"none 100%",layout:"anchor",title:a.title,tbar:a.tbar,items:a.boundList}},onSelectChange:function(a,b){if(!this.ignoreSelectChange){this.setValue(b)}},getSelected:function(){return this.boundList.getSelectionModel().getSelection()},isEqual:function(e,d){var b=Ext.Array.from,c=0,a;e=b(e);d=b(d);a=e.length;if(a!==d.length){return false}for(;c<a;c++){if(d[c]!==e[c]){return false}}return true},afterRender:function(){var b=this,a;b.callParent();if(b.selectOnRender){a=b.getRecordsForValue(b.value);if(a.length){++b.ignoreSelectChange;b.boundList.getSelectionModel().select(a);--b.ignoreSelectChange}delete b.toSelect}if(b.ddReorder&&!b.dragGroup&&!b.dropGroup){b.dragGroup=b.dropGroup="MultiselectDD-"+Ext.id()}if(b.draggable||b.dragGroup){b.dragZone=Ext.create("Ext.view.DragZone",{view:b.boundList,ddGroup:b.dragGroup,dragText:b.dragText})}if(b.droppable||b.dropGroup){b.dropZone=Ext.create("Ext.view.DropZone",{view:b.boundList,ddGroup:b.dropGroup,handleNodeDrop:function(i,h,c){var d=this.view,f=d.getStore(),e=i.records,g;i.view.store.remove(e);g=f.indexOf(h);if(c==="after"){g++}f.insert(g,e);d.getSelectionModel().select(e);b.fireEvent("drop",b,e)}})}},isValid:function(){var b=this,a=b.disabled,c=b.forceValidation||!a;return c?b.validateValue(b.value):a},validateValue:function(b){var a=this,d=a.getErrors(b),c=Ext.isEmpty(d);if(!a.preventMark){if(c){a.clearInvalid()}else{a.markInvalid(d)}}return c},markInvalid:function(c){var b=this,a=b.getActiveError();b.setActiveErrors(Ext.Array.from(c));if(a!==b.getActiveError()){b.updateLayout()}},clearInvalid:function(){var b=this,a=b.hasActiveError();b.unsetActiveError();if(a){b.updateLayout()}},getSubmitData:function(){var a=this,b=null,c;if(!a.disabled&&a.submitValue&&!a.isFileUpload()){c=a.getSubmitValue();if(c!==null){b={};b[a.getName()]=c}}return b},getSubmitValue:function(){var b=this,a=b.delimiter,c=b.getValue();return Ext.isString(a)?c.join(a):c},getValue:function(){return this.value||[]},getRecordsForValue:function(g){var f=this,a=[],h=f.store.getRange(),l=f.valueField,d=0,k=h.length,b,c,e;for(e=g.length;d<e;++d){for(c=0;c<k;++c){b=h[c];if(b.get(l)==g[d]){a.push(b)}}}return a},setupValue:function(g){var b=this.delimiter,d=this.valueField,e=0,c,a,f;if(Ext.isDefined(g)){if(b&&Ext.isString(g)){g=g.split(b)}else{if(!Ext.isArray(g)){g=[g]}}for(a=g.length;e<a;++e){f=g[e];if(f&&f.isModel){g[e]=f.get(d)}}c=Ext.Array.unique(g)}else{c=[]}return c},setValue:function(d){var c=this,b=c.boundList.getSelectionModel(),a=c.store;if(!a.getCount()){a.on({load:Ext.Function.bind(c.setValue,c,[d]),single:true});return}d=c.setupValue(d);c.mixins.field.setValue.call(c,d);if(c.rendered){++c.ignoreSelectChange;b.deselectAll();if(d.length){b.select(c.getRecordsForValue(d))}--c.ignoreSelectChange}else{c.selectOnRender=true}},clearValue:function(){this.setValue([])},onEnable:function(){var a=this.boundList;this.callParent();if(a){a.enable()}},onDisable:function(){var a=this.boundList;this.callParent();if(a){a.disable()}},getErrors:function(b){var a=this,c=Ext.String.format,e=[],d;b=Ext.Array.from(b||a.getValue());d=b.length;if(!a.allowBlank&&d<1){e.push(a.blankText)}if(d<a.minSelections){e.push(c(a.minSelectionsText,a.minSelections))}if(d>a.maxSelections){e.push(c(a.maxSelectionsText,a.maxSelections))}return e},onDestroy:function(){var a=this;a.bindStore(null);Ext.destroy(a.dragZone,a.dropZone);a.callParent()},onBindStore:function(a){var b=this.boundList;if(b){b.bindStore(a)}}});Ext.define("Ext.ux.form.ItemSelector",{extend:"Ext.ux.form.MultiSelect",alias:["widget.itemselectorfield","widget.itemselector"],alternateClassName:["Ext.ux.ItemSelector"],requires:["Ext.button.Button","Ext.ux.form.MultiSelect"],hideNavIcons:false,buttons:["top","up","add","remove","down","bottom"],buttonsText:{top:"Move to Top",up:"Move Up",add:"Add to Selected",remove:"Remove from Selected",down:"Move Down",bottom:"Move to Bottom"},layout:{type:"hbox",align:"stretch"},initComponent:function(){var a=this;a.ddGroup=a.id+"-dd";a.callParent();a.bindStore(a.store)},createList:function(b){var a=this;return Ext.create("Ext.ux.form.MultiSelect",{submitValue:false,getSubmitData:function(){return null},getModelData:function(){return null},flex:1,dragGroup:a.ddGroup,dropGroup:a.ddGroup,title:b,store:{model:a.store.model,data:[]},displayField:a.displayField,valueField:a.valueField,disabled:a.disabled,listeners:{boundList:{scope:a,itemdblclick:a.onItemDblClick,drop:a.syncValue}}})},setupItems:function(){var a=this;a.fromField=a.createList(a.fromTitle);a.toField=a.createList(a.toTitle);return[a.fromField,{xtype:"container",margin:"0 4",layout:{type:"vbox",pack:"center"},items:a.createButtons()},a.toField]},createButtons:function(){var b=this,a=[];if(!b.hideNavIcons){Ext.Array.forEach(b.buttons,function(c){a.push({xtype:"button",tooltip:b.buttonsText[c],handler:b["on"+Ext.String.capitalize(c)+"BtnClick"],cls:Ext.baseCSSPrefix+"form-itemselector-btn",iconCls:Ext.baseCSSPrefix+"form-itemselector-"+c,navBtn:true,scope:b,margin:"4 0 0 0"})})}return a},getSelections:function(b){var a=b.getStore();return Ext.Array.sort(b.getSelectionModel().getSelection(),function(d,c){d=a.indexOf(d);c=a.indexOf(c);if(d<c){return -1}else{if(d>c){return 1}}return 0})},onTopBtnClick:function(){var c=this.toField.boundList,a=c.getStore(),b=this.getSelections(c);a.suspendEvents();a.remove(b,true);a.insert(0,b);a.resumeEvents();c.refresh();this.syncValue();c.getSelectionModel().select(b)},onBottomBtnClick:function(){var c=this.toField.boundList,a=c.getStore(),b=this.getSelections(c);a.suspendEvents();a.remove(b,true);a.add(b);a.resumeEvents();c.refresh();this.syncValue();c.getSelectionModel().select(b)},onUpBtnClick:function(){var f=this.toField.boundList,b=f.getStore(),e=this.getSelections(f),g,d=0,a=e.length,c=0;b.suspendEvents();for(;d<a;++d,c++){g=e[d];c=Math.max(c,b.indexOf(g)-1);b.remove(g,true);b.insert(c,g)}b.resumeEvents();f.refresh();this.syncValue();f.getSelectionModel().select(e)},onDownBtnClick:function(){var e=this.toField.boundList,a=e.getStore(),d=this.getSelections(e),f,c=d.length-1,b=a.getCount()-1;a.suspendEvents();for(;c>-1;--c,b--){f=d[c];b=Math.min(b,a.indexOf(f)+1);a.remove(f,true);a.insert(b,f)}a.resumeEvents();e.refresh();this.syncValue();e.getSelectionModel().select(d)},onAddBtnClick:function(){var b=this,a=b.getSelections(b.fromField.boundList);b.moveRec(true,a);b.toField.boundList.getSelectionModel().select(a)},onRemoveBtnClick:function(){var b=this,a=b.getSelections(b.toField.boundList);b.moveRec(false,a);b.fromField.boundList.getSelectionModel().select(a)},moveRec:function(f,e){var c=this,g=c.fromField,a=c.toField,b=f?g.store:a.store,d=f?a.store:g.store;b.suspendEvents();d.suspendEvents();b.remove(e);d.add(e);b.resumeEvents();d.resumeEvents();g.boundList.refresh();a.boundList.refresh();c.syncValue()},syncValue:function(){var a=this;a.mixins.field.setValue.call(a,a.setupValue(a.toField.store.getRange()))},onItemDblClick:function(a,b){this.moveRec(a===this.fromField.boundList,b)},setValue:function(f){var d=this,g=d.fromField,a=d.toField,b=g.store,e=a.store,c;if(!d.fromStorePopulated){d.fromField.store.on({load:Ext.Function.bind(d.setValue,d,[f]),single:true});return}f=d.setupValue(f);d.mixins.field.setValue.call(d,f);c=d.getRecordsForValue(f);b.suspendEvents();e.suspendEvents();b.removeAll();e.removeAll();d.populateFromStore(d.store);Ext.Array.forEach(c,function(h){if(b.indexOf(h)>-1){b.remove(h)}e.add(h)});b.resumeEvents();e.resumeEvents();Ext.suspendLayouts();g.boundList.refresh();a.boundList.refresh();Ext.resumeLayouts(true)},onBindStore:function(a,b){var c=this;if(c.fromField){c.fromField.store.removeAll();c.toField.store.removeAll();if(a.getCount()){c.populateFromStore(a)}else{c.store.on("load",c.populateFromStore,c)}}},populateFromStore:function(a){var b=this.fromField.store;this.fromStorePopulated=true;b.add(a.getRange());b.fireEvent("load",b)},onEnable:function(){var a=this;a.callParent();a.fromField.enable();a.toField.enable();Ext.Array.forEach(a.query("[navBtn]"),function(b){b.enable()})},onDisable:function(){var a=this;a.callParent();a.fromField.disable();a.toField.disable();Ext.Array.forEach(a.query("[navBtn]"),function(b){b.disable()})},onDestroy:function(){this.bindStore(null);this.callParent()}});Ext.define("Ext.ux.form.SearchField",{extend:"Ext.form.field.Text",alias:"widget.searchfield",triggers:{clear:{weight:0,cls:Ext.baseCSSPrefix+"form-clear-trigger",hidden:true,handler:"onClearClick",scope:"this"},search:{weight:1,cls:Ext.baseCSSPrefix+"form-search-trigger",handler:"onSearchClick",scope:"this"}},hasSearch:false,paramName:"query",initComponent:function(){var c=this,a=c.store,b;c.callParent(arguments);c.on("specialkey",function(d,g){if(g.getKey()==g.ENTER){c.onSearchClick()}});if(!a||!a.isStore){a=c.store=Ext.data.StoreManager.lookup(a)}a.setRemoteFilter(true);b=c.store.getProxy();b.setFilterParam(c.paramName);b.encodeFilters=function(d){return d[0].getValue()}},onClearClick:function(){var b=this,a=b.activeFilter;if(a){b.setValue("");b.store.getFilters().remove(a);b.activeFilter=null;b.getTrigger("clear").hide();b.updateLayout()}},onSearchClick:function(){var a=this,b=a.getValue();if(b.length>0){a.activeFilter=new Ext.util.Filter({property:a.paramName,value:b});a.store.getFilters().add(a.activeFilter);a.getTrigger("clear").show();a.updateLayout()}}});Ext.define("Ext.ux.grid.SubTable",{extend:"Ext.grid.plugin.RowExpander",alias:"plugin.subtable",rowBodyTpl:['<table class="'+Ext.baseCSSPrefix+'grid-subtable">',"{%","this.owner.renderTable(out, values);","%}","</table>"],init:function(d){var e=this,c=e.columns,a,b,f;e.callParent(arguments);e.columns=[];if(c){for(b=0,a=c.length;b<a;++b){f=Ext.apply({preventRegister:true},c[b]);f.xtype=f.xtype||"gridcolumn";e.columns.push(Ext.widget(f))}}},destroy:function(){var c=this.columns,a,b;if(c){for(b=0,a=c.length;b<a;++b){c[b].destroy()}}this.columns=null;this.callParent()},getRowBodyFeatureData:function(b,a,c){this.callParent(arguments);c.rowBodyCls+=" "+Ext.baseCSSPrefix+"grid-subtable-row"},renderTable:function(g,m){var k=this,d=k.columns,a=d.length,c=k.getAssociatedRecords(m.record),n=c.length,e,b,h,f,l;g.push("<thead>");for(f=0;f<a;f++){g.push('<th class="'+Ext.baseCSSPrefix+'grid-subtable-header">',d[f].text,"</th>")}g.push("</thead><tbody>");for(h=0;h<n;h++){e=c[h];g.push("<tr>");for(f=0;f<a;f++){b=d[f];l=e.get(b.dataIndex);if(b.renderer&&b.renderer.call){l=b.renderer.call(b.scope||k,l,{},e)}g.push('<td class="'+Ext.baseCSSPrefix+'grid-subtable-cell"');if(b.width!=null){g.push(' style="width:'+b.width+'px"')}g.push('><div class="'+Ext.baseCSSPrefix+'grid-cell-inner">',l,"</div></td>")}g.push("</tr>")}g.push("</tbody>")},getRowBodyContentsFn:function(a){var b=this;return function(c){a.owner=b;return a.applyTemplate(c)}},getAssociatedRecords:function(a){return a[this.association]().getRange()}});Ext.define("Ext.ux.grid.TransformGrid",{extend:"Ext.grid.Panel",constructor:function(q,f){f=Ext.apply({},f);q=this.table=Ext.get(q);var j=f.fields||[],c=f.columns||[],k=[],m=[],e=q.query("thead th"),h=0,l=e.length,g=q.dom,b,p,n,d,o,a;for(;h<l;++h){d=e[h];o=d.innerHTML;a="tcol-"+h;k.push(Ext.applyIf(j[h]||{},{name:a,mapping:"td:nth("+(h+1)+")/@innerHTML"}));m.push(Ext.applyIf(c[h]||{},{text:o,dataIndex:a,width:d.offsetWidth,tooltip:d.title,sortable:true}))}if(f.width){b=f.width}else{b=q.getWidth()+1}if(f.height){p=f.height}Ext.applyIf(f,{store:{data:g,fields:k,proxy:{type:"memory",reader:{record:"tbody tr",type:"xml"}}},columns:m,width:b,height:p});this.callParent([f]);if(f.remove!==false){g.parentNode.removeChild(g)}},onDestroy:function(){this.callParent();this.table.remove();delete this.table}});Ext.define("Ext.ux.statusbar.ValidationStatus",{extend:"Ext.Component",requires:["Ext.util.MixedCollection"],errorIconCls:"x-status-error",errorListCls:"x-status-error-list",validIconCls:"x-status-valid",showText:"The form has errors (click for details...)",hideText:"Click again to hide the error list",submitText:"Saving...",init:function(b){var a=this;a.statusBar=b;b.on({single:true,scope:a,render:a.onStatusbarRender,beforedestroy:a.destroy});b.on({click:{element:"el",fn:a.onStatusClick,scope:a,buffer:200}})},onStatusbarRender:function(c){var b=this,a=function(){b.monitor=true};b.monitor=true;b.errors=Ext.create("Ext.util.MixedCollection");b.listAlign=(c.statusAlign==="right"?"br-tr?":"bl-tl?");if(b.form){b.formPanel=Ext.getCmp(b.form);b.basicForm=b.formPanel.getForm();b.startMonitoring();b.basicForm.on("beforeaction",function(e,d){if(d.type==="submit"){b.monitor=false}});b.basicForm.on("actioncomplete",a);b.basicForm.on("actionfailed",a)}},startMonitoring:function(){this.basicForm.getFields().each(function(a){a.on("validitychange",this.onFieldValidation,this)},this)},stopMonitoring:function(){this.basicForm.getFields().each(function(a){a.un("validitychange",this.onFieldValidation,this)},this)},onDestroy:function(){this.stopMonitoring();this.statusBar.statusEl.un("click",this.onStatusClick,this);this.callParent(arguments)},onFieldValidation:function(b,c){var a=this,d;if(!a.monitor){return false}d=b.getErrors()[0];if(d){a.errors.add(b.id,{field:b,msg:d})}else{a.errors.removeAtKey(b.id)}this.updateErrorList();if(a.errors.getCount()>0){if(a.statusBar.getText()!==a.showText){a.statusBar.setStatus({text:a.showText,iconCls:a.errorIconCls})}}else{a.statusBar.clearStatus().setIcon(a.validIconCls)}},updateErrorList:function(){var b=this,c,a=b.getMsgEl();if(b.errors.getCount()>0){c=["<ul>"];this.errors.each(function(d){c.push('<li id="x-err-',d.field.id,'"><a href="#">',d.msg,"</a></li>")});c.push("</ul>");a.update(c.join(""))}else{a.update("")}a.setSize("auto","auto")},getMsgEl:function(){var c=this,a=c.msgEl,b;if(!a){a=c.msgEl=Ext.DomHelper.append(Ext.getBody(),{cls:c.errorListCls},true);a.hide();a.on("click",function(d){b=d.getTarget("li",10,true);if(b){Ext.getCmp(b.id.split("x-err-")[1]).focus();c.hideErrors()}},null,{stopEvent:true})}return a},showErrors:function(){var a=this;a.updateErrorList();a.getMsgEl().alignTo(a.statusBar.getEl(),a.listAlign).slideIn("b",{duration:300,easing:"easeOut"});a.statusBar.setText(a.hideText);a.formPanel.body.on("click",a.hideErrors,a,{single:true})},hideErrors:function(){var a=this.getMsgEl();if(a.isVisible()){a.slideOut("b",{duration:300,easing:"easeIn"});this.statusBar.setText(this.showText)}this.formPanel.body.un("click",this.hideErrors,this)},onStatusClick:function(){if(this.getMsgEl().isVisible()){this.hideErrors()}else{if(this.errors.getCount()>0){this.showErrors()}}}});Ext.define("sl.data.CacheStore",{extend:"Ext.data.Store",alias:["store.cachestore"],uses:["sl.utils.Toast","Ext.util.HashMap"],loaded:false,saveIndividually:false,isStoreValidatedOnLoad:true,isRecordChangeValidated:true,isNewRecordValidated:true,config:{CacheClassName:"",CacheQueryName:"",CacheMethodName:"",extraParams:{},pageSize:0},defaultSaveConfig:{},removedphantom:[],constructor:function(b){var a=this;b=b||{};if(b.CacheQueryName==="**Required**"){b.CacheQueryName=undefined}b.CacheCommandType=b.CacheCommandType||(Ext.isString(b.CacheQueryName)&&b.CacheQueryName.length>0)?2:1;b.extraParams=Ext.apply({CacheClassName:b.CacheClassName,CacheQueryName:b.CacheQueryName,CacheMethodName:b.CacheMethodName,CacheCommandType:b.CacheCommandType},(b.extraParams||{}));b.proxy=Ext.merge({type:"ajax",url:"../Ext.JsonRequest.cls",timeout:b.timeout||Ext.Ajax.getTimeout()||300000,reader:{type:"json",rootProperty:"records",totalProperty:"totalCount"},writer:{type:"json"},extraParams:b.extraParams,listeners:{scope:a,exception:function(f,d,c,e){if(!Ext.isEmpty(d.responseText)){var h=Ext.decode(d.responseText),g="";if(h&&h.error&&h.error.Msg){g=h.error.Msg;Ext.Msg.alert("Request Error",g)}console.error("Cach Store Proxy Error",{extraParams:this.getExtraParams(),errorMessage:g,store:this,lastOptions:this.lastOptions,args:arguments,r:h})}}}},b.proxy);Ext.Object.each(b.proxy.extraParams,function(c,e,d){if(Ext.isEmpty(e)){delete b.proxy.extraParams[c]}});a.callParent(arguments);a.on({priority:1000,beforeload:a.onCacheStoreBeforeLoad,load:a.onCacheStoreLoad,exception:a.onCacheStoreException,datachanged:(a.isStoreValidatedOnLoad?a.validateOnStoreLoad:Ext.emptyFn),update:(a.isRecordChangeValidated?a.validateOnRecordChange:Ext.emptyFn),add:(a.isNewRecordValidated?a.validateOnRecordAdded:Ext.emptyFn),clear:a.onCacheStoreClear});a.remove=Ext.Function.createSequence(a.remove,function(c){c=Ext.Array.from(c);Ext.Array.forEach(c,function(e,d,f){if(e.phantom){a.removedphantom.push(e)}});return a.removedphantom},a)},onCacheStoreBeforeLoad:function(b,a){b.setExtraParam("idProperty",b.getExtraParam("idProperty")||b.getIDProperty());b.resetRemovedRecordsArrays()},onCacheStoreLoad:function(){this.loaded=true},onCacheStoreClear:function(){this.loaded=false},onCacheStoreException:function(a){if(!Ext.isEmpty(this.reader.jsonData.error.Msg)){console.error("Cach Store Exception",{Error:this.reader.jsonData.error.Msg,m:a});Ext.Msg.alert("Request Error",this.reader.jsonData.error.Msg)}},showValidationErrorToast:function(){var a=this.validateRecords();if(a){sl.utils.Toast.showErrorToast(a.title,a.message,4000)}return a},filterSaved:function(a){return a.isSaved()},filterSaving:function(a){return a.isSaving()},filterDeleting:function(a){return a.isDeleting()},filterNotDeleted:function(a){return a.isNotDeleted()},getLastSavedRecords:function(a,b){return this.getSaveSessionRecords(a,b,"hadSuccessfulSave")},getLastSaveFailureRecords:function(a,b){return this.getSaveSessionRecords(a,b,"hadSaveFailure")},getSaveSessionRecords:function(d,e,a){var c=this,b=[];d=d||c.getRecords();e=e||c.getCurrentSaveSessionID();a=Ext.valueFrom(a,"isInSaveSession");if(e){b=Ext.Array.filter(d,function(f){return f[a](e)})}return b},getSavedRecords:function(a){return this.getRecordCollection(a).filterBy(this.filterSaved).items},getSavingRecords:function(a){return this.getRecordCollection(a).filterBy(this.filterSaving).items},getDeletingRecords:function(a){return this.getRecordCollection(a).filterBy(this.filterDeleting).items},getNotDeletedRecords:function(a){return this.getRecordCollection(a).filterBy(this.filterNotDeleted).items},getDeletedRecords:function(b){var a=this,f=a.getRemovedRecords(b)||[],e=a.getPhantomRemovedRecords(b)||[],d=f.concat(e),c=d.length>0?a.getDeletingRecords(d):[];return c},isLoaded:function(){var a=false;if(Ext.isBoolean(this.loaded)&&this.loaded===true){a=true}return a},addSaveSession:function(b){var a=this;b=b||Date.now();a.saveSessions=Ext.isDefined(a.saveSessions)?a.saveSessions:Ext.create("Ext.util.Collection");a.saveSessions.add({id:b,fn:undefined});return b},getCurrentSaveSessionID:function(){var c=false,b=this.saveSessions,a;if(Ext.isFunction((b||{}).last)){a=b.last();if(a){c=b.getKey(a)}}return c},updateSaveCallback:function(d,e){var a=this,b,c=false;d=Ext.valueFrom(d,Ext.emptyFn);if(e){b=(Ext.isFunction((a.saveSessions||{}).get)?a.saveSessions.get(e):undefined);if(Ext.isObject(b)){b.fn=d;c=true}}if(!c){a.saveConfig=Ext.apply({},a.saveConfig);a.saveConfig.saveCallback=d;c=true}return c},getSaveCallback:function(c){var b=this,a;if(c){a=(Ext.isFunction((b.saveSessions||{}).get)?(b.saveSessions.get(c)||{}).fn:undefined)}return a||(b.saveConfig||{}).saveCallback},saveModifiedRecords:function(b,a){this.saveRecords(this.getModifiedRecords(),b,Ext.apply({},a,{trackAllModifiedRecords:true}))},saveRecords:function(a,f,c){var b=this,e=50,d;if(Ext.isEmpty(a)&&!Ext.isArray(a)){b.saveModifiedRecords(c)}else{a=Ext.Array.from(a);if(b.fireEvent("beforesave",b,a,f,c)!==false){d=b.initBeforeSave(a,c);if(f){if(!Ext.isString(f)&&!Ext.isFunction(f)&&Ext.isObject(f)){c=f}else{b.updateSaveCallback(f,d)}}if(a.length>0){b.fireEvent("saving",b,a);Ext.Function.defer(function(){b.commitChanges(a);if(!b.saveIndividually){b.saveMultipleRecords(a,d)}},e,b)}else{b.afterAllRecordsSaved(d)}}}},initBeforeSave:function(a,d){var b=this,c;b.saveConfig=Ext.apply({},d,b.defaultSaveConfig);b.saveErrors=Ext.create("Ext.util.HashMap");c=b.addSaveSession(b.saveConfig.saveSessionID||undefined);b.initRecordsBeforeSave(a,c,b.saveConfig.trackAllModifiedRecords);return c},initRecordsBeforeSave:function(a,e,d){var b=this,c,f;a=Ext.Array.from(a);e=e||b.getCurrentSaveSessionID();Ext.Array.forEach(a,function(h,g,i){h.initBeforeSave(e)});if(d){c=b.getDirtyRecords();f=b.getDeletingRecords();Ext.Array.forEach(Ext.Array.difference(Ext.Array.difference(c,a),f),function(g){g.addSaveSession(e)})}},addRecordErrorsToHash:function(a,b){a=Ext.Array.from(a);if(b){Ext.Array.forEach(a,function(e,c,f){var d=e.getValidation().getErrors();Ext.Array.forEach(d,function(h,g,i){b.add(h.id+":  "+h.msg,h.source||"ExtJS Validation")})})}return b},onRecordCommit:function(d,e,g){g=g||{};if(e===Ext.data.Model.COMMIT){var j=this,h=Ext.apply(g,j.saveConfig),a,f,b,c=d.getCurrentSaveSessionID();if(j.fireEvent("beforerecordsave",j,d,h)!==false){a=h.idField||j.getIDProperty(d);f=h.cacheIdProperty||j.getIDProperty(d)||"ID";b=h.cacheClassName||j.getExtraParam("CacheClassName");j.saveIndividualRecord(d,a,f,b,h,c)}else{d.restoreBeforeCommitProperties();var i=j.getSavingRecords().length;if(i===0){j.afterAllRecordsSaved(c)}}}},saveMultipleRecords:function(b,d){var i=this,g=i.saveConfig||{},e=[],h,a,f,c;Ext.Array.forEach(b,function(j,k,l){if(i.fireEvent("beforerecordsave",i,j,g)!==false){a=g.idField||i.getIDProperty(b[0]);f=g.cacheIdProperty||"ID";c=g.cacheClassName||i.getExtraParam("CacheClassName");h=j.getFormattedPropertiesBeforeSave(f,a);e.push({CacheClassName:"JSON.Adapter",CacheMethodName:"SaveObject",CacheCommandType:1,JSONObject:Ext.encode({CacheClassName:c,Properties:h,idProperty:f,OldValues:j.json})})}else{j.restoreBeforeCommitProperties()}});Ext.Ajax.request({scope:i,url:"../Ext.BatchJsonRequest.cls",params:{Batch:Ext.encode(e)},callback:function(k,l,j){i.multipleRecordsSaveCallback(k,l,j,b,a,d)}})},saveIndividualRecord:function(a,c,e,g,f){var b=this,d=a.getFormattedPropertiesBeforeSave(e,c);Ext.Ajax.request({scope:b,url:"../Ext.JsonRequest.cls",params:{CacheClassName:"JSON.Adapter",CacheMethodName:"SaveObject",CacheCommandType:1,idProperty:e,JSONObject:Ext.encode({CacheClassName:g,Properties:d,OldValues:a.json})},callback:function(i,j,h){b.recordSaveCallback(i,j,h,a,c,f)}})},multipleRecordsSaveCallback:function(j,i,d,b,a,c){var h=this,e=Ext.decode(d.responseText)||[],f,g=function(k,n){var m=n.error?n.error.Msg:"Error",l={success:i,response:d,idField:a,options:j};h.handleFailedRecordSave(k,m,l)};if(e.success===false){Ext.Array.forEach(b,function(k,l,m){g(k,e)})}else{Ext.Array.forEach(e,function(n,m,o){var l=b[m],k;if(!n.success){g(l,n)}else{k=n.result;h.handleSuccessfulRecordSave(l,k,a,c)}f=h.getSavingRecords().length;h.fireEvent("recordsave",h,l,f,n.success)})}h.afterAllRecordsSaved(c)},recordSaveCallback:function(k,j,d,e,b,c){var i=this,a=Ext.decode(d.responseText)||{success:false},g;if(!a.success){var f=a.error?a.error.Msg:"Error",h={success:j,response:d,idField:b,options:k};i.handleFailedRecordSave(e,f,h)}else{i.handleSuccessfulRecordSave(e,a.result,b,c)}g=i.getSavingRecords().length;i.fireEvent("recordsave",i,e,g,a.success);if(g===0){i.afterAllRecordsSaved(c)}},handleSuccessfulRecordSave:function(a,c,d,e){var b=this,f=a.get(d),g=Ext.isEmpty(f);a.set(d,c,{dirty:false});a.clearBeforeCommitProperties();a.updateSaveSessionResult(e,true);if(g){b.fireEvent("newrecordsaved",b,a,c)}else{if(!sl.utils.areValuesEquivalent(f,c)){console.error("Cach Changed Saved Record's ID",{record:a,oldID:f,newID:c})}}return g},handleFailedRecordSave:function(a,e,c,d){var b=this;b.saveErrors.add(e,"Cach");a.updateSaveSessionResult(d,e);sl.utils.consoleWarningWithTrace("Record's Save Error",Ext.apply({record:a,error:e},c));b.fireEvent("recordfailedsave",b,a);return a.restoreBeforeCommitProperties()},afterAllRecordsSaved:function(a){var b=this,d=a||b.getCurrentSaveSessionID(),h=b.getSaveSessionRecords(undefined,d),g=[],e=[],f=false,c;Ext.Array.forEach(h,function(k,j,l){var i=k.getSaveSessionResult(d);if(i===true){g.push(k)}else{e.push(k);if(i===false){k.addValidationErrorsToSaveSession(d)}}});if(e.length>0){b.addRecordErrorsToHash(e,b.saveErrors);b.revertCommittedRecords(e);f=false}else{if(g.length>0){f=true}}c=b.showSaveNotification(g,e);b.fireEvent("save",b,f,g,e,h,d,c);Ext.callback(b.getSaveCallback(d),b,[f,g,e,h,d,c]);return f},showSaveNotification:function(i,b){var h=this,d=h.saveConfig||{},g=i.length,j=b.length,c=d.dontShowToast||d.dontShowSaveToast||false,f=d.dontShowCount||d.dontShowSaveCount||false,a=c||d.dontShowNoChangesToast||false,e;if(g>0){if(j>0){e=h.notifyErrorsDuringSave(i,b)}else{if(!c){e=h.notifyRecordsSaved(g,f)}}}else{if(j>0){e=h.notifyErrorsDuringSave(i,b)}else{if(!c&&!a){e=h.notifyNoRecordsToSave()}}}return e},notifyNoRecordsToSave:function(){var b="No Changes to Save",a="";return sl.utils.Toast.showWarningToast(b,a)},notifyRecordsSaved:function(a,b){return sl.utils.Toast.showActionToast("save",(b?"":a))},notifyErrorsDuringSave:function(k,b){var h=this,f=k.length,l=b.length,c="",e=Ext.String.format("{0} record{1} saved",f,(f===1?" was":"s were")),d=Ext.String.format("{0} record{1} could not be saved",l,(l===1?"":"s")),g=h.getErrors(h.saveErrors),j=h.getErrorMessage(g),i=(g.length>0||l>0),a;if(i){sl.utils.consoleWarningWithTrace("Error(s) During Save",{errors:g,"failed to save":b,store:h})}if(j){d+=" because of the following errors:<br/><br/>"+j}c=e+"<br/><br/><hr><br/>"+d;a=Ext.Msg.alert("Save Failed",c);h.fireEvent("saveerrors",h);return a},getErrors:function(a){return a.getKeys()||[]},getErrorMessage:function(c,a){var b="";a=a||"&#149; <b>{0}</b>";Ext.Array.forEach(c,function(e,d,f){b+=(d>0?"<br/><br/>":"")+Ext.String.format(a,Ext.util.Format.stripTags(e||""))});return b},revertCommittedRecords:function(b){var a=this,c=[];b=b||a.getUnsavedRecords();b=Ext.Array.from(b);Ext.Array.forEach(b,function(e,d,f){if(e.restoreBeforeCommitProperties()){c.push(e)}});return c},deleteRecords:function(d,c){var a=this;d=Ext.Array.from(d);c=c||{};if(a.fireEvent("beforedelete",a,d,c)){a.initBeforeDelete(c);if(d.length>0){a.initRecordsBeforeDelete(d);a._showDeleteMask=true;a.fireEvent("deleting",a,d);var b=a.splitNewAndExistingRecords(d),f=b.hasId||[],e=b.noId||[];if(f.length>0){a.deleteRecordsFromDatabase(f,e)}else{if(e.length>0){a.deleteNewRecords(e)}a.afterRecordsDeleted()}}else{a.afterRecordsDeleted()}}},deleteRecordsFromDatabase:function(g,f){var b=this,c=b.deleteConfig,d=b.getRecordIDs(g,c),e=c.cacheClassName||b.getExtraParam("CacheClassName"),a=c.deleteRequestParams||{CacheClassName:"JSON.Adapter",CacheMethodName:"DeleteObjects",CacheCommandType:1,JSONObject:Ext.encode({CacheClassName:e,Properties:d})};f=f||[];Ext.Ajax.request({url:"../Ext.JsonRequest.cls",scope:b,params:a,callback:function(i,j,h){b.deleteCallback(i,j,h,g,f)}})},deleteCallback:function(c,f,b,g,e){var a=this,d=Ext.decode(b.responseText);g=Ext.Array.from(g);e=Ext.Array.from(e);if(d.success){a.handleSuccessfulRecordsDelete(g)}else{a.handleFailedRecordsDelete(g,c,f,b)}Ext.Array.forEach(g,function(h){a.fireEvent("recorddelete",a,h,d.success)});if(e.length>0){a.deleteNewRecords(e)}a.afterRecordsDeleted()},deleteNewRecords:function(b){var a=this;a.remove(b);Ext.Array.forEach(b,function(c){a.fireEvent("recorddelete",a,c)})},setRecordsToDelete:function(a,b){b=Ext.isDefined(b)?b:true;Ext.Array.forEach(a,function(d,c,e){d.deleting=b})},handleSuccessfulRecordsDelete:function(b){var a=this;a.remove(b)},handleFailedRecordsDelete:function(c,d,g,b){var a=this,f=Ext.decode(b.responseText),e=f.error?f.error.Msg:"Error";c=Ext.Array.from(c);Ext.Array.forEach(c,function(h){a.deleteErrors.add(e,"Cach");sl.utils.consoleWarningWithTrace("Record's Delete Error",{error:e,options:d,response:b,success:g,record:h});a.fireEvent("recordfaileddelete",a,h)});a.addRecordErrorsToHash(c,a.errorHash)},afterRecordsDeleted:function(){var a=this,c=a.getDeletedRecords(),b=a.getNotDeletedRecords(),d=false;if(b.length>0){a.addRecordErrorsToHash(b,a.deleteErrors)}d=a.showDeleteNotification(c,b);a.fireEvent("delete",a,d);delete a._showDeleteMask;return d},showDeleteNotification:function(e,j){var i=this,d=i.deleteConfig||{},b=e.length,f=j.length,c=d.dontShowToast||d.dontShowDeleteToast||false,h=d.dontShowCount||d.dontShowDeleteCount||false,a=c||d.dontShowNoChangesToast||false,g;if(b>0){if(f>0){g=i.notifyErrorsDuringDelete(e,j)}else{if(!c){g=i.notifyRecordsDeleted(b,h)}}}else{if(f>0){g=i.notifyErrorsDuringDelete(e,j)}else{if(!c&&!a){g=i.notifyNoRecordsToDelete()}}}return g},notifyNoRecordsToDelete:function(){var b="No Records to Delete",a="";return sl.utils.Toast.showWarningToast(b,a)},notifyRecordsDeleted:function(a,b){return sl.utils.Toast.showActionToast("delete",(b?"":a))},notifyErrorsDuringDelete:function(e,l){var i=this,c=e.length,f=l.length,d="",b=Ext.String.format("{0} record{1} deleted",c,(c===1?" was":"s were")),g=Ext.String.format("{0} record{1} could not be deleted",f,(f===1?"":"s")),h=i.getErrors(i.deleteErrors),k=i.getErrorMessage(h),j=(h.length>0||f>0),a;if(j){sl.utils.consoleWarningWithTrace("Error(s) During Delete",{errors:h,recordsNotDeleted:l,store:i})}if(k){g+=" because of the following errors:<br/><br/>"+k}d=b+"<br/><br/><hr><br/>"+g;a=Ext.Msg.alert("Delete Failed",d);i.fireEvent("deleteerrors",i,a);return a},initBeforeDelete:function(d){var a=this,c={},b=Ext.clone(a.defaultDeleteConfig)||{};Ext.apply(c,d,b);a.deleteConfig=c||{};a.deleteErrors=Ext.create("Ext.util.HashMap")},initRecordsBeforeDelete:function(b){var a=this,c=a.getDeletingRecords()||[];a.resetRemovedRecordsArrays(b);a.setRecordsToDelete(c,false);a.setRecordsToDelete(b,true)},resetRemovedRecordsArrays:function(b){var a=this;if(Ext.isArray(b)){a.removed=(a.removed||[]).filter(function(c){return b.indexOf(c)>=0});a.removedphantom=(a.removedphantom||[]).filter(function(c){return b.indexOf(c)>=0})}else{a.removed=[];a.removedphantom=[]}},undoDeleteRecords:function(a,d){d=d||{};var c=this,b=[],f=[],e=d.addlMsg||"<br/><br/><b>You must save all restored records.</b>";d.newRecordOpts=Ext.applyIf(d.newRecordOpts||{},{includeID:false});if(c.fireEvent("beforeundodelete",c,a,d)){if(a.length>0){Ext.Array.forEach(a,function(i,g,h){var j=c.createNewRecord.call(c,i.data,d.newRecordOpts);b.push(j)});if(b.length>0){f=c.insert(0,b);if(f.length>0){c.resetRemovedRecordsArrays();if(!d.dontShowToast){sl.utils.Toast.showActionToast("restore",f.length,4000,e)}}}}if(a.length===0){sl.utils.Toast.showWarningToast("No records to restore","",2500)}else{if(b.length===0||f.length===0){sl.utils.Toast.showErrorToast("Error","No records restored",3500)}}c.fireEvent("undodelete",c,f,b,a)}},splitNewAndExistingRecords:function(b){var a=this,d=a.deleteConfig||{},e=[],f=[],c;b=Ext.Array.from(b||a.getRecords());Ext.Array.forEach(b,function(h,g,i){c=d.idField||a.getIDProperty(h,true);if(!Ext.isEmpty(h.data[c])){e.push(h)}else{f.push(h)}});return{all:b,hasId:e,noId:f}},syncRecordData:function(h,e,c,b,g,d,f){var i=this,a={},j;h=Ext.apply({},h);e=Ext.valueFrom(e,true);c=Ext.valueFrom(c,false);b=Ext.valueFrom(b,false);g=Ext.isFunction(g)?g:Ext.emptyFn;d=Ext.valueFrom(d,i);f=Ext.apply({},f);a=Ext.apply({},(i.lastOptions||{}).params,i.getExtraParams());h=Ext.apply({},h,a);j=(f._delegateDeleteHandling!==true);if(i.fireEvent("beforerecorddatasync",i,h)){Ext.Ajax.request({url:"../Ext.JsonRequest.cls",timeout:3600000,params:Ext.applyIf(h,{CacheClassName:i.getExtraParam("CacheClassName"),CacheQueryName:i.getExtraParam("CacheQueryName"),CacheCommandType:2}),callback:function(k,z,s){var l=Ext.JSON.decode(s.responseText),q=Ext.create("Ext.util.HashMap"),m=Ext.create("Ext.util.HashMap"),t=Ext.create("Ext.util.HashMap"),A=f.idField||i.getIDProperty(),B=i.getRecords(),x=(Ext.Array.from(l.records)||[]).map(function(r){return i.model.prototype.createNewRecord.apply(i.model,[r,{includeID:true}])}),p={},u=[],y=[],w=[],o=[],v=[],n=[];x.forEach(function(D,C,F){var E=D.get(A)||("undefined-"+C),r=i.getAt(i.findExact(A,E));if(r){t.add(E,{cacheRecord:D,storeRecord:r})}else{m.add(E,{cacheRecord:D})}p[E]=D});B.forEach(function(r,D,F){var E=r.get(A)||("undefined-"+D),C=p[E];if(C){t.add(E,{cacheRecord:C,storeRecord:r})}else{q.add(E,{storeRecord:r})}});i.suspendEvent("update");u=t.getValues();u.forEach(function(E,D,F){var C=E.cacheRecord,r=E.storeRecord;Ext.Object.each(C.getData(),function(I,K,H){if(r.idProperty!==I){var J=r.isModified(I),G=r.get(I);if(!J||(J&&b)){G=!Ext.isEmpty(G)?G:"";K=!Ext.isEmpty(K)?K:"";if(!sl.utils.areValuesEquivalent(G,K)){r.set(I,K,{dirty:e});r._updateProperties=Ext.Array.from(r._updateProperties);r._updateProperties.push(I);o.push(r)}}}})});w=q.getValues();y=m.getValues();y.forEach(function(D,C,E){var r=D.cacheRecord;i.insert(0,r);v.push(r)});w.forEach(function(D,C,E){var r=D.storeRecord;if(c||(!i.filterDirty(r)&&!i.filterInvalid(r)&&!Ext.isEmpty(r.get(A)))){n.push(r);if(j){i.remove(r)}}});i.resumeEvent("update");o=Ext.Array.unique(o);v=Ext.Array.unique(v);n=Ext.Array.unique(n);g.call(d,o,v,n);o.forEach(function(r){delete r._updateProperties});i.fireEvent("recorddatasync",i,o,v,n)}})}else{return false}}},function(){var a=this;a.createAlias({getBaseParam:"getExtraParam",setBaseParam:"setExtraParam"})});Ext.define("sl.data.CacheTreeStore",{extend:"Ext.data.TreeStore",alias:["store.cachetreestore"],mixins:{cachestore:"sl.data.CacheStore"},config:{CacheClassName:"",CacheQueryName:"",CacheMethodName:"",idField:"NodeId",textField:"Text",leafField:"isLeaf",walkTree:false,addLeafCheckbox:false,nodeParam:"nodeId"},constructor:function(b){var a=this;b=b||{};if(b.CacheQueryName==="**Required**"){b.CacheQueryName=undefined}b.CacheCommandType=b.CacheCommandType||(Ext.isString(b.CacheQueryName)&&b.CacheQueryName.length>0)?2:1;b.extraParams=Ext.apply({CacheClassName:b.CacheClassName,CacheQueryName:b.CacheQueryName,CacheMethodName:b.CacheMethodName,CacheCommandType:b.CacheCommandType,idField:b.idField,leafField:b.leafField,textField:b.textField},b.extraParams);if(b.addLeafCheckbox){b.extraParams.addLeafCheckbox=(b.addLeafCheckbox?1:0)}if(b.walkTree){b.extraParams.walkTree=(b.walkTree?1:0)}b.proxy=Ext.merge({type:"ajax",url:"../Ext.TreeLoader.cls",timeout:b.timeout||Ext.Ajax.getTimeout()||300000,reader:{type:"json",rootProperty:"records",totalProperty:"totalCount"},writer:{type:"json"},extraParams:b.extraParams,listeners:{scope:a,exception:function(f,d,c,e){if(!Ext.isEmpty(d.responseText)){var h=Ext.decode(d.responseText),g="";if(h&&h.error&&h.error.Msg){g=h.error.Msg;Ext.Msg.alert("Request Error",g)}console.error("Cach Tree Store Proxy Error",{extraParams:this.getExtraParams(),errorMessage:g,store:this,lastOptions:this.lastOptions,args:arguments,r:h})}}}},b.proxy);Ext.Object.each(b.proxy.extraParams,function(c,e,d){if(Ext.isEmpty(e)){delete b.proxy.extraParams[c]}});a.callParent(arguments);a=Ext.applyIf(a,a.mixins.cachestore);a.on({priority:1000,beforeload:a.onCacheStoreBeforeLoad,load:a.onCacheTreeStoreLoad,exception:a.onCacheStoreException,datachanged:(a.isStoreValidatedOnLoad?a.validateOnStoreLoad:Ext.emptyFn),update:(a.isRecordChangeValidated?a.validateOnRecordChange:Ext.emptyFn),add:(a.isNewRecordValidated?a.validateOnRecordAdded:Ext.emptyFn),clear:a.onCacheStoreClear});a.remove=Ext.Function.createSequence(a.remove,function(c){c=Ext.Array.from(c)||[];Ext.Array.forEach(c,function(e,d,f){if(e.phantom){a.removedphantom.push(e)}})},a)},handleSuccessfulRecordSave:function(a,c,d){var b=this,e=b.mixins.cachestore.handleSuccessfulRecordSave.apply(b,arguments);if(e){a.dirty=false}return e},deleteNewRecords:function(b){var a=this;Ext.Array.forEach(b,function(c){c.parentNode.removeChild(c);a.fireEvent("recorddelete",a,c)})},handleSuccessfulRecordsDelete:function(a){Ext.Array.forEach(a,function(b){b.parentNode.removeChild(b)})},getLoadingRecords:function(){var a=this;return a.getData().items.filter(function(b){return b.isLoading()})},onCacheTreeStoreLoad:function(c,b,f,a,e,d){c.onCacheStoreLoad.apply(c,arguments);if(c.getLoadingRecords().length===0){c.fireEvent("loadcomplete",c)}}});Ext.define("sl.data.file.Packet",{mixins:{observable:"Ext.util.Observable"},config:{format:"binary",data:null,binary:null,name:"",extension:"",type:"",size:null},constructor:function(a){this.initConfig(a);if(this.hasData()){this.set(this.getData(),this.getFormat())}this.mixins.observable.constructor.call(this,a);return this.callParent(arguments)},reset:function(){this.setBinary(null);this.setType(null);this.setSize(0);this.setName("")},getReader:function(){var b=this,a=new FileReader();return a},read:function(b,a){return this.readBlob(b,a)},readBlob:function(c,b){this.reset();var d=this,a=this.getReader();a.onload=function(g){var f=g.target.result;d.setBinary(f);if(typeof b==="function"){b(f)}};a.readAsArrayBuffer(c)},setBinary:function(b){var a=0;if(b){if(!this.isBinary(b)){b=new Uint8Array(b)}a=b.length}this.setSize(a);this.binary=b;return this},setText:function(f,e){if(e){this.setType(e)}var d=0,a=f.length,c=new ArrayBuffer(a),b=new Uint8Array(c);for(;d<a;d++){b[d]=f.charCodeAt(d)}this.setBinary(b);return this},setBase64:function(g,f){if(f){this.setType(f)}var e=0,b=window.atob(g),a=b.length,d=new ArrayBuffer(a),c=new Uint8Array(d);for(;e<a;e++){c[e]=b.charCodeAt(e)}this.setBinary(c);return this},set:function(b,c,a){if(!c){c=this.guessFormat(b)}this.setFormat(c);if(a){this.setType(a)}switch(c){case"text":return this.setText(b);case"base64":return this.setBase64(b);default:return this.setBinary(b)}},getText:function(){var b=0,c=this.getBinary(),a=c.length,d="";for(;b<a;b++){d+=String.fromCharCode(c[b])}return d},getBase64:function(){return btoa(this.getText())},getBinary:function(){return this.binary},getBlob:function(a){a=a||this.getType();var b=this.getBinary();return new Blob([b.buffer],{type:a})},save:function(){this.saveAs(this.getName())},saveAs:function(a){saveAs(this.getBlob(),a)},get:function(d,a){var b=this,c=b.data;d=d||b.guessFormat(c);a=a||b.getType();switch(d){case"base64":return b.getBase64();case"binary":return b.getBinary(a);default:return b.getText()}},getType:function(){var a=this.type;if(a){return a}var b=this.extension;switch(b){case"csv":return"text/csv";case"xls":return"application/vnd.ms-excel";case"xlsx":return"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";default:return"text/plain"}},isText:function(a){return !this.isBinary(a)&&!this.isBase64(a)},isBinary:function(a){return(a instanceof Uint8Array||a instanceof Uint16Array)},isBase64:function(b){var a=new RegExp("^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$");return a.test(b)},hasData:function(){return(this.data&&this.data.length)},guessFormat:function(a){if(this.isBinary(a)){return"binary"}else{if(this.isBase64(a)){return"base64"}}return"text"}});Ext.define("sl.data.file.reader.FileReader",{extend:"Ext.data.reader.Reader",alternateClassName:["sl.data.file.Reader"],alias:"reader.file",idProperty:null,totalProperty:null,successProperty:null,format:"binary",mapping:null,rawData:null,rawHeaders:null,rawHeadersFuzzySet:null,matchScore:0.3,autoCreateModelFromHeader:false,autoGuessMapping:true,setModel:function(b,c,a){this.callParent(arguments);if(!a){this.setMapping(this.getRawMapping())}},getRawMapping:function(){var f=this,e=f.getModel()||{},b=e.prototype||{},c=b.fields||{},a=c.items||[],d={};Ext.Array.each(a,function(j,i){var g=j.name,h=j.importMapping||j.mapping||null;if(Ext.Array.indexOf(["id"],g)!==-1){return}if(Ext.Array.indexOf(["hasMany"],j.type.type)!==-1){return}if(!j.persist){return}d[g]=h});return d},getMapping:function(){return this.mapping},setMapping:function(d,b){var e=this,c=this.getModel(),g,f={};Ext.Object.each(d,function(h,i){g=e.findField(c,h);if(!g){throw new Error("Can't set mapping for unknown field: "+h)}if(typeof i==="string"){i={source:i}}else{if(i===null){i={source:g.mapping||g.name}}}f[h]=i});this.mapping=f;if(!b){var a=this.getMappedRecords();this.onMappingChange(d,a)}return this.mapping},onMappingChange:function(b,a){this.fireEvent("mappingchange",this,b,a)},findField:function(a,b){return Ext.Array.findBy(a.getFields(),function(c){return c.name===b})},guessMapping:function(h,a){var d=this,c=d.getRawMapping(),g={},b=d.getModel(),f=d.importStore,e=this.rawHeadersFuzzySet;Ext.Object.each(c,function(q,t){var o;if(t!==null&&typeof t==="object"&&t.value){o=t}else{var n;if(typeof t==="string"){n=t}else{if(t!==null&&typeof t==="object"&&t.source){n=t.source}}var i=d.findField(b,q),p=d.getModelHeader&&d.getModelHeader(q),l=[q,n,p],m=[];if(e){Ext.each(l,function(v){if(v){var u=e.get(v);if(u){m=m.concat(u)}}})}var s=Ext.Array.sort(m,0),k=Ext.Array.slice(s,-1)[0];if(k&&k.length===2){var j=k[0],r=k[1];if(j>d.matchScore){o={source:r}}}if(!o&&i.defaultValue){o={value:i.defaultValue}}}g[q]=o});if(!h){g=this.setMapping(g,a)}return g},getMappedRecords:function(){var c=this,e=c.rawData,d=c.getData(e),a=c.getRoot(d),b=[];if(a){b=c.extractData(a)}return b},buildExtractors:Ext.emptyFn,getIdProperty:Ext.emptyFn,getId:Ext.emptyFn,buildRecordDataExtractor:Ext.emptyFn,createFieldAccessExpression:Ext.emptyFn,getSuccess:function(a){return a.length>0},getCount:function(a){return a.length},getTotal:function(a){return a.length},convertRecordData:function(c,e,b){var d=this,a=d.getModel().getFields();Ext.Array.each(a,function(h,f){var g=h.name;if(g==="id"){return}c[g]=this.readField(h,b,g)},this)},readRecords:function(f){var b=Ext.Array.from(f)[0]||{},e=this.proxy||{},c=e.store||{};this.rawData=f;this.rawHeaders=Ext.Object.getKeys(b);this.rawHeadersFuzzySet=new window.FuzzySet(this.rawHeaders);if(this.autoCreateModelFromHeader||e.autoCreateModelFromHeader){var a=Ext.Array.map(this.rawHeaders,function(g){return{name:g}});var d=Ext.define("Ext.data.Store.ImplicitModel-"+Ext.id(),{extend:"Ext.data.Model",fields:a});this.model=d;e.model=d;if(e.store){e.store.model=d}}if(this.autoGuessMapping||(typeof this.autoGuessMapping==="undefined"&&c.autoGuessMapping)){this.guessMapping()}return this.callParent(arguments)},readPacket:function(a){return this.read(a.getText(),{type:"binary"})},defaultRecordCreator:function(){var a=this.callParent(arguments);delete a.data.id;return a},extractModelData:function(d,b){var e=this,c=this.getMapping(),g=this.getModel(),a=g.getFields(),f={};Ext.Array.each(a,function(i){var h=i.name;f[h]=e.readField(i,d,h)});return f},readField:function(g,b,d){d=d||g.name;var c=this.getMapping(),e=c[d],f;if(e&&typeof e!=="object"){e={source:e}}var h=Ext.Object.getKeys(e)[0],a=Ext.Object.getValues(e)[0];if(h==="value"){f=a}else{f=b[a||d]}if(typeof f==="undefined"||f===null){if(g.defaultValue){f=g.defaultValue}}if(g.convert){f=g.convert(f,b)}return f}});Ext.define("sl.data.file.reader.Csv",{extend:"sl.data.file.reader.FileReader",alias:"reader.file.csv",format:"text",lineEnding:null,delimiter:null,lineEndings:["\r\n","\r","\n"],delimiters:[",",";","\t"],read:function(d){var c=this.lineEnding||this.guessLineEnding(d),a=this.delimiter||this.guessDelimiter(d,c),g,b;d=this.alwaysTrailingLineEnding(d,c);try{d=window.CSV.parse(d,{header:true,line:c,delimiter:a});return this.callParent(arguments)}catch(f){b=new Ext.data.ResultSet({total:0,count:0,records:[],success:false,message:f.message});this.fireEvent("exception",this,d,b);console.error("Unable to parse the provided CSV: "+f.message);return b}},guessLineEnding:function(g){var b=this.lineEndings,e=new RegExp("("+b.join("|")+")","g"),f=g.match(e),d=0,a=0,c=Ext.Array.map(b,function(j,h){var i=0;Ext.Array.forEach(f,function(k){if(j===k){i++}});if(i>a){d=h;a=i}return i});return b[d]},guessDelimiter:function(d,c){var e=this.delimiters,g=Ext.Array.map(e,function(j){return new RegExp(j,"g")}),h=[],i=d.split(c);Ext.each(i,function(j){var k=Ext.Array.map(g,function(l){return(j.match(l)||[]).length});if(Ext.Array.max(k)>0&&Ext.Array.equals(h,k)){return false}h=k});var f=Ext.Array.max(h),b=Ext.Array.indexOf(h,f),a=e[b];return a},alwaysTrailingLineEnding:function(c,b){var a=b.length;if(c.slice(-a)!==b){c+=b}return c}});Ext.define("sl.data.file.reader.Xls",{extend:"sl.data.file.reader.FileReader",alias:"reader.file.xls",parserFnName:"XLS",read:function(e,b){Ext.applyIf(b||{},this.readerConfig||{});b=Ext.applyIf(b,{type:this.format||this.proxy.format||"binary"});var c=this,g=window[c.parserFnName],d=g.read(e,b),a=[],f=true;d.SheetNames.forEach(function(h){var i=g.utils.sheet_to_row_object_array(d.Sheets[h]);if(i.length>0){a=a.concat(i)}});return this.callParent([a])}});Ext.define("sl.data.file.reader.Xlsx",{extend:"sl.data.file.reader.Xls",alias:"reader.file.xlsx",parserFnName:"XLSX"});Ext.define("sl.data.file.writer.FileWriter",{extend:"Ext.data.writer.Writer",alternateClassName:["sl.data.file.Writer"],alias:"writer.file",config:{nameProperty:"mapping",writeAllFields:true,writeRecordId:false},model:null,title:null,setTitle:function(a){this.title=a.substring(0,a.lastIndexOf("."))},getTitle:function(){return this.title||""},getRawColumns:function(c){var b=Ext.isArray(c)&&c.length>0?c[0]:null,a=[];if(b){Ext.Array.each(b,function(e,d){a.push({dataIndex:d,text:d})})}return a},write:function(){return this.callParent(arguments)},getRecordData:function(a,b){var c=Ext.clone(a.data);delete c.id;return c}});Ext.define("sl.data.file.writer.Csv",{extend:"sl.data.file.writer.FileWriter",alias:"writer.file.csv",writeRecords:function(d,e){var b=d.operation||d.getOperation(),c=b.batch||b.getBatch(),f=c.packet,g=(c.title||"Data")+".csv",a=window.CSV.encode(e,{header:true});this.setTitle(g);c.packet.setText(a);c.packet.setName(g);return d},writeValue:function(b,c){var a=c[this.nameProperty];if(a===null){a=c.name}if(typeof b[a]==="undefined"||b[a]===null){b[a]=""}}});Ext.define("sl.data.file.writer.Xlsx",{extend:"sl.data.file.writer.FileWriter",alias:"writer.file.xlsx",writeRecords:function(d,f){var a=d.operation||d.getOperation(),b=a.batch||a.getBatch(),e,g=(b.title||"Data")+".xlsx",c=b.columns||this.getRawColumns(f);this.setTitle(g);e={SheetNames:[this.getTitle()],Sheets:{}};e.Sheets[this.getTitle()]=this.createSheet(c,f);var h=window.XLSX.write(e,{type:"binary"});b.packet.setText(h);b.packet.setName(g);return d},writeValue:function(b){var a={v:Ext.isEmpty(b)?"":b};if(typeof a.v==="number"){a.t="n"}else{if(typeof a.v==="boolean"){a.t="b"}else{if(Ext.isDate(b)){a.t="n";a.z=window.XLSX.SSF._table[14];a.v=this.convertDate(a.v)}else{a.t="s"}}}return a},createSheet:function(b,d){var c=this,a={};Ext.Array.each(b,function(f,e){a[window.XLSX.utils.encode_cell({c:f.getVisibleIndex(),r:0})]={t:"s",v:f.text}});Ext.Array.each(d,function(e,f){Ext.Array.each(b,function(g){a[window.XLSX.utils.encode_cell({c:g.getVisibleIndex(),r:f+1})]=c.writeValue(e[g.dataIndex])})});a["!ref"]=window.XLSX.utils.encode_range({s:{c:0,r:0},e:{c:b.length-1,r:d.length}});return a},convertDate:function(b,a){if(a){b+=1462}var c=Date.parse(b);return(c-new Date(Date.UTC(1899,11,30)))/(24*60*60*1000)}});Ext.define("sl.data.file.FileProxy",{extend:"Ext.data.proxy.Memory",alias:"proxy.file",requires:["sl.data.file.Packet","sl.data.file.reader.FileReader","sl.data.file.reader.Csv","sl.data.file.reader.Xls","sl.data.file.reader.Xlsx","sl.data.file.writer.FileWriter","sl.data.file.writer.Csv","sl.data.file.writer.Xlsx"],defaultReaderType:"file",defaultWriterType:"file",reader:"file",writer:"file",isSynchronous:false,binary:true,format:"binary",packet:null,autoCreateModelFromHeader:false,read:function(a,d,b){var c=this;a.packet=c.getPacket();if(a.config){if(a.config.blob){a.blob=a.config.blob}if(a.config.url){a.url=a.config.url}if(a.config.data){a.data=a.config.data}}if(a.blob){return c.readBlob.apply(c,arguments)}else{if(a.url){return c.readUrl.apply(c,arguments)}else{if(a.data){return c.readData.apply(c,arguments)}else{if(c.data){a.data=c.data;a.format=c.format||"binary";return c.readData.apply(c,arguments)}}}}console.error("Read operation without blob, url or data");return false},readBlob:function(b){var d=this,c=arguments,a=b.blob,e=b.packet;delete b.blob;e.readBlob(a,function(){d.readPacket.apply(d,c)})},readUrl:function(a){throw new Error("Not yet implemented.")},readData:function(a,h,c){var d=this,b=arguments,e=a.data,g=a.format,f=a.packet;delete a.data;delete a.format;f.set(e,g);return d.readPacket.apply(d,b)},readPacket:function(b,f,d){var e=this,a=e.getReader();var c=a.readPacket(b.packet);b.setResultSet(c);this.finishOperation(b);Ext.callback(f,d||e,[b])},create:function(a,d,b){var c=new Ext.data.Request({operation:a,callback:d,scope:b});this.getWriter().write(c);this.finishOperation(a);Ext.callback(d,b||this,[a])},batch:function(a){a.batch=new Ext.data.Batch({proxy:this});a.batch.packet=Ext.create("sl.data.file.Packet");a.batch.title=a.title;a.batch.columns=a.columns;return this.callParent(arguments)},update:function(a){this.finishOperation(a)},erase:function(a){this.finishOperation(a)},setModel:function(a){this.callParent(arguments);this.getReader().setModel(a);this.fireEvent("modelchange",this,this.model)},updateReader:function(a){this.callParent(arguments);if(a&&a.onMappingChange){a.onMappingChange=Ext.Function.createSequence(a.onMappingChange,this.onMappingChange,this)}},onMappingChange:function(b,a){this.fireEvent("mappingchange",this,b,a)},getPacket:function(){if(!this.packet){this.setPacket(Ext.create("sl.data.file.Packet"))}return this.packet},setPacket:function(a){this.packet=a;return this},getMapping:function(){return this.getReader().getMapping()},setMapping:function(b,a){return this.getReader().setMapping(b,a)},guessMapping:function(){return this.getReader().guessMapping()}});Ext.define("sl.data.file.FileStore",{extend:"Ext.data.Store",alias:"store.file",mixins:["Ext.data.Store"],requires:["sl.data.file.FileProxy"],defaultProxyType:"file",proxy:"file",mapping:null,autoGuessMapping:true,constructor:function(a){a=a||{};this.callParent(arguments);if(a.mapping){this.getProxy().setMapping(a.model)}if(a.model){this.setModel(a.model)}if(a.data){this.loadRawData(a.data,false,a.format||"binary")}if(this.rawData){this.loadRawData(this.rawData,false,a.format||"binary")}},loadRawData:function(b,a,c){this.getProxy().getReader().format=c;this.rawData=b;return this.callParent(arguments)},getNewRecords:function(){return this.data.items},updateProxy:function(a){if(a){a.on("mappingchange",this.onMappingChange,this)}},setModel:function(b,a){this.model=b;if(!a&&this.getProxy()){this.getProxy().setModel(b)}this.fireEvent("modelchange",this,b)},getMapping:function(){var a=this.getProxy();return a.getMapping.apply(a,arguments)},setMapping:function(b,a){return this.getProxy().setMapping(b,a)},guessMapping:function(){var a=this.getProxy();return a.guessMapping.apply(a,arguments)},onMappingChange:function(c,b,a){this.loadData(a);this.fireEvent("mappingchange",this,b,a)},bindDrop:function(b){var a=this,c=b.getEl().dom;c.ondrop=Ext.bind(function(e,d){d.preventDefault();a.onDrop(e,d.dataTransfer.files)},this,[b],0);this.onDragBind(b.getMaskTarget())},onDragBind:function(b){var a=null;document.ondragenter=function(c){a=c.toElement;return false}.bind(this);document.ondragleave=function(c){if(a!==null){a=null;return}if(b.isMasked()){b.unmask()}return false}.bind(this);document.ondragover=function(){if(!b.isMasked()){b.mask("Drag and drop files here to upload","")}return false}.bind(this);b.on("destroy",this.onDragUnbind,this)},onDragUnbind:function(){document.ondragenter=null;document.ondragleave=null;document.ondragover=null},destroy:function(){this.onDragUnbind()},onDrop:function(b,a){this.loadFiles(a);b.unmask()},loadFiles:function(a){if(a.length){this.loadFile(a[0])}},loadFile:function(b){var a=b.name,d="csv",c=a.lastIndexOf(".");if(c!==-1){d=a.substring(c+1)}this.getProxy().setReader("file."+d);this.load({blob:b,format:"binary"})},exportFile:function(b,a,c){if(typeof c!=="undefined"){c="file."+c}else{c=this.getProxy().getReader().type}a=a||b.title;this.getProxy().setWriter(c);this.sync({title:a,columns:b.columns,callback:function(d){d.packet.save()}})}});Ext.define("sl.data.validator.Any",{extend:"Ext.data.validator.Validator",mixins:{presence:"Ext.data.validator.Presence"},alias:"data.validator.any",config:{message:"{0} must have AT LEAST ONE value",additionalFields:null,allowFalse:false,messageNames:null},validate:function(d,a){var c=this,b=c.getValidValues(d,a).length>0;return((b===true)?true:Ext.String.trim(Ext.String.format(c.getMessage(),c.getMessageNames())))},getValidValues:function(d,a){var c=this,b=c.getAdditionalFieldValues(a).concat(d);return b.filter(function(e){return c.isValueValid(e)})},isValueValid:function(b){var a=this,d=a.mixins.presence.validate.bind(a),c;if(b===false&&!a.getAllowFalse()){c=false}else{c=(d(b)===true)}return c}});Ext.define("sl.data.validator.GreaterThan",{extend:"Ext.data.validator.Validator",alias:"data.validator.greaterthan",config:{message:"must be GREATER THAN {0}",additionalFields:null,messageNames:"them",allowEqual:false},compare:function(b,a){return(this.getAllowEqual()?b>=a:b>a)},validate:function(e,b){var d=this,a=Ext.Array.from(d.getAdditionalFields()),f=d.findField(b),h=f?f.isDateField:false,c=f?f.isNumeric:false,g=Ext.isEmpty(e);if(h||c){valid=g||a.every(function(l){var i=b.get(l),k,j;if(Ext.isEmpty(i)){isValid=true}else{if(h){k=(new Date(e)).getTime();j=(new Date(i)).getTime()}else{k=Number(e);j=Number(i)}isValid=d.compare(k,j)}return isValid});return((valid===true)?true:Ext.String.trim(Ext.String.format(d.getMessage(),d.getMessageNames())))}else{Ext.Error.raise({msg:"[ "+this.$className+" validator] Field must be a numberfield, integerfield or datefield"})}}});Ext.define("sl.data.validator.LessThan",{extend:"sl.data.validator.GreaterThan",alias:"data.validator.lessthan",config:{message:"must be LESS THAN {0}"},compare:function(b,a){return(this.getAllowEqual()?b<=a:b<a)}});Ext.define("sl.data.validator.OneAndOnly",{extend:"sl.data.validator.Any",alias:"data.validator.oneandonly",config:{message:"must have ONE & ONLY ONE value between {0}",messageNames:"them"},validate:function(d,a){var c=this,b=c.getValidValues(d,a).length===1;return((b===true)?true:Ext.String.trim(Ext.String.format(c.getMessage(),c.getMessageNames())))}});Ext.define("sl.data.validator.Only",{extend:"sl.data.validator.Any",alias:"data.validator.only",config:{message:"must have ONLY one value between {0}",messageNames:"them"},validate:function(d,a){var c=this,b=c.getValidValues(d,a).length<=1;return((b===true)?true:Ext.String.trim(Ext.String.format(c.getMessage(),c.getMessageNames())))}});Ext.define("sl.data.validator.Unique",{extend:"Ext.data.validator.Validator",alias:"data.validator.unique",config:{message:"must be UNIQUE"},validate:function(e,a){var d=this,f=d.findField(a),c=true,b;if(!f){Ext.Error.raise({msg:"[unique validator] Cannot find the field that is being validated"})}b=f.getName();c=!(a.store.getRecords().some(function(g){return g!==a&&sl.utils.areValuesEquivalent(g.get(b),e)}));return((c===true)?true:d.getMessage())}});Ext.define("sl.field.ComboBox",{extend:"Ext.form.field.ComboBox",alias:["widget.slcombo"],requires:["sl.data.CacheStore","sl.panel.grid.GridEditorFunctions"],uses:["sl.panel.grid.GridRenderers"],anyMatch:true,queryMode:"local",triggerAction:"all",forceSelection:true,selectOnFocus:true,typeAhead:true,typeAheadDelay:500,minChars:2,valueField:"ID",rendererValueNotFoundText:"Value Not Found",gridDisplayField:"",initComponent:function(){var a=this;if(!Ext.Object.isEmpty(a.storeConfig)){a.store=a.createStore()}if(a.isGridEditor()){a.gridValueField=a.gridValueField||(Ext.isFunction(a.getColumn)?(a.getColumn()||{}).dataIndex:false);a.on({select:a.onSelectInGrid,clear:a.onClearInGrid})}a.callParent()},addBlankRecordToStore:function(){var c=this,a=c.getStore(),b;if(!a.isEmptyStore){if((Ext.isFunction(a.isLoaded)?a.isLoaded():true)&&!a.loading){b=a.createNewRecord();c.store.insert(0,b)}}},clearValue:function(){this.callParent(arguments);this.fireEvent("clear",this)},createStore:function(){var f=this,d=f.storeConfig||{},a=!Ext.isEmpty(d.model)||false,c=Ext.isDefined(d.autoLoad)?d.autoLoad:false,e={},b;if(d){if(!a){f.fields=f.fields||d.fields||[];if(Ext.isArray(f.fields)&&f.fields.length===0){f.fields.push(f.displayField,f.valueField)}}e.extraParams=Ext.apply({CacheClassName:d.CacheClassName,CacheQueryName:d.CacheQueryName,CacheCommandType:2},d.extraParams||{})||{}}b=Ext.createByAlias("store.cachestore",Ext.apply({autoLoad:c,fields:f.fields,proxy:e,listeners:d.listeners||{},autoStore:true},d));if(b&&!b.isLoading()&&c){b.load()}if(!a){b.updateModelIDProperty(d.clientIdProperty||f.valueField)}return b},onSelectInGrid:function(c,a,b){var e,d;a=Ext.Array.from(a)||[];if(a.length===1){d=a[0];e=c.getActiveRecord();if(e){if(c.gridDisplayField){e.set(c.gridDisplayField,d.get(c.displayField))}if(c.getGridValueField()){e.set(c.getGridValueField(),d.get(c.valueField))}}}else{}},onClearInGrid:function(b){var d=b.getActiveRecord(true),a,c;if(d){a=b.gridDisplayField;c=b.getGridValueField();if(a){d.set(a,"")}if(c){d.set(c,"")}}},onEnterKeyInGrid:function(f,d,c){var b=f.getParentGrid(),a=b.getEditingPlugin();if(!f.isExpanded&&b){b.getSelectionModel().onKeyEnter(a,d)}},renderer:function(i,g,c,f,l,j,h){var k=i,a=this,b,d;try{b=a.getColumnAt(l);d=b.getColumnEditor();i=sl.panel.grid.GridRenderers.comboRenderer.apply(d,arguments)}catch(e){i=k;console.error("["+(d||{}).$className||"Component] Renderer Error",{error:e,grid:a,column:b,editor:d,args:arguments})}return i}});Ext.define("sl.view.ComboGridKeyNav",{extend:"Ext.view.BoundListKeyNav",alias:"view.navigation.combogrid",uses:["Ext.grid.CellContext","Ext.grid.CellContext"],initKeyNav:function(a){var c=this,b=a.grid,d=b.getView();a.pickerField=b.pickerField;b.highlightItem=d.highlightItem.bind(d);b.getNode=d.getNode.bind(d);c.position=new Ext.grid.CellContext(a);c.callParent(arguments)},getPosition:function(){var d=this,a=Ext.apply({},d.position,{view:this.view,record:this.record,column:this.view.pickerField.getPicker().getColumnAt(0),rowIdx:0}),c,b,e;if(a.record&&a.column){b=a.view;e=b.dataSource;c=e.indexOf(a.record);if(c===-1){c=e.indexOfId(a.record.id);if(c===-1){c=a.rowIdx;if(!e.getAt(c)){c=-1}}a.record=e.getAt(c)}if(c===-1||b.getVisibleColumnManager().indexOf(a.column)===-1){a.setAll();d.record=d.column=d.recordIndex=d.columnIndex=null}else{return a}}return null},onKeyEnter:function(d){var a=this.view,c=a.pickerField,b=c.getPickerStore();if(b.loading||(c.doQueryTask||{}).id){return false}return this.callParent(arguments)},onKeyUp:function(g){var f=this,a=f.view,e=a.indexInStore(a.highlightedItem),c=a.walkRows(e,-1),h,d,b;if(e===c){h=a.pickerField;d=h.getPicker();b=d.getStore();c=b.getAt(b.getCount()-1)}f.setPosition(c)},onKeyDown:function(e){var d=this,a=d.view,c=a.indexInStore(a.highlightedItem),b=a.walkRows(c,1);if(c===b){b=0}d.setPosition(b)},onSelectAllKeyPress:function(b){var a=this.view,c=a.pickerField;c.selectText()},onKeyHome:Ext.returnTrue,onKeyEnd:Ext.returnTrue,onKeyPageDown:function(e){var f=this,g=f.view,h=g.pickerField,b=h.getPicker(),a=b.getView(),c=f.getRowsVisible(),i,d;if(c){if(a.bufferedRenderer){i=Math.min(f.recordIndex+c,a.dataSource.getCount()-1);f.lastKeyEvent=e;a.bufferedRenderer.scrollTo(i,false,f.afterBufferedScrollTo,f)}else{d=g.walkRecs(f.record,c);f.setPosition(d,null,e)}}},onKeyPageUp:function(e){var f=this,g=f.view,h=g.pickerField,b=h.getPicker(),a=b.getView(),c=f.getRowsVisible(),i,d;if(c){if(a.bufferedRenderer){i=Math.max(f.recordIndex-c,0);f.lastKeyEvent=e;a.bufferedRenderer.scrollTo(i,false,f.afterBufferedScrollTo,f)}else{d=g.walkRecs(f.record,-c);f.setPosition(d,null,e)}}},afterBufferedScrollTo:function(b,a){this.setPosition(a,null,this.lastKeyEvent,null,!this.lastKeyEvent)},getRowsVisible:function(){var e=false,a=this.view,d=a.all.first(),b,c;if(d){b=d.getHeight();c=a.el.getHeight();e=Math.floor(c/b)}return e},setPosition:function(e,i,m,f){var j=this,k=j.view,g=k.getSelectionModel(),c=k.dataSource,h,d;var l=k.pickerField,b=l.getPicker(),a=b.getView();if(e==null||!k.all.getCount()){j.record=j.recordIndex=null}else{if(typeof e==="number"){d=Math.max(Math.min(e,c.getCount()-1),0);h=c.getAt(e)}else{if(e.isEntity){h=c.getById(e.id);d=c.indexOf(h);if(d===-1){h=c.getAt(0);d=0}}else{if(e.tagName){h=k.getRecord(e);d=c.indexOf(h)}else{h=d=null}}}}if(h===j.record){return j.focusPosition(j.recordIndex)}if(j.item){j.item.removeCls(j.focusCls)}j.previousRecordIndex=j.recordIndex;j.previousRecord=j.record;j.previousItem=j.item;j.recordIndex=d;j.record=h;f=f||j.record===j.lastFocused;if(h){if(a.bufferedRenderer){a.bufferedRenderer.scrollTo(Math.min(j.recordIndex,c.getCount()-1),false,function(){j.focusPosition(j.recordIndex)},j)}else{j.focusPosition(j.recordIndex)}}else{j.item=null}if(!m){g.fireEvent("focuschange",g,j.previousRecord,j.record)}if(!f&&i){j.fireNavigateEvent(i)}}});Ext.define("sl.field.ComboGrid",{extend:"sl.field.ComboBox",alias:["widget.combogrid"],mixins:["sl.field.utils.ValueToDisplayHash"],requires:["sl.view.ComboGridKeyNav"],uses:["Ext.util.Format","Ext.view.Table","sl.utils.Toast"],selectOnFocus:false,queryMode:"remote",queryDelay:750,triggerAction:"query",typeAhead:false,matchFieldWidth:false,minChars:0,minCharsMsg:"You must enter at least {0} character{1}",disableAutoRecordSort:false,disableSingleRecordAutoSelect:false,disableSearchOnEnter:false,defaultPickerWidth:800,defaultListConfig:{minWidth:70,shadow:"frame"},gridXType:"displaygrid",disableHighlightMatching:false,clearQueryOnRowChange:false,disableQueryTextConvert:false,queryTextSeparator:/[^\w\s'.]/,triggers:{clearTrigger:{cls:Ext.baseCSSPrefix+"form-clear-trigger",weight:-1,handler:function(){this.onClearTriggerClick()}}},initComponent:function(a){var b=this;b.callParent(arguments);b.getValueToDisplayHash();b.getParams=Ext.Function.createSequence(b.getParams,function(d){var c=b.store;if(c&&Ext.isFunction(c.setSearchedText)&&!b.disableHighlightMatching){c.setSearchedText(d)}},b);b.on({beforequery:{priority:1000,fn:b.onBeforeQuery},specialkey:(!b.disableSearchOnEnter?function(d,c){if(c.getKey()==c.ENTER){b.forceQueryTaskExecute()}}:Ext.emptyFn)});b.showMinCharMessage=Ext.Function.createThrottled(b.showMinCharMessage,2500)},doSetValue:function(t,o){var A=this,j=A.getStore(),k=j.getModel(),x=[],h=[],w=A.autoLoadOnValue,g=j.getCount()>0||j.isLoaded(),a=j.hasPendingLoad(),q=w&&!g&&!a,m=A.forceSelection,s=A.pickerSelectionModel,d=A.displayField===A.valueField,r=j.isEmptyStore,l=A.lastSelection,y,z,e,v,f,C,n=!Ext.isEmpty(t),p=(n&&g&&j.findNewInstanceOfRecords(t).length>0),B=(n&&g&&A.findRecordByValue(t)!==false),c=(p||B),b=Ext.isFunction(A.getValueToDisplayHash)?A.getValueToDisplayHash():false,u;if(a||q||!g||r||(!c&&(n||A.queryMode!=="remote"))){if(!t.isModel){if(o){A.value=Ext.Array.from(A.value).concat(t)}else{A.value=t}A.setHiddenValue(A.value);if(b){u=b.get(t)}A.setRawValue(d?t:u);if(!Ext.isEmpty(u)){return A}}if((q||!c&&(n||A.queryMode!=="remote"))&&!r){j.load()}if(!t.isModel||r){return A}}t=o?Ext.Array.from(A.value).concat(t):Ext.Array.from(t);for(y=0,z=t.length;y<z;y++){e=t[y];if(!e||!e.isModel){e=A.findRecordByValue(C=e);if(!e){e=A.valueCollection.find(A.valueField,C)}}if(!e){if(!m){if(!e&&t[y]){v={};v[A.displayField]=t[y];if(A.valueField&&A.displayField!==A.valueField){v[A.valueField]=t[y]}e=new k(v)}}else{if(A.valueNotFoundRecord){e=A.valueNotFoundRecord}}}if(e){x.push(e);h.push(e.get(A.valueField))}}if(l){z=l.length;if(z===x.length){for(y=0;!f&&y<z;y++){if(Ext.Array.indexOf(A.lastSelection,x[y])===-1){f=true}}}else{f=true}}else{f=x.length}if(f){A.suspendEvent("select");A.valueCollection.beginUpdate();if(x.length){s.select(x,false)}else{s.deselectAll()}A.valueCollection.endUpdate();A.resumeEvent("select")}else{A.updateValue()}if(A.inputEl&&A.emptyText){A.inputEl.removeCls(A.emptyCls);A.valueContainsPlaceholder=false}A.applyEmptyText();return A},getValue:function(){var d=this,b=d.getStore(),c=d.picker,f=d.getRawValue(),e=d.value;if(!d.doesTextHaveCachedValue()&&!b.isEmptyStore&&d.getDisplayValue()!==f){d.displayTplData=undefined;if(c){d.valueCollection.suspendEvents();c.getSelectionModel().deselectAll();d.valueCollection.resumeEvents();d.lastSelection=null}if(b.isLoaded()&&(d.multiSelect||d.forceSelection)){e=d.value=undefined}else{var g=d.getValueToDisplayHash(),a=g.get(e);if(!sl.utils.areValuesEquivalent(f,a)){e=d.value=f}}}d.value=e==null?null:e;return d.value},assertValue:function(){var c=this,e=c.getRawValue(),b=c.getDisplayValue(),h;if(c.isDirty()){if(c.forceSelection){if(c.multiSelect){if(e!==b){c.setRawValue(b)}}else{h=c.findRecordByDisplay(e);if(h){if(c.getDisplayValue([c.getRecordDisplayData(h)])!==b){c.select(h,true)}}else{var g=false,d=e,f=c.getValueToDisplayHash(),a=f.get(c.value);if(c.isGridEditor()){if(sl.utils.areValuesEquivalent(d,a)){e=c.value;if(!Ext.isEmpty(e)){c.setValue(e);g=true}}}if(!g){c.setRawValue("");if(Ext.isEmpty(c.value)){c.fireEvent("clear",c)}}}}}}c.collapse()},getStoreListeners:function(b){var c=this,a=c.callParent(arguments);if(!b.isEmptyStore){a=Ext.apply({},a,{beforeload:c.onStoreBeforeLoad,scope:c});if(Ext.isFunction(a.load)){a.load={fn:a.load,priority:1000}}}return a},bindStoreListeners:function(a){var b=this;if(a&&!a._bindSetExtraParam&&Ext.isFunction(a.setExtraParam)){a.setExtraParam=Ext.Function.createSequence(function(d,c){if(!sl.utils.areValuesEquivalent(a.getExtraParam(d),c)){a.removeAll();delete b.lastQuery}},a.setExtraParam,a);a._bindSetExtraParam=true}return b.callParent(arguments)},createPicker:function(){var b=this,a;b.listConfig=Ext.apply({},b.listConfig);b.defaultListConfig=Ext.apply({},b.defaultListConfig);if(Ext.isEmpty(b.listConfig.columns)&&(b.columns||[]).length>0){b.listConfig.columns=b.columns}b.defaultPickerWidth=(b.defaultPickerWidth||b.listConfig.width||b.defaultListConfig.width||b.getWidth());b.defaultPickerHeight=(b.defaultPickerHeight||b.listConfig.height||b.defaultListConfig.height);b.defaultPickerMaxHeight=(b.defaultPickerMaxHeight||b.listConfig.maxHeight||b.defaultListConfig.maxHeight);b.listConfig=Ext.apply({xtype:b.gridXType,plugins:[],selModel:b.pickerSelectionModel,includeRefreshBtn:false,includeSearch:false,includeRowCount:false,columnLines:true,refresh:Ext.emptyFn,viewConfig:Ext.apply({navigationModel:"combogrid",cls:"combogrid",overItemCls:Ext.view.Table.prototype.overItemCls+" combogrid-row-over",refreshSelmodelOnRefresh:true,emptyText:b.customNoMatchesMessage||"No Matches",loadingHeight:50},b.pickerViewConfig)},{title:"",width:b.defaultPickerWidth,height:b.defaultPickerHeight,maxHeight:Math.max(150,sl.utils.adjHeight(0.5,b.defaultPickerMaxHeight))},b.listConfig);a=b.callParent(arguments);a.on({scope:b,afterlayout:function(){if(a.getStore().getCount()>0){b.alignPicker()}}});return a},alignPicker:function(){var b=this,a=b.getPicker();if(b.rendered){a.setWidth(Math.max(b.getWidth(),sl.utils.adjWidth(0.8,b.defaultPickerWidth)))}return b.callParent(arguments)},onExpand:function(){var a=this;a.callParent(arguments);a.suspendEvent("focus");if(Ext.isFunction(a.focusInput)){a.focusInput()}else{a.focus()}a.selectText(a.getRawValue().length);a.resumeEvent("focus")},doAutoSelect:function(){var c=this,a=c.picker,d,b,f,e;if(a&&c.autoSelect&&c.store.getCount()>0){d=c.picker.getSelectionModel().lastSelected;b=a.store.indexOf(d);if(b<0){if(c.isGridEditor()){f=c.getActiveRecord();e=(f&&Ext.isFunction(f.get))?f.get(c.getGridValueField()):null}if(Ext.isEmpty(e)){e=c.getValue()}if(e){d=c.findRecordByValue(e);if(d){b=c.getStore().indexOf(d)}}}a.getNavigationModel().setPosition(((Ext.isNumber(b)&&b>=0)?b:0))}},onLoad:function(c,b,f){var d=this,a=!d.valueCollection.byValue.get(d.value);if(f&&a&&!(c.lastOptions&&"rawQuery" in c.lastOptions)){d.setValueOnData()}b=Ext.Array.from(b)||[];d.fireEvent("load",d,c,b,f);if(b.length===1&&!d.disableSingleRecordAutoSelect&&!d._userClickedSearch){var e=b[0],g=false;d.on({single:true,select:function(h,i){g=true}});d.select(e,true);d.setReadOnly(true);Ext.defer(function(){d.setReadOnly(false);if(!g){d.fireEvent("select",d,e)}},500,d)}delete d._userClickedSearch},onCollapse:function(){var a=this;a.resetPicker();a.callParent(arguments)},reset:function(){var a=this;a.callParent();a.store.removeAll();a.clearValue();a.originalValue=undefined;a.lastQuery=false;a.collapse()},resetOriginalValue:function(){this.originalValue=(Ext.isDefined(this.value)?this.value:this.getRawValue());this.checkDirty()},onTriggerClick:function(){var b=this,c=b.isDirty(),a=((!c||!b.isGridEditor())?b.findRecordByValue(b.getValue()):false);if(a){b.lastQuery=a.get(b.displayField);b.expand()}else{b._userClickedSearch=true;b.loadPickerData(b.getQueryText())}},onBeforeQuery:function(a){var d=this,b,c,e;if(d.clearQueryOnRowChange){b=Ext.isFunction(d.getParentGrid)?d.getParentGrid():undefined;if(b){e=d.getActiveRecord()||b.getSelectionModel().selected.first();c=b.getIndexForRecord(e);if(c!==d._queryRowIndex){delete d.lastQuery}d._queryRowIndex=c}}a[d.queryParam]=d.getQueryText(a[d.queryParam])},onEnterKeyInGrid:function(h,g,c){var f=h,b=f.getParentGrid(),a=f.getStore().isLoading(),d=!Ext.isEmpty((f.doQueryTask||{}).id);if(b&&!f.isExpanded&&!a&&!d){b.getSelectionModel().onKeyEnter(b.getEditingPlugin(),g)}},forceQueryTaskExecute:function(){var b=this,c=b.doQueryTask,a=(c?!Ext.isEmpty(c.id):false);if(a){c.delay(0)}},onClearTriggerClick:function(){var a=this;a.reset();a.focus(true,true)},loadPickerData:function(d){var c=this,b=c.allowForceQuery,a=!c.isDirty();d=String(!Ext.isEmpty(d)?d:c.getQueryText());if(!b&&d.length<Math.max(c.minChars,0)){delete c._userClickedSearch;if(a&&c.getStore().getCount()>0){c.expand();return false}else{c.showMinCharMessage();return false}}if(!c.readOnly&&!c.disabled){if(c.isExpanded&&a){c.collapse()}else{c.onFocus();if(c.triggerAction==="all"){c.doQuery(c.allQuery,true)}else{if(c.triggerAction==="last"){c.doQuery(c.lastQuery,true)}else{c.doQuery(d,b,true)}}}c.inputEl.focus()}},getQueryText:function(){var b=this,d=b.getRawValue(),a,c="";if(!b.disableQueryTextConvert){a=String(d||"").split(b.queryTextSeparator);Ext.Array.forEach(a,function(e,f,g){if(e.length>c.length){c=e}})}else{c=d}return String(c||"").trim()},showMinCharMessage:function(){var a=this;myMinCharsMsg=Ext.String.format(a.minCharsMsg,a.minChars,(a.minChars===1?"":"s"));sl.utils.Toast.showWarningToast("Error",myMinCharsMsg)},resetPicker:function(){var c=this,b=c.getPicker(),a=b.store,d=(a&&Ext.isFunction(a.getRankingSorters)?a.getRankingSorters():[]);b.highlightedIndex=undefined;if(Ext.isArray(d)&&d.length){a.sorters.remove(d)}a.fireEvent("needfilterremoval",a);c.cancelRunningQueries()},onStoreBeforeLoad:function(a){var b=this;if(b.fireEvent("beforeload",b,a,b.picker)!==false){b.cancelRunningQueries();b.getFieldsToSearch();a.setExtraParam("searchAnyOrder",(b.anyMatch?1:0));b._records_ranked_by_search=false;if((b.picker||{}).el){b.picker.el.unmask()}a.removeAll();if(!b.disableAutoRecordSort){a.on({scope:b,priority:1000,single:true,datachanged:function(c){c.suspendEvent("datachanged");b.rankAndSortRecordsBySearchStr();c.resumeEvent("datachanged")}})}}else{b.collapse();b.lastQuery=false;return false}},getFieldsToSearch:function(){var b=this,a=b.store.getFieldsToSearch()||b.setFieldsToSearch();return Ext.isString(a)?Ext.decode(a):a},setFieldsToSearch:function(){var g=this,a=g.getStore(),f=[],c,b=g.getPicker(),e=b?b.getStore():false,d=[];if(b){if(e){f=e.model.prototype.getFieldsToSearch()||[]}if(f.length===0){d=b.getColumnsToSearch(true)||[]}}else{if(a){f=a.model.prototype.getFieldsToSearch()||[]}}if(f.length===0&&d.length>0){Ext.Array.forEach(d,function(i,h,j){f.push(i.dataIndex)})}if(Ext.isArray(f)){if(f.length===0){}c=Ext.encode(f)}a.setExtraParam("fields",c);return f},cancelRunningQueries:function(){var a=this;a.doQueryTask.cancel();if(a.queryMode==="remote"){a.getStore().abortPreviousRequests()}},rankAndSortRecordsBySearchStr:function(h){var f=this,d=f.store,c=d.getRecords(),e=c.length,b,a,g;if(e){if(!f._records_ranked_by_search||h===true){f._records_ranked_by_search=true;if(Ext.isFunction(d.getSearchedText)){b=sl.utils.stripNonAlphanumericChars(d.getSearchedText()||"")}a=f.getFieldsToSearch();if(!Ext.isEmpty(b)){g=d.setSortRanking(b,undefined,f.getGridDataToRank(),c);if(g){d.sortRankedRecords()}}}}},getGridDataToRank:function(){var f=this,d=f.getPicker(),b=f.store,a=b.getRecords(),e=f.getFieldsToSearch(),h=[],c,g;Ext.Array.forEach(a,function(k,i,j){h[i]=[];c=[];g=[];Ext.Array.forEach(e,function(p,m,o){var n=d.getColumnIndexByDataIndex(p),l="";if(n>=0){l=d.getTextInCell(n,k);l=sl.utils.AllTrim(Ext.util.Format.htmlDecode(l));c[n]=l}else{l=k.get(p);g.push(l)}});h[i]=c.concat(g)},a);return h},doesTextHaveCachedValue:function(){var c=this,b=c.getRawValue(),a=false,d;if(!Ext.isEmpty(b)){d=c.getValueToDisplayHash();a=!Ext.isEmpty(d.findKey(b))}return a}},function(){var a=this;a.createAlias({onSearchTriggerClick:"onTriggerClick",onTrigger2Click:"onTriggerClick",onTrigger1Click:"onClearTriggerClick"})});Ext.define("sl.field.ListCombo",{extend:"sl.field.ComboBox",alias:["widget.listcombo"],uses:["Ext.grid.column.Column"],CacheClassName:"",CachePropertyName:"",displayField:"Display",valueField:"Value",fields:["Display","Value"],initExpr:"",useInitialExpression:true,useExternalValue:true,initComponent:function(){var b=this;b._defaultValueField=b.valueField;if(b.useExternalValue){b.valueField=b.displayField}b.name=b.name||b.CachePropertyName;b.initExpr=b.value=(b.initExpr||b.value);if(Ext.isFunction(b.isGridEditor)&&b.isGridEditor()&&sl.utils.isInstanceOf(b.column,Ext.grid.column.Column)){var a=b.getParentGrid();if(a){if(Ext.isEmpty(b.CacheClassName)){b.CacheClassName=a.getStore().getCacheClassName()}if(Ext.isEmpty(b.CachePropertyName)){b.CachePropertyName=b.column.dataIndex}}}b.store=b.store||b.createStore();b.callParent(arguments)},getStoreListeners:function(){var a=this;return{load:a.setToInitialExpression,priority:1000,scope:a}},createStore:function(){var e=this,c=e.storeConfig||{},a=!Ext.isEmpty(c.model)||false,d={},b;if(c){if(!a){e.fields=e.fields||c.fields||[];if(Ext.isArray(e.fields)&&e.fields.length===0){e.fields.push(e.displayField,e._defaultValueField)}}d.extraParams=Ext.apply({ClassName:e.CacheClassName,PropertyName:e.CachePropertyName,allowBlank:e.allowBlank},c.extraParams||{})||{};b=Ext.createByAlias("store.cachestore",Ext.apply({autoLoad:true,isStoreValidatedOnLoad:false,CacheClassName:"ClassDef.Utilities",CacheQueryName:"DisplayListValueList",CacheCommandType:2,fields:e.fields,proxy:d,listeners:c.listeners||{}},c));b.updateModelIDProperty(e._defaultValueField)}return b},setToInitialExpression:function(){var a=this;if(a.useInitialExpression&&!a.initExpr){a.loadInitialExpression()}else{if(a.initExpr){a.suspendEvents(false);a.setValue(a.initExpr);a.resumeEvents()}}},loadInitialExpression:function(){var b=this,a=b.getStore();Ext.Ajax.request({timeout:900000,url:"../Ext.JsonRequest.cls",params:{CacheClassName:"ClassDef.Utilities",CacheMethodName:"PropertyInitialExpression",CacheCommandType:1,ClassName:a.getExtraParam("ClassName"),PropertyName:a.getExtraParam("PropertyName")},scope:b,callback:function(e,i,c){var g=Ext.decode(c.responseText);if(!g.success){Ext.Msg.alert("Error",g.error.Msg);console.error("loadInitialExpression Error",{msg:g.error.Msg,r:g,options:e,success:i,response:c})}else{if(g.result){var f=g.result.replace(/\"/g,""),h=b.store.findRecord(b._defaultValueField,f),d=h?h.get(b.valueField):f;b.initExpr=b.value=d;b.setValue(b.initExpr)}}}})}});Ext.define("sl.field.button.AllOKButton",{extend:"Ext.button.Button",alias:"widget.allOKbutton",text:"All OK",itemId:"allokbutton",icon:"./resources/icons/fam/accept.png"});Ext.define("sl.field.button.BuildButton",{extend:"Ext.button.Button",alias:"widget.buildbutton",text:"Build",itemId:"buildbutton",icon:"./resources/icons/fam/brick_go.png"});Ext.define("sl.field.button.CancelButton",{extend:"Ext.button.Button",alias:"widget.cancelbutton",text:"Cancel",itemId:"cancelbutton",icon:"./resources/icons/fam/cancel.png"});Ext.define("sl.field.button.ClearButton",{extend:"Ext.button.Button",alias:"widget.clearbutton",text:"Clear",itemId:"clearbutton",icon:"./resources/icons/fam/page_white_delete.png"});Ext.define("sl.field.button.ConfirmButton",{extend:"Ext.button.Button",alias:"widget.confirmbutton",text:"Confirm",itemId:"confirmbutton",icon:"./resources/icons/fam/tick.png"});Ext.define("sl.field.button.CopyButton",{extend:"Ext.button.Button",alias:"widget.copybutton",text:"Copy",itemId:"copybutton",icon:"./resources/icons/fam/page_white_stack.png"});Ext.define("sl.field.button.DeleteButton",{extend:"Ext.button.Button",alias:"widget.deletebutton",text:"Delete",itemId:"deletebutton",icon:"./resources/icons/fam/delete.png",hasUndo:false});Ext.define("sl.field.button.DeleteWithUndoButton",{extend:"Ext.button.Split",alias:"widget.deletewithundobutton",requires:["Ext.menu.Item","Ext.menu.Menu"],text:"Delete",itemId:"deletewithundobutton",icon:"/resources/icons/fam/delete.png",undoText:"Undo Delete",hasUndo:true,initComponent:function(){this.menu=Ext.create("Ext.menu.Menu",{itemId:"deletemenu"});this.undoDeleteButton=Ext.create("Ext.menu.Item",{text:this.undoText,iconCls:"ReverseButton",itemId:"undodeletebutton",disabled:true});this.menu.add(this.undoDeleteButton);this.callParent()}});Ext.define("sl.field.button.EditButton",{extend:"Ext.button.Button",alias:"widget.editbutton",text:"Edit",itemId:"editbutton",icon:"./resources/icons/fam/page_white_edit.png"});Ext.define("sl.field.button.ExcelButton",{extend:"Ext.button.Button",alias:"widget.excelbutton",text:"",overflowText:"Send To Excel",itemId:"sendtoexcelbutton",icon:"./resources/icons/Excel-16.gif"});Ext.define("sl.field.button.FindButton",{extend:"Ext.button.Button",alias:"widget.findbutton",text:"Find",itemId:"findbutton",icon:"./resources/icons/fam/find.png"});Ext.define("sl.field.button.GarbageButton",{extend:"Ext.button.Button",alias:"widget.garbagebutton",text:"Empty Garbage",itemId:"garbagebutton",icon:"./resources/icons/fam/garbage.png"});Ext.define("sl.field.button.HomeButton",{extend:"Ext.button.Button",alias:"widget.homebutton",text:"",itemId:"homebutton",icon:"./resources/icons/fam/house.png"});Ext.define("sl.field.button.ImportButton",{extend:"Ext.button.Button",alias:"widget.importbutton",text:"Import",itemId:"importbutton",icon:"./resources/icons/fam/page_white_get.png"});Ext.define("sl.field.button.NewButton",{extend:"Ext.button.Button",alias:"widget.newbutton",text:"New",itemId:"newbutton",icon:"./resources/icons/fam/add.png"});Ext.define("sl.field.button.PasteButton",{extend:"Ext.button.Button",alias:"widget.pastebutton",text:"Paste",itemId:"pastebutton",icon:"./resources/icons/fam/page_paste.png"});Ext.define("sl.field.button.PostButton",{extend:"Ext.button.Button",alias:"widget.postbutton",text:"Post",itemId:"postbutton",icon:"./resources/icons/fam/database_go.png"});Ext.define("sl.field.button.PrintButton",{extend:"Ext.button.Button",alias:"widget.printbutton",text:"Print",itemId:"printbutton",icon:"./resources/icons/fam/printer.png"});Ext.define("sl.field.button.QuickUpdateButton",{extend:"Ext.button.Button",alias:"widget.quickUpdateButton",text:"Update Status",itemId:"quickupdatebutton",icon:"./resources/icons/fam/lightning.png"});Ext.define("sl.field.button.RefreshButton",{extend:"Ext.button.Button",alias:"widget.refreshbutton",text:"Refresh",itemId:"refreshbutton",icon:"./resources/icons/fam/arrow_refresh.png"});Ext.define("sl.field.button.ReverseButton",{extend:"Ext.button.Button",alias:"widget.reversebutton",text:"Reverse",itemId:"reversebutton",icon:"/resources/icons/fam/arrow_undo.png"});Ext.define("sl.field.button.SaveButton",{extend:"Ext.button.Button",alias:"widget.savebutton",text:"Save",itemId:"savebutton",icon:"./resources/icons/fam/disk.png"});Ext.define("sl.field.button.SendButton",{extend:"Ext.button.Button",alias:"widget.sendbutton",text:"Send/Resend",itemId:"sendbutton",icon:"/resources/icons/fam/email_go.png"});Ext.define("sl.field.button.SwitchButton",{extend:"Ext.button.Button",alias:"widget.switchbutton",text:"Switch",itemId:"switchbutton",icon:"./resources/icons/fam/arrow_switch.png"});
/*! @source http://purl.eligrey.com/github/FileSaver.js/blob/master/FileSaver.js */
var saveAs=saveAs||(typeof navigator!=="undefined"&&navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob.bind(navigator))||(function(l){if(typeof navigator!=="undefined"&&/MSIE [1-9]\./.test(navigator.userAgent)){return}var m=l.document,i=function(){return l.URL||l.webkitURL||l},p=m.createElementNS("http://www.w3.org/1999/xhtml","a"),d="download" in p,q=function(s){var r=m.createEvent("MouseEvents");r.initMouseEvent("click",true,false,l,0,0,0,0,0,false,false,false,false,0,null);s.dispatchEvent(r)},g=l.webkitRequestFileSystem,n=l.requestFileSystem||g||l.mozRequestFileSystem,e=function(r){(l.setImmediate||l.setTimeout)(function(){throw r},0)},k="application/octet-stream",h=0,c=500,o=function(s){var r=function(){if(typeof s==="string"){i().revokeObjectURL(s)}else{s.remove()}};if(l.chrome){r()}else{setTimeout(r,c)}},j=function(s,r,v){r=[].concat(r);var u=r.length;while(u--){var w=s["on"+r[u]];if(typeof w==="function"){try{w.call(s,v||s)}catch(t){e(t)}}}},b=function(r,s){var t=this,z=r.type,C=false,v,u,y=function(){j(t,"writestart progress write writeend".split(" "))},B=function(){if(C||!v){v=i().createObjectURL(r)}if(u){u.location.href=v}else{var D=l.open(v,"_blank");if(D==undefined&&typeof safari!=="undefined"){l.location.href=v}}t.readyState=t.DONE;y();o(v)},x=function(D){return function(){if(t.readyState!==t.DONE){return D.apply(this,arguments)}}},w={create:true,exclusive:false},A;t.readyState=t.INIT;if(!s){s="download"}if(d){v=i().createObjectURL(r);p.href=v;p.download=s;q(p);t.readyState=t.DONE;y();o(v);return}if(l.chrome&&z&&z!==k){A=r.slice||r.webkitSlice;r=A.call(r,0,r.size,k);C=true}if(g&&s!=="download"){s+=".download"}if(z===k||g){u=l}if(!n){B();return}h+=r.size;n(l.TEMPORARY,h,x(function(D){D.root.getDirectory("saved",w,x(function(E){var F=function(){E.getFile(s,w,x(function(G){G.createWriter(x(function(H){H.onwriteend=function(I){u.location.href=G.toURL();t.readyState=t.DONE;j(t,"writeend",I);o(G)};H.onerror=function(){var I=H.error;if(I.code!==I.ABORT_ERR){B()}};"writestart progress write abort".split(" ").forEach(function(I){H["on"+I]=t["on"+I]});H.write(r);t.abort=function(){H.abort();t.readyState=t.DONE};t.readyState=t.WRITING}),B)}),B)};E.getFile(s,{create:false},x(function(G){G.remove();F()}),x(function(G){if(G.code===G.NOT_FOUND_ERR){F()}else{B()}}))}),B)}),B)},a=b.prototype,f=function(r,s){return new b(r,s)};a.abort=function(){var r=this;r.readyState=r.DONE;j(r,"abort")};a.readyState=a.INIT=0;a.WRITING=1;a.DONE=2;a.error=a.onwritestart=a.onprogress=a.onwrite=a.onabort=a.onerror=a.onwriteend=null;return f}(typeof self!=="undefined"&&self||typeof window!=="undefined"&&window||this.content));if(typeof module!=="undefined"&&module.exports){module.exports.saveAs=saveAs}else{if((typeof define!=="undefined"&&define!==null)&&(define.amd!=null)){define([],function(){return saveAs})}}var cptable={version:"1.3.4"};cptable[874]=(function(){var f="\x00\x01\x02\x03\x04\x05\x06\x07\b\t\n\v\f\r\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\u2026\u2018\u2019\u201c\u201d\u2022\u2013\u2014\xa0",c=[],b={};for(var a=0;a!=f.length;++a){if(f.charCodeAt(a)!==65533){b[f[a]]=a}c[a]=f.charAt(a)}return{enc:b,dec:c}})();cptable[932]=(function(){var f=[],c={},b=[],a;b[0]="\x00\x01\x02\x03\x04\x05\x06\x07\b\t\n\v\f\r\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~".split("");for(a=0;a!=b[0].length;++a){if(b[0][a].charCodeAt(0)!==65533){c[b[0][a]]=0+a;f[0+a]=b[0][a]}}b[129]="\u3000\u2015\u2010\u2026\u2025\u2018\u2019\u201c\u201d\u2032\u2033\u203b\u2030\u2020\u2021".split("");for(a=0;a!=b[129].length;++a){if(b[129][a].charCodeAt(0)!==65533){c[b[129][a]]=33024+a;f[33024+a]=b[129][a]}}b[130]="".split("");for(a=0;a!=b[130].length;++a){if(b[130][a].charCodeAt(0)!==65533){c[b[130][a]]=33280+a;f[33280+a]=b[130][a]}}b[131]="".split("");for(a=0;a!=b[131].length;++a){if(b[131][a].charCodeAt(0)!==65533){c[b[131][a]]=33536+a;f[33536+a]=b[131][a]}}b[132]="".split("");for(a=0;a!=b[132].length;++a){if(b[132][a].charCodeAt(0)!==65533){c[b[132][a]]=33792+a;f[33792+a]=b[132][a]}}b[135]="".split("");for(a=0;a!=b[135].length;++a){if(b[135][a].charCodeAt(0)!==65533){c[b[135][a]]=34560+a;f[34560+a]=b[135][a]}}b[136]="".split("");for(a=0;a!=b[136].length;++a){if(b[136][a].charCodeAt(0)!==65533){c[b[136][a]]=34816+a;f[34816+a]=b[136][a]}}b[137]="".split("");for(a=0;a!=b[137].length;++a){if(b[137][a].charCodeAt(0)!==65533){c[b[137][a]]=35072+a;f[35072+a]=b[137][a]}}b[138]="".split("");for(a=0;a!=b[138].length;++a){if(b[138][a].charCodeAt(0)!==65533){c[b[138][a]]=35328+a;f[35328+a]=b[138][a]}}b[139]="".split("");for(a=0;a!=b[139].length;++a){if(b[139][a].charCodeAt(0)!==65533){c[b[139][a]]=35584+a;f[35584+a]=b[139][a]}}b[140]="".split("");for(a=0;a!=b[140].length;++a){if(b[140][a].charCodeAt(0)!==65533){c[b[140][a]]=35840+a;f[35840+a]=b[140][a]}}b[141]="".split("");for(a=0;a!=b[141].length;++a){if(b[141][a].charCodeAt(0)!==65533){c[b[141][a]]=36096+a;f[36096+a]=b[141][a]}}b[142]="".split("");for(a=0;a!=b[142].length;++a){if(b[142][a].charCodeAt(0)!==65533){c[b[142][a]]=36352+a;f[36352+a]=b[142][a]}}b[143]="".split("");for(a=0;a!=b[143].length;++a){if(b[143][a].charCodeAt(0)!==65533){c[b[143][a]]=36608+a;f[36608+a]=b[143][a]}}b[144]="".split("");for(a=0;a!=b[144].length;++a){if(b[144][a].charCodeAt(0)!==65533){c[b[144][a]]=36864+a;f[36864+a]=b[144][a]}}b[145]="".split("");for(a=0;a!=b[145].length;++a){if(b[145][a].charCodeAt(0)!==65533){c[b[145][a]]=37120+a;f[37120+a]=b[145][a]}}b[146]="".split("");for(a=0;a!=b[146].length;++a){if(b[146][a].charCodeAt(0)!==65533){c[b[146][a]]=37376+a;f[37376+a]=b[146][a]}}b[147]="".split("");for(a=0;a!=b[147].length;++a){if(b[147][a].charCodeAt(0)!==65533){c[b[147][a]]=37632+a;f[37632+a]=b[147][a]}}b[148]="".split("");for(a=0;a!=b[148].length;++a){if(b[148][a].charCodeAt(0)!==65533){c[b[148][a]]=37888+a;f[37888+a]=b[148][a]}}b[149]="".split("");for(a=0;a!=b[149].length;++a){if(b[149][a].charCodeAt(0)!==65533){c[b[149][a]]=38144+a;f[38144+a]=b[149][a]}}b[150]="".split("");for(a=0;a!=b[150].length;++a){if(b[150][a].charCodeAt(0)!==65533){c[b[150][a]]=38400+a;f[38400+a]=b[150][a]}}b[151]="".split("");for(a=0;a!=b[151].length;++a){if(b[151][a].charCodeAt(0)!==65533){c[b[151][a]]=38656+a;f[38656+a]=b[151][a]}}b[152]="".split("");for(a=0;a!=b[152].length;++a){if(b[152][a].charCodeAt(0)!==65533){c[b[152][a]]=38912+a;f[38912+a]=b[152][a]}}b[153]="".split("");for(a=0;a!=b[153].length;++a){if(b[153][a].charCodeAt(0)!==65533){c[b[153][a]]=39168+a;f[39168+a]=b[153][a]}}b[154]="".split("");for(a=0;a!=b[154].length;++a){if(b[154][a].charCodeAt(0)!==65533){c[b[154][a]]=39424+a;f[39424+a]=b[154][a]}}b[155]="".split("");for(a=0;a!=b[155].length;++a){if(b[155][a].charCodeAt(0)!==65533){c[b[155][a]]=39680+a;f[39680+a]=b[155][a]}}b[156]="".split("");for(a=0;a!=b[156].length;++a){if(b[156][a].charCodeAt(0)!==65533){c[b[156][a]]=39936+a;f[39936+a]=b[156][a]}}b[157]="".split("");for(a=0;a!=b[157].length;++a){if(b[157][a].charCodeAt(0)!==65533){c[b[157][a]]=40192+a;f[40192+a]=b[157][a]}}b[158]="".split("");for(a=0;a!=b[158].length;++a){if(b[158][a].charCodeAt(0)!==65533){c[b[158][a]]=40448+a;f[40448+a]=b[158][a]}}b[159]="".split("");for(a=0;a!=b[159].length;++a){if(b[159][a].charCodeAt(0)!==65533){c[b[159][a]]=40704+a;f[40704+a]=b[159][a]}}b[224]="".split("");for(a=0;a!=b[224].length;++a){if(b[224][a].charCodeAt(0)!==65533){c[b[224][a]]=57344+a;f[57344+a]=b[224][a]}}b[225]="".split("");for(a=0;a!=b[225].length;++a){if(b[225][a].charCodeAt(0)!==65533){c[b[225][a]]=57600+a;f[57600+a]=b[225][a]}}b[226]="".split("");for(a=0;a!=b[226].length;++a){if(b[226][a].charCodeAt(0)!==65533){c[b[226][a]]=57856+a;f[57856+a]=b[226][a]}}b[227]="".split("");for(a=0;a!=b[227].length;++a){if(b[227][a].charCodeAt(0)!==65533){c[b[227][a]]=58112+a;f[58112+a]=b[227][a]}}b[228]="".split("");for(a=0;a!=b[228].length;++a){if(b[228][a].charCodeAt(0)!==65533){c[b[228][a]]=58368+a;f[58368+a]=b[228][a]}}b[229]="".split("");for(a=0;a!=b[229].length;++a){if(b[229][a].charCodeAt(0)!==65533){c[b[229][a]]=58624+a;f[58624+a]=b[229][a]}}b[230]="".split("");for(a=0;a!=b[230].length;++a){if(b[230][a].charCodeAt(0)!==65533){c[b[230][a]]=58880+a;f[58880+a]=b[230][a]}}b[231]="".split("");for(a=0;a!=b[231].length;++a){if(b[231][a].charCodeAt(0)!==65533){c[b[231][a]]=59136+a;f[59136+a]=b[231][a]}}b[232]="".split("");for(a=0;a!=b[232].length;++a){if(b[232][a].charCodeAt(0)!==65533){c[b[232][a]]=59392+a;f[59392+a]=b[232][a]}}b[233]="".split("");for(a=0;a!=b[233].length;++a){if(b[233][a].charCodeAt(0)!==65533){c[b[233][a]]=59648+a;f[59648+a]=b[233][a]}}b[234]="".split("");for(a=0;a!=b[234].length;++a){if(b[234][a].charCodeAt(0)!==65533){c[b[234][a]]=59904+a;f[59904+a]=b[234][a]}}b[237]="".split("");for(a=0;a!=b[237].length;++a){if(b[237][a].charCodeAt(0)!==65533){c[b[237][a]]=60672+a;f[60672+a]=b[237][a]}}b[238]="".split("");for(a=0;a!=b[238].length;++a){if(b[238][a].charCodeAt(0)!==65533){c[b[238][a]]=60928+a;f[60928+a]=b[238][a]}}b[250]="".split("");for(a=0;a!=b[250].length;++a){if(b[250][a].charCodeAt(0)!==65533){c[b[250][a]]=64000+a;f[64000+a]=b[250][a]}}b[251]="".split("");for(a=0;a!=b[251].length;++a){if(b[251][a].charCodeAt(0)!==65533){c[b[251][a]]=64256+a;f[64256+a]=b[251][a]}}b[252]="".split("");for(a=0;a!=b[252].length;++a){if(b[252][a].charCodeAt(0)!==65533){c[b[252][a]]=64512+a;f[64512+a]=b[252][a]}}return{enc:c,dec:f}})();cptable[936]=(function(){var f=[],c={},b=[],a;b[0]="\x00\x01\x02\x03\x04\x05\x06\x07\b\t\n\v\f\r\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~".split("");for(a=0;a!=b[0].length;++a){if(b[0][a].charCodeAt(0)!==65533){c[b[0][a]]=0+a;f[0+a]=b[0][a]}}b[129]="".split("");for(a=0;a!=b[129].length;++a){if(b[129][a].charCodeAt(0)!==65533){c[b[129][a]]=33024+a;f[33024+a]=b[129][a]}}b[130]="".split("");for(a=0;a!=b[130].length;++a){if(b[130][a].charCodeAt(0)!==65533){c[b[130][a]]=33280+a;f[33280+a]=b[130][a]}}b[131]="".split("");for(a=0;a!=b[131].length;++a){if(b[131][a].charCodeAt(0)!==65533){c[b[131][a]]=33536+a;f[33536+a]=b[131][a]}}b[132]="".split("");for(a=0;a!=b[132].length;++a){if(b[132][a].charCodeAt(0)!==65533){c[b[132][a]]=33792+a;f[33792+a]=b[132][a]}}b[133]="".split("");for(a=0;a!=b[133].length;++a){if(b[133][a].charCodeAt(0)!==65533){c[b[133][a]]=34048+a;f[34048+a]=b[133][a]}}b[134]="".split("");for(a=0;a!=b[134].length;++a){if(b[134][a].charCodeAt(0)!==65533){c[b[134][a]]=34304+a;f[34304+a]=b[134][a]}}b[135]="".split("");for(a=0;a!=b[135].length;++a){if(b[135][a].charCodeAt(0)!==65533){c[b[135][a]]=34560+a;f[34560+a]=b[135][a]}}b[136]="".split("");for(a=0;a!=b[136].length;++a){if(b[136][a].charCodeAt(0)!==65533){c[b[136][a]]=34816+a;f[34816+a]=b[136][a]}}b[137]="".split("");for(a=0;a!=b[137].length;++a){if(b[137][a].charCodeAt(0)!==65533){c[b[137][a]]=35072+a;f[35072+a]=b[137][a]}}b[138]="".split("");for(a=0;a!=b[138].length;++a){if(b[138][a].charCodeAt(0)!==65533){c[b[138][a]]=35328+a;f[35328+a]=b[138][a]}}b[139]="".split("");for(a=0;a!=b[139].length;++a){if(b[139][a].charCodeAt(0)!==65533){c[b[139][a]]=35584+a;f[35584+a]=b[139][a]}}b[140]="".split("");for(a=0;a!=b[140].length;++a){if(b[140][a].charCodeAt(0)!==65533){c[b[140][a]]=35840+a;f[35840+a]=b[140][a]}}b[141]="".split("");for(a=0;a!=b[141].length;++a){if(b[141][a].charCodeAt(0)!==65533){c[b[141][a]]=36096+a;f[36096+a]=b[141][a]}}b[142]="".split("");for(a=0;a!=b[142].length;++a){if(b[142][a].charCodeAt(0)!==65533){c[b[142][a]]=36352+a;f[36352+a]=b[142][a]}}b[143]="".split("");for(a=0;a!=b[143].length;++a){if(b[143][a].charCodeAt(0)!==65533){c[b[143][a]]=36608+a;f[36608+a]=b[143][a]}}b[144]="".split("");for(a=0;a!=b[144].length;++a){if(b[144][a].charCodeAt(0)!==65533){c[b[144][a]]=36864+a;f[36864+a]=b[144][a]}}b[145]="".split("");for(a=0;a!=b[145].length;++a){if(b[145][a].charCodeAt(0)!==65533){c[b[145][a]]=37120+a;f[37120+a]=b[145][a]}}b[146]="".split("");for(a=0;a!=b[146].length;++a){if(b[146][a].charCodeAt(0)!==65533){c[b[146][a]]=37376+a;f[37376+a]=b[146][a]}}b[147]="".split("");for(a=0;a!=b[147].length;++a){if(b[147][a].charCodeAt(0)!==65533){c[b[147][a]]=37632+a;f[37632+a]=b[147][a]}}b[148]="".split("");for(a=0;a!=b[148].length;++a){if(b[148][a].charCodeAt(0)!==65533){c[b[148][a]]=37888+a;f[37888+a]=b[148][a]}}b[149]="".split("");for(a=0;a!=b[149].length;++a){if(b[149][a].charCodeAt(0)!==65533){c[b[149][a]]=38144+a;f[38144+a]=b[149][a]}}b[150]="".split("");for(a=0;a!=b[150].length;++a){if(b[150][a].charCodeAt(0)!==65533){c[b[150][a]]=38400+a;f[38400+a]=b[150][a]}}b[151]="".split("");for(a=0;a!=b[151].length;++a){if(b[151][a].charCodeAt(0)!==65533){c[b[151][a]]=38656+a;f[38656+a]=b[151][a]}}b[152]="".split("");for(a=0;a!=b[152].length;++a){if(b[152][a].charCodeAt(0)!==65533){c[b[152][a]]=38912+a;f[38912+a]=b[152][a]}}b[153]="".split("");for(a=0;a!=b[153].length;++a){if(b[153][a].charCodeAt(0)!==65533){c[b[153][a]]=39168+a;f[39168+a]=b[153][a]}}b[154]="".split("");for(a=0;a!=b[154].length;++a){if(b[154][a].charCodeAt(0)!==65533){c[b[154][a]]=39424+a;f[39424+a]=b[154][a]}}b[155]="".split("");for(a=0;a!=b[155].length;++a){if(b[155][a].charCodeAt(0)!==65533){c[b[155][a]]=39680+a;f[39680+a]=b[155][a]}}b[156]="".split("");for(a=0;a!=b[156].length;++a){if(b[156][a].charCodeAt(0)!==65533){c[b[156][a]]=39936+a;f[39936+a]=b[156][a]}}b[157]="".split("");for(a=0;a!=b[157].length;++a){if(b[157][a].charCodeAt(0)!==65533){c[b[157][a]]=40192+a;f[40192+a]=b[157][a]}}b[158]="".split("");for(a=0;a!=b[158].length;++a){if(b[158][a].charCodeAt(0)!==65533){c[b[158][a]]=40448+a;f[40448+a]=b[158][a]}}b[159]="".split("");for(a=0;a!=b[159].length;++a){if(b[159][a].charCodeAt(0)!==65533){c[b[159][a]]=40704+a;f[40704+a]=b[159][a]}}b[160]="".split("");for(a=0;a!=b[160].length;++a){if(b[160][a].charCodeAt(0)!==65533){c[b[160][a]]=40960+a;f[40960+a]=b[160][a]}}b[161]="\u3000\u2014\u2016\u2026\u2018\u2019\u201c\u201d\u2032\u2033\u2030\u203b".split("");for(a=0;a!=b[161].length;++a){if(b[161][a].charCodeAt(0)!==65533){c[b[161][a]]=41216+a;f[41216+a]=b[161][a]}}b[162]="".split("");for(a=0;a!=b[162].length;++a){if(b[162][a].charCodeAt(0)!==65533){c[b[162][a]]=41472+a;f[41472+a]=b[162][a]}}b[163]="".split("");for(a=0;a!=b[163].length;++a){if(b[163][a].charCodeAt(0)!==65533){c[b[163][a]]=41728+a;f[41728+a]=b[163][a]}}b[164]="".split("");for(a=0;a!=b[164].length;++a){if(b[164][a].charCodeAt(0)!==65533){c[b[164][a]]=41984+a;f[41984+a]=b[164][a]}}b[165]="".split("");for(a=0;a!=b[165].length;++a){if(b[165][a].charCodeAt(0)!==65533){c[b[165][a]]=42240+a;f[42240+a]=b[165][a]}}b[166]="".split("");for(a=0;a!=b[166].length;++a){if(b[166][a].charCodeAt(0)!==65533){c[b[166][a]]=42496+a;f[42496+a]=b[166][a]}}b[167]="".split("");for(a=0;a!=b[167].length;++a){if(b[167][a].charCodeAt(0)!==65533){c[b[167][a]]=42752+a;f[42752+a]=b[167][a]}}b[168]="\u2013\u2015\u2025\u2035".split("");for(a=0;a!=b[168].length;++a){if(b[168][a].charCodeAt(0)!==65533){c[b[168][a]]=43008+a;f[43008+a]=b[168][a]}}b[169]="\u2010".split("");for(a=0;a!=b[169].length;++a){if(b[169][a].charCodeAt(0)!==65533){c[b[169][a]]=43264+a;f[43264+a]=b[169][a]}}b[170]="".split("");for(a=0;a!=b[170].length;++a){if(b[170][a].charCodeAt(0)!==65533){c[b[170][a]]=43520+a;f[43520+a]=b[170][a]}}b[171]="".split("");for(a=0;a!=b[171].length;++a){if(b[171][a].charCodeAt(0)!==65533){c[b[171][a]]=43776+a;f[43776+a]=b[171][a]}}b[172]="".split("");for(a=0;a!=b[172].length;++a){if(b[172][a].charCodeAt(0)!==65533){c[b[172][a]]=44032+a;f[44032+a]=b[172][a]}}b[173]="".split("");for(a=0;a!=b[173].length;++a){if(b[173][a].charCodeAt(0)!==65533){c[b[173][a]]=44288+a;f[44288+a]=b[173][a]}}b[174]="".split("");for(a=0;a!=b[174].length;++a){if(b[174][a].charCodeAt(0)!==65533){c[b[174][a]]=44544+a;f[44544+a]=b[174][a]}}b[175]="".split("");for(a=0;a!=b[175].length;++a){if(b[175][a].charCodeAt(0)!==65533){c[b[175][a]]=44800+a;f[44800+a]=b[175][a]}}b[176]="".split("");for(a=0;a!=b[176].length;++a){if(b[176][a].charCodeAt(0)!==65533){c[b[176][a]]=45056+a;f[45056+a]=b[176][a]}}b[177]="".split("");for(a=0;a!=b[177].length;++a){if(b[177][a].charCodeAt(0)!==65533){c[b[177][a]]=45312+a;f[45312+a]=b[177][a]}}b[178]="".split("");for(a=0;a!=b[178].length;++a){if(b[178][a].charCodeAt(0)!==65533){c[b[178][a]]=45568+a;f[45568+a]=b[178][a]}}b[179]="".split("");for(a=0;a!=b[179].length;++a){if(b[179][a].charCodeAt(0)!==65533){c[b[179][a]]=45824+a;f[45824+a]=b[179][a]}}b[180]="".split("");for(a=0;a!=b[180].length;++a){if(b[180][a].charCodeAt(0)!==65533){c[b[180][a]]=46080+a;f[46080+a]=b[180][a]}}b[181]="".split("");for(a=0;a!=b[181].length;++a){if(b[181][a].charCodeAt(0)!==65533){c[b[181][a]]=46336+a;f[46336+a]=b[181][a]}}b[182]="".split("");for(a=0;a!=b[182].length;++a){if(b[182][a].charCodeAt(0)!==65533){c[b[182][a]]=46592+a;f[46592+a]=b[182][a]}}b[183]="".split("");for(a=0;a!=b[183].length;++a){if(b[183][a].charCodeAt(0)!==65533){c[b[183][a]]=46848+a;f[46848+a]=b[183][a]}}b[184]="".split("");for(a=0;a!=b[184].length;++a){if(b[184][a].charCodeAt(0)!==65533){c[b[184][a]]=47104+a;f[47104+a]=b[184][a]}}b[185]="".split("");for(a=0;a!=b[185].length;++a){if(b[185][a].charCodeAt(0)!==65533){c[b[185][a]]=47360+a;f[47360+a]=b[185][a]}}b[186]="".split("");for(a=0;a!=b[186].length;++a){if(b[186][a].charCodeAt(0)!==65533){c[b[186][a]]=47616+a;f[47616+a]=b[186][a]}}b[187]="".split("");for(a=0;a!=b[187].length;++a){if(b[187][a].charCodeAt(0)!==65533){c[b[187][a]]=47872+a;f[47872+a]=b[187][a]}}b[188]="".split("");for(a=0;a!=b[188].length;++a){if(b[188][a].charCodeAt(0)!==65533){c[b[188][a]]=48128+a;f[48128+a]=b[188][a]}}b[189]="".split("");for(a=0;a!=b[189].length;++a){if(b[189][a].charCodeAt(0)!==65533){c[b[189][a]]=48384+a;f[48384+a]=b[189][a]}}b[190]="".split("");for(a=0;a!=b[190].length;++a){if(b[190][a].charCodeAt(0)!==65533){c[b[190][a]]=48640+a;f[48640+a]=b[190][a]}}b[191]="".split("");for(a=0;a!=b[191].length;++a){if(b[191][a].charCodeAt(0)!==65533){c[b[191][a]]=48896+a;f[48896+a]=b[191][a]}}b[192]="".split("");for(a=0;a!=b[192].length;++a){if(b[192][a].charCodeAt(0)!==65533){c[b[192][a]]=49152+a;f[49152+a]=b[192][a]}}b[193]="".split("");for(a=0;a!=b[193].length;++a){if(b[193][a].charCodeAt(0)!==65533){c[b[193][a]]=49408+a;f[49408+a]=b[193][a]}}b[194]="".split("");for(a=0;a!=b[194].length;++a){if(b[194][a].charCodeAt(0)!==65533){c[b[194][a]]=49664+a;f[49664+a]=b[194][a]}}b[195]="".split("");for(a=0;a!=b[195].length;++a){if(b[195][a].charCodeAt(0)!==65533){c[b[195][a]]=49920+a;f[49920+a]=b[195][a]}}b[196]="".split("");for(a=0;a!=b[196].length;++a){if(b[196][a].charCodeAt(0)!==65533){c[b[196][a]]=50176+a;f[50176+a]=b[196][a]}}b[197]="".split("");for(a=0;a!=b[197].length;++a){if(b[197][a].charCodeAt(0)!==65533){c[b[197][a]]=50432+a;f[50432+a]=b[197][a]}}b[198]="".split("");for(a=0;a!=b[198].length;++a){if(b[198][a].charCodeAt(0)!==65533){c[b[198][a]]=50688+a;f[50688+a]=b[198][a]}}b[199]="".split("");for(a=0;a!=b[199].length;++a){if(b[199][a].charCodeAt(0)!==65533){c[b[199][a]]=50944+a;f[50944+a]=b[199][a]}}b[200]="".split("");for(a=0;a!=b[200].length;++a){if(b[200][a].charCodeAt(0)!==65533){c[b[200][a]]=51200+a;f[51200+a]=b[200][a]}}b[201]="".split("");for(a=0;a!=b[201].length;++a){if(b[201][a].charCodeAt(0)!==65533){c[b[201][a]]=51456+a;f[51456+a]=b[201][a]}}b[202]="".split("");for(a=0;a!=b[202].length;++a){if(b[202][a].charCodeAt(0)!==65533){c[b[202][a]]=51712+a;f[51712+a]=b[202][a]}}b[203]="".split("");for(a=0;a!=b[203].length;++a){if(b[203][a].charCodeAt(0)!==65533){c[b[203][a]]=51968+a;f[51968+a]=b[203][a]}}b[204]="".split("");for(a=0;a!=b[204].length;++a){if(b[204][a].charCodeAt(0)!==65533){c[b[204][a]]=52224+a;f[52224+a]=b[204][a]}}b[205]="".split("");for(a=0;a!=b[205].length;++a){if(b[205][a].charCodeAt(0)!==65533){c[b[205][a]]=52480+a;f[52480+a]=b[205][a]}}b[206]="".split("");for(a=0;a!=b[206].length;++a){if(b[206][a].charCodeAt(0)!==65533){c[b[206][a]]=52736+a;f[52736+a]=b[206][a]}}b[207]="".split("");for(a=0;a!=b[207].length;++a){if(b[207][a].charCodeAt(0)!==65533){c[b[207][a]]=52992+a;f[52992+a]=b[207][a]}}b[208]="".split("");for(a=0;a!=b[208].length;++a){if(b[208][a].charCodeAt(0)!==65533){c[b[208][a]]=53248+a;f[53248+a]=b[208][a]}}b[209]="".split("");for(a=0;a!=b[209].length;++a){if(b[209][a].charCodeAt(0)!==65533){c[b[209][a]]=53504+a;f[53504+a]=b[209][a]}}b[210]="".split("");for(a=0;a!=b[210].length;++a){if(b[210][a].charCodeAt(0)!==65533){c[b[210][a]]=53760+a;f[53760+a]=b[210][a]}}b[211]="".split("");for(a=0;a!=b[211].length;++a){if(b[211][a].charCodeAt(0)!==65533){c[b[211][a]]=54016+a;f[54016+a]=b[211][a]}}b[212]="".split("");for(a=0;a!=b[212].length;++a){if(b[212][a].charCodeAt(0)!==65533){c[b[212][a]]=54272+a;f[54272+a]=b[212][a]}}b[213]="".split("");for(a=0;a!=b[213].length;++a){if(b[213][a].charCodeAt(0)!==65533){c[b[213][a]]=54528+a;f[54528+a]=b[213][a]}}b[214]="".split("");for(a=0;a!=b[214].length;++a){if(b[214][a].charCodeAt(0)!==65533){c[b[214][a]]=54784+a;f[54784+a]=b[214][a]}}b[215]="".split("");for(a=0;a!=b[215].length;++a){if(b[215][a].charCodeAt(0)!==65533){c[b[215][a]]=55040+a;f[55040+a]=b[215][a]}}b[216]="".split("");for(a=0;a!=b[216].length;++a){if(b[216][a].charCodeAt(0)!==65533){c[b[216][a]]=55296+a;f[55296+a]=b[216][a]}}b[217]="".split("");for(a=0;a!=b[217].length;++a){if(b[217][a].charCodeAt(0)!==65533){c[b[217][a]]=55552+a;f[55552+a]=b[217][a]}}b[218]="".split("");for(a=0;a!=b[218].length;++a){if(b[218][a].charCodeAt(0)!==65533){c[b[218][a]]=55808+a;f[55808+a]=b[218][a]}}b[219]="".split("");for(a=0;a!=b[219].length;++a){if(b[219][a].charCodeAt(0)!==65533){c[b[219][a]]=56064+a;f[56064+a]=b[219][a]}}b[220]="".split("");for(a=0;a!=b[220].length;++a){if(b[220][a].charCodeAt(0)!==65533){c[b[220][a]]=56320+a;f[56320+a]=b[220][a]}}b[221]="".split("");for(a=0;a!=b[221].length;++a){if(b[221][a].charCodeAt(0)!==65533){c[b[221][a]]=56576+a;f[56576+a]=b[221][a]}}b[222]="".split("");for(a=0;a!=b[222].length;++a){if(b[222][a].charCodeAt(0)!==65533){c[b[222][a]]=56832+a;f[56832+a]=b[222][a]}}b[223]="".split("");for(a=0;a!=b[223].length;++a){if(b[223][a].charCodeAt(0)!==65533){c[b[223][a]]=57088+a;f[57088+a]=b[223][a]}}b[224]="".split("");for(a=0;a!=b[224].length;++a){if(b[224][a].charCodeAt(0)!==65533){c[b[224][a]]=57344+a;f[57344+a]=b[224][a]}}b[225]="".split("");for(a=0;a!=b[225].length;++a){if(b[225][a].charCodeAt(0)!==65533){c[b[225][a]]=57600+a;f[57600+a]=b[225][a]}}b[226]="".split("");for(a=0;a!=b[226].length;++a){if(b[226][a].charCodeAt(0)!==65533){c[b[226][a]]=57856+a;f[57856+a]=b[226][a]}}b[227]="".split("");for(a=0;a!=b[227].length;++a){if(b[227][a].charCodeAt(0)!==65533){c[b[227][a]]=58112+a;f[58112+a]=b[227][a]}}b[228]="".split("");for(a=0;a!=b[228].length;++a){if(b[228][a].charCodeAt(0)!==65533){c[b[228][a]]=58368+a;f[58368+a]=b[228][a]}}b[229]="".split("");for(a=0;a!=b[229].length;++a){if(b[229][a].charCodeAt(0)!==65533){c[b[229][a]]=58624+a;f[58624+a]=b[229][a]}}b[230]="".split("");for(a=0;a!=b[230].length;++a){if(b[230][a].charCodeAt(0)!==65533){c[b[230][a]]=58880+a;f[58880+a]=b[230][a]}}b[231]="".split("");for(a=0;a!=b[231].length;++a){if(b[231][a].charCodeAt(0)!==65533){c[b[231][a]]=59136+a;f[59136+a]=b[231][a]}}b[232]="".split("");for(a=0;a!=b[232].length;++a){if(b[232][a].charCodeAt(0)!==65533){c[b[232][a]]=59392+a;f[59392+a]=b[232][a]}}b[233]="".split("");for(a=0;a!=b[233].length;++a){if(b[233][a].charCodeAt(0)!==65533){c[b[233][a]]=59648+a;f[59648+a]=b[233][a]}}b[234]="".split("");for(a=0;a!=b[234].length;++a){if(b[234][a].charCodeAt(0)!==65533){c[b[234][a]]=59904+a;f[59904+a]=b[234][a]}}b[235]="".split("");for(a=0;a!=b[235].length;++a){if(b[235][a].charCodeAt(0)!==65533){c[b[235][a]]=60160+a;f[60160+a]=b[235][a]}}b[236]="".split("");for(a=0;a!=b[236].length;++a){if(b[236][a].charCodeAt(0)!==65533){c[b[236][a]]=60416+a;f[60416+a]=b[236][a]}}b[237]="".split("");for(a=0;a!=b[237].length;++a){if(b[237][a].charCodeAt(0)!==65533){c[b[237][a]]=60672+a;f[60672+a]=b[237][a]}}b[238]="".split("");for(a=0;a!=b[238].length;++a){if(b[238][a].charCodeAt(0)!==65533){c[b[238][a]]=60928+a;f[60928+a]=b[238][a]}}b[239]="".split("");for(a=0;a!=b[239].length;++a){if(b[239][a].charCodeAt(0)!==65533){c[b[239][a]]=61184+a;f[61184+a]=b[239][a]}}b[240]="".split("");for(a=0;a!=b[240].length;++a){if(b[240][a].charCodeAt(0)!==65533){c[b[240][a]]=61440+a;f[61440+a]=b[240][a]}}b[241]="".split("");for(a=0;a!=b[241].length;++a){if(b[241][a].charCodeAt(0)!==65533){c[b[241][a]]=61696+a;f[61696+a]=b[241][a]}}b[242]="".split("");for(a=0;a!=b[242].length;++a){if(b[242][a].charCodeAt(0)!==65533){c[b[242][a]]=61952+a;f[61952+a]=b[242][a]}}b[243]="".split("");for(a=0;a!=b[243].length;++a){if(b[243][a].charCodeAt(0)!==65533){c[b[243][a]]=62208+a;f[62208+a]=b[243][a]}}b[244]="".split("");for(a=0;a!=b[244].length;++a){if(b[244][a].charCodeAt(0)!==65533){c[b[244][a]]=62464+a;f[62464+a]=b[244][a]}}b[245]="".split("");for(a=0;a!=b[245].length;++a){if(b[245][a].charCodeAt(0)!==65533){c[b[245][a]]=62720+a;f[62720+a]=b[245][a]}}b[246]="".split("");for(a=0;a!=b[246].length;++a){if(b[246][a].charCodeAt(0)!==65533){c[b[246][a]]=62976+a;f[62976+a]=b[246][a]}}b[247]="".split("");for(a=0;a!=b[247].length;++a){if(b[247][a].charCodeAt(0)!==65533){c[b[247][a]]=63232+a;f[63232+a]=b[247][a]}}b[248]="".split("");for(a=0;a!=b[248].length;++a){if(b[248][a].charCodeAt(0)!==65533){c[b[248][a]]=63488+a;f[63488+a]=b[248][a]}}b[249]="".split("");for(a=0;a!=b[249].length;++a){if(b[249][a].charCodeAt(0)!==65533){c[b[249][a]]=63744+a;f[63744+a]=b[249][a]}}b[250]="".split("");for(a=0;a!=b[250].length;++a){if(b[250][a].charCodeAt(0)!==65533){c[b[250][a]]=64000+a;f[64000+a]=b[250][a]}}b[251]="".split("");for(a=0;a!=b[251].length;++a){if(b[251][a].charCodeAt(0)!==65533){c[b[251][a]]=64256+a;f[64256+a]=b[251][a]}}b[252]="".split("");for(a=0;a!=b[252].length;++a){if(b[252][a].charCodeAt(0)!==65533){c[b[252][a]]=64512+a;f[64512+a]=b[252][a]}}b[253]="".split("");for(a=0;a!=b[253].length;++a){if(b[253][a].charCodeAt(0)!==65533){c[b[253][a]]=64768+a;f[64768+a]=b[253][a]}}b[254]="".split("");for(a=0;a!=b[254].length;++a){if(b[254][a].charCodeAt(0)!==65533){c[b[254][a]]=65024+a;f[65024+a]=b[254][a]}}return{enc:c,dec:f}})();cptable[949]=(function(){var f=[],c={},b=[],a;b[0]="\x00\x01\x02\x03\x04\x05\x06\x07\b\t\n\v\f\r\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~".split("");for(a=0;a!=b[0].length;++a){if(b[0][a].charCodeAt(0)!==65533){c[b[0][a]]=0+a;f[0+a]=b[0][a]}}b[129]="".split("");for(a=0;a!=b[129].length;++a){if(b[129][a].charCodeAt(0)!==65533){c[b[129][a]]=33024+a;f[33024+a]=b[129][a]}}b[130]="".split("");for(a=0;a!=b[130].length;++a){if(b[130][a].charCodeAt(0)!==65533){c[b[130][a]]=33280+a;f[33280+a]=b[130][a]}}b[131]="".split("");for(a=0;a!=b[131].length;++a){if(b[131][a].charCodeAt(0)!==65533){c[b[131][a]]=33536+a;f[33536+a]=b[131][a]}}b[132]="".split("");for(a=0;a!=b[132].length;++a){if(b[132][a].charCodeAt(0)!==65533){c[b[132][a]]=33792+a;f[33792+a]=b[132][a]}}b[133]="".split("");for(a=0;a!=b[133].length;++a){if(b[133][a].charCodeAt(0)!==65533){c[b[133][a]]=34048+a;f[34048+a]=b[133][a]}}b[134]="".split("");for(a=0;a!=b[134].length;++a){if(b[134][a].charCodeAt(0)!==65533){c[b[134][a]]=34304+a;f[34304+a]=b[134][a]}}b[135]="".split("");for(a=0;a!=b[135].length;++a){if(b[135][a].charCodeAt(0)!==65533){c[b[135][a]]=34560+a;f[34560+a]=b[135][a]}}b[136]="".split("");for(a=0;a!=b[136].length;++a){if(b[136][a].charCodeAt(0)!==65533){c[b[136][a]]=34816+a;f[34816+a]=b[136][a]}}b[137]="".split("");for(a=0;a!=b[137].length;++a){if(b[137][a].charCodeAt(0)!==65533){c[b[137][a]]=35072+a;f[35072+a]=b[137][a]}}b[138]="".split("");for(a=0;a!=b[138].length;++a){if(b[138][a].charCodeAt(0)!==65533){c[b[138][a]]=35328+a;f[35328+a]=b[138][a]}}b[139]="".split("");for(a=0;a!=b[139].length;++a){if(b[139][a].charCodeAt(0)!==65533){c[b[139][a]]=35584+a;f[35584+a]=b[139][a]}}b[140]="".split("");for(a=0;a!=b[140].length;++a){if(b[140][a].charCodeAt(0)!==65533){c[b[140][a]]=35840+a;f[35840+a]=b[140][a]}}b[141]="".split("");for(a=0;a!=b[141].length;++a){if(b[141][a].charCodeAt(0)!==65533){c[b[141][a]]=36096+a;f[36096+a]=b[141][a]}}b[142]="".split("");for(a=0;a!=b[142].length;++a){if(b[142][a].charCodeAt(0)!==65533){c[b[142][a]]=36352+a;f[36352+a]=b[142][a]}}b[143]="".split("");for(a=0;a!=b[143].length;++a){if(b[143][a].charCodeAt(0)!==65533){c[b[143][a]]=36608+a;f[36608+a]=b[143][a]}}b[144]="".split("");for(a=0;a!=b[144].length;++a){if(b[144][a].charCodeAt(0)!==65533){c[b[144][a]]=36864+a;f[36864+a]=b[144][a]}}b[145]="".split("");for(a=0;a!=b[145].length;++a){if(b[145][a].charCodeAt(0)!==65533){c[b[145][a]]=37120+a;f[37120+a]=b[145][a]}}b[146]="".split("");for(a=0;a!=b[146].length;++a){if(b[146][a].charCodeAt(0)!==65533){c[b[146][a]]=37376+a;f[37376+a]=b[146][a]}}b[147]="".split("");for(a=0;a!=b[147].length;++a){if(b[147][a].charCodeAt(0)!==65533){c[b[147][a]]=37632+a;f[37632+a]=b[147][a]}}b[148]="".split("");for(a=0;a!=b[148].length;++a){if(b[148][a].charCodeAt(0)!==65533){c[b[148][a]]=37888+a;f[37888+a]=b[148][a]}}b[149]="".split("");for(a=0;a!=b[149].length;++a){if(b[149][a].charCodeAt(0)!==65533){c[b[149][a]]=38144+a;f[38144+a]=b[149][a]}}b[150]="".split("");for(a=0;a!=b[150].length;++a){if(b[150][a].charCodeAt(0)!==65533){c[b[150][a]]=38400+a;f[38400+a]=b[150][a]}}b[151]="".split("");for(a=0;a!=b[151].length;++a){if(b[151][a].charCodeAt(0)!==65533){c[b[151][a]]=38656+a;f[38656+a]=b[151][a]}}b[152]="".split("");for(a=0;a!=b[152].length;++a){if(b[152][a].charCodeAt(0)!==65533){c[b[152][a]]=38912+a;f[38912+a]=b[152][a]}}b[153]="".split("");for(a=0;a!=b[153].length;++a){if(b[153][a].charCodeAt(0)!==65533){c[b[153][a]]=39168+a;f[39168+a]=b[153][a]}}b[154]="".split("");for(a=0;a!=b[154].length;++a){if(b[154][a].charCodeAt(0)!==65533){c[b[154][a]]=39424+a;f[39424+a]=b[154][a]}}b[155]="".split("");for(a=0;a!=b[155].length;++a){if(b[155][a].charCodeAt(0)!==65533){c[b[155][a]]=39680+a;f[39680+a]=b[155][a]}}b[156]="".split("");for(a=0;a!=b[156].length;++a){if(b[156][a].charCodeAt(0)!==65533){c[b[156][a]]=39936+a;f[39936+a]=b[156][a]}}b[157]="".split("");for(a=0;a!=b[157].length;++a){if(b[157][a].charCodeAt(0)!==65533){c[b[157][a]]=40192+a;f[40192+a]=b[157][a]}}b[158]="".split("");for(a=0;a!=b[158].length;++a){if(b[158][a].charCodeAt(0)!==65533){c[b[158][a]]=40448+a;f[40448+a]=b[158][a]}}b[159]="".split("");for(a=0;a!=b[159].length;++a){if(b[159][a].charCodeAt(0)!==65533){c[b[159][a]]=40704+a;f[40704+a]=b[159][a]}}b[160]="".split("");for(a=0;a!=b[160].length;++a){if(b[160][a].charCodeAt(0)!==65533){c[b[160][a]]=40960+a;f[40960+a]=b[160][a]}}b[161]="\u3000\u2025\u2026\u2015\u2018\u2019\u201c\u201d\u2032\u2033\u203b".split("");for(a=0;a!=b[161].length;++a){if(b[161][a].charCodeAt(0)!==65533){c[b[161][a]]=41216+a;f[41216+a]=b[161][a]}}b[162]="\u2030\u2020\u2021".split("");for(a=0;a!=b[162].length;++a){if(b[162][a].charCodeAt(0)!==65533){c[b[162][a]]=41472+a;f[41472+a]=b[162][a]}}b[163]="".split("");for(a=0;a!=b[163].length;++a){if(b[163][a].charCodeAt(0)!==65533){c[b[163][a]]=41728+a;f[41728+a]=b[163][a]}}b[164]="".split("");for(a=0;a!=b[164].length;++a){if(b[164][a].charCodeAt(0)!==65533){c[b[164][a]]=41984+a;f[41984+a]=b[164][a]}}b[165]="".split("");for(a=0;a!=b[165].length;++a){if(b[165][a].charCodeAt(0)!==65533){c[b[165][a]]=42240+a;f[42240+a]=b[165][a]}}b[166]="".split("");for(a=0;a!=b[166].length;++a){if(b[166][a].charCodeAt(0)!==65533){c[b[166][a]]=42496+a;f[42496+a]=b[166][a]}}b[167]="".split("");for(a=0;a!=b[167].length;++a){if(b[167][a].charCodeAt(0)!==65533){c[b[167][a]]=42752+a;f[42752+a]=b[167][a]}}b[168]="".split("");for(a=0;a!=b[168].length;++a){if(b[168][a].charCodeAt(0)!==65533){c[b[168][a]]=43008+a;f[43008+a]=b[168][a]}}b[169]="".split("");for(a=0;a!=b[169].length;++a){if(b[169][a].charCodeAt(0)!==65533){c[b[169][a]]=43264+a;f[43264+a]=b[169][a]}}b[170]="".split("");for(a=0;a!=b[170].length;++a){if(b[170][a].charCodeAt(0)!==65533){c[b[170][a]]=43520+a;f[43520+a]=b[170][a]}}b[171]="".split("");for(a=0;a!=b[171].length;++a){if(b[171][a].charCodeAt(0)!==65533){c[b[171][a]]=43776+a;f[43776+a]=b[171][a]}}b[172]="".split("");for(a=0;a!=b[172].length;++a){if(b[172][a].charCodeAt(0)!==65533){c[b[172][a]]=44032+a;f[44032+a]=b[172][a]}}b[173]="".split("");for(a=0;a!=b[173].length;++a){if(b[173][a].charCodeAt(0)!==65533){c[b[173][a]]=44288+a;f[44288+a]=b[173][a]}}b[174]="".split("");for(a=0;a!=b[174].length;++a){if(b[174][a].charCodeAt(0)!==65533){c[b[174][a]]=44544+a;f[44544+a]=b[174][a]}}b[175]="".split("");for(a=0;a!=b[175].length;++a){if(b[175][a].charCodeAt(0)!==65533){c[b[175][a]]=44800+a;f[44800+a]=b[175][a]}}b[176]="".split("");for(a=0;a!=b[176].length;++a){if(b[176][a].charCodeAt(0)!==65533){c[b[176][a]]=45056+a;f[45056+a]=b[176][a]}}b[177]="".split("");for(a=0;a!=b[177].length;++a){if(b[177][a].charCodeAt(0)!==65533){c[b[177][a]]=45312+a;f[45312+a]=b[177][a]}}b[178]="".split("");for(a=0;a!=b[178].length;++a){if(b[178][a].charCodeAt(0)!==65533){c[b[178][a]]=45568+a;f[45568+a]=b[178][a]}}b[179]="".split("");for(a=0;a!=b[179].length;++a){if(b[179][a].charCodeAt(0)!==65533){c[b[179][a]]=45824+a;f[45824+a]=b[179][a]}}b[180]="".split("");for(a=0;a!=b[180].length;++a){if(b[180][a].charCodeAt(0)!==65533){c[b[180][a]]=46080+a;f[46080+a]=b[180][a]}}b[181]="".split("");for(a=0;a!=b[181].length;++a){if(b[181][a].charCodeAt(0)!==65533){c[b[181][a]]=46336+a;f[46336+a]=b[181][a]}}b[182]="".split("");for(a=0;a!=b[182].length;++a){if(b[182][a].charCodeAt(0)!==65533){c[b[182][a]]=46592+a;f[46592+a]=b[182][a]}}b[183]="".split("");for(a=0;a!=b[183].length;++a){if(b[183][a].charCodeAt(0)!==65533){c[b[183][a]]=46848+a;f[46848+a]=b[183][a]}}b[184]="".split("");for(a=0;a!=b[184].length;++a){if(b[184][a].charCodeAt(0)!==65533){c[b[184][a]]=47104+a;f[47104+a]=b[184][a]}}b[185]="".split("");for(a=0;a!=b[185].length;++a){if(b[185][a].charCodeAt(0)!==65533){c[b[185][a]]=47360+a;f[47360+a]=b[185][a]}}b[186]="".split("");for(a=0;a!=b[186].length;++a){if(b[186][a].charCodeAt(0)!==65533){c[b[186][a]]=47616+a;f[47616+a]=b[186][a]}}b[187]="".split("");for(a=0;a!=b[187].length;++a){if(b[187][a].charCodeAt(0)!==65533){c[b[187][a]]=47872+a;f[47872+a]=b[187][a]}}b[188]="".split("");for(a=0;a!=b[188].length;++a){if(b[188][a].charCodeAt(0)!==65533){c[b[188][a]]=48128+a;f[48128+a]=b[188][a]}}b[189]="".split("");for(a=0;a!=b[189].length;++a){if(b[189][a].charCodeAt(0)!==65533){c[b[189][a]]=48384+a;f[48384+a]=b[189][a]}}b[190]="".split("");for(a=0;a!=b[190].length;++a){if(b[190][a].charCodeAt(0)!==65533){c[b[190][a]]=48640+a;f[48640+a]=b[190][a]}}b[191]="".split("");for(a=0;a!=b[191].length;++a){if(b[191][a].charCodeAt(0)!==65533){c[b[191][a]]=48896+a;f[48896+a]=b[191][a]}}b[192]="".split("");for(a=0;a!=b[192].length;++a){if(b[192][a].charCodeAt(0)!==65533){c[b[192][a]]=49152+a;f[49152+a]=b[192][a]}}b[193]="".split("");for(a=0;a!=b[193].length;++a){if(b[193][a].charCodeAt(0)!==65533){c[b[193][a]]=49408+a;f[49408+a]=b[193][a]}}b[194]="".split("");for(a=0;a!=b[194].length;++a){if(b[194][a].charCodeAt(0)!==65533){c[b[194][a]]=49664+a;f[49664+a]=b[194][a]}}b[195]="".split("");for(a=0;a!=b[195].length;++a){if(b[195][a].charCodeAt(0)!==65533){c[b[195][a]]=49920+a;f[49920+a]=b[195][a]}}b[196]="".split("");for(a=0;a!=b[196].length;++a){if(b[196][a].charCodeAt(0)!==65533){c[b[196][a]]=50176+a;f[50176+a]=b[196][a]}}b[197]="".split("");for(a=0;a!=b[197].length;++a){if(b[197][a].charCodeAt(0)!==65533){c[b[197][a]]=50432+a;f[50432+a]=b[197][a]}}b[198]="".split("");for(a=0;a!=b[198].length;++a){if(b[198][a].charCodeAt(0)!==65533){c[b[198][a]]=50688+a;f[50688+a]=b[198][a]}}b[199]="".split("");for(a=0;a!=b[199].length;++a){if(b[199][a].charCodeAt(0)!==65533){c[b[199][a]]=50944+a;f[50944+a]=b[199][a]}}b[200]="".split("");for(a=0;a!=b[200].length;++a){if(b[200][a].charCodeAt(0)!==65533){c[b[200][a]]=51200+a;f[51200+a]=b[200][a]}}b[202]="".split("");for(a=0;a!=b[202].length;++a){if(b[202][a].charCodeAt(0)!==65533){c[b[202][a]]=51712+a;f[51712+a]=b[202][a]}}b[203]="".split("");for(a=0;a!=b[203].length;++a){if(b[203][a].charCodeAt(0)!==65533){c[b[203][a]]=51968+a;f[51968+a]=b[203][a]}}b[204]="".split("");for(a=0;a!=b[204].length;++a){if(b[204][a].charCodeAt(0)!==65533){c[b[204][a]]=52224+a;f[52224+a]=b[204][a]}}b[205]="".split("");for(a=0;a!=b[205].length;++a){if(b[205][a].charCodeAt(0)!==65533){c[b[205][a]]=52480+a;f[52480+a]=b[205][a]}}b[206]="".split("");for(a=0;a!=b[206].length;++a){if(b[206][a].charCodeAt(0)!==65533){c[b[206][a]]=52736+a;f[52736+a]=b[206][a]}}b[207]="".split("");for(a=0;a!=b[207].length;++a){if(b[207][a].charCodeAt(0)!==65533){c[b[207][a]]=52992+a;f[52992+a]=b[207][a]}}b[208]="".split("");for(a=0;a!=b[208].length;++a){if(b[208][a].charCodeAt(0)!==65533){c[b[208][a]]=53248+a;f[53248+a]=b[208][a]}}b[209]="".split("");for(a=0;a!=b[209].length;++a){if(b[209][a].charCodeAt(0)!==65533){c[b[209][a]]=53504+a;f[53504+a]=b[209][a]}}b[210]="".split("");for(a=0;a!=b[210].length;++a){if(b[210][a].charCodeAt(0)!==65533){c[b[210][a]]=53760+a;f[53760+a]=b[210][a]}}b[211]="".split("");for(a=0;a!=b[211].length;++a){if(b[211][a].charCodeAt(0)!==65533){c[b[211][a]]=54016+a;f[54016+a]=b[211][a]}}b[212]="".split("");for(a=0;a!=b[212].length;++a){if(b[212][a].charCodeAt(0)!==65533){c[b[212][a]]=54272+a;f[54272+a]=b[212][a]}}b[213]="".split("");for(a=0;a!=b[213].length;++a){if(b[213][a].charCodeAt(0)!==65533){c[b[213][a]]=54528+a;f[54528+a]=b[213][a]}}b[214]="".split("");for(a=0;a!=b[214].length;++a){if(b[214][a].charCodeAt(0)!==65533){c[b[214][a]]=54784+a;f[54784+a]=b[214][a]}}b[215]="".split("");for(a=0;a!=b[215].length;++a){if(b[215][a].charCodeAt(0)!==65533){c[b[215][a]]=55040+a;f[55040+a]=b[215][a]}}b[216]="".split("");for(a=0;a!=b[216].length;++a){if(b[216][a].charCodeAt(0)!==65533){c[b[216][a]]=55296+a;f[55296+a]=b[216][a]}}b[217]="".split("");for(a=0;a!=b[217].length;++a){if(b[217][a].charCodeAt(0)!==65533){c[b[217][a]]=55552+a;f[55552+a]=b[217][a]}}b[218]="".split("");for(a=0;a!=b[218].length;++a){if(b[218][a].charCodeAt(0)!==65533){c[b[218][a]]=55808+a;f[55808+a]=b[218][a]}}b[219]="".split("");for(a=0;a!=b[219].length;++a){if(b[219][a].charCodeAt(0)!==65533){c[b[219][a]]=56064+a;f[56064+a]=b[219][a]}}b[220]="".split("");for(a=0;a!=b[220].length;++a){if(b[220][a].charCodeAt(0)!==65533){c[b[220][a]]=56320+a;f[56320+a]=b[220][a]}}b[221]="".split("");for(a=0;a!=b[221].length;++a){if(b[221][a].charCodeAt(0)!==65533){c[b[221][a]]=56576+a;f[56576+a]=b[221][a]}}b[222]="".split("");for(a=0;a!=b[222].length;++a){if(b[222][a].charCodeAt(0)!==65533){c[b[222][a]]=56832+a;f[56832+a]=b[222][a]}}b[223]="".split("");for(a=0;a!=b[223].length;++a){if(b[223][a].charCodeAt(0)!==65533){c[b[223][a]]=57088+a;f[57088+a]=b[223][a]}}b[224]="".split("");for(a=0;a!=b[224].length;++a){if(b[224][a].charCodeAt(0)!==65533){c[b[224][a]]=57344+a;f[57344+a]=b[224][a]}}b[225]="".split("");for(a=0;a!=b[225].length;++a){if(b[225][a].charCodeAt(0)!==65533){c[b[225][a]]=57600+a;f[57600+a]=b[225][a]}}b[226]="".split("");for(a=0;a!=b[226].length;++a){if(b[226][a].charCodeAt(0)!==65533){c[b[226][a]]=57856+a;f[57856+a]=b[226][a]}}b[227]="".split("");for(a=0;a!=b[227].length;++a){if(b[227][a].charCodeAt(0)!==65533){c[b[227][a]]=58112+a;f[58112+a]=b[227][a]}}b[228]="".split("");for(a=0;a!=b[228].length;++a){if(b[228][a].charCodeAt(0)!==65533){c[b[228][a]]=58368+a;f[58368+a]=b[228][a]}}b[229]="".split("");for(a=0;a!=b[229].length;++a){if(b[229][a].charCodeAt(0)!==65533){c[b[229][a]]=58624+a;f[58624+a]=b[229][a]}}b[230]="".split("");for(a=0;a!=b[230].length;++a){if(b[230][a].charCodeAt(0)!==65533){c[b[230][a]]=58880+a;f[58880+a]=b[230][a]}}b[231]="".split("");for(a=0;a!=b[231].length;++a){if(b[231][a].charCodeAt(0)!==65533){c[b[231][a]]=59136+a;f[59136+a]=b[231][a]}}b[232]="".split("");for(a=0;a!=b[232].length;++a){if(b[232][a].charCodeAt(0)!==65533){c[b[232][a]]=59392+a;f[59392+a]=b[232][a]}}b[233]="".split("");for(a=0;a!=b[233].length;++a){if(b[233][a].charCodeAt(0)!==65533){c[b[233][a]]=59648+a;f[59648+a]=b[233][a]}}b[234]="".split("");for(a=0;a!=b[234].length;++a){if(b[234][a].charCodeAt(0)!==65533){c[b[234][a]]=59904+a;f[59904+a]=b[234][a]}}b[235]="".split("");for(a=0;a!=b[235].length;++a){if(b[235][a].charCodeAt(0)!==65533){c[b[235][a]]=60160+a;f[60160+a]=b[235][a]}}b[236]="".split("");for(a=0;a!=b[236].length;++a){if(b[236][a].charCodeAt(0)!==65533){c[b[236][a]]=60416+a;f[60416+a]=b[236][a]}}b[237]="".split("");for(a=0;a!=b[237].length;++a){if(b[237][a].charCodeAt(0)!==65533){c[b[237][a]]=60672+a;f[60672+a]=b[237][a]}}b[238]="".split("");for(a=0;a!=b[238].length;++a){if(b[238][a].charCodeAt(0)!==65533){c[b[238][a]]=60928+a;f[60928+a]=b[238][a]}}b[239]="".split("");for(a=0;a!=b[239].length;++a){if(b[239][a].charCodeAt(0)!==65533){c[b[239][a]]=61184+a;f[61184+a]=b[239][a]}}b[240]="".split("");for(a=0;a!=b[240].length;++a){if(b[240][a].charCodeAt(0)!==65533){c[b[240][a]]=61440+a;f[61440+a]=b[240][a]}}b[241]="".split("");for(a=0;a!=b[241].length;++a){if(b[241][a].charCodeAt(0)!==65533){c[b[241][a]]=61696+a;f[61696+a]=b[241][a]}}b[242]="".split("");for(a=0;a!=b[242].length;++a){if(b[242][a].charCodeAt(0)!==65533){c[b[242][a]]=61952+a;f[61952+a]=b[242][a]}}b[243]="".split("");for(a=0;a!=b[243].length;++a){if(b[243][a].charCodeAt(0)!==65533){c[b[243][a]]=62208+a;f[62208+a]=b[243][a]}}b[244]="".split("");for(a=0;a!=b[244].length;++a){if(b[244][a].charCodeAt(0)!==65533){c[b[244][a]]=62464+a;f[62464+a]=b[244][a]}}b[245]="".split("");for(a=0;a!=b[245].length;++a){if(b[245][a].charCodeAt(0)!==65533){c[b[245][a]]=62720+a;f[62720+a]=b[245][a]}}b[246]="".split("");for(a=0;a!=b[246].length;++a){if(b[246][a].charCodeAt(0)!==65533){c[b[246][a]]=62976+a;f[62976+a]=b[246][a]}}b[247]="".split("");for(a=0;a!=b[247].length;++a){if(b[247][a].charCodeAt(0)!==65533){c[b[247][a]]=63232+a;f[63232+a]=b[247][a]}}b[248]="".split("");for(a=0;a!=b[248].length;++a){if(b[248][a].charCodeAt(0)!==65533){c[b[248][a]]=63488+a;f[63488+a]=b[248][a]}}b[249]="".split("");for(a=0;a!=b[249].length;++a){if(b[249][a].charCodeAt(0)!==65533){c[b[249][a]]=63744+a;f[63744+a]=b[249][a]}}b[250]="".split("");for(a=0;a!=b[250].length;++a){if(b[250][a].charCodeAt(0)!==65533){c[b[250][a]]=64000+a;f[64000+a]=b[250][a]}}b[251]="".split("");for(a=0;a!=b[251].length;++a){if(b[251][a].charCodeAt(0)!==65533){c[b[251][a]]=64256+a;f[64256+a]=b[251][a]}}b[252]="".split("");for(a=0;a!=b[252].length;++a){if(b[252][a].charCodeAt(0)!==65533){c[b[252][a]]=64512+a;f[64512+a]=b[252][a]}}b[253]="".split("");for(a=0;a!=b[253].length;++a){if(b[253][a].charCodeAt(0)!==65533){c[b[253][a]]=64768+a;f[64768+a]=b[253][a]}}return{enc:c,dec:f}})();cptable[950]=(function(){var f=[],c={},b=[],a;b[0]="\x00\x01\x02\x03\x04\x05\x06\x07\b\t\n\v\f\r\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~".split("");for(a=0;a!=b[0].length;++a){if(b[0][a].charCodeAt(0)!==65533){c[b[0][a]]=0+a;f[0+a]=b[0][a]}}b[161]="\u3000\u2027\u2026\u2025\u2013\u2014\u2018\u2019\u201c\u201d\u2035\u2032\u203b".split("");for(a=0;a!=b[161].length;++a){if(b[161][a].charCodeAt(0)!==65533){c[b[161][a]]=41216+a;f[41216+a]=b[161][a]}}b[162]="".split("");for(a=0;a!=b[162].length;++a){if(b[162][a].charCodeAt(0)!==65533){c[b[162][a]]=41472+a;f[41472+a]=b[162][a]}}b[163]="".split("");for(a=0;a!=b[163].length;++a){if(b[163][a].charCodeAt(0)!==65533){c[b[163][a]]=41728+a;f[41728+a]=b[163][a]}}b[164]="".split("");for(a=0;a!=b[164].length;++a){if(b[164][a].charCodeAt(0)!==65533){c[b[164][a]]=41984+a;f[41984+a]=b[164][a]}}b[165]="".split("");for(a=0;a!=b[165].length;++a){if(b[165][a].charCodeAt(0)!==65533){c[b[165][a]]=42240+a;f[42240+a]=b[165][a]}}b[166]="".split("");for(a=0;a!=b[166].length;++a){if(b[166][a].charCodeAt(0)!==65533){c[b[166][a]]=42496+a;f[42496+a]=b[166][a]}}b[167]="".split("");for(a=0;a!=b[167].length;++a){if(b[167][a].charCodeAt(0)!==65533){c[b[167][a]]=42752+a;f[42752+a]=b[167][a]}}b[168]="".split("");for(a=0;a!=b[168].length;++a){if(b[168][a].charCodeAt(0)!==65533){c[b[168][a]]=43008+a;f[43008+a]=b[168][a]}}b[169]="".split("");for(a=0;a!=b[169].length;++a){if(b[169][a].charCodeAt(0)!==65533){c[b[169][a]]=43264+a;f[43264+a]=b[169][a]}}b[170]="".split("");for(a=0;a!=b[170].length;++a){if(b[170][a].charCodeAt(0)!==65533){c[b[170][a]]=43520+a;f[43520+a]=b[170][a]}}b[171]="".split("");for(a=0;a!=b[171].length;++a){if(b[171][a].charCodeAt(0)!==65533){c[b[171][a]]=43776+a;f[43776+a]=b[171][a]}}b[172]="".split("");for(a=0;a!=b[172].length;++a){if(b[172][a].charCodeAt(0)!==65533){c[b[172][a]]=44032+a;f[44032+a]=b[172][a]}}b[173]="".split("");for(a=0;a!=b[173].length;++a){if(b[173][a].charCodeAt(0)!==65533){c[b[173][a]]=44288+a;f[44288+a]=b[173][a]}}b[174]="".split("");for(a=0;a!=b[174].length;++a){if(b[174][a].charCodeAt(0)!==65533){c[b[174][a]]=44544+a;f[44544+a]=b[174][a]}}b[175]="".split("");for(a=0;a!=b[175].length;++a){if(b[175][a].charCodeAt(0)!==65533){c[b[175][a]]=44800+a;f[44800+a]=b[175][a]}}b[176]="".split("");for(a=0;a!=b[176].length;++a){if(b[176][a].charCodeAt(0)!==65533){c[b[176][a]]=45056+a;f[45056+a]=b[176][a]}}b[177]="".split("");for(a=0;a!=b[177].length;++a){if(b[177][a].charCodeAt(0)!==65533){c[b[177][a]]=45312+a;f[45312+a]=b[177][a]}}b[178]="".split("");for(a=0;a!=b[178].length;++a){if(b[178][a].charCodeAt(0)!==65533){c[b[178][a]]=45568+a;f[45568+a]=b[178][a]}}b[179]="".split("");for(a=0;a!=b[179].length;++a){if(b[179][a].charCodeAt(0)!==65533){c[b[179][a]]=45824+a;f[45824+a]=b[179][a]}}b[180]="".split("");for(a=0;a!=b[180].length;++a){if(b[180][a].charCodeAt(0)!==65533){c[b[180][a]]=46080+a;f[46080+a]=b[180][a]}}b[181]="".split("");for(a=0;a!=b[181].length;++a){if(b[181][a].charCodeAt(0)!==65533){c[b[181][a]]=46336+a;f[46336+a]=b[181][a]}}b[182]="".split("");for(a=0;a!=b[182].length;++a){if(b[182][a].charCodeAt(0)!==65533){c[b[182][a]]=46592+a;f[46592+a]=b[182][a]}}b[183]="".split("");for(a=0;a!=b[183].length;++a){if(b[183][a].charCodeAt(0)!==65533){c[b[183][a]]=46848+a;f[46848+a]=b[183][a]}}b[184]="".split("");for(a=0;a!=b[184].length;++a){if(b[184][a].charCodeAt(0)!==65533){c[b[184][a]]=47104+a;f[47104+a]=b[184][a]}}b[185]="".split("");for(a=0;a!=b[185].length;++a){if(b[185][a].charCodeAt(0)!==65533){c[b[185][a]]=47360+a;f[47360+a]=b[185][a]}}b[186]="".split("");for(a=0;a!=b[186].length;++a){if(b[186][a].charCodeAt(0)!==65533){c[b[186][a]]=47616+a;f[47616+a]=b[186][a]}}b[187]="".split("");for(a=0;a!=b[187].length;++a){if(b[187][a].charCodeAt(0)!==65533){c[b[187][a]]=47872+a;f[47872+a]=b[187][a]}}b[188]="".split("");for(a=0;a!=b[188].length;++a){if(b[188][a].charCodeAt(0)!==65533){c[b[188][a]]=48128+a;f[48128+a]=b[188][a]}}b[189]="".split("");for(a=0;a!=b[189].length;++a){if(b[189][a].charCodeAt(0)!==65533){c[b[189][a]]=48384+a;f[48384+a]=b[189][a]}}b[190]="".split("");for(a=0;a!=b[190].length;++a){if(b[190][a].charCodeAt(0)!==65533){c[b[190][a]]=48640+a;f[48640+a]=b[190][a]}}b[191]="".split("");for(a=0;a!=b[191].length;++a){if(b[191][a].charCodeAt(0)!==65533){c[b[191][a]]=48896+a;f[48896+a]=b[191][a]}}b[192]="".split("");for(a=0;a!=b[192].length;++a){if(b[192][a].charCodeAt(0)!==65533){c[b[192][a]]=49152+a;f[49152+a]=b[192][a]}}b[193]="".split("");for(a=0;a!=b[193].length;++a){if(b[193][a].charCodeAt(0)!==65533){c[b[193][a]]=49408+a;f[49408+a]=b[193][a]}}b[194]="".split("");for(a=0;a!=b[194].length;++a){if(b[194][a].charCodeAt(0)!==65533){c[b[194][a]]=49664+a;f[49664+a]=b[194][a]}}b[195]="".split("");for(a=0;a!=b[195].length;++a){if(b[195][a].charCodeAt(0)!==65533){c[b[195][a]]=49920+a;f[49920+a]=b[195][a]}}b[196]="".split("");for(a=0;a!=b[196].length;++a){if(b[196][a].charCodeAt(0)!==65533){c[b[196][a]]=50176+a;f[50176+a]=b[196][a]}}b[197]="".split("");for(a=0;a!=b[197].length;++a){if(b[197][a].charCodeAt(0)!==65533){c[b[197][a]]=50432+a;f[50432+a]=b[197][a]}}b[198]="".split("");for(a=0;a!=b[198].length;++a){if(b[198][a].charCodeAt(0)!==65533){c[b[198][a]]=50688+a;f[50688+a]=b[198][a]}}b[201]="".split("");for(a=0;a!=b[201].length;++a){if(b[201][a].charCodeAt(0)!==65533){c[b[201][a]]=51456+a;f[51456+a]=b[201][a]}}b[202]="".split("");for(a=0;a!=b[202].length;++a){if(b[202][a].charCodeAt(0)!==65533){c[b[202][a]]=51712+a;f[51712+a]=b[202][a]}}b[203]="".split("");for(a=0;a!=b[203].length;++a){if(b[203][a].charCodeAt(0)!==65533){c[b[203][a]]=51968+a;f[51968+a]=b[203][a]}}b[204]="".split("");for(a=0;a!=b[204].length;++a){if(b[204][a].charCodeAt(0)!==65533){c[b[204][a]]=52224+a;f[52224+a]=b[204][a]}}b[205]="".split("");for(a=0;a!=b[205].length;++a){if(b[205][a].charCodeAt(0)!==65533){c[b[205][a]]=52480+a;f[52480+a]=b[205][a]}}b[206]="".split("");for(a=0;a!=b[206].length;++a){if(b[206][a].charCodeAt(0)!==65533){c[b[206][a]]=52736+a;f[52736+a]=b[206][a]}}b[207]="".split("");for(a=0;a!=b[207].length;++a){if(b[207][a].charCodeAt(0)!==65533){c[b[207][a]]=52992+a;f[52992+a]=b[207][a]}}b[208]="".split("");for(a=0;a!=b[208].length;++a){if(b[208][a].charCodeAt(0)!==65533){c[b[208][a]]=53248+a;f[53248+a]=b[208][a]}}b[209]="".split("");for(a=0;a!=b[209].length;++a){if(b[209][a].charCodeAt(0)!==65533){c[b[209][a]]=53504+a;f[53504+a]=b[209][a]}}b[210]="".split("");for(a=0;a!=b[210].length;++a){if(b[210][a].charCodeAt(0)!==65533){c[b[210][a]]=53760+a;f[53760+a]=b[210][a]}}b[211]="".split("");for(a=0;a!=b[211].length;++a){if(b[211][a].charCodeAt(0)!==65533){c[b[211][a]]=54016+a;f[54016+a]=b[211][a]}}b[212]="".split("");for(a=0;a!=b[212].length;++a){if(b[212][a].charCodeAt(0)!==65533){c[b[212][a]]=54272+a;f[54272+a]=b[212][a]}}b[213]="".split("");for(a=0;a!=b[213].length;++a){if(b[213][a].charCodeAt(0)!==65533){c[b[213][a]]=54528+a;f[54528+a]=b[213][a]}}b[214]="".split("");for(a=0;a!=b[214].length;++a){if(b[214][a].charCodeAt(0)!==65533){c[b[214][a]]=54784+a;f[54784+a]=b[214][a]}}b[215]="".split("");for(a=0;a!=b[215].length;++a){if(b[215][a].charCodeAt(0)!==65533){c[b[215][a]]=55040+a;f[55040+a]=b[215][a]}}b[216]="".split("");for(a=0;a!=b[216].length;++a){if(b[216][a].charCodeAt(0)!==65533){c[b[216][a]]=55296+a;f[55296+a]=b[216][a]}}b[217]="".split("");for(a=0;a!=b[217].length;++a){if(b[217][a].charCodeAt(0)!==65533){c[b[217][a]]=55552+a;f[55552+a]=b[217][a]}}b[218]="".split("");for(a=0;a!=b[218].length;++a){if(b[218][a].charCodeAt(0)!==65533){c[b[218][a]]=55808+a;f[55808+a]=b[218][a]}}b[219]="".split("");for(a=0;a!=b[219].length;++a){if(b[219][a].charCodeAt(0)!==65533){c[b[219][a]]=56064+a;f[56064+a]=b[219][a]}}b[220]="".split("");for(a=0;a!=b[220].length;++a){if(b[220][a].charCodeAt(0)!==65533){c[b[220][a]]=56320+a;f[56320+a]=b[220][a]}}b[221]="".split("");for(a=0;a!=b[221].length;++a){if(b[221][a].charCodeAt(0)!==65533){c[b[221][a]]=56576+a;f[56576+a]=b[221][a]}}b[222]="".split("");for(a=0;a!=b[222].length;++a){if(b[222][a].charCodeAt(0)!==65533){c[b[222][a]]=56832+a;f[56832+a]=b[222][a]}}b[223]="".split("");for(a=0;a!=b[223].length;++a){if(b[223][a].charCodeAt(0)!==65533){c[b[223][a]]=57088+a;f[57088+a]=b[223][a]}}b[224]="".split("");for(a=0;a!=b[224].length;++a){if(b[224][a].charCodeAt(0)!==65533){c[b[224][a]]=57344+a;f[57344+a]=b[224][a]}}b[225]="".split("");for(a=0;a!=b[225].length;++a){if(b[225][a].charCodeAt(0)!==65533){c[b[225][a]]=57600+a;f[57600+a]=b[225][a]}}b[226]="".split("");for(a=0;a!=b[226].length;++a){if(b[226][a].charCodeAt(0)!==65533){c[b[226][a]]=57856+a;f[57856+a]=b[226][a]}}b[227]="".split("");for(a=0;a!=b[227].length;++a){if(b[227][a].charCodeAt(0)!==65533){c[b[227][a]]=58112+a;f[58112+a]=b[227][a]}}b[228]="".split("");for(a=0;a!=b[228].length;++a){if(b[228][a].charCodeAt(0)!==65533){c[b[228][a]]=58368+a;f[58368+a]=b[228][a]}}b[229]="".split("");for(a=0;a!=b[229].length;++a){if(b[229][a].charCodeAt(0)!==65533){c[b[229][a]]=58624+a;f[58624+a]=b[229][a]}}b[230]="".split("");for(a=0;a!=b[230].length;++a){if(b[230][a].charCodeAt(0)!==65533){c[b[230][a]]=58880+a;f[58880+a]=b[230][a]}}b[231]="".split("");for(a=0;a!=b[231].length;++a){if(b[231][a].charCodeAt(0)!==65533){c[b[231][a]]=59136+a;f[59136+a]=b[231][a]}}b[232]="".split("");for(a=0;a!=b[232].length;++a){if(b[232][a].charCodeAt(0)!==65533){c[b[232][a]]=59392+a;f[59392+a]=b[232][a]}}b[233]="".split("");for(a=0;a!=b[233].length;++a){if(b[233][a].charCodeAt(0)!==65533){c[b[233][a]]=59648+a;f[59648+a]=b[233][a]}}b[234]="".split("");for(a=0;a!=b[234].length;++a){if(b[234][a].charCodeAt(0)!==65533){c[b[234][a]]=59904+a;f[59904+a]=b[234][a]}}b[235]="".split("");for(a=0;a!=b[235].length;++a){if(b[235][a].charCodeAt(0)!==65533){c[b[235][a]]=60160+a;f[60160+a]=b[235][a]}}b[236]="".split("");for(a=0;a!=b[236].length;++a){if(b[236][a].charCodeAt(0)!==65533){c[b[236][a]]=60416+a;f[60416+a]=b[236][a]}}b[237]="".split("");for(a=0;a!=b[237].length;++a){if(b[237][a].charCodeAt(0)!==65533){c[b[237][a]]=60672+a;f[60672+a]=b[237][a]}}b[238]="".split("");for(a=0;a!=b[238].length;++a){if(b[238][a].charCodeAt(0)!==65533){c[b[238][a]]=60928+a;f[60928+a]=b[238][a]}}b[239]="".split("");for(a=0;a!=b[239].length;++a){if(b[239][a].charCodeAt(0)!==65533){c[b[239][a]]=61184+a;f[61184+a]=b[239][a]}}b[240]="".split("");for(a=0;a!=b[240].length;++a){if(b[240][a].charCodeAt(0)!==65533){c[b[240][a]]=61440+a;f[61440+a]=b[240][a]}}b[241]="".split("");for(a=0;a!=b[241].length;++a){if(b[241][a].charCodeAt(0)!==65533){c[b[241][a]]=61696+a;f[61696+a]=b[241][a]}}b[242]="".split("");for(a=0;a!=b[242].length;++a){if(b[242][a].charCodeAt(0)!==65533){c[b[242][a]]=61952+a;f[61952+a]=b[242][a]}}b[243]="".split("");for(a=0;a!=b[243].length;++a){if(b[243][a].charCodeAt(0)!==65533){c[b[243][a]]=62208+a;f[62208+a]=b[243][a]}}b[244]="".split("");for(a=0;a!=b[244].length;++a){if(b[244][a].charCodeAt(0)!==65533){c[b[244][a]]=62464+a;f[62464+a]=b[244][a]}}b[245]="".split("");for(a=0;a!=b[245].length;++a){if(b[245][a].charCodeAt(0)!==65533){c[b[245][a]]=62720+a;f[62720+a]=b[245][a]}}b[246]="".split("");for(a=0;a!=b[246].length;++a){if(b[246][a].charCodeAt(0)!==65533){c[b[246][a]]=62976+a;f[62976+a]=b[246][a]}}b[247]="".split("");for(a=0;a!=b[247].length;++a){if(b[247][a].charCodeAt(0)!==65533){c[b[247][a]]=63232+a;f[63232+a]=b[247][a]}}b[248]="".split("");for(a=0;a!=b[248].length;++a){if(b[248][a].charCodeAt(0)!==65533){c[b[248][a]]=63488+a;f[63488+a]=b[248][a]}}b[249]="".split("");for(a=0;a!=b[249].length;++a){if(b[249][a].charCodeAt(0)!==65533){c[b[249][a]]=63744+a;f[63744+a]=b[249][a]}}return{enc:c,dec:f}})();cptable[1250]=(function(){var f="\x00\x01\x02\x03\x04\x05\x06\x07\b\t\n\v\f\r\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\u201a\u201e\u2026\u2020\u2021\u2030\u2039\u2018\u2019\u201c\u201d\u2022\u2013\u2014\u203a\xa0",c=[],b={};for(var a=0;a!=f.length;++a){if(f.charCodeAt(a)!==65533){b[f[a]]=a}c[a]=f.charAt(a)}return{enc:b,dec:c}})();cptable[1251]=(function(){var f="\x00\x01\x02\x03\x04\x05\x06\x07\b\t\n\v\f\r\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\u201a\u201e\u2026\u2020\u2021\u2030\u2039\u2018\u2019\u201c\u201d\u2022\u2013\u2014\u203a\xa0",c=[],b={};for(var a=0;a!=f.length;++a){if(f.charCodeAt(a)!==65533){b[f[a]]=a}c[a]=f.charAt(a)}return{enc:b,dec:c}})();cptable[1252]=(function(){var f="\x00\x01\x02\x03\x04\x05\x06\x07\b\t\n\v\f\r\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\u201a\u201e\u2026\u2020\u2021\u2030\u2039\u2018\u2019\u201c\u201d\u2022\u2013\u2014\u203a\xa0",c=[],b={};for(var a=0;a!=f.length;++a){if(f.charCodeAt(a)!==65533){b[f[a]]=a}c[a]=f.charAt(a)}return{enc:b,dec:c}})();cptable[1253]=(function(){var f="\x00\x01\x02\x03\x04\x05\x06\x07\b\t\n\v\f\r\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\u201a\u201e\u2026\u2020\u2021\u2030\u2039\u2018\u2019\u201c\u201d\u2022\u2013\u2014\u203a\xa0\u2015",c=[],b={};for(var a=0;a!=f.length;++a){if(f.charCodeAt(a)!==65533){b[f[a]]=a}c[a]=f.charAt(a)}return{enc:b,dec:c}})();cptable[1254]=(function(){var f="\x00\x01\x02\x03\x04\x05\x06\x07\b\t\n\v\f\r\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\u201a\u201e\u2026\u2020\u2021\u2030\u2039\u2018\u2019\u201c\u201d\u2022\u2013\u2014\u203a\xa0",c=[],b={};for(var a=0;a!=f.length;++a){if(f.charCodeAt(a)!==65533){b[f[a]]=a}c[a]=f.charAt(a)}return{enc:b,dec:c}})();cptable[1255]=(function(){var f="\x00\x01\x02\x03\x04\x05\x06\x07\b\t\n\v\f\r\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\u201a\u201e\u2026\u2020\u2021\u2030\u2039\u2018\u2019\u201c\u201d\u2022\u2013\u2014\u203a\xa0\u200e\u200f",c=[],b={};for(var a=0;a!=f.length;++a){if(f.charCodeAt(a)!==65533){b[f[a]]=a}c[a]=f.charAt(a)}return{enc:b,dec:c}})();cptable[1256]=(function(){var f="\x00\x01\x02\x03\x04\x05\x06\x07\b\t\n\v\f\r\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\u201a\u201e\u2026\u2020\u2021\u2030\u2039\u2018\u2019\u201c\u201d\u2022\u2013\u2014\u203a\u200c\u200d\xa0\u200e\u200f",c=[],b={};for(var a=0;a!=f.length;++a){if(f.charCodeAt(a)!==65533){b[f[a]]=a}c[a]=f.charAt(a)}return{enc:b,dec:c}})();cptable[1257]=(function(){var f="\x00\x01\x02\x03\x04\x05\x06\x07\b\t\n\v\f\r\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\u201a\u201e\u2026\u2020\u2021\u2030\u2039\u2018\u2019\u201c\u201d\u2022\u2013\u2014\u203a\xa0",c=[],b={};for(var a=0;a!=f.length;++a){if(f.charCodeAt(a)!==65533){b[f[a]]=a}c[a]=f.charAt(a)}return{enc:b,dec:c}})();cptable[1258]=(function(){var f="\x00\x01\x02\x03\x04\x05\x06\x07\b\t\n\v\f\r\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\u201a\u201e\u2026\u2020\u2021\u2030\u2039\u2018\u2019\u201c\u201d\u2022\u2013\u2014\u203a\xa0",c=[],b={};for(var a=0;a!=f.length;++a){if(f.charCodeAt(a)!==65533){b[f[a]]=a}c[a]=f.charAt(a)}return{enc:b,dec:c}})();cptable[10000]=(function(){var f="\x00\x01\x02\x03\x04\x05\x06\x07\b\t\n\v\f\r\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\u2020\u2022\u2026\xa0\u2013\u2014\u201c\u201d\u2018\u2019\u2044\u2039\u203a\u2021\u201a\u201e\u2030",c=[],b={};for(var a=0;a!=f.length;++a){if(f.charCodeAt(a)!==65533){b[f[a]]=a}c[a]=f.charAt(a)}return{enc:b,dec:c}})();cptable[10006]=(function(){var f="\x00\x01\x02\x03\x04\x05\x06\x07\b\t\n\v\f\r\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\u2022\u2030\u2020\u2026\xa0\u2013\u2015\u201c\u201d\u2018\u2019",c=[],b={};for(var a=0;a!=f.length;++a){if(f.charCodeAt(a)!==65533){b[f[a]]=a}c[a]=f.charAt(a)}return{enc:b,dec:c}})();cptable[10007]=(function(){var f="\x00\x01\x02\x03\x04\x05\x06\x07\b\t\n\v\f\r\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\u2020\u2022\u2026\xa0\u2013\u2014\u201c\u201d\u2018\u2019\u201e",c=[],b={};for(var a=0;a!=f.length;++a){if(f.charCodeAt(a)!==65533){b[f[a]]=a}c[a]=f.charAt(a)}return{enc:b,dec:c}})();cptable[10029]=(function(){var f="\x00\x01\x02\x03\x04\x05\x06\x07\b\t\n\v\f\r\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\u2020\u2022\u2026\xa0\u2013\u2014\u201c\u201d\u2018\u2019\u2039\u203a\u201a\u201e",c=[],b={};for(var a=0;a!=f.length;++a){if(f.charCodeAt(a)!==65533){b[f[a]]=a}c[a]=f.charAt(a)}return{enc:b,dec:c}})();cptable[10079]=(function(){var f="\x00\x01\x02\x03\x04\x05\x06\x07\b\t\n\v\f\r\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\u2022\u2026\xa0\u2013\u2014\u201c\u201d\u2018\u2019\u2044\u201a\u201e\u2030",c=[],b={};for(var a=0;a!=f.length;++a){if(f.charCodeAt(a)!==65533){b[f[a]]=a}c[a]=f.charAt(a)}return{enc:b,dec:c}})();cptable[10081]=(function(){var f="\x00\x01\x02\x03\x04\x05\x06\x07\b\t\n\v\f\r\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\u2020\u2022\u2026\xa0\u2013\u2014\u201c\u201d\u2018\u2019\u2021\u201a\u201e\u2030",c=[],b={};for(var a=0;a!=f.length;++a){if(f.charCodeAt(a)!==65533){b[f[a]]=a}c[a]=f.charAt(a)}return{enc:b,dec:c}})();if(typeof module!=="undefined"&&module.exports){module.exports=cptable}(function(a,b){if(typeof cptable==="undefined"){if(typeof require!=="undefined"){var c=require("./cptable");if(typeof module!=="undefined"&&module.exports){module.exports=b(c)}else{a.cptable=b(c)}}else{throw new Error("cptable not found")}}else{cptable=b(cptable)}}(this,function(r){var m={"1200":"utf16le","1201":"utf16be","12000":"utf32le","12001":"utf32be","16969":"utf64le","20127":"ascii","65000":"utf7","65001":"utf8"};var n=[874,1250,1251,1252,1253,1254,1255,1256,10000];var y=[932,936,949,950];var p=[65001];var s={};var g={};var c={};var H={};var f=function f(J){return String.fromCharCode(J)};var q=function q(J){return J.charCodeAt(0)};if(typeof Buffer!=="undefined"){var b=1024,j=new Buffer(b);var F=function F(O){var L=new Buffer(65536);for(var M=0;M<65536;++M){L[M]=0}var N=Object.keys(O),J=N.length;for(var K=0,P=N[K];K<J;++K){if(!(P=N[K])){continue}L[P.charCodeAt(0)]=O[P]}return L};var B=function A(L){var J=F(r[L].enc);return function K(R,T){var M=R.length;var P,Q,O,S,N;if(typeof R==="string"){P=Buffer(M);for(Q=0;Q<M;++Q){P[Q]=J[R.charCodeAt(Q)]}}else{if(Buffer.isBuffer(R)){P=Buffer(2*M);O=0;for(Q=0;Q<M;++Q){S=R[Q];if(S<128){P[O++]=J[S]}else{if(S<224){P[O++]=J[((S&31)<<6)+(R[Q+1]&63)];++Q}else{if(S<240){P[O++]=J[((S&15)<<12)+((R[Q+1]&63)<<6)+(R[Q+2]&63)];Q+=2}else{N=((S&7)<<18)+((R[Q+1]&63)<<12)+((R[Q+2]&63)<<6)+(R[Q+3]&63);Q+=3;if(N<65536){P[O++]=J[N]}else{N-=65536;P[O++]=J[55296+((N>>10)&1023)];P[O++]=J[56320+(N&1023)]}}}}}P.length=O}else{P=Buffer(M);for(Q=0;Q<M;++Q){P[Q]=J[R[Q].charCodeAt(0)]}}}if(T===undefined||T==="buf"){return P}if(T!=="arr"){return P.toString("binary")}return[].slice.call(P)}};var e=function d(N){var M=r[N].dec;var K=new Buffer(131072),O=0,P;for(O=0;O<M.length;++O){if(!(P=M[O])){continue}var J=P.charCodeAt(0);K[2*O]=J&255;K[2*O+1]=J>>8}return function L(T){var Q=T.length,S=0,R;if(2*Q>b){b=2*Q;j=new Buffer(b)}if(Buffer.isBuffer(T)){for(S=0;S<Q;S++){R=2*T[S];j[2*S]=K[R];j[2*S+1]=K[R+1]}}else{if(typeof T==="string"){for(S=0;S<Q;S++){R=2*T.charCodeAt(S);j[2*S]=K[R];j[2*S+1]=K[R+1]}}else{for(S=0;S<Q;S++){R=2*T[S];j[2*S]=K[R];j[2*S+1]=K[R+1]}}}j.length=2*Q;return j.toString("ucs2")}};var a=function x(N){var Q=r[N].enc;var R=new Buffer(131072);for(var J=0;J<131072;++J){R[J]=0}var P=Object.keys(Q);for(var K=0,M=P[K];K<P.length;++K){if(!(M=P[K])){continue}var L=M.charCodeAt(0);R[2*L]=Q[M]&255;R[2*L+1]=Q[M]>>8}return function O(X,T){var aa=X.length,V=new Buffer(2*aa),Y,W,Z,U,S;if(typeof X==="string"){for(Y=U=0;Y<aa;++Y){W=X.charCodeAt(Y)*2;V[U++]=R[W+1]||R[W];if(R[W+1]>0){V[U++]=R[W]}}V.length=U}else{if(Buffer.isBuffer(X)){for(Y=U=0;Y<aa;++Y){S=X[Y];if(S<128){W=S}else{if(S<224){W=((S&31)<<6)+(X[Y+1]&63);++Y}else{if(S<240){W=((S&15)<<12)+((X[Y+1]&63)<<6)+(X[Y+2]&63);Y+=2}else{W=((S&7)<<18)+((X[Y+1]&63)<<12)+((X[Y+2]&63)<<6)+(X[Y+3]&63);Y+=3}}}if(W<65536){W*=2;V[U++]=R[W+1]||R[W];if(R[W+1]>0){V[U++]=R[W]}}else{Z=W-65536;W=2*(55296+((Z>>10)&1023));V[U++]=R[W+1]||R[W];if(R[W+1]>0){V[U++]=R[W]}W=2*(56320+(Z&1023));V[U++]=R[W+1]||R[W];if(R[W+1]>0){V[U++]=R[W]}}}V.length=U}else{for(Y=U=0;Y<aa;Y++){W=X[Y].charCodeAt(0)*2;V[U++]=R[W+1]||R[W];if(R[W+1]>0){V[U++]=R[W]}}}}if(T===undefined||T==="buf"){return V}if(T!=="arr"){return V.toString("binary")}return[].slice.call(V)}};var E=function D(P){var J=r[P].dec;var L=new Buffer(131072),N=0,O,Q=0,K=0,M=0;for(M=0;M<65536;++M){L[2*M]=255;L[2*M+1]=253}for(N=0;N<J.length;++N){if(!(O=J[N])){continue}Q=O.charCodeAt(0);K=2*N;L[K]=Q&255;L[K+1]=Q>>8}return function R(X){var S=X.length,V=new Buffer(2*S),W,U,T=0;if(Buffer.isBuffer(X)){for(W=0;W<S;W++){U=2*X[W];if(L[U]===255&&L[U+1]===253){U=2*((X[W]<<8)+X[W+1]);++W}V[T++]=L[U];V[T++]=L[U+1]}}else{if(typeof X==="string"){for(W=0;W<S;W++){U=2*X.charCodeAt(W);if(L[U]===255&&L[U+1]===253){U=2*((X.charCodeAt(W)<<8)+X.charCodeAt(W+1));++W}V[T++]=L[U];V[T++]=L[U+1]}}else{for(W=0;W<S;W++){U=2*X[W];if(L[U]===255&&L[U+1]===253){U=2*((X[W]<<8)+X[W+1]);++W}V[T++]=L[U];V[T++]=L[U+1]}}}V.length=T;return V.toString("ucs2")}};s[65001]=function o(O){var J=O.length,K=0,Q=0;if(4*J>b){b=4*J;j=new Buffer(b)}j.length=0;var N=0;if(J>=3&&O[0]==239){if(O[1]==187&&O[2]==191){N=3}}for(var M=1,L=0,P=0;N<J;N+=M){M=1;P=O[N];if(P<128){K=P}else{if(P<224){K=(P&31)*64+(O[N+1]&63);M=2}else{if(P<240){K=((P&15)<<12)+(O[N+1]&63)*64+(O[N+2]&63);M=3}else{K=(P&7)*262144+((O[N+1]&63)<<12)+(O[N+2]&63)*64+(O[N+3]&63);M=4}}}if(K<65536){j[L++]=K&255;j[L++]=K>>8}else{K-=65536;Q=55296+((K>>10)&1023);K=56320+(K&1023);j[L++]=Q&255;j[L++]=Q>>>8;j[L++]=K&255;j[L++]=(K>>>8)&255}}j.length=L;return j.toString("ucs2")};g[65001]=function l(N,P){var J=N.length,K=0,O=0,L=0;var Q=typeof N==="string";if(4*J>b){b=4*J;j=new Buffer(b)}for(var M=0;M<J;++M){K=Q?N.charCodeAt(M):N[M].charCodeAt(0);if(K<=127){j[L++]=K}else{if(K<=2047){j[L++]=192+(K>>6);j[L++]=128+(K&63)}else{if(K>=55296&&K<=57343){K-=55296;++M;O=(Q?N.charCodeAt(M):N[M].charCodeAt(0))-56320+(K<<10);j[L++]=240+((O>>>18)&7);j[L++]=144+((O>>>12)&63);j[L++]=128+((O>>>6)&63);j[L++]=128+(O&63)}else{j[L++]=224+(K>>12);j[L++]=128+((K>>6)&63);j[L++]=128+(K&63)}}}}j.length=L;if(P===undefined||P==="buf"){return j}if(P!=="arr"){return j.toString("binary")}return[].slice.call(j)}}var t=function t(){if(typeof Buffer!=="undefined"){if(H[n[0]]){return}var J,K;for(J=0;J<n.length;++J){K=n[J];if(r[K]){H[K]=e(K);c[K]=B(K)}}for(J=0;J<y.length;++J){K=y[J];if(r[K]){H[K]=E(K);c[K]=a(K)}}for(J=0;J<p.length;++J){K=p[J];if(s[K]){H[K]=s[K]}if(g[K]){c[K]=g[K]}}}};var i=function i(J){H[J]=c[J]=undefined};var G=function G(){if(typeof Buffer!=="undefined"){if(!H[n[0]]){return}n.forEach(i);y.forEach(i);p.forEach(i)}z=I=undefined};var v={encache:t,decache:G,sbcs:n,dbcs:y};t();var C="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789'(),-./:?";var z,I;var h=function h(V,P,K){if(V===I){return z(P,K)}if(c[V]!==undefined){z=c[I=V];return z(P,K)}if(typeof Buffer!=="undefined"&&Buffer.isBuffer(P)){P=P.toString("utf8")}var R=P.length;var L=typeof Buffer!=="undefined"?new Buffer(4*R):[],W,Q,N=0,U,S,O;var J=r[V],X,T;if(J&&(X=J.enc)){for(Q=0;Q<R;++Q,++N){W=X[P[Q]];L[N]=W&255;if(W>255){L[N]=W>>8;L[++N]=W&255}}}else{if((T=m[V])){switch(T){case"utf8":if(typeof Buffer!=="undefined"&&typeof P==="string"){L=new Buffer(P,T);N=L.length;break}for(Q=0;Q<R;++Q,++N){W=P[Q].charCodeAt(0);if(W<=127){L[N]=W}else{if(W<=2047){L[N]=192+(W>>6);L[++N]=128+(W&63)}else{if(W>=55296&&W<=57343){W-=55296;O=P[++Q].charCodeAt(0)-56320+(W<<10);L[N]=240+((O>>>18)&7);L[++N]=144+((O>>>12)&63);L[++N]=128+((O>>>6)&63);L[++N]=128+(O&63)}else{L[N]=224+(W>>12);L[++N]=128+((W>>6)&63);L[++N]=128+(W&63)}}}}break;case"ascii":if(typeof Buffer!=="undefined"&&typeof P==="string"){L=new Buffer(P,T);N=L.length;break}for(Q=0;Q<R;++Q,++N){W=P[Q].charCodeAt(0);if(W<=127){L[N]=W}else{throw new Error("bad ascii "+W)}}break;case"utf16le":if(typeof Buffer!=="undefined"&&typeof P==="string"){L=new Buffer(P,T);N=L.length;break}for(Q=0;Q<R;++Q){W=P[Q].charCodeAt(0);L[N++]=W&255;L[N++]=W>>8}break;case"utf16be":for(Q=0;Q<R;++Q){W=P[Q].charCodeAt(0);L[N++]=W>>8;L[N++]=W&255}break;case"utf32le":for(Q=0;Q<R;++Q){W=P[Q].charCodeAt(0);if(W>=55296&&W<=57343){W=65536+((W-55296)<<10)+(P[++Q].charCodeAt(0)-56320)}L[N++]=W&255;W>>=8;L[N++]=W&255;W>>=8;L[N++]=W&255;W>>=8;L[N++]=W&255}break;case"utf32be":for(Q=0;Q<R;++Q){W=P[Q].charCodeAt(0);if(W>=55296&&W<=57343){W=65536+((W-55296)<<10)+(P[++Q].charCodeAt(0)-56320)}L[N+3]=W&255;W>>=8;L[N+2]=W&255;W>>=8;L[N+1]=W&255;W>>=8;L[N]=W&255;W>>=8;N+=4}break;case"utf7":for(Q=0;Q<R;Q++){U=P[Q];if(U==="+"){L[N++]=43;L[N++]=45;continue}if(k.indexOf(U)>-1){L[N++]=U.charCodeAt(0);continue}S=h(1201,U);L[N++]=43;L[N++]=C.charCodeAt(S[0]>>2);L[N++]=C.charCodeAt(((S[0]&3)<<4)+((S[1]||0)>>4));L[N++]=C.charCodeAt(((S[1]&15)<<2)+((S[2]||0)>>6));L[N++]=45}break;default:throw new Error("Unsupported magic: "+V+" "+m[V])}}else{throw new Error("Unrecognized CP: "+V)}}L.length=N;if(typeof Buffer==="undefined"){return(K=="str")?L.map(f).join(""):L}if(K===undefined||K==="buf"){return L}if(K!=="arr"){return L.toString("binary")}return[].slice.call(L)};var w=function w(O,ag){var T;if((T=H[O])){return T(ag)}var af=ag.length,ae=new Array(af),R,ad,ac=1,ab=0,ah;var V=r[O],U,Q;if(V&&(U=V.dec)){if(typeof ag==="string"){ag=ag.split("").map(q)}for(ad=0;ad<af;ad+=ac){ac=2;R=U[(ag[ad]<<8)+ag[ad+1]];if(!R){ac=1;R=U[ag[ad]]}if(!R){throw new Error("Unrecognized code: "+ag[ad]+" "+ag[ad+ac-1]+" "+ad+" "+ac+" "+U[ag[ad]])}ae[ab++]=R}}else{if((Q=m[O])){switch(Q){case"utf8":ad=0;if(af>=3&&ag[0]==239){if(ag[1]==187&&ag[2]==191){ad=3}}for(;ad<af;ad+=ac){ac=1;if(ag[ad]<128){R=ag[ad]}else{if(ag[ad]<224){R=(ag[ad]&31)*64+(ag[ad+1]&63);ac=2}else{if(ag[ad]<240){R=((ag[ad]&15)<<12)+(ag[ad+1]&63)*64+(ag[ad+2]&63);ac=3}else{R=(ag[ad]&7)*262144+((ag[ad+1]&63)<<12)+(ag[ad+2]&63)*64+(ag[ad+3]&63);ac=4}}}if(R<65536){ae[ab++]=String.fromCharCode(R)}else{R-=65536;ah=55296+((R>>10)&1023);R=56320+(R&1023);ae[ab++]=String.fromCharCode(ah);ae[ab++]=String.fromCharCode(R)}}break;case"ascii":if(typeof Buffer!=="undefined"&&Buffer.isBuffer(ag)){return ag.toString(Q)}for(ad=0;ad<af;ad++){ae[ad]=String.fromCharCode(ag[ad])}ab=af;break;case"utf16le":ad=0;if(af>=2&&ag[0]==255){if(ag[1]==254){ad=2}}if(typeof Buffer!=="undefined"&&Buffer.isBuffer(ag)){return ag.toString(Q)}ac=2;for(;ad<af;ad+=ac){ae[ab++]=String.fromCharCode((ag[ad+1]<<8)+ag[ad])}break;case"utf16be":ad=0;if(af>=2&&ag[0]==254){if(ag[1]==255){ad=2}}ac=2;for(;ad<af;ad+=ac){ae[ab++]=String.fromCharCode((ag[ad]<<8)+ag[ad+1])}break;case"utf32le":ad=0;if(af>=4&&ag[0]==255){if(ag[1]==254&&ag[2]==0&&ag[3]==0){ad=4}}ac=4;for(;ad<af;ad+=ac){R=(ag[ad+3]<<24)+(ag[ad+2]<<16)+(ag[ad+1]<<8)+(ag[ad]);if(R>65535){R-=65536;ae[ab++]=String.fromCharCode(55296+((R>>10)&1023));ae[ab++]=String.fromCharCode(56320+(R&1023))}else{ae[ab++]=String.fromCharCode(R)}}break;case"utf32be":ad=0;if(af>=4&&ag[3]==255){if(ag[2]==254&&ag[1]==0&&ag[0]==0){ad=4}}ac=4;for(;ad<af;ad+=ac){R=(ag[ad]<<24)+(ag[ad+1]<<16)+(ag[ad+2]<<8)+(ag[ad+3]);if(R>65535){R-=65536;ae[ab++]=String.fromCharCode(55296+((R>>10)&1023));ae[ab++]=String.fromCharCode(56320+(R&1023))}else{ae[ab++]=String.fromCharCode(R)}}break;case"utf7":ad=0;if(af>=4&&ag[0]==43&&ag[1]==47&&ag[2]==118){if(af>=5&&ag[3]==56&&ag[4]==45){ad=5}else{if(ag[3]==56||ag[3]==57||ag[3]==43||ag[3]==47){ad=4}}}for(;ad<af;ad+=ac){if(ag[ad]!==43){ac=1;ae[ab++]=String.fromCharCode(ag[ad]);continue}ac=1;if(ag[ad+1]===45){ac=2;ae[ab++]="+";continue}while(String.fromCharCode(ag[ad+ac]).match(/[A-Za-z0-9+\/]/)){ac++}var S=0;if(ag[ad+ac]===45){++ac;S=1}var J=[];var Z;var Y,X,W;var P,N,L,K;for(var aa=1;aa<ac-S;){P=C.indexOf(String.fromCharCode(ag[ad+aa++]));N=C.indexOf(String.fromCharCode(ag[ad+aa++]));Y=P<<2|N>>4;J.push(Y);L=C.indexOf(String.fromCharCode(ag[ad+aa++]));if(L===-1){break}X=(N&15)<<4|L>>2;J.push(X);K=C.indexOf(String.fromCharCode(ag[ad+aa++]));if(K===-1){break}W=(L&3)<<6|K;if(K<64){J.push(W)}}if((J.length&1)===1){J.length--}Z=w(1201,J);for(aa=0;aa<Z.length;++aa){ae[ab++]=Z[aa]}}break;default:throw new Error("Unsupported magic: "+O+" "+m[O])}}else{throw new Error("Unrecognized CP: "+O)}}ae.length=ab;return ae.join("")};var u=function u(J){return r[J]||m[J]};r.utils={decode:w,encode:h,hascp:u,magic:m,cache:v};return r}));(function(){var f=["|","^"],m=[",",";","\t","|","^"],h=["\r\n","\r","\n"];function p(r){var s=typeof r;return s==="function"||s==="object"&&!!r}var k=Array.isArray||function(r){return toString.call(r)==="[object Array]"};function d(r){return typeof r==="string"}function o(r){return !isNaN(Number(r))}function e(r){return r==false||r==true}function b(r){return r==null}function q(r){return r!=null}function j(r,s){return q(r)?r:s}function l(u,s){for(var t=0,r=u.length;t<r;t+=1){if(s(u[t],t)===false){break}}}function a(r){return"attrs["+r+"]"}function g(s,r){if(o(s)){return"Number("+a(r)+")"}else{if(e(s)){return"Boolean("+a(r)+" == true)"}else{return"String("+a(r)+")"}}}function c(r,s,t){var u=[];if(arguments.length==2){if(r){if(k(r)){l(s,function(w,v){u.push(r[v]+"("+a(v)+")")})}else{l(s,function(w,v){u.push(g(w,v))})}}else{l(s,function(w,v){u.push(a(v))})}u="return ["+u.join(",")+"]"}else{if(r){if(k(r)){l(s,function(w,v){u.push('"'+t[v]+'": '+r[v]+"("+a(v)+")")})}else{l(s,function(w,v){u.push('"'+t[v]+'": '+g(w,v))})}}else{l(s,function(w,v){u.push('"'+t[v]+'": '+a(v))})}u="return {"+u.join(",")+"}"}return new Function("attrs",u)}function i(s,u){var t=0,r;l(u,function(v){var x=v,w;if(f.indexOf(v)!=-1){x="\\"+x}w=s.match(new RegExp(x,"g"));if(w&&w.length>t){t=w.length;r=v}});return(r||u[0])}var n=(function(){function u(y,v){if(!v){v={}}if(k(y)){this.mode="encode"}else{if(d(y)){this.mode="parse"}else{throw new Error("Incompatible format!")}}this.data=y;this.options={header:j(v.header,false),cast:j(v.cast,true)};var x=v.lineDelimiter||v.line,w=v.cellDelimiter||v.delimiter;if(this.isParser()){this.options.lineDelimiter=x||i(this.data,h);this.options.cellDelimiter=w||i(this.data,m);this.data=t(this.data,this.options.lineDelimiter)}else{if(this.isEncoder()){this.options.lineDelimiter=x||"\r\n";this.options.cellDelimiter=w||","}}}function s(x,w,v){x(new w(v))}function t(w,v){if(w.slice(-v.length)!=v){w+=v}return w}u.prototype.set=function(v,w){return this.options[v]=w};u.prototype.isParser=function(){return this.mode=="parse"};u.prototype.isEncoder=function(){return this.mode=="encode"};u.prototype.parse=function(D){if(this.mode!="parse"){return}if(this.data.trim().length===0){return[]}var O=this.data,B=this.options,K=B.header,I={cell:"",line:[]},J,z,w;if(!D){w=[];D=function(P){w.push(P)}}function N(){J={escaped:false,quote:false,cell:true}}function y(){I.cell=""}function F(){I.line=[]}function L(P){I.line.push(J.escaped?P.slice(1,-1).replace(/""/g,'"'):P);y();N()}function G(P){L(P.slice(0,1-B.lineDelimiter.length))}function A(){if(K){if(k(K)){z=c(B.cast,I.line,K);A=function(){s(D,z,I.line)};A()}else{K=I.line}}else{if(!z){z=c(B.cast,I.line)}A=function(){s(D,z,I.line)};A()}}if(B.lineDelimiter.length==1){G=L}var E=O.length,M=B.cellDelimiter.charCodeAt(0),H=B.lineDelimiter.charCodeAt(B.lineDelimiter.length-1),x,C,v;N();for(x=0,C=0;x<E;x++){v=O.charCodeAt(x);if(J.cell){J.cell=false;if(v==34){J.escaped=true;continue}}if(J.escaped&&v==34){J.quote=!J.quote;continue}if((J.escaped&&J.quote)||!J.escaped){if(v==M){L(I.cell+O.slice(C,x));C=x+1}else{if(v==H){G(I.cell+O.slice(C,x));C=x+1;A();F()}}}}if(w){return w}else{return this}};function r(v){if(k(v)){return"array"}else{if(p(v)){return"object"}else{if(d(v)){return"string"}else{if(b(v)){return"null"}else{return"primitive"}}}}}u.prototype.serialize={object:function(w){var x=this,v=Object.keys(w),y=Array(v.length);l(v,function(z,A){y[A]=x[r(w[z])](w[z])});return y},array:function(x){var v=this,w=Array(x.length);l(x,function(z,y){w[y]=v[r(z)](z)});return w},string:function(v){return'"'+String(v).replace(/"/g,'""')+'"'},"null":function(v){return""},primitive:function(v){return v}};u.prototype.encode=function(E){if(this.mode!="encode"){return}if(this.data.length==0){return""}var B=this.data,G=this.options,C=G.header,D=B[0],F=this.serialize,z=0,A,y;if(!E){y=Array(B.length);E=function(H,I){y[I+z]=H}}function w(H){return H.join(G.cellDelimiter)}if(C){if(!k(C)){A=Object.keys(D);C=A}E(w(F.array(C)),0);z=1}var x=r(D),v;if(x=="array"){if(k(G.cast)){v=Array(G.cast.length);l(G.cast,function(I,H){v[H]=I.toLowerCase()})}else{v=Array(D.length);l(D,function(I,H){v[H]=r(I)})}l(B,function(H,J){var I=Array(v.length);l(H,function(K,L){I[L]=F[v[L]](K)});E(w(I),J)})}else{if(x=="object"){A=Object.keys(D);if(k(G.cast)){v=Array(G.cast.length);l(G.cast,function(I,H){v[H]=I.toLowerCase()})}else{v=Array(A.length);l(A,function(H,I){v[I]=r(D[H])})}l(B,function(H,J){var I=Array(A.length);l(A,function(K,L){I[L]=F[v[L]](H[K])});E(w(I),J)})}}if(y){return y.join(G.lineDelimiter)}else{return this}};u.prototype.forEach=function(v){return this[this.mode](v)};return u})();n.parse=function(s,r){return new n(s,r).parse()};n.encode=function(s,r){return new n(s,r).encode()};n.forEach=function(s,r,t){if(arguments.length==2){t=r}return new n(s,r).forEach(t)};if(typeof define==="function"&&define.amd){define("CSV",[],function(){return n})}else{if(typeof module==="object"&&module.exports){module.exports=n}else{if(window){window.CSV=n}}}})();(function(){var b=function(l,k,f,n){var d={version:"0.0.1"};l=l||[];d.gramSizeLower=f||2;d.gramSizeUpper=n||3;d.useLevenshtein=k||true;d.exactSet={};d.matchDict={};d.items={};var m=function(t,r){var u=[],q,s;for(var p=0;p<=r.length;p++){for(var o=0;o<=t.length;o++){if(p&&o){if(t.charAt(o-1)===r.charAt(p-1)){s=q}else{s=Math.min(u[o],u[o-1],q)+1}}else{s=p+o}q=u[o];u[o]=s}}return u.pop()};var e=function(o,i){if(o===null&&i===null){throw"Trying to compare two null values"}if(o===null||i===null){return 0}o=String(o);i=String(i);var p=m(o,i);if(o.length>i.length){return 1-p/o.length}else{return 1-p/i.length}};var j=/[^\w, ]+/;var g=function(r,s){s=s||2;var t="-"+r.toLowerCase().replace(j,"")+"-",o=s-t.length,q=[];if(o>0){for(var p=0;p<o;++p){r+="-"}}for(var p=0;p<t.length-s+1;++p){q.push(t.slice(p,p+s))}return q};var c=function(r,s){s=s||2;var o={},p=g(r,s),q=0;for(q;q<p.length;++q){if(p[q] in o){o[p[q]]+=1}else{o[p[q]]=1}}return o};d.get=function(p,o){var i=this._get(p);if(!i&&o){return o}return i};d._get=function(q){var p=this._normalizeStr(q),i=this.exactSet[p];if(i){return[[1,i]]}var o=[];for(var r=this.gramSizeUpper;r>=this.gramSizeLower;--r){o=this.__get(q,r);if(o){return o}}return null};d.__get=function(C,H){var o=this._normalizeStr(C),p={},D=c(o,H),z=this.items[H],x=0,r,A,F,t,v;for(r in D){A=D[r];x+=Math.pow(A,2);if(r in this.matchDict){for(F=0;F<this.matchDict[r].length;++F){t=this.matchDict[r][F][0];v=this.matchDict[r][F][1];if(t in p){p[t]+=A*v}else{p[t]=A*v}}}}function u(i){for(var I in i){if(i.hasOwnProperty(I)){return false}}return true}if(u(p)){return null}var G=Math.sqrt(x),B=[],w;for(var q in p){w=p[q];B.push([w/(G*z[q][0]),z[q][1]])}var y=function(I,i){if(I[0]<i[0]){return 1}else{if(I[0]>i[0]){return -1}else{return 0}}};B.sort(y);if(this.useLevenshtein){var E=[],s=Math.min(50,B.length);for(var F=0;F<s;++F){E.push([e(B[F][1],o),B[F][1]])}B=E;B.sort(y)}var E=[];for(var F=0;F<B.length;++F){if(B[F][0]==B[0][0]){E.push([B[F][0],this.exactSet[B[F][1]]])}}return E};d.add=function(q){var p=this._normalizeStr(q);if(p in this.exactSet){return false}var o=this.gramSizeLower;for(o;o<this.gramSizeUpper+1;++o){this._add(q,o)}};d._add=function(w,i){var v=this._normalizeStr(w),u=this.items[i]||[],s=u.length;u.push(0);var p=c(v,i),o=0,q,r;for(q in p){r=p[q];o+=Math.pow(r,2);if(q in this.matchDict){this.matchDict[q].push([s,r])}else{this.matchDict[q]=[[s,r]]}}var t=Math.sqrt(o);u[s]=[t,v];this.items[i]=u;this.exactSet[v]=w};d._normalizeStr=function(i){if(Object.prototype.toString.call(i)!=="[object String]"){throw"Must use a string as argument to FuzzySet functions"}return i.toLowerCase()};d.length=function(){var i=0,o;for(o in this.exactSet){if(this.exactSet.hasOwnProperty(o)){i+=1}}return i};d.isEmpty=function(){for(var i in this.exactSet){if(this.exactSet.hasOwnProperty(i)){return false}}return true};d.values=function(){var i=[],o;for(o in this.exactSet){if(this.exactSet.hasOwnProperty(o)){i.push(this.exactSet[o])}}return i};var h=d.gramSizeLower;for(h;h<d.gramSizeUpper+1;++h){d.items[h]=[]}for(h=0;h<l.length;++h){d.add(l[h])}return d};var a=this;if(typeof module!=="undefined"&&module.exports){module.exports=b;a.FuzzySet=b}else{a.FuzzySet=b}})();var JSZip=function(b,a){this.files={};this.root="";if(b){this.load(b,a)}};JSZip.signature={LOCAL_FILE_HEADER:"PK\x03\x04",CENTRAL_FILE_HEADER:"PK\x01\x02",CENTRAL_DIRECTORY_END:"PK\x05\x06",ZIP64_CENTRAL_DIRECTORY_LOCATOR:"PK\x06\x07",ZIP64_CENTRAL_DIRECTORY_END:"PK\x06\x06",DATA_DESCRIPTOR:"PK\x07\b"};JSZip.defaults={base64:false,binary:false,dir:false,date:null,compression:null};JSZip.support={arraybuffer:(function(){return typeof ArrayBuffer!=="undefined"&&typeof Uint8Array!=="undefined"})(),nodebuffer:(function(){return typeof Buffer!=="undefined"})(),uint8array:(function(){return typeof Uint8Array!=="undefined"})(),blob:(function(){if(typeof ArrayBuffer==="undefined"){return false}var a=new ArrayBuffer(0);try{return new Blob([a],{type:"application/zip"}).size===0}catch(d){}try{var c=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;var b=new c();b.append(a);return b.getBlob("application/zip").size===0}catch(d){}return false})()};JSZip.prototype=(function(){var h,b;if(JSZip.support.uint8array&&typeof TextEncoder==="function"&&typeof TextDecoder==="function"){h=new TextEncoder("utf-8");b=new TextDecoder("utf-8")}var m=function(r){if(r._data instanceof JSZip.CompressedObject){r._data=r._data.getContent();r.options.binary=true;r.options.base64=false;if(JSZip.utils.getTypeOf(r._data)==="uint8array"){var s=r._data;r._data=new Uint8Array(s.length);if(s.length!==0){r._data.set(s,0)}}}return r._data};var f=function(s){var r=m(s),t=JSZip.utils.getTypeOf(r);if(t==="string"){if(!s.options.binary){if(h){return h.encode(r)}if(JSZip.support.nodebuffer){return new Buffer(r,"utf-8")}}return s.asBinary()}return r};var j=function(s){var r=m(this);if(r===null||typeof r==="undefined"){return""}if(this.options.base64){r=JSZip.base64.decode(r)}if(s&&this.options.binary){r=JSZip.prototype.utf8decode(r)}else{r=JSZip.utils.transformTo("string",r)}if(!s&&!this.options.binary){r=JSZip.prototype.utf8encode(r)}return r};var d=function(s,t,r){this.name=s;this._data=t;this.options=r};d.prototype={asText:function(){return j.call(this,true)},asBinary:function(){return j.call(this,false)},asNodeBuffer:function(){var r=f(this);return JSZip.utils.transformTo("nodebuffer",r)},asUint8Array:function(){var r=f(this);return JSZip.utils.transformTo("uint8array",r)},asArrayBuffer:function(){return this.asUint8Array().buffer}};var g=function(u,r){var t="",s;for(s=0;s<r;s++){t+=String.fromCharCode(u&255);u=u>>>8}return t};var l=function(){var s={},t,r;for(t=0;t<arguments.length;t++){for(r in arguments[t]){if(arguments[t].hasOwnProperty(r)&&typeof s[r]==="undefined"){s[r]=arguments[t][r]}}}return s};var p=function(r){r=r||{};if(r.base64===true&&r.binary==null){r.binary=true}r=l(r,JSZip.defaults);r.date=r.date||new Date();if(r.compression!==null){r.compression=r.compression.toUpperCase()}return r};var o=function(t,v,w){var u=n(t),r=JSZip.utils.getTypeOf(v);if(u){q.call(this,u)}w=p(w);if(w.dir||v===null||typeof v==="undefined"){w.base64=false;w.binary=false;v=null}else{if(r==="string"){if(w.binary&&!w.base64){if(w.optimizedBinaryString!==true){v=JSZip.utils.string2binary(v)}}}else{w.base64=false;w.binary=true;if(!r&&!(v instanceof JSZip.CompressedObject)){throw new Error("The data of '"+t+"' is in an unsupported format !")}if(r==="arraybuffer"){v=JSZip.utils.transformTo("uint8array",v)}}}var s=new d(t,v,w);this.files[t]=s;return s};var n=function(s){if(s.slice(-1)=="/"){s=s.substring(0,s.length-1)}var r=s.lastIndexOf("/");return(r>0)?s.substring(0,r):""};var q=function(r){if(r.slice(-1)!="/"){r+="/"}if(!this.files[r]){o.call(this,r,null,{dir:true})}return this.files[r]};var k=function(t,s){var r=new JSZip.CompressedObject(),u;if(t._data instanceof JSZip.CompressedObject){r.uncompressedSize=t._data.uncompressedSize;r.crc32=t._data.crc32;if(r.uncompressedSize===0||t.options.dir){s=JSZip.compressions.STORE;r.compressedContent="";r.crc32=0}else{if(t._data.compressionMethod===s.magic){r.compressedContent=t._data.getCompressedContent()}else{u=t._data.getContent();r.compressedContent=s.compress(JSZip.utils.transformTo(s.compressInputType,u))}}}else{u=f(t);if(!u||u.length===0||t.options.dir){s=JSZip.compressions.STORE;u=""}r.uncompressedSize=u.length;r.crc32=this.crc32(u);r.compressedContent=s.compress(JSZip.utils.transformTo(s.compressInputType,u))}r.compressedSize=r.compressedContent.length;r.compressionMethod=s.magic;return r};var e=function(r,u,A,x){var y=A.compressedContent,w=this.utf8encode(u.name),t=w!==u.name,s=u.options,C,B;C=s.date.getHours();C=C<<6;C=C|s.date.getMinutes();C=C<<5;C=C|s.date.getSeconds()/2;B=s.date.getFullYear()-1980;B=B<<4;B=B|(s.date.getMonth()+1);B=B<<5;B=B|s.date.getDate();var z="";z+="\n\x00";z+=t?"\x00\b":"\x00\x00";z+=A.compressionMethod;z+=g(C,2);z+=g(B,2);z+=g(A.crc32,4);z+=g(A.compressedSize,4);z+=g(A.uncompressedSize,4);z+=g(w.length,2);z+="\x00\x00";var v=JSZip.signature.LOCAL_FILE_HEADER+z+w;var D=JSZip.signature.CENTRAL_FILE_HEADER+"\x14\x00"+z+"\x00\x00\x00\x00\x00\x00"+(u.options.dir===true?"\x10\x00\x00\x00":"\x00\x00\x00\x00")+g(x,4)+w;return{fileRecord:v,dirRecord:D,compressedObject:A}};var a=function(){this.data=[]};a.prototype={append:function(r){r=JSZip.utils.transformTo("string",r);this.data.push(r)},finalize:function(){return this.data.join("")}};var i=function(r){this.data=new Uint8Array(r);this.index=0};i.prototype={append:function(r){if(r.length!==0){r=JSZip.utils.transformTo("uint8array",r);this.data.set(r,this.index);this.index+=r.length}},finalize:function(){return this.data}};return{load:function(s,r){throw new Error("Load method is not defined. Is the file jszip-load.js included ?")},filter:function(w){var r=[],t,s,v,u;for(t in this.files){if(!this.files.hasOwnProperty(t)){continue}v=this.files[t];u=new d(v.name,v._data,l(v.options));s=t.slice(this.root.length,t.length);if(t.slice(0,this.root.length)===this.root&&w(s,u)){r.push(u)}}return r},file:function(r,t,u){if(arguments.length===1){if(JSZip.utils.isRegExp(r)){var s=r;return this.filter(function(v,w){return !w.options.dir&&s.test(v)})}else{return this.filter(function(v,w){return !w.options.dir&&v===r})[0]||null}}else{r=this.root+r;o.call(this,r,t,u)}return this},folder:function(r){if(!r){return this}if(JSZip.utils.isRegExp(r)){return this.filter(function(v,w){return w.options.dir&&r.test(v)})}var t=this.root+r;var u=q.call(this,t);var s=this.clone();s.root=u.name;return s},remove:function(s){s=this.root+s;var u=this.files[s];if(!u){if(s.slice(-1)!="/"){s+="/"}u=this.files[s]}if(u){if(!u.options.dir){delete this.files[s]}else{var r=this.filter(function(v,w){return w.name.slice(0,s.length)===s});for(var t=0;t<r.length;t++){delete this.files[r[t].name]}}}return this},generate:function(E){E=l(E||{},{base64:true,compression:"STORE",type:"base64"});JSZip.utils.checkSupport(E.type);var y=[],z=0,u=0,x,A;for(var s in this.files){if(!this.files.hasOwnProperty(s)){continue}var w=this.files[s];var B=w.options.compression||E.compression.toUpperCase();var D=JSZip.compressions[B];if(!D){throw new Error(B+" is not a valid compression method !")}var C=k.call(this,w,D);var r=e.call(this,s,w,C,z);z+=r.fileRecord.length+C.compressedSize;u+=r.dirRecord.length;y.push(r)}var v="";v=JSZip.signature.CENTRAL_DIRECTORY_END+"\x00\x00\x00\x00"+g(y.length,2)+g(y.length,2)+g(u,4)+g(z,4)+"\x00\x00";switch(E.type.toLowerCase()){case"uint8array":case"arraybuffer":case"blob":case"nodebuffer":x=new i(z+u+v.length);break;default:x=new a(z+u+v.length);break}for(A=0;A<y.length;A++){x.append(y[A].fileRecord);x.append(y[A].compressedObject.compressedContent)}for(A=0;A<y.length;A++){x.append(y[A].dirRecord)}x.append(v);var t=x.finalize();switch(E.type.toLowerCase()){case"uint8array":case"arraybuffer":case"nodebuffer":return JSZip.utils.transformTo(E.type.toLowerCase(),t);case"blob":return JSZip.utils.arrayBuffer2Blob(JSZip.utils.transformTo("arraybuffer",t));case"base64":return(E.base64)?JSZip.base64.encode(t):t;default:return t}},crc32:function c(z,u){if(typeof z==="undefined"||!z.length){return 0}var t=JSZip.utils.getTypeOf(z)!=="string";var B=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918000,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];if(typeof(u)=="undefined"){u=0}var A=0;var v=0;var w=0;u=u^(-1);for(var s=0,r=z.length;s<r;s++){w=t?z[s]:z.charCodeAt(s);v=(u^w)&255;A=B[v];u=(u>>>8)^A}return u^(-1)},clone:function(){var r=new JSZip();for(var s in this){if(typeof this[s]!=="function"){r[s]=this[s]}}return r},utf8encode:function(t){if(h){var s=h.encode(t);return JSZip.utils.transformTo("string",s)}if(JSZip.support.nodebuffer){return JSZip.utils.transformTo("string",new Buffer(t,"utf-8"))}var r=[],u=0;for(var w=0;w<t.length;w++){var v=t.charCodeAt(w);if(v<128){r[u++]=String.fromCharCode(v)}else{if((v>127)&&(v<2048)){r[u++]=String.fromCharCode((v>>6)|192);r[u++]=String.fromCharCode((v&63)|128)}else{r[u++]=String.fromCharCode((v>>12)|224);r[u++]=String.fromCharCode(((v>>6)&63)|128);r[u++]=String.fromCharCode((v&63)|128)}}}return r.join("")},utf8decode:function(y){var A=[],z=0;var x=JSZip.utils.getTypeOf(y);var v=x!=="string";var u=0;var w=0,t=0,s=0,r=0;if(b){return b.decode(JSZip.utils.transformTo("uint8array",y))}if(JSZip.support.nodebuffer){return JSZip.utils.transformTo("nodebuffer",y).toString("utf-8")}while(u<y.length){w=v?y[u]:y.charCodeAt(u);if(w<128){A[z++]=String.fromCharCode(w);u++}else{if((w>191)&&(w<224)){s=v?y[u+1]:y.charCodeAt(u+1);A[z++]=String.fromCharCode(((w&31)<<6)|(s&63));u+=2}else{s=v?y[u+1]:y.charCodeAt(u+1);r=v?y[u+2]:y.charCodeAt(u+2);A[z++]=String.fromCharCode(((w&15)<<12)|((s&63)<<6)|(r&63));u+=3}}}return A.join("")}}}());JSZip.compressions={STORE:{magic:"\x00\x00",compress:function(a){return a},uncompress:function(a){return a},compressInputType:null,uncompressInputType:null}};(function(){JSZip.utils={string2binary:function(h){var f="";for(var g=0;g<h.length;g++){f+=String.fromCharCode(h.charCodeAt(g)&255)}return f},string2Uint8Array:function(f){return JSZip.utils.transformTo("uint8array",f)},uint8Array2String:function(f){return JSZip.utils.transformTo("string",f)},arrayBuffer2Blob:function(f){JSZip.utils.checkSupport("blob");try{return new Blob([f],{type:"application/zip"})}catch(i){}try{var h=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;var g=new h();g.append(f);return g.getBlob("application/zip")}catch(i){}throw new Error("Bug : can't construct the Blob.")},string2Blob:function(g){var f=JSZip.utils.transformTo("arraybuffer",g);return JSZip.utils.arrayBuffer2Blob(f)}};function b(f){return f}function a(g,h){for(var f=0;f<g.length;++f){h[f]=g.charCodeAt(f)&255}return h}function d(l){var p=65536;var q=[],j=l.length,o=JSZip.utils.getTypeOf(l),g=0;var f=true;try{switch(o){case"uint8array":String.fromCharCode.apply(null,new Uint8Array(0));break;case"nodebuffer":String.fromCharCode.apply(null,new Buffer(0));break}}catch(m){f=false}if(!f){var n="";for(var h=0;h<l.length;h++){n+=String.fromCharCode(l[h])}return n}while(g<j&&p>1){try{if(o==="array"||o==="nodebuffer"){q.push(String.fromCharCode.apply(null,l.slice(g,Math.min(g+p,j))))}else{q.push(String.fromCharCode.apply(null,l.subarray(g,Math.min(g+p,j))))}g+=p}catch(m){p=Math.floor(p/2)}}return q.join("")}function e(g,h){for(var f=0;f<g.length;f++){h[f]=g[f]}return h}var c={};c.string={string:b,array:function(f){return a(f,new Array(f.length))},arraybuffer:function(f){return c.string["uint8array"](f).buffer},uint8array:function(f){return a(f,new Uint8Array(f.length))},nodebuffer:function(f){return a(f,new Buffer(f.length))}};c.array={string:d,array:b,arraybuffer:function(f){return(new Uint8Array(f)).buffer},uint8array:function(f){return new Uint8Array(f)},nodebuffer:function(f){return new Buffer(f)}};c.arraybuffer={string:function(f){return d(new Uint8Array(f))},array:function(f){return e(new Uint8Array(f),new Array(f.byteLength))},arraybuffer:b,uint8array:function(f){return new Uint8Array(f)},nodebuffer:function(f){return new Buffer(new Uint8Array(f))}};c.uint8array={string:d,array:function(f){return e(f,new Array(f.length))},arraybuffer:function(f){return f.buffer},uint8array:b,nodebuffer:function(f){return new Buffer(f)}};c.nodebuffer={string:d,array:function(f){return e(f,new Array(f.length))},arraybuffer:function(f){return c.nodebuffer["uint8array"](f).buffer},uint8array:function(f){return e(f,new Uint8Array(f.length))},nodebuffer:b};JSZip.utils.transformTo=function(i,g){if(!g){g=""}if(!i){return g}JSZip.utils.checkSupport(i);var h=JSZip.utils.getTypeOf(g);var f=c[h][i](g);return f};JSZip.utils.getTypeOf=function(f){if(typeof f==="string"){return"string"}if(Object.prototype.toString.call(f)==="[object Array]"){return"array"}if(JSZip.support.nodebuffer&&Buffer.isBuffer(f)){return"nodebuffer"}if(JSZip.support.uint8array&&f instanceof Uint8Array){return"uint8array"}if(JSZip.support.arraybuffer&&f instanceof ArrayBuffer){return"arraybuffer"}};JSZip.utils.isRegExp=function(f){return Object.prototype.toString.call(f)==="[object RegExp]"};JSZip.utils.checkSupport=function(g){var f=true;switch(g.toLowerCase()){case"uint8array":f=JSZip.support.uint8array;break;case"arraybuffer":f=JSZip.support.arraybuffer;break;case"nodebuffer":f=JSZip.support.nodebuffer;break;case"blob":f=JSZip.support.blob;break}if(!f){throw new Error(g+" is not supported by this browser")}}})();(function(){JSZip.CompressedObject=function(){this.compressedSize=0;this.uncompressedSize=0;this.crc32=0;this.compressionMethod=null;this.compressedContent=null};JSZip.CompressedObject.prototype={getContent:function(){return null},getCompressedContent:function(){return null}}})();JSZip.base64=(function(){var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";return{encode:function(e,d){var b="";var m,k,h,l,j,g,f;var c=0;while(c<e.length){m=e.charCodeAt(c++);k=e.charCodeAt(c++);h=e.charCodeAt(c++);l=m>>2;j=((m&3)<<4)|(k>>4);g=((k&15)<<2)|(h>>6);f=h&63;if(isNaN(k)){g=f=64}else{if(isNaN(h)){f=64}}b=b+a.charAt(l)+a.charAt(j)+a.charAt(g)+a.charAt(f)}return b},decode:function(e,d){var b="";var m,k,h;var l,j,g,f;var c=0;e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(c<e.length){l=a.indexOf(e.charAt(c++));j=a.indexOf(e.charAt(c++));g=a.indexOf(e.charAt(c++));f=a.indexOf(e.charAt(c++));m=(l<<2)|(j>>4);k=((j&15)<<4)|(g>>2);h=((g&3)<<6)|f;b=b+String.fromCharCode(m);if(g!=64){b=b+String.fromCharCode(k)}if(f!=64){b=b+String.fromCharCode(h)}}return b}}}());(function(){if(!JSZip){throw"JSZip not defined"}var c={};(function(){(function(){var F=void 0,B=!0,J=this;function q(C,K){var L=C.split("."),u=J;!(L[0] in u)&&u.execScript&&u.execScript("var "+L[0]);for(var n;L.length&&(n=L.shift());){!L.length&&K!==F?u[n]=K:u=u[n]?u[n]:u[n]={}}}var D="undefined"!==typeof Uint8Array&&"undefined"!==typeof Uint16Array&&"undefined"!==typeof Uint32Array;function y(n,u){this.index="number"===typeof u?u:0;this.d=0;this.buffer=n instanceof (D?Uint8Array:Array)?n:new (D?Uint8Array:Array)(32768);if(2*this.buffer.length<=this.index){throw Error("invalid index")}this.buffer.length<=this.index&&E(this)}function E(C){var K=C.buffer,L,u=K.length,n=new (D?Uint8Array:Array)(u<<1);if(D){n.set(K)}else{for(L=0;L<u;++L){n[L]=K[L]}}return C.buffer=n}y.prototype.a=function(M,O,P){var L=this.buffer,C=this.index,u=this.d,K=L[C],n;P&&1<O&&(M=8<O?(w[M&255]<<24|w[M>>>8&255]<<16|w[M>>>16&255]<<8|w[M>>>24&255])>>32-O:w[M]>>8-O);if(8>O+u){K=K<<O|M,u+=O}else{for(n=0;n<O;++n){K=K<<1|M>>O-n-1&1,8===++u&&(u=0,L[C++]=w[K],K=0,C===L.length&&(L=E(this)))}}L[C]=K;this.buffer=L;this.d=u;this.index=C};y.prototype.finish=function(){var n=this.buffer,u=this.index,C;0<this.d&&(n[u]<<=8-this.d,n[u]=w[n[u]],u++);D?C=n.subarray(0,u):(n.length=u,C=n);return C};var N=new (D?Uint8Array:Array)(256),s;for(s=0;256>s;++s){for(var p=s,o=p,r=7,p=p>>>1;p;p>>>=1){o<<=1,o|=p&1,--r}N[s]=(o<<r&255)>>>0}var w=N;function d(n){this.buffer=new (D?Uint16Array:Array)(2*n);this.length=0}d.prototype.getParent=function(n){return 2*((n-2)/4|0)};d.prototype.push=function(K,L){var M,C,u=this.buffer,n;M=this.length;u[this.length++]=L;for(u[this.length++]=K;0<M;){if(C=this.getParent(M),u[M]>u[C]){n=u[M],u[M]=u[C],u[C]=n,n=u[M+1],u[M+1]=u[C+1],u[C+1]=n,M=C}else{break}}return this.length};d.prototype.pop=function(){var K,L,M=this.buffer,C,u,n;L=M[0];K=M[1];this.length-=2;M[0]=M[this.length];M[1]=M[this.length+1];for(n=0;;){u=2*n+2;if(u>=this.length){break}u+2<this.length&&M[u+2]>M[u]&&(u+=2);if(M[u]>M[n]){C=M[n],M[n]=M[u],M[u]=C,C=M[n+1],M[n+1]=M[u+1],M[u+1]=C}else{break}n=u}return{index:K,value:L,length:this.length}};function t(n,u){this.e=e;this.f=0;this.input=D&&n instanceof Array?new Uint8Array(n):n;this.c=0;u&&(u.lazy&&(this.f=u.lazy),"number"===typeof u.compressionType&&(this.e=u.compressionType),u.outputBuffer&&(this.b=D&&u.outputBuffer instanceof Array?new Uint8Array(u.outputBuffer):u.outputBuffer),"number"===typeof u.outputIndex&&(this.c=u.outputIndex));this.b||(this.b=new (D?Uint8Array:Array)(32768))}var e=2,l=[],k;for(k=0;288>k;k++){switch(B){case 143>=k:l.push([k+48,8]);break;case 255>=k:l.push([k-144+400,9]);break;case 279>=k:l.push([k-256+0,7]);break;case 287>=k:l.push([k-280+192,8]);break;default:throw"invalid literal: "+k}}t.prototype.h=function(){var aR,aS,aT,aQ,aV=this.input;switch(this.e){case 0:aT=0;for(aQ=aV.length;aT<aQ;){aS=D?aV.subarray(aT,aT+65535):aV.slice(aT,aT+65535);aT+=aS.length;var aU=aS,aN=aT===aQ,aL=F,aP=F,aK=F,aA=F,ay=F,aM=this.b,aO=this.c;if(D){for(aM=new Uint8Array(this.b.buffer);aM.length<=aO+aU.length+5;){aM=new Uint8Array(aM.length<<1)}aM.set(this.b)}aL=aN?1:0;aM[aO++]=aL|0;aP=aU.length;aK=~aP+65536&65535;aM[aO++]=aP&255;aM[aO++]=aP>>>8&255;aM[aO++]=aK&255;aM[aO++]=aK>>>8&255;if(D){aM.set(aU,aO),aO+=aU.length,aM=aM.subarray(0,aO)}else{aA=0;for(ay=aU.length;aA<ay;++aA){aM[aO++]=aU[aA]}aM.length=aO}this.c=aO;this.b=aM}break;case 1:var aI=new y(D?new Uint8Array(this.b.buffer):this.b,this.c);aI.a(1,1,B);aI.a(1,2,B);var aD=v(this,aV),az,am,av;az=0;for(am=aD.length;az<am;az++){if(av=aD[az],y.prototype.a.apply(aI,l[av]),256<av){aI.a(aD[++az],aD[++az],B),aI.a(aD[++az],5),aI.a(aD[++az],aD[++az],B)}else{if(256===av){break}}}this.b=aI.finish();this.c=this.b.length;break;case e:var ak=new y(D?new Uint8Array(this.b.buffer):this.b,this.c),aC,ad,ac,ab,V,U=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],L,ao,K,R,n,au=Array(19),aH,T,at,aw,aq;aC=e;ak.a(1,1,B);ak.a(aC,2,B);ad=v(this,aV);L=G(this.j,15);ao=f(L);K=G(this.i,7);R=f(K);for(ac=286;257<ac&&0===L[ac-1];ac--){}for(ab=30;1<ab&&0===K[ab-1];ab--){}var S=ac,aJ=ab,ah=new (D?Uint32Array:Array)(S+aJ),aG,ag,aF,C,ai=new (D?Uint32Array:Array)(316),aj,al,af=new (D?Uint8Array:Array)(19);for(aG=ag=0;aG<S;aG++){ah[ag++]=L[aG]}for(aG=0;aG<aJ;aG++){ah[ag++]=K[aG]}if(!D){aG=0;for(C=af.length;aG<C;++aG){af[aG]=0}}aG=aj=0;for(C=ah.length;aG<C;aG+=ag){for(ag=1;aG+ag<C&&ah[aG+ag]===ah[aG];++ag){}aF=ag;if(0===ah[aG]){if(3>aF){for(;0<aF--;){ai[aj++]=0,af[0]++}}else{for(;0<aF;){al=138>aF?aF:138,al>aF-3&&al<aF&&(al=aF-3),10>=al?(ai[aj++]=17,ai[aj++]=al-3,af[17]++):(ai[aj++]=18,ai[aj++]=al-11,af[18]++),aF-=al}}}else{if(ai[aj++]=ah[aG],af[ah[aG]]++,aF--,3>aF){for(;0<aF--;){ai[aj++]=ah[aG],af[ah[aG]]++}}else{for(;0<aF;){al=6>aF?aF:6,al>aF-3&&al<aF&&(al=aF-3),ai[aj++]=16,ai[aj++]=al-3,af[16]++,aF-=al}}}}aR=D?ai.subarray(0,aj):ai.slice(0,aj);n=G(af,7);for(aw=0;19>aw;aw++){au[aw]=n[U[aw]]}for(V=19;4<V&&0===au[V-1];V--){}aH=f(n);ak.a(ac-257,5,B);ak.a(ab-1,5,B);ak.a(V-4,4,B);for(aw=0;aw<V;aw++){ak.a(au[aw],3,B)}aw=0;for(aq=aR.length;aw<aq;aw++){if(T=aR[aw],ak.a(aH[T],n[T],B),16<=T){aw++;switch(T){case 16:at=2;break;case 17:at=3;break;case 18:at=7;break;default:throw"invalid code: "+T}ak.a(aR[aw],at,B)}}var ar=[ao,L],aa=[R,K],ae,aB,u,ax,an,M,aE,ap;an=ar[0];M=ar[1];aE=aa[0];ap=aa[1];ae=0;for(aB=ad.length;ae<aB;++ae){if(u=ad[ae],ak.a(an[u],M[u],B),256<u){ak.a(ad[++ae],ad[++ae],B),ax=ad[++ae],ak.a(aE[ax],ap[ax],B),ak.a(ad[++ae],ad[++ae],B)}else{if(256===u){break}}}this.b=ak.finish();this.c=this.b.length;break;default:throw"invalid compression type"}return this.b};function x(n,u){this.length=n;this.g=u}var H=function(){function u(L){switch(B){case 3===L:return[257,L-3,0];case 4===L:return[258,L-4,0];case 5===L:return[259,L-5,0];case 6===L:return[260,L-6,0];case 7===L:return[261,L-7,0];case 8===L:return[262,L-8,0];case 9===L:return[263,L-9,0];case 10===L:return[264,L-10,0];case 12>=L:return[265,L-11,1];case 14>=L:return[266,L-13,1];case 16>=L:return[267,L-15,1];case 18>=L:return[268,L-17,1];case 22>=L:return[269,L-19,2];case 26>=L:return[270,L-23,2];case 30>=L:return[271,L-27,2];case 34>=L:return[272,L-31,2];case 42>=L:return[273,L-35,3];case 50>=L:return[274,L-43,3];case 58>=L:return[275,L-51,3];case 66>=L:return[276,L-59,3];case 82>=L:return[277,L-67,4];case 98>=L:return[278,L-83,4];case 114>=L:return[279,L-99,4];case 130>=L:return[280,L-115,4];case 162>=L:return[281,L-131,5];case 194>=L:return[282,L-163,5];case 226>=L:return[283,L-195,5];case 257>=L:return[284,L-227,5];case 258===L:return[285,L-258,0];default:throw"invalid length: "+L}}var C=[],K,n;for(K=3;258>=K;K++){n=u(K),C[K]=n[2]<<24|n[1]<<16|n[0]}return C}(),g=D?new Uint32Array(H):H;function v(V,W){function X(aj,ah){var ai=aj.g,ag=[],ae=0,af;af=g[aj.length];ag[ae++]=af&65535;ag[ae++]=af>>16&255;ag[ae++]=af>>24;var ad;switch(B){case 1===ai:ad=[0,ai-1,0];break;case 2===ai:ad=[1,ai-2,0];break;case 3===ai:ad=[2,ai-3,0];break;case 4===ai:ad=[3,ai-4,0];break;case 6>=ai:ad=[4,ai-5,1];break;case 8>=ai:ad=[5,ai-7,1];break;case 12>=ai:ad=[6,ai-9,2];break;case 16>=ai:ad=[7,ai-13,2];break;case 24>=ai:ad=[8,ai-17,3];break;case 32>=ai:ad=[9,ai-25,3];break;case 48>=ai:ad=[10,ai-33,4];break;case 64>=ai:ad=[11,ai-49,4];break;case 96>=ai:ad=[12,ai-65,5];break;case 128>=ai:ad=[13,ai-97,5];break;case 192>=ai:ad=[14,ai-129,6];break;case 256>=ai:ad=[15,ai-193,6];break;case 384>=ai:ad=[16,ai-257,7];break;case 512>=ai:ad=[17,ai-385,7];break;case 768>=ai:ad=[18,ai-513,8];break;case 1024>=ai:ad=[19,ai-769,8];break;case 1536>=ai:ad=[20,ai-1025,9];break;case 2048>=ai:ad=[21,ai-1537,9];break;case 3072>=ai:ad=[22,ai-2049,10];break;case 4096>=ai:ad=[23,ai-3073,10];break;case 6144>=ai:ad=[24,ai-4097,11];break;case 8192>=ai:ad=[25,ai-6145,11];break;case 12288>=ai:ad=[26,ai-8193,12];break;case 16384>=ai:ad=[27,ai-12289,12];break;case 24576>=ai:ad=[28,ai-16385,13];break;case 32768>=ai:ad=[29,ai-24577,13];break;default:throw"invalid distance"}af=ad;ag[ae++]=af[0];ag[ae++]=af[1];ag[ae++]=af[2];var ac,ab;ac=0;for(ab=ag.length;ac<ab;++ac){Q[S++]=ag[ac]}L[ag[0]]++;C[ag[3]]++;M=aj.length+ah-1;u=null}var U,Z,Y,R,P,T={},O,K,u,Q=D?new Uint16Array(2*W.length):[],S=0,M=0,L=new (D?Uint32Array:Array)(286),C=new (D?Uint32Array:Array)(30),aa=V.f,n;if(!D){for(Y=0;285>=Y;){L[Y++]=0}for(Y=0;29>=Y;){C[Y++]=0}}L[256]=1;U=0;for(Z=W.length;U<Z;++U){Y=P=0;for(R=3;Y<R&&U+Y!==Z;++Y){P=P<<8|W[U+Y]}T[P]===F&&(T[P]=[]);O=T[P];if(!(0<M--)){for(;0<O.length&&32768<U-O[0];){O.shift()}if(U+3>=Z){u&&X(u,-1);Y=0;for(R=Z-U;Y<R;++Y){n=W[U+Y],Q[S++]=n,++L[n]}break}0<O.length?(K=z(W,U,O),u?u.length<K.length?(n=W[U-1],Q[S++]=n,++L[n],X(K,0)):X(u,-1):K.length<aa?u=K:X(K,0)):u?X(u,-1):(n=W[U],Q[S++]=n,++L[n])}O.push(U)}Q[S++]=256;L[256]++;V.j=L;V.i=C;return D?Q.subarray(0,S):Q}function z(M,O,P){var L,R,Q=0,C,u,K,n,S=M.length;u=0;n=P.length;R:for(;u<n;u++){L=P[n-u-1];C=3;if(3<Q){for(K=Q;3<K;K--){if(M[L+K-1]!==M[O+K-1]){continue R}}C=Q}for(;258>C&&O+C<S&&M[L+C]===M[O+C];){++C}C>Q&&(R=L,Q=C);if(258===C){break}}return new x(Q,O-R)}function G(M,O){var P=M.length,L=new d(572),R=new (D?Uint8Array:Array)(P),Q,C,u,K,n;if(!D){for(K=0;K<P;K++){R[K]=0}}for(K=0;K<P;++K){0<M[K]&&L.push(K,M[K])}Q=Array(L.length/2);C=new (D?Uint32Array:Array)(L.length/2);if(1===Q.length){return R[L.pop().index]=1,R}K=0;for(n=L.length/2;K<n;++K){Q[K]=L.pop(),C[K]=Q[K].value}u=h(C,C.length,O);K=0;for(n=Q.length;K<n;++K){R[Q[K].index]=u[K]}return R}function h(Q,R,S){function P(aa){var Z=O[aa][u[aa]];Z===R?(P(aa+1),P(aa+1)):--L[Z];++u[aa]}var V=new (D?Uint16Array:Array)(S),T=new (D?Uint8Array:Array)(S),L=new (D?Uint8Array:Array)(R),C=Array(S),O=Array(S),u=Array(S),X=(1<<S)-R,U=1<<S-1,K,M,n,Y,W;V[S-1]=R;for(M=0;M<S;++M){X<U?T[M]=0:(T[M]=1,X-=U),X<<=1,V[S-2-M]=(V[S-1-M]/2|0)+R}V[0]=T[0];C[0]=Array(V[0]);O[0]=Array(V[0]);for(M=1;M<S;++M){V[M]>2*V[M-1]+T[M]&&(V[M]=2*V[M-1]+T[M]),C[M]=Array(V[M]),O[M]=Array(V[M])}for(K=0;K<R;++K){L[K]=S}for(n=0;n<V[S-1];++n){C[S-1][n]=Q[n],O[S-1][n]=n}for(K=0;K<S;++K){u[K]=0}1===T[S-1]&&(--L[0],++u[S-1]);for(M=S-2;0<=M;--M){Y=K=0;W=u[M+1];for(n=0;n<V[M];n++){Y=C[M+1][W]+C[M+1][W+1],Y>Q[K]?(C[M][n]=Y,O[M][n]=R,W+=2):(C[M][n]=Q[K],O[M][n]=K,++K)}u[M]=0;1===T[M]&&P(M)}return L}function f(L){var M=new (D?Uint16Array:Array)(L.length),O=[],K=[],Q=0,P,u,n,C;P=0;for(u=L.length;P<u;P++){O[L[P]]=(O[L[P]]|0)+1}P=1;for(u=16;P<=u;P++){K[P]=Q,Q+=O[P]|0,Q<<=1}P=0;for(u=L.length;P<u;P++){Q=K[L[P]];K[L[P]]+=1;n=M[P]=0;for(C=L[P];n<C;n++){M[P]=M[P]<<1|Q&1,Q>>>=1}}return M}q("Zlib.RawDeflate",t);q("Zlib.RawDeflate.prototype.compress",t.prototype.h);var A={NONE:0,FIXED:1,DYNAMIC:e},j,I,m,i;if(Object.keys){j=Object.keys(A)}else{for(I in j=[],m=0,A){j[m++]=I}}m=0;for(i=j.length;m<i;++m){I=j[m],q("Zlib.RawDeflate.CompressionType."+I,A[I])}}).call(this)}).call(c);var a=function(d){var e=new c.Zlib.RawDeflate(d);return e.compress()};var b=(typeof Uint8Array!=="undefined")&&(typeof Uint16Array!=="undefined")&&(typeof Uint32Array!=="undefined");if(!JSZip.compressions.DEFLATE){JSZip.compressions.DEFLATE={magic:"\b\x00",compress:a,compressInputType:b?"uint8array":"array"}}else{JSZip.compressions.DEFLATE.compress=a;JSZip.compressions.DEFLATE.compressInputType=b?"uint8array":"array"}})();(function(){if(!JSZip){throw"JSZip not defined"}var b={};(function(){(function(){var at=void 0,ar=this;function ap(u,r){var p=u.split("."),l=ar;!(p[0] in l)&&l.execScript&&l.execScript("var "+p[0]);for(var q;p.length&&(q=p.shift());){!p.length&&r!==at?l[q]=r:l=l[q]?l[q]:l[q]={}}}var an="undefined"!==typeof Uint8Array&&"undefined"!==typeof Uint16Array&&"undefined"!==typeof Uint32Array;function aj(y){var x=y.length,A=0,z=Number.POSITIVE_INFINITY,w,v,u,r,q,p,C,l,B;for(l=0;l<x;++l){y[l]>A&&(A=y[l]),y[l]<z&&(z=y[l])}w=1<<A;v=new (an?Uint32Array:Array)(w);u=1;r=0;for(q=2;u<=A;){for(l=0;l<x;++l){if(y[l]===u){p=0;C=r;for(B=0;B<u;++B){p=p<<1|C&1,C>>=1}for(B=p;B<w;B+=q){v[B]=u<<16|l}++r}}++u;r<<=1;q<<=1}return[v,A,z]}function ah(p,l){this.g=[];this.h=32768;this.c=this.f=this.d=this.k=0;this.input=an?new Uint8Array(p):p;this.l=!1;this.i=af;this.p=!1;if(l||!(l={})){l.index&&(this.d=l.index),l.bufferSize&&(this.h=l.bufferSize),l.bufferType&&(this.i=l.bufferType),l.resize&&(this.p=l.resize)}switch(this.i){case ad:this.a=32768;this.b=new (an?Uint8Array:Array)(32768+this.h+258);break;case af:this.a=0;this.b=new (an?Uint8Array:Array)(this.h);this.e=this.u;this.m=this.r;this.j=this.s;break;default:throw Error("invalid inflate mode")}}var ad=0,af=1;ah.prototype.t=function(){for(;!this.l;){var x=aa(this,3);x&1&&(this.l=!0);x>>>=1;switch(x){case 0:var w=this.input,z=this.d,y=this.b,v=this.a,u=at,r=at,q=at,p=y.length,l=at;this.c=this.f=0;u=w[z++];if(u===at){throw Error("invalid uncompressed block header: LEN (first byte)")}r=u;u=w[z++];if(u===at){throw Error("invalid uncompressed block header: LEN (second byte)")}r|=u<<8;u=w[z++];if(u===at){throw Error("invalid uncompressed block header: NLEN (first byte)")}q=u;u=w[z++];if(u===at){throw Error("invalid uncompressed block header: NLEN (second byte)")}q|=u<<8;if(r===~q){throw Error("invalid uncompressed block header: length verify")}if(z+r>w.length){throw Error("input buffer is broken")}switch(this.i){case ad:for(;v+r>y.length;){l=p-v;r-=l;if(an){y.set(w.subarray(z,z+l),v),v+=l,z+=l}else{for(;l--;){y[v++]=w[z++]}}this.a=v;y=this.e();v=this.a}break;case af:for(;v+r>y.length;){y=this.e({o:2})}break;default:throw Error("invalid inflate mode")}if(an){y.set(w.subarray(z,z+r),v),v+=r,z+=r}else{for(;r--;){y[v++]=w[z++]}}this.d=z;this.a=v;this.b=y;break;case 1:this.j(Y,aq);break;case 2:ao(this);break;default:throw Error("unknown BTYPE: "+x)}}return this.m()};var am=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],al=an?new Uint16Array(am):am,ak=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258],ai=an?new Uint16Array(ak):ak,ag=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0],ae=an?new Uint8Array(ag):ag,ac=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],ab=an?new Uint16Array(ac):ac,Z=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],t=an?new Uint8Array(Z):Z,s=new (an?Uint8Array:Array)(288),o,n;o=0;for(n=s.length;o<n;++o){s[o]=143>=o?8:255>=o?9:279>=o?7:8}var Y=aj(s),m=new (an?Uint8Array:Array)(30),k,j;k=0;for(j=m.length;k<j;++k){m[k]=5}var aq=aj(m);function aa(w,v){for(var p=w.f,l=w.c,u=w.input,r=w.d,q;l<v;){q=u[r++];if(q===at){throw Error("input buffer is broken")}p|=q<<l;l+=8}q=p&(1<<v)-1;w.f=p>>>v;w.c=l-v;w.d=r;return q}function i(x,w){for(var z=x.f,y=x.c,v=x.input,u=x.d,r=w[0],q=w[1],p,l,A;y<q;){p=v[u++];if(p===at){break}z|=p<<y;y+=8}l=r[z&(1<<q)-1];A=l>>>16;x.f=z>>A;x.c=y-A;x.d=u;return l&65535}function ao(x){function w(B,G,A){var F,D,E,C;for(C=0;C<B;){switch(F=i(this,G),F){case 16:for(E=3+aa(this,2);E--;){A[C++]=D}break;case 17:for(E=3+aa(this,3);E--;){A[C++]=0}D=0;break;case 18:for(E=11+aa(this,7);E--;){A[C++]=0}D=0;break;default:D=A[C++]=F}}return A}var z=aa(x,5)+257,y=aa(x,5)+1,v=aa(x,4)+4,u=new (an?Uint8Array:Array)(al.length),r,q,p,l;for(l=0;l<v;++l){u[al[l]]=aa(x,3)}r=aj(u);q=new (an?Uint8Array:Array)(z);p=new (an?Uint8Array:Array)(y);x.j(aj(w.call(x,z,r,q)),aj(w.call(x,y,r,p)))}ah.prototype.j=function(w,v){var y=this.b,x=this.a;this.n=w;for(var u=y.length-258,r,q,p,l;256!==(r=i(this,w));){if(256>r){x>=u&&(this.a=x,y=this.e(),x=this.a),y[x++]=r}else{q=r-257;l=ai[q];0<ae[q]&&(l+=aa(this,ae[q]));r=i(this,v);p=ab[r];0<t[r]&&(p+=aa(this,t[r]));x>=u&&(this.a=x,y=this.e(),x=this.a);for(;l--;){y[x]=y[x++-p]}}}for(;8<=this.c;){this.c-=8,this.d--}this.a=x};ah.prototype.s=function(w,v){var y=this.b,x=this.a;this.n=w;for(var u=y.length,r,q,p,l;256!==(r=i(this,w));){if(256>r){x>=u&&(y=this.e(),u=y.length),y[x++]=r}else{q=r-257;l=ai[q];0<ae[q]&&(l+=aa(this,ae[q]));r=i(this,v);p=ab[r];0<t[r]&&(p+=aa(this,t[r]));x+l>u&&(y=this.e(),u=y.length);for(;l--;){y[x]=y[x++-p]}}}for(;8<=this.c;){this.c-=8,this.d--}this.a=x};ah.prototype.e=function(){var u=new (an?Uint8Array:Array)(this.a-32768),r=this.a-32768,p,l,q=this.b;if(an){u.set(q.subarray(32768,u.length))}else{p=0;for(l=u.length;p<l;++p){u[p]=q[p+32768]}}this.g.push(u);this.k+=u.length;if(an){q.set(q.subarray(r,r+32768))}else{for(p=0;32768>p;++p){q[p]=q[r+p]}}this.a=32768;return q};ah.prototype.u=function(x){var w,p=this.input.length/this.d+1|0,l,v,u,r=this.input,q=this.b;x&&("number"===typeof x.o&&(p=x.o),"number"===typeof x.q&&(p+=x.q));2>p?(l=(r.length-this.d)/this.n[2],u=258*(l/2)|0,v=u<q.length?q.length+u:q.length<<1):v=q.length*p;an?(w=new Uint8Array(v),w.set(q)):w=q;return this.b=w};ah.prototype.m=function(){var w=0,v=this.b,y=this.g,x,u=new (an?Uint8Array:Array)(this.k+(this.a-32768)),r,q,p,l;if(0===y.length){return an?this.b.subarray(32768,this.a):this.b.slice(32768,this.a)}r=0;for(q=y.length;r<q;++r){x=y[r];p=0;for(l=x.length;p<l;++p){u[w++]=x[p]}}r=32768;for(q=this.a;r<q;++r){u[w++]=v[r]}this.g=[];return this.buffer=u};ah.prototype.r=function(){var p,l=this.a;an?this.p?(p=new Uint8Array(l),p.set(this.b.subarray(0,l))):p=this.b.subarray(0,l):(this.b.length>l&&(this.b.length=l),p=this.b);return this.buffer=p};ap("Zlib.RawInflate",ah);ap("Zlib.RawInflate.prototype.decompress",ah.prototype.t);var h={ADAPTIVE:af,BLOCK:ad},g,f,e,d;if(Object.keys){g=Object.keys(h)}else{for(f in g=[],e=0,h){g[e++]=f}}e=0;for(d=g.length;e<d;++e){f=g[e],ap("Zlib.RawInflate.BufferType."+f,h[f])}}).call(this)}).call(b);var c=function(d){var e=new b.Zlib.RawInflate(d);return e.decompress()};var a=(typeof Uint8Array!=="undefined")&&(typeof Uint16Array!=="undefined")&&(typeof Uint32Array!=="undefined");if(!JSZip.compressions.DEFLATE){JSZip.compressions.DEFLATE={magic:"\b\x00",uncompress:c,uncompressInputType:a?"uint8array":"array"}}else{JSZip.compressions.DEFLATE.uncompress=c;JSZip.compressions.DEFLATE.uncompressInputType=a?"uint8array":"array"}})();(function(j){var c=65535;var b=-1;var h=function(o){var m="",n,l;for(l=0;l<(o||"").length;l++){n=o.charCodeAt(l);m+="\\x"+(n<16?"0":"")+n.toString(16).toUpperCase()}return m};var k=function(l){for(var m in JSZip.compressions){if(!JSZip.compressions.hasOwnProperty(m)){continue}if(JSZip.compressions[m].magic===l){return JSZip.compressions[m]}}return null};function f(l){this.data=null;this.length=0;this.index=0}f.prototype={checkOffset:function(l){this.checkIndex(this.index+l)},checkIndex:function(l){if(this.length<l||l<0){throw new Error("End of data reached (data length = "+this.length+", asked index = "+(l)+"). Corrupted zip ?")}},setIndex:function(l){this.checkIndex(l);this.index=l},skip:function(l){this.setIndex(this.index+l)},byteAt:function(l){},readInt:function(n){var l=0,m;this.checkOffset(n);for(m=this.index+n-1;m>=this.index;m--){l=(l<<8)+this.byteAt(m)}this.index+=n;return l},readString:function(l){return JSZip.utils.transformTo("string",this.readData(l))},readData:function(l){},lastIndexOfSignature:function(l){},readDate:function(){var l=this.readInt(4);return new Date(((l>>25)&127)+1980,((l>>21)&15)-1,(l>>16)&31,(l>>11)&31,(l>>5)&63,(l&31)<<1)}};function d(m,l){this.data=m;if(!l){this.data=JSZip.utils.string2binary(this.data)}this.length=this.data.length;this.index=0}d.prototype=new f();d.prototype.byteAt=function(l){return this.data.charCodeAt(l)};d.prototype.lastIndexOfSignature=function(l){return this.data.lastIndexOf(l)};d.prototype.readData=function(m){this.checkOffset(m);var l=this.data.slice(this.index,this.index+m);this.index+=m;return l};function i(l){if(l){this.data=l;this.length=this.data.length;this.index=0}}i.prototype=new f();i.prototype.byteAt=function(l){return this.data[l]};i.prototype.lastIndexOfSignature=function(q){var p=q.charCodeAt(0),o=q.charCodeAt(1),n=q.charCodeAt(2),m=q.charCodeAt(3);for(var l=this.length-4;l>=0;--l){if(this.data[l]===p&&this.data[l+1]===o&&this.data[l+2]===n&&this.data[l+3]===m){return l}}return -1};i.prototype.readData=function(m){this.checkOffset(m);var l=this.data.subarray(this.index,this.index+m);this.index+=m;return l};function a(l){this.data=l;this.length=this.data.length;this.index=0}a.prototype=new i();a.prototype.readData=function(m){this.checkOffset(m);var l=this.data.slice(this.index,this.index+m);this.index+=m;return l};function g(l,m){this.options=l;this.loadOptions=m}g.prototype={isEncrypted:function(){return(this.bitFlag&1)===1},useUTF8:function(){return(this.bitFlag&2048)===2048},prepareCompressedContent:function(l,n,m){return function(){var p=l.index;l.setIndex(n);var o=l.readData(m);l.setIndex(p);return o}},prepareContent:function(l,p,o,n,m){return function(){var q=JSZip.utils.transformTo(n.uncompressInputType,this.getCompressedContent());var r=n.uncompress(q);if(r.length!==m){throw new Error("Bug : uncompressed data size mismatch")}return r}},readLocalPart:function(l){var m,n;l.skip(22);this.fileNameLength=l.readInt(2);n=l.readInt(2);this.fileName=l.readString(this.fileNameLength);l.skip(n);if(this.compressedSize==-1||this.uncompressedSize==-1){throw new Error("Bug or corrupted zip : didn't get enough informations from the central directory (compressedSize == -1 || uncompressedSize == -1)")}m=k(this.compressionMethod);if(m===null){throw new Error("Corrupted zip : compression "+h(this.compressionMethod)+" unknown (inner file : "+this.fileName+")")}this.decompressed=new JSZip.CompressedObject();this.decompressed.compressedSize=this.compressedSize;this.decompressed.uncompressedSize=this.uncompressedSize;this.decompressed.crc32=this.crc32;this.decompressed.compressionMethod=this.compressionMethod;this.decompressed.getCompressedContent=this.prepareCompressedContent(l,l.index,this.compressedSize,m);this.decompressed.getContent=this.prepareContent(l,l.index,this.compressedSize,m,this.uncompressedSize);if(this.loadOptions.checkCRC32){this.decompressed=JSZip.utils.transformTo("string",this.decompressed.getContent());if(JSZip.prototype.crc32(this.decompressed)!==this.crc32){throw new Error("Corrupted zip : CRC32 mismatch")}}},readCentralPart:function(l){this.versionMadeBy=l.readString(2);this.versionNeeded=l.readInt(2);this.bitFlag=l.readInt(2);this.compressionMethod=l.readString(2);this.date=l.readDate();this.crc32=l.readInt(4);this.compressedSize=l.readInt(4);this.uncompressedSize=l.readInt(4);this.fileNameLength=l.readInt(2);this.extraFieldsLength=l.readInt(2);this.fileCommentLength=l.readInt(2);this.diskNumberStart=l.readInt(2);this.internalFileAttributes=l.readInt(2);this.externalFileAttributes=l.readInt(4);this.localHeaderOffset=l.readInt(4);if(this.isEncrypted()){throw new Error("Encrypted zip are not supported")}this.fileName=l.readString(this.fileNameLength);this.readExtraFields(l);this.parseZIP64ExtraField(l);this.fileComment=l.readString(this.fileCommentLength);this.dir=this.externalFileAttributes&16?true:false},parseZIP64ExtraField:function(l){if(!this.extraFields[1]){return}var m=new d(this.extraFields[1].value);if(this.uncompressedSize===b){this.uncompressedSize=m.readInt(8)}if(this.compressedSize===b){this.compressedSize=m.readInt(8)}if(this.localHeaderOffset===b){this.localHeaderOffset=m.readInt(8)}if(this.diskNumberStart===b){this.diskNumberStart=m.readInt(4)}},readExtraFields:function(m){var p=m.index,n,o,l;this.extraFields=this.extraFields||{};while(m.index<p+this.extraFieldsLength){n=m.readInt(2);o=m.readInt(2);l=m.readString(o);this.extraFields[n]={id:n,length:o,value:l}}},handleUTF8:function(){if(this.useUTF8()){this.fileName=JSZip.prototype.utf8decode(this.fileName);this.fileComment=JSZip.prototype.utf8decode(this.fileComment)}}};function e(m,l){this.files=[];this.loadOptions=l;if(m){this.load(m)}}e.prototype={checkSignature:function(m){var l=this.reader.readString(4);if(l!==m){throw new Error("Corrupted zip or bug : unexpected signature ("+h(l)+", expected "+h(m)+")")}},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2);this.diskWithCentralDirStart=this.reader.readInt(2);this.centralDirRecordsOnThisDisk=this.reader.readInt(2);this.centralDirRecords=this.reader.readInt(2);this.centralDirSize=this.reader.readInt(4);this.centralDirOffset=this.reader.readInt(4);this.zipCommentLength=this.reader.readInt(2);this.zipComment=this.reader.readString(this.zipCommentLength)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8);this.versionMadeBy=this.reader.readString(2);this.versionNeeded=this.reader.readInt(2);this.diskNumber=this.reader.readInt(4);this.diskWithCentralDirStart=this.reader.readInt(4);this.centralDirRecordsOnThisDisk=this.reader.readInt(8);this.centralDirRecords=this.reader.readInt(8);this.centralDirSize=this.reader.readInt(8);this.centralDirOffset=this.reader.readInt(8);this.zip64ExtensibleData={};var p=this.zip64EndOfCentralSize-44,m=0,n,o,l;while(m<p){n=this.reader.readInt(2);o=this.reader.readInt(4);l=this.reader.readString(o);this.zip64ExtensibleData[n]={id:n,length:o,value:l}}},readBlockZip64EndOfCentralLocator:function(){this.diskWithZip64CentralDirStart=this.reader.readInt(4);this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8);this.disksCount=this.reader.readInt(4);if(this.disksCount>1){throw new Error("Multi-volumes zip are not supported")}},readLocalFiles:function(){var m,l;for(m=0;m<this.files.length;m++){l=this.files[m];this.reader.setIndex(l.localHeaderOffset);this.checkSignature(JSZip.signature.LOCAL_FILE_HEADER);l.readLocalPart(this.reader);l.handleUTF8()}},readCentralDir:function(){var l;this.reader.setIndex(this.centralDirOffset);while(this.reader.readString(4)===JSZip.signature.CENTRAL_FILE_HEADER){l=new g({zip64:this.zip64},this.loadOptions);l.readCentralPart(this.reader);this.files.push(l)}},readEndOfCentral:function(){var l=this.reader.lastIndexOfSignature(JSZip.signature.CENTRAL_DIRECTORY_END);if(l===-1){throw new Error("Corrupted zip : can't find end of central directory")}this.reader.setIndex(l);this.checkSignature(JSZip.signature.CENTRAL_DIRECTORY_END);this.readBlockEndOfCentral();if(this.diskNumber===c||this.diskWithCentralDirStart===c||this.centralDirRecordsOnThisDisk===c||this.centralDirRecords===c||this.centralDirSize===b||this.centralDirOffset===b){this.zip64=true;l=this.reader.lastIndexOfSignature(JSZip.signature.ZIP64_CENTRAL_DIRECTORY_LOCATOR);if(l===-1){throw new Error("Corrupted zip : can't find the ZIP64 end of central directory locator")}this.reader.setIndex(l);this.checkSignature(JSZip.signature.ZIP64_CENTRAL_DIRECTORY_LOCATOR);this.readBlockZip64EndOfCentralLocator();this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir);this.checkSignature(JSZip.signature.ZIP64_CENTRAL_DIRECTORY_END);this.readBlockZip64EndOfCentral()}},prepareReader:function(m){var l=JSZip.utils.getTypeOf(m);if(l==="string"&&!JSZip.support.uint8array){this.reader=new d(m,this.loadOptions.optimizedBinaryString)}else{if(l==="nodebuffer"){this.reader=new a(m)}else{this.reader=new i(JSZip.utils.transformTo("uint8array",m))}}},load:function(l){this.prepareReader(l);this.readEndOfCentral();this.readCentralDir();this.readLocalFiles()}};JSZip.prototype.load=function(q,m){var p,o,n,l;m=m||{};if(m.base64){q=JSZip.base64.decode(q)}o=new e(q,m);p=o.files;for(n=0;n<p.length;n++){l=p[n];this.file(l.fileName,l.decompressed,{binary:true,optimizedBinaryString:true,date:l.date,dir:l.dir})}return this}}(this));if(typeof exports!=="undefined"){exports.JSZip=JSZip}var XLS={};(function make_xls(cT){cT.version="0.7.2";var e2=1252,ii;if(typeof module!=="undefined"&&typeof require!=="undefined"){if(typeof cptable==="undefined"){cptable=require("./dist/cpexcel")}ii=cptable[e2]}function fD(){ew(1252)}function ew(fs){e2=fs;if(typeof cptable!=="undefined"){ii=cptable[fs]}}var fG=function hy(fs){return String.fromCharCode(fs)};if(typeof cptable!=="undefined"){fG=function hx(fs){if(e2===1200){return String.fromCharCode(fs)}return cptable.utils.decode(e2,[fs&255,fs>>8])[0]}}var I=(typeof Buffer!=="undefined");function dr(fs){return new (I?Buffer:Array)(fs)}var bm=(function fA(){var kR="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";return{decode:function fs(k2,k1){var kS="";var kW,kU,kT;var k0,kZ,kY,kX;k2=k2.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var kV=0;kV<k2.length;){k0=kR.indexOf(k2.charAt(kV++));kZ=kR.indexOf(k2.charAt(kV++));kY=kR.indexOf(k2.charAt(kV++));kX=kR.indexOf(k2.charAt(kV++));kW=k0<<2|kZ>>4;kU=(kZ&15)<<4|kY>>2;kT=(kY&3)<<6|kX;kS+=String.fromCharCode(kW);if(kY!=64){kS+=String.fromCharCode(kU)}if(kX!=64){kS+=String.fromCharCode(kT)}}return kS}}})();function jY(kR){if(I){return new Buffer(kR,"binary")}var fs=kR.split("").map(function(kS){return kS.charCodeAt(0)&255});return fs}function ho(kT,k1,kU,fs,kW){if(kU===undefined){kU=true}if(!fs){fs=8}if(!kW&&fs===8){kW=52}var kZ,kV,kS=fs*8-kW-1,kY=(1<<kS)-1,kR=kY>>1;var k2=-7,k0=kU?-1:1,kX=kU?(fs-1):0,k3=kT[k1+kX];kX+=k0;kZ=k3&((1<<(-k2))-1);k3>>>=(-k2);k2+=kS;for(;k2>0;kZ=kZ*256+kT[k1+kX],kX+=k0,k2-=8){}kV=kZ&((1<<(-k2))-1);kZ>>>=(-k2);k2+=kW;for(;k2>0;kV=kV*256+kT[k1+kX],kX+=k0,k2-=8){}if(kZ===kY){return kV?NaN:((k3?-1:1)*Infinity)}else{if(kZ===0){kZ=1-kR}else{kV=kV+Math.pow(2,kW);kZ=kZ-kR}}return(k3?-1:1)*kV*Math.pow(2,kZ-kW)}var a8=/\u0000/g,a7=/[\u0001-\u0006]/;var fK,w;fK=w=function hd(kS){var fs=[];for(var kR=0;kR<kS[0].length;++kR){fs.push.apply(fs,kS[0][kR])}return fs};var iY,ac;iY=ac=function jB(fs,kT,kU){var kS=[];for(var kR=kT;kR<kU;kR+=2){kS.push(String.fromCharCode(eT(fs,kR)))}return kS.join("")};var a,co;a=co=function bM(fs,kS,kR){return fs.slice(kS,(kS+kR)).map(function(kT){return(kT<16?"0":"")+kT.toString(16)}).join("")};var kD,js;kD=js=function(fs,kT,kU){var kS=[];for(var kR=kT;kR<kU;kR++){kS.push(String.fromCharCode(hl(fs,kR)))}return kS.join("")};var jq,dj;jq=dj=function hD(kR,kS){var fs=a5(kR,kS);return fs>0?kD(kR,kS+4,kS+4+fs-1):""};var O,h3;O=h3=function fH(kR,kS){var fs=2*a5(kR,kS);return fs>0?kD(kR,kS+4,kS+4+fs-1):""};var gv,dg;gv=dg=function(kR,fs){return ho(kR,fs)};var hQ=function(fs){return[].concat.apply([],fs)};if(typeof Buffer!=="undefined"){iY=function gr(fs,kR,kS){if(!Buffer.isBuffer(fs)){return ac(fs,kR,kS)}return fs.toString("utf16le",kR,kS)};a=function(fs,kS,kR){return Buffer.isBuffer(fs)?fs.toString("hex",kS,kS+kR):co(fs,kS,kR)};jq=function de(kR,kS){if(!Buffer.isBuffer(kR)){return dj(kR,kS)}var fs=kR.readUInt32LE(kS);return fs>0?kR.toString("utf8",kS+4,kS+4+fs-1):""};O=function iT(kR,kS){if(!Buffer.isBuffer(kR)){return h3(kR,kS)}var fs=2*kR.readUInt32LE(kS);return kR.toString("utf16le",kS+4,kS+4+fs-1)};kD=function bs(fs,kR){return this.toString("utf8",fs,kR)};fK=function(fs){return(fs[0].length>0&&Buffer.isBuffer(fs[0][0]))?Buffer.concat(fs[0]):w(fs)};hQ=function(fs){return Buffer.isBuffer(fs[0])?Buffer.concat(fs):[].concat.apply([],fs)};gv=function ha(fs,kR){if(Buffer.isBuffer(fs)){return fs.readDoubleLE(kR)}return dg(fs,kR)}}var hl=function(kR,fs){return kR[fs]};var eT=function(kR,fs){return kR[fs+1]*(1<<8)+kR[fs]};var jO=function(kR,fs){var kS=kR[fs+1]*(1<<8)+kR[fs];return(kS<32768)?kS:(65535-kS+1)*-1};var a5=function(kR,fs){return kR[fs+3]*(1<<24)+(kR[fs+2]<<16)+(kR[fs+1]<<8)+kR[fs]};var f1=function(kR,fs){return(kR[fs+3]<<24)|(kR[fs+2]<<16)|(kR[fs+1]<<8)|kR[fs]};var jG=function(fs){return fs.match(/../g).map(function(kR){return parseInt(kR,16)})};var h0=typeof Buffer!=="undefined"?function(fs){return Buffer.isBuffer(fs)?new Buffer(fs,"hex"):jG(fs)}:jG;if(typeof cptable!=="undefined"){iY=function(fs,kR,kS){return cptable.utils.decode(1200,fs.slice(kR,kS))};kD=function(fs,kR,kS){return cptable.utils.decode(65001,fs.slice(kR,kS))};jq=function(kR,kS){var fs=a5(kR,kS);return fs>0?cptable.utils.decode(e2,kR.slice(kS+4,kS+4+fs-1)):""};O=function(kR,kS){var fs=2*a5(kR,kS);return fs>0?cptable.utils.decode(1200,kR.slice(kS+4,kS+4+fs-1)):""}}function d0(kZ,kY){var fs,kR,kV,kU=[],kX,kW,kS,kT;switch(kY){case"lpstr":fs=jq(this,this.l);kZ=5+fs.length;break;case"lpwstr":fs=O(this,this.l);kZ=5+fs.length;if(fs[fs.length-1]=="\x00"){kZ+=2}break;case"cstr":kZ=0;fs="";while((kX=hl(this,this.l+kZ++))!==0){kU.push(fG(kX))}fs=kU.join("");break;case"wstr":kZ=0;fs="";while((kX=eT(this,this.l+kZ))!==0){kU.push(fG(kX));kZ+=2}kZ+=2;fs=kU.join("");break;case"dbcs":fs="";kT=this.l;for(kS=0;kS!=kZ;++kS){if(this.lens&&this.lens.indexOf(kT)!==-1){kX=hl(this,kT);this.l=kT+1;kW=d0.call(this,kZ-kS,kX?"dbcs":"sbcs");return kU.join("")+kW}kU.push(fG(eT(this,kT)));kT+=2}fs=kU.join("");kZ*=2;break;case"sbcs":fs="";kT=this.l;for(kS=0;kS!=kZ;++kS){if(this.lens&&this.lens.indexOf(kT)!==-1){kX=hl(this,kT);this.l=kT+1;kW=d0.call(this,kZ-kS,kX?"dbcs":"sbcs");return kU.join("")+kW}kU.push(fG(hl(this,kT)));kT+=1}fs=kU.join("");break;case"utf8":fs=kD(this,this.l,this.l+kZ);break;case"utf16le":kZ*=2;fs=iY(this,this.l,this.l+kZ);break;default:switch(kZ){case 1:kR=hl(this,this.l);this.l++;return kR;case 2:kR=kY!=="i"?eT(this,this.l):jO(this,this.l);this.l+=2;return kR;case 4:if(kY==="i"||(this[this.l+3]&128)===0){kR=f1(this,this.l);this.l+=4;return kR}else{kV=a5(this,this.l);this.l+=4;return kV}break;case 8:if(kY==="f"){kV=gv(this,this.l);this.l+=8;return kV}case 16:fs=a(this,this.l,kZ);break}}this.l+=kZ;return fs}function ev(kS,kR){var fs=a(this,this.l,kS.length>>1);if(fs!==kS){throw kR+"Expected "+kS+" saw "+fs}this.l+=kS.length>>1}function ht(fs,kR){fs.l=kR;fs.read_shift=d0;fs.chk=ev}var cN={};var gx=function gx(le){le.version="0.8.1";function k5(ls){var lu="",lt=ls.length-1;while(lt>=0){lu+=ls.charAt(lt--)}return lu}function k7(lu,ls){var lt="";while(lt.length<ls){lt+=lu}return lt}function lf(ls,lu){var lt=""+ls;return lt.length>=lu?lt:k7("0",lu-lt.length)+lt}function kZ(ls,lu){var lt=""+ls;return lt.length>=lu?lt:k7(" ",lu-lt.length)+lt}function lo(ls,lu){var lt=""+ls;return lt.length>=lu?lt:lt+k7(" ",lu-lt.length)}function kU(ls,lu){var lt=""+Math.round(ls);return lt.length>=lu?lt:k7("0",lu-lt.length)+lt}function kS(ls,lu){var lt=""+ls;return lt.length>=lu?lt:k7("0",lu-lt.length)+lt}var lh=Math.pow(2,32);function li(ls,lu){if(ls>lh||ls<-lh){return kU(ls,lu)}var lt=Math.round(ls);return kS(lt,lu)}function k9(lt,ls){return lt.length>=7+ls&&(lt.charCodeAt(ls)|32)===103&&(lt.charCodeAt(ls+1)|32)===101&&(lt.charCodeAt(ls+2)|32)===110&&(lt.charCodeAt(ls+3)|32)===101&&(lt.charCodeAt(ls+4)|32)===114&&(lt.charCodeAt(ls+5)|32)===97&&(lt.charCodeAt(ls+6)|32)===108}var lj=[["date1904",0],["output",""],["WTF",false]];function k2(ls){for(var lt=0;lt!=lj.length;++lt){if(ls[lj[lt][0]]===undefined){ls[lj[lt][0]]=lj[lt][1]}}}le.opts=lj;var lk={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "',65535:"General"};var k1=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]];var k8=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function lr(lE,ls,lD){var lz=lE<0?-1:1;var lu=lE*lz;var lw=0,lx=1,lC=0;var ly=1,lA=0,lB=0;var lv=Math.floor(lu);while(lA<ls){lv=Math.floor(lu);lC=lv*lx+lw;lB=lv*lA+ly;if((lu-lv)<5e-10){break}lu=1/(lu-lv);lw=lx;lx=lC;ly=lA;lA=lB}if(lB>ls){lB=lA;lC=lx}if(lB>ls){lB=ly;lC=lw}if(!lD){return[0,lz*lC,lB]}if(lB===0){throw"Unexpected state: "+lC+" "+lx+" "+lw+" "+lB+" "+lA+" "+ly}var lt=Math.floor(lz*lC/lB);return[lt,lz*lC-lt*lB,lB]}function kW(ls,lt){return""+ls}le._general_int=kW;var k6=(function lm(){var lw=/\.(\d*[1-9])0+$/,lv=/\.0*$/,lu=/\.(\d*[1-9])0+/,lt=/\.0*[Ee]/,ls=/(E[+-])(\d)$/;function lB(lD){var lC=(lD<0?12:11);var lE=lx(lD.toFixed(12));if(lE.length<=lC){return lE}lE=lD.toPrecision(10);if(lE.length<=lC){return lE}return lD.toExponential(5)}function lz(lC){var lD=lC.toFixed(11).replace(lw,".$1");if(lD.length>(lC<0?12:11)){lD=lC.toPrecision(6)}return lD}function ly(lD){for(var lC=0;lC!=lD.length;++lC){if((lD.charCodeAt(lC)|32)===101){return lD.replace(lu,".$1").replace(lt,"E").replace("e","E").replace(ls,"$10$2")}}return lD}function lx(lC){return lC.indexOf(".")>-1?lC.replace(lv,"").replace(lw,".$1"):lC}return function lA(lD,lE){var lC=Math.floor(Math.log(Math.abs(lD))*Math.LOG10E),lF;if(lC>=-4&&lC<=-1){lF=lD.toPrecision(10+lC)}else{if(Math.abs(lC)<=9){lF=lB(lD)}else{if(lC===10){lF=lD.toFixed(10).substr(0,12)}else{lF=lz(lD)}}}return lx(ly(lF))}})();le._general_num=k6;function lp(ls,lt){switch(typeof ls){case"string":return ls;case"boolean":return ls?"TRUE":"FALSE";case"number":return(ls|0)===ls?kW(ls,lt):k6(ls,lt)}throw new Error("unsupported value in General format: "+ls)}le._general=lp;function kX(ls,lt){return 0}function lg(lz,ls,ly){if(lz>2958465||lz<0){return null}var lu=(lz|0),lt=Math.floor(86400*(lz-lu)),lA=0;var lv=[];var lw={D:lu,T:lt,u:86400*(lz-lu)-lt,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(lw.u)<0.000001){lw.u=0}k2(ls!=null?ls:(ls=[]));if(ls.date1904){lu+=1462}if(lw.u>0.999){lw.u=0;if(++lt==86400){lt=0;++lu}}if(lu===60){lv=ly?[1317,10,29]:[1900,2,29];lA=3}else{if(lu===0){lv=ly?[1317,8,29]:[1900,1,0];lA=6}else{if(lu>60){--lu}var lx=new Date(1900,0,1);lx.setDate(lx.getDate()+lu-1);lv=[lx.getFullYear(),lx.getMonth()+1,lx.getDate()];lA=lx.getDay();if(lu<60){lA=(lA+6)%7}if(ly){lA=kX(lx,lv)}}}lw.y=lv[0];lw.m=lv[1];lw.d=lv[2];lw.S=lt%60;lt=Math.floor(lt/60);lw.M=lt%60;lt=Math.floor(lt/60);lw.H=lt;lw.q=lA;return lw}le.parse_date_code=lg;function ll(ly,lu,lt,lA){var ls="",lB=0,lx=0,lz=lt.y,lv,lw=0;switch(ly){case 98:lz=lt.y+543;case 121:switch(lu.length){case 1:case 2:lv=lz%100;lw=2;break;default:lv=lz%10000;lw=4;break}break;case 109:switch(lu.length){case 1:case 2:lv=lt.m;lw=lu.length;break;case 3:return k8[lt.m-1][1];case 5:return k8[lt.m-1][0];default:return k8[lt.m-1][2]}break;case 100:switch(lu.length){case 1:case 2:lv=lt.d;lw=lu.length;break;case 3:return k1[lt.q][0];default:return k1[lt.q][1]}break;case 104:switch(lu.length){case 1:case 2:lv=1+(lt.H+11)%12;lw=lu.length;break;default:throw"bad hour format: "+lu}break;case 72:switch(lu.length){case 1:case 2:lv=lt.H;lw=lu.length;break;default:throw"bad hour format: "+lu}break;case 77:switch(lu.length){case 1:case 2:lv=lt.M;lw=lu.length;break;default:throw"bad minute format: "+lu}break;case 115:if(lt.u===0){switch(lu){case"s":case"ss":return lf(lt.S,lu.length);case".0":case".00":case".000":}}switch(lu){case"s":case"ss":case".0":case".00":case".000":if(lA>=2){lx=lA===3?1000:100}else{lx=lA===1?10:1}lB=Math.round((lx)*(lt.S+lt.u));if(lB>=60*lx){lB=0}if(lu==="s"){return lB===0?"0":""+lB/lx}ls=lf(lB,2+lA);if(lu==="ss"){return ls.substr(0,2)}return"."+ls.substr(2,lu.length-1);default:throw"bad second format: "+lu}case 90:switch(lu){case"[h]":case"[hh]":lv=lt.D*24+lt.H;break;case"[m]":case"[mm]":lv=(lt.D*24+lt.H)*60+lt.M;break;case"[s]":case"[ss]":lv=((lt.D*24+lt.H)*60+lt.M)*60+Math.round(lt.S+lt.u);break;default:throw"bad abstime format: "+lu}lw=lu.length===3?1:2;break;case 101:lv=lz;lw=1}if(lw>0){return lf(lv,lw)}else{return""}}function lc(lt){if(lt.length<=3){return lt}var ls=(lt.length%3),lu=lt.substr(0,ls);for(;ls!=lt.length;ls+=3){lu+=(lu.length>0?",":"")+lt.substr(ls,3)}return lu}var kV=(function kT(){var lJ=/%/g;function lv(lN,lM,lQ){var lP=lM.replace(lJ,""),lO=lM.length-lP.length;return lL(lN,lP,lQ*Math.pow(10,2*lO))+k7("%",lO)}function lu(lO,lN,lP){var lM=lN.length-1;while(lN.charCodeAt(lM-1)===44){--lM}return lL(lO,lN.substr(0,lM),lP/Math.pow(10,3*(lN.length-lM)))}function lz(lO,lS){var lR;var lM=lO.indexOf("E")-lO.indexOf(".")-1;if(lO.match(/^#+0.0E\+0$/)){var lQ=lO.indexOf(".");if(lQ===-1){lQ=lO.indexOf("E")}var lN=Math.floor(Math.log(Math.abs(lS))*Math.LOG10E)%lQ;if(lN<0){lN+=lQ}lR=(lS/Math.pow(10,lN)).toPrecision(lM+1+(lQ+lN)%lQ);if(lR.indexOf("e")===-1){var lP=Math.floor(Math.log(Math.abs(lS))*Math.LOG10E);if(lR.indexOf(".")===-1){lR=lR[0]+"."+lR.substr(1)+"E+"+(lP-lR.length+lN)}else{lR+="E+"+(lP-lN)}while(lR.substr(0,2)==="0."){lR=lR[0]+lR.substr(2,lQ)+"."+lR.substr(2+lQ);lR=lR.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.")}lR=lR.replace(/\+-/,"-")}lR=lR.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(lU,lT,lW,lV){return lT+lW+lV.substr(0,(lQ+lN)%lQ)+"."+lV.substr(lN)+"E"})}else{lR=lS.toExponential(lM)}if(lO.match(/E\+00$/)&&lR.match(/e[+-]\d$/)){lR=lR.substr(0,lR.length-1)+"0"+lR[lR.length-1]}if(lO.match(/E\-/)&&lR.match(/e\+/)){lR=lR.replace(/e\+/,"e")}return lR.replace("e","E")}var lw=/# (\?+)( ?)\/( ?)(\d+)/;function lC(lR,lQ,lM){var lT=parseInt(lR[4]),lP=Math.round(lQ*lT),lS=Math.floor(lP/lT);var lO=(lP-lS*lT),lN=lT;return lM+(lS===0?"":""+lS)+" "+(lO===0?k7(" ",lR[1].length+1+lR[4].length):kZ(lO,lR[1].length)+lR[2]+"/"+lR[3]+lf(lN,lR[4].length))}function lA(lO,lN,lM){return lM+(lN===0?"":""+lN)+k7(" ",lO[1].length+2+lO[4].length)}var lD=/^#*0*\.(0+)/;var lK=/\).*[0#]/;var ly=/\(###\) ###\\?-####/;function lx(lO){var lN="",lP;for(var lM=0;lM!=lO.length;++lM){switch((lP=lO.charCodeAt(lM))){case 35:break;case 63:lN+=" ";break;case 48:lN+="0";break;default:lN+=String.fromCharCode(lP)}}return lN}function lB(lO,lN){var lM=Math.pow(10,lN);return""+(Math.round(lO*lM)/lM)}function lF(lN,lM){return Math.round((lN-Math.floor(lN))*Math.pow(10,lM))}function lH(lM){if(lM<2147483647&&lM>-2147483648){return""+(lM>=0?(lM|0):(lM-1|0))}return""+Math.floor(lM)}function lG(lW,lS,lR){if(lW.charCodeAt(0)===40&&!lS.match(lK)){var lV=lS.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");if(lR>=0){return lG("n",lV,lR)}return"("+lG("n",lV,-lR)+")"}if(lS.charCodeAt(lS.length-1)===44){return lu(lW,lS,lR)}if(lS.indexOf("%")!==-1){return lv(lW,lS,lR)}if(lS.indexOf("E")!==-1){return lz(lS,lR)}if(lS.charCodeAt(0)===36){return"$"+lG(lW,lS.substr(lS[1]==" "?2:1),lR)}var lP,lU;var lM,lY,lN,l0=Math.abs(lR),lQ=lR<0?"-":"";if(lS.match(/^00+$/)){return lQ+li(l0,lS.length)}if(lS.match(/^[#?]+$/)){lP=li(lR,0);if(lP==="0"){lP=""}return lP.length>lS.length?lP:lx(lS.substr(0,lS.length-lP.length))+lP}if((lM=lS.match(lw))!==null){return lC(lM,l0,lQ)}if(lS.match(/^#+0+$/)!==null){return lQ+li(l0,lS.length-lS.indexOf("0"))}if((lM=lS.match(lD))!==null){lP=lB(lR,lM[1].length).replace(/^([^\.]+)$/,"$1."+lM[1]).replace(/\.$/,"."+lM[1]).replace(/\.(\d*)$/,function(l2,l1){return"."+l1+k7("0",lM[1].length-l1.length)});return lS.indexOf("0.")!==-1?lP:lP.replace(/^0\./,".")}lS=lS.replace(/^#+([0.])/,"$1");if((lM=lS.match(/^(0*)\.(#*)$/))!==null){return lQ+lB(l0,lM[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,lM[1].length?"0.":".")}if((lM=lS.match(/^#,##0(\.?)$/))!==null){return lQ+lc(li(l0,0))}if((lM=lS.match(/^#,##0\.([#0]*0)$/))!==null){return lR<0?"-"+lG(lW,lS,-lR):lc(""+(Math.floor(lR)))+"."+lf(lF(lR,lM[1].length),lM[1].length)}if((lM=lS.match(/^#,#*,#0/))!==null){return lG(lW,lS.replace(/^#,#*,/,""),lR)}if((lM=lS.match(/^([0#]+)(\\?-([0#]+))+$/))!==null){lP=k5(lG(lW,lS.replace(/[\\-]/g,""),lR));lY=0;return k5(k5(lS.replace(/\\/g,"")).replace(/[0#]/g,function(l1){return lY<lP.length?lP[lY++]:l1==="0"?"0":""}))}if(lS.match(ly)!==null){lP=lG(lW,"##########",lR);return"("+lP.substr(0,3)+") "+lP.substr(3,3)+"-"+lP.substr(6)}var lO="";if((lM=lS.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))!==null){lY=Math.min(lM[4].length,7);lN=lr(l0,Math.pow(10,lY)-1,false);lP=""+lQ;lO=lL("n",lM[1],lN[1]);if(lO[lO.length-1]==" "){lO=lO.substr(0,lO.length-1)+"0"}lP+=lO+lM[2]+"/"+lM[3];lO=lo(lN[2],lY);if(lO.length<lM[4].length){lO=lx(lM[4].substr(lM[4].length-lO.length))+lO}lP+=lO;return lP}if((lM=lS.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))!==null){lY=Math.min(Math.max(lM[1].length,lM[4].length),7);lN=lr(l0,Math.pow(10,lY)-1,true);return lQ+(lN[0]||(lN[1]?"":"0"))+" "+(lN[1]?kZ(lN[1],lY)+lM[2]+"/"+lM[3]+lo(lN[2],lY):k7(" ",2*lY+1+lM[2].length+lM[3].length))}if((lM=lS.match(/^[#0?]+$/))!==null){lP=li(lR,0);if(lS.length<=lP.length){return lP}return lx(lS.substr(0,lS.length-lP.length))+lP}if((lM=lS.match(/^([#0?]+)\.([#0]+)$/))!==null){lP=""+lR.toFixed(Math.min(lM[2].length,10)).replace(/([^0])0+$/,"$1");lY=lP.indexOf(".");var lT=lS.indexOf(".")-lY,lZ=lS.length-lP.length-lT;return lx(lS.substr(0,lT)+lP+lS.substr(lS.length-lZ))}if((lM=lS.match(/^00,000\.([#0]*0)$/))!==null){lY=lF(lR,lM[1].length);return lR<0?"-"+lG(lW,lS,-lR):lc(lH(lR)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(l1){return"00,"+(l1.length<3?lf(0,3-l1.length):"")+l1})+"."+lf(lY,lM[1].length)}switch(lS){case"#,###":var lX=lc(li(l0,0));return lX!=="0"?lQ+lX:"";default:}throw new Error("unsupported format |"+lS+"|")}function lI(lO,lN,lP){var lM=lN.length-1;while(lN.charCodeAt(lM-1)===44){--lM}return lL(lO,lN.substr(0,lM),lP/Math.pow(10,3*(lN.length-lM)))}function lE(lN,lM,lQ){var lP=lM.replace(lJ,""),lO=lM.length-lP.length;return lL(lN,lP,lQ*Math.pow(10,2*lO))+k7("%",lO)}function lt(lO,lS){var lR;var lM=lO.indexOf("E")-lO.indexOf(".")-1;if(lO.match(/^#+0.0E\+0$/)){var lQ=lO.indexOf(".");if(lQ===-1){lQ=lO.indexOf("E")}var lN=Math.floor(Math.log(Math.abs(lS))*Math.LOG10E)%lQ;if(lN<0){lN+=lQ}lR=(lS/Math.pow(10,lN)).toPrecision(lM+1+(lQ+lN)%lQ);if(!lR.match(/[Ee]/)){var lP=Math.floor(Math.log(Math.abs(lS))*Math.LOG10E);if(lR.indexOf(".")===-1){lR=lR[0]+"."+lR.substr(1)+"E+"+(lP-lR.length+lN)}else{lR+="E+"+(lP-lN)}lR=lR.replace(/\+-/,"-")}lR=lR.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(lU,lT,lW,lV){return lT+lW+lV.substr(0,(lQ+lN)%lQ)+"."+lV.substr(lN)+"E"})}else{lR=lS.toExponential(lM)}if(lO.match(/E\+00$/)&&lR.match(/e[+-]\d$/)){lR=lR.substr(0,lR.length-1)+"0"+lR[lR.length-1]}if(lO.match(/E\-/)&&lR.match(/e\+/)){lR=lR.replace(/e\+/,"e")}return lR.replace("e","E")}function ls(lV,lS,lR){if(lV.charCodeAt(0)===40&&!lS.match(lK)){var lU=lS.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");if(lR>=0){return ls("n",lU,lR)}return"("+ls("n",lU,-lR)+")"}if(lS.charCodeAt(lS.length-1)===44){return lI(lV,lS,lR)}if(lS.indexOf("%")!==-1){return lE(lV,lS,lR)}if(lS.indexOf("E")!==-1){return lt(lS,lR)}if(lS.charCodeAt(0)===36){return"$"+ls(lV,lS.substr(lS[1]==" "?2:1),lR)}var lP;var lM,lX,lN,lZ=Math.abs(lR),lQ=lR<0?"-":"";if(lS.match(/^00+$/)){return lQ+lf(lZ,lS.length)}if(lS.match(/^[#?]+$/)){lP=(""+lR);if(lR===0){lP=""}return lP.length>lS.length?lP:lx(lS.substr(0,lS.length-lP.length))+lP}if((lM=lS.match(lw))!==null){return lA(lM,lZ,lQ)}if(lS.match(/^#+0+$/)!==null){return lQ+lf(lZ,lS.length-lS.indexOf("0"))}if((lM=lS.match(lD))!==null){lP=(""+lR).replace(/^([^\.]+)$/,"$1."+lM[1]).replace(/\.$/,"."+lM[1]).replace(/\.(\d*)$/,function(l1,l0){return"."+l0+k7("0",lM[1].length-l0.length)});return lS.indexOf("0.")!==-1?lP:lP.replace(/^0\./,".")}lS=lS.replace(/^#+([0.])/,"$1");if((lM=lS.match(/^(0*)\.(#*)$/))!==null){return lQ+(""+lZ).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,lM[1].length?"0.":".")}if((lM=lS.match(/^#,##0(\.?)$/))!==null){return lQ+lc((""+lZ))}if((lM=lS.match(/^#,##0\.([#0]*0)$/))!==null){return lR<0?"-"+ls(lV,lS,-lR):lc((""+lR))+"."+k7("0",lM[1].length)}if((lM=lS.match(/^#,#*,#0/))!==null){return ls(lV,lS.replace(/^#,#*,/,""),lR)}if((lM=lS.match(/^([0#]+)(\\?-([0#]+))+$/))!==null){lP=k5(ls(lV,lS.replace(/[\\-]/g,""),lR));lX=0;return k5(k5(lS.replace(/\\/g,"")).replace(/[0#]/g,function(l0){return lX<lP.length?lP[lX++]:l0==="0"?"0":""}))}if(lS.match(ly)!==null){lP=ls(lV,"##########",lR);return"("+lP.substr(0,3)+") "+lP.substr(3,3)+"-"+lP.substr(6)}var lO="";if((lM=lS.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))!==null){lX=Math.min(lM[4].length,7);lN=lr(lZ,Math.pow(10,lX)-1,false);lP=""+lQ;lO=lL("n",lM[1],lN[1]);if(lO[lO.length-1]==" "){lO=lO.substr(0,lO.length-1)+"0"}lP+=lO+lM[2]+"/"+lM[3];lO=lo(lN[2],lX);if(lO.length<lM[4].length){lO=lx(lM[4].substr(lM[4].length-lO.length))+lO}lP+=lO;return lP}if((lM=lS.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))!==null){lX=Math.min(Math.max(lM[1].length,lM[4].length),7);lN=lr(lZ,Math.pow(10,lX)-1,true);return lQ+(lN[0]||(lN[1]?"":"0"))+" "+(lN[1]?kZ(lN[1],lX)+lM[2]+"/"+lM[3]+lo(lN[2],lX):k7(" ",2*lX+1+lM[2].length+lM[3].length))}if((lM=lS.match(/^[#0?]+$/))!==null){lP=""+lR;if(lS.length<=lP.length){return lP}return lx(lS.substr(0,lS.length-lP.length))+lP}if((lM=lS.match(/^([#0]+)\.([#0]+)$/))!==null){lP=""+lR.toFixed(Math.min(lM[2].length,10)).replace(/([^0])0+$/,"$1");lX=lP.indexOf(".");var lT=lS.indexOf(".")-lX,lY=lS.length-lP.length-lT;return lx(lS.substr(0,lT)+lP+lS.substr(lS.length-lY))}if((lM=lS.match(/^00,000\.([#0]*0)$/))!==null){return lR<0?"-"+ls(lV,lS,-lR):lc(""+lR).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(l0){return"00,"+(l0.length<3?lf(0,3-l0.length):"")+l0})+"."+lf(0,lM[1].length)}switch(lS){case"#,###":var lW=lc(""+lZ);return lW!=="0"?lQ+lW:"";default:}throw new Error("unsupported format |"+lS+"|")}return function lL(lN,lM,lO){return(lO|0)===lO?ls(lN,lM,lO):lG(lN,lM,lO)}})();function ln(ls){var lu=[];var lw=false,lx;for(var lv=0,lt=0;lv<ls.length;++lv){switch((lx=ls.charCodeAt(lv))){case 34:lw=!lw;break;case 95:case 42:case 92:++lv;break;case 59:lu[lu.length]=ls.substr(lt,lv-lt);lt=lv+1}}lu[lu.length]=ls.substr(lt);if(lw===true){throw new Error("Format |"+ls+"| unterminated string ")}return lu}le._split=ln;var k3=/\[[HhMmSs]*\]/;function kY(lt,lz,lB,lR){var lL=[],lG="",lK=0,lO="",lw="t",lF,lC,lJ,lE;var lS="H";while(lK<lt.length){switch((lO=lt[lK])){case"G":if(!k9(lt,lK)){throw new Error("unrecognized character "+lO+" in "+lt)}lL[lL.length]={t:"G",v:"General"};lK+=7;break;case'"':for(lG="";(lE=lt.charCodeAt(++lK))!==34&&lK<lt.length;){lG+=String.fromCharCode(lE)}lL[lL.length]={t:"t",v:lG};++lK;break;case"\\":var ly=lt[++lK],lA=(ly==="("||ly===")")?ly:"t";lL[lL.length]={t:lA,v:ly};++lK;break;case"_":lL[lL.length]={t:"t",v:" "};lK+=2;break;case"@":lL[lL.length]={t:"T",v:lz};++lK;break;case"B":case"b":if(lt[lK+1]==="1"||lt[lK+1]==="2"){if(lC==null){lC=lg(lz,lB,lt[lK+1]==="2");if(lC==null){return""}}lL[lL.length]={t:"X",v:lt.substr(lK,2)};lw=lO;lK+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":lO=lO.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(lz<0){return""}if(lC==null){lC=lg(lz,lB);if(lC==null){return""}}lG=lO;while(++lK<lt.length&&lt[lK].toLowerCase()===lO){lG+=lO}if(lO==="m"&&lw.toLowerCase()==="h"){lO="M"}if(lO==="h"){lO=lS}lL[lL.length]={t:lO,v:lG};lw=lO;break;case"A":lF={t:lO,v:"A"};if(lC==null){lC=lg(lz,lB)}if(lt.substr(lK,3)==="A/P"){if(lC!=null){lF.v=lC.H>=12?"P":"A"}lF.t="T";lS="h";lK+=3}else{if(lt.substr(lK,5)==="AM/PM"){if(lC!=null){lF.v=lC.H>=12?"PM":"AM"}lF.t="T";lK+=5;lS="h"}else{lF.t="t";++lK}}if(lC==null&&lF.t==="T"){return""}lL[lL.length]=lF;lw=lO;break;case"[":lG=lO;while(lt[lK++]!=="]"&&lK<lt.length){lG+=lt[lK]}if(lG.substr(-1)!=="]"){throw'unterminated "[" block: |'+lG+"|"}if(lG.match(k3)){if(lC==null){lC=lg(lz,lB);if(lC==null){return""}}lL[lL.length]={t:"Z",v:lG.toLowerCase()}}else{lG=""}break;case".":if(lC!=null){lG=lO;while((lO=lt[++lK])==="0"){lG+=lO}lL[lL.length]={t:"s",v:lG};break}case"0":case"#":lG=lO;while("0#?.,E+-%".indexOf(lO=lt[++lK])>-1||lO=="\\"&&lt[lK+1]=="-"&&"0#".indexOf(lt[lK+2])>-1){lG+=lO}lL[lL.length]={t:"n",v:lG};break;case"?":lG=lO;while(lt[++lK]===lO){lG+=lO}lF={t:lO,v:lG};lL[lL.length]=lF;lw=lO;break;case"*":++lK;if(lt[lK]==" "||lt[lK]=="*"){++lK}break;case"(":case")":lL[lL.length]={t:(lR===1?"t":lO),v:lO};++lK;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":lG=lO;while("0123456789".indexOf(lt[++lK])>-1){lG+=lt[lK]}lL[lL.length]={t:"D",v:lG};break;case" ":lL[lL.length]={t:lO,v:lO};++lK;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxz".indexOf(lO)===-1){throw new Error("unrecognized character "+lO+" in "+lt)}lL[lL.length]={t:"t",v:lO};++lK;break}}var lN=0,lI=0,lx;for(lK=lL.length-1,lw="t";lK>=0;--lK){switch(lL[lK].t){case"h":case"H":lL[lK].t=lS;lw="h";if(lN<1){lN=1}break;case"s":if((lx=lL[lK].v.match(/\.0+$/))){lI=Math.max(lI,lx[0].length-1)}if(lN<3){lN=3}case"d":case"y":case"M":case"e":lw=lL[lK].t;break;case"m":if(lw==="s"){lL[lK].t="M";if(lN<2){lN=2}}break;case"X":if(lL[lK].v==="B2"){}break;case"Z":if(lN<1&&lL[lK].v.match(/[Hh]/)){lN=1}if(lN<2&&lL[lK].v.match(/[Mm]/)){lN=2}if(lN<3&&lL[lK].v.match(/[Ss]/)){lN=3}}}switch(lN){case 0:break;case 1:if(lC.u>=0.5){lC.u=0;++lC.S}if(lC.S>=60){lC.S=0;++lC.M}if(lC.M>=60){lC.M=0;++lC.H}break;case 2:if(lC.u>=0.5){lC.u=0;++lC.S}if(lC.S>=60){lC.S=0;++lC.M}break}var ls="",lM;for(lK=0;lK<lL.length;++lK){switch(lL[lK].t){case"t":case"T":case" ":case"D":break;case"X":lL[lK]=undefined;break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":lL[lK].v=ll(lL[lK].t.charCodeAt(0),lL[lK].v,lC,lI);lL[lK].t="t";break;case"n":case"(":case"?":lM=lK+1;while(lL[lM]!=null&&((lO=lL[lM].t)==="?"||lO==="D"||(lO===" "||lO==="t")&&lL[lM+1]!=null&&(lL[lM+1].t==="?"||lL[lM+1].t==="t"&&lL[lM+1].v==="/")||lL[lK].t==="("&&(lO===" "||lO==="n"||lO===")")||lO==="t"&&(lL[lM].v==="/"||"$".indexOf(lL[lM].v)>-1||lL[lM].v===" "&&lL[lM+1]!=null&&lL[lM+1].t=="?"))){lL[lK].v+=lL[lM].v;lL[lM]=undefined;++lM}ls+=lL[lK].v;lK=lM-1;break;case"G":lL[lK].t="t";lL[lK].v=lp(lz,lB);break}}var lH="",lQ,lv;if(ls.length>0){lQ=(lz<0&&ls.charCodeAt(0)===45?-lz:lz);lv=kV(ls.charCodeAt(0)===40?"(":"n",ls,lQ);lM=lv.length-1;var lu=lL.length;for(lK=0;lK<lL.length;++lK){if(lL[lK]!=null&&lL[lK].v.indexOf(".")>-1){lu=lK;break}}var lP=lL.length;if(lu===lL.length&&lv.indexOf("E")===-1){for(lK=lL.length-1;lK>=0;--lK){if(lL[lK]==null||"n?(".indexOf(lL[lK].t)===-1){continue}if(lM>=lL[lK].v.length-1){lM-=lL[lK].v.length;lL[lK].v=lv.substr(lM+1,lL[lK].v.length)}else{if(lM<0){lL[lK].v=""}else{lL[lK].v=lv.substr(0,lM+1);lM=-1}}lL[lK].t="t";lP=lK}if(lM>=0&&lP<lL.length){lL[lP].v=lv.substr(0,lM+1)+lL[lP].v}}else{if(lu!==lL.length&&lv.indexOf("E")===-1){lM=lv.indexOf(".")-1;for(lK=lu;lK>=0;--lK){if(lL[lK]==null||"n?(".indexOf(lL[lK].t)===-1){continue}lJ=lL[lK].v.indexOf(".")>-1&&lK===lu?lL[lK].v.indexOf(".")-1:lL[lK].v.length-1;lH=lL[lK].v.substr(lJ+1);for(;lJ>=0;--lJ){if(lM>=0&&(lL[lK].v[lJ]==="0"||lL[lK].v[lJ]==="#")){lH=lv[lM--]+lH}}lL[lK].v=lH;lL[lK].t="t";lP=lK}if(lM>=0&&lP<lL.length){lL[lP].v=lv.substr(0,lM+1)+lL[lP].v}lM=lv.indexOf(".")+1;for(lK=lu;lK<lL.length;++lK){if(lL[lK]==null||"n?(".indexOf(lL[lK].t)===-1&&lK!==lu){continue}lJ=lL[lK].v.indexOf(".")>-1&&lK===lu?lL[lK].v.indexOf(".")+1:0;lH=lL[lK].v.substr(0,lJ);for(;lJ<lL[lK].v.length;++lJ){if(lM<lv.length){lH+=lv[lM++]}}lL[lK].v=lH;lL[lK].t="t";lP=lK}}}}for(lK=0;lK<lL.length;++lK){if(lL[lK]!=null&&"n(?".indexOf(lL[lK].t)>-1){lQ=(lR>1&&lz<0&&lK>0&&lL[lK-1].v==="-"?-lz:lz);lL[lK].v=kV(lL[lK].t,lL[lK].v,lQ);lL[lK].t="t"}}var lD="";for(lK=0;lK!==lL.length;++lK){if(lL[lK]!=null){lD+=lL[lK].v}}return lD}le._eval=kY;var fs=/\[[=<>]/;var k0=/\[([=<>]*)(-?\d+\.?\d*)\]/;function la(ls,lt){if(lt==null){return false}var lu=parseFloat(lt[2]);switch(lt[1]){case"=":if(ls==lu){return true}break;case">":if(ls>lu){return true}break;case"<":if(ls<lu){return true}break;case"<>":if(ls!=lu){return true}break;case">=":if(ls>=lu){return true}break;case"<=":if(ls<=lu){return true}break}return false}function lq(ly,lw){var lt=ln(ly);var ls=lt.length,lz=lt[ls-1].indexOf("@");if(ls<4&&lz>-1){--ls}if(lt.length>4){throw"cannot find right format for |"+lt+"|"}if(typeof lw!=="number"){return[4,lt.length===4||lz>-1?lt[lt.length-1]:"@"]}switch(lt.length){case 1:lt=lz>-1?["General","General","General",lt[0]]:[lt[0],lt[0],lt[0],"@"];break;case 2:lt=lz>-1?[lt[0],lt[0],lt[0],lt[1]]:[lt[0],lt[1],lt[0],"@"];break;case 3:lt=lz>-1?[lt[0],lt[1],lt[0],lt[2]]:[lt[0],lt[1],lt[2],"@"];break;case 4:break}var lv=lw>0?lt[0]:lw<0?lt[1]:lt[2];if(lt[0].indexOf("[")===-1&&lt[1].indexOf("[")===-1){return[ls,lv]}if(lt[0].match(fs)!=null||lt[1].match(fs)!=null){var lx=lt[0].match(k0);var lu=lt[1].match(k0);return la(lw,lx)?[ls,lt[0]]:la(lw,lu)?[ls,lt[1]]:[ls,lt[lx!=null&&lu!=null?2:1]]}return[ls,lv]}function ld(ls,lt,lw){k2(lw!=null?lw:(lw=[]));var lv="";switch(typeof ls){case"string":lv=ls;break;case"number":lv=(lw.table!=null?lw.table:lk)[ls];break}if(k9(lv,0)){return lp(lt,lw)}var lu=lq(lv,lt);if(k9(lu[1])){return lp(lt,lw)}if(lt===true){lt="TRUE"}else{if(lt===false){lt="FALSE"}else{if(lt===""||lt==null){return""}}}return kY(lu[1],lt,lw,lu[0])}le._table=lk;le.load=function k4(lt,ls){lk[ls]=lt};le.format=ld;le.get_table=function lb(){return lk};le.load_table=function kR(lt){for(var ls=0;ls!=392;++ls){if(lt[ls]!==undefined){le.load(lt[ls],ls)}}}};gx(cN);var gt=0;var h7=1;var ff=2;var fc=3;var c6=4;var c2=5;var gf=6;var bD=7;var hP=8;var er=10;var du=11;var ab=12;var U=14;var fg=16;var bT=17;var bR=18;var bN=19;var fa=20;var bL=21;var gl=22;var dM=23;var B=30;var jc=31;var aj=64;var cg=65;var V=66;var jD=67;var cs=68;var hz=69;var h9=70;var gn=71;var gS=72;var K=73;var d3=4096;var cD=8192;var cO=80;var j=81;var iG=[cO,j];var ge={1:{n:"CodePage",t:ff},2:{n:"Category",t:cO},3:{n:"PresentationFormat",t:cO},4:{n:"ByteCount",t:fc},5:{n:"LineCount",t:fc},6:{n:"ParagraphCount",t:fc},7:{n:"SlideCount",t:fc},8:{n:"NoteCount",t:fc},9:{n:"HiddenCount",t:fc},10:{n:"MultimediaClipCount",t:fc},11:{n:"Scale",t:du},12:{n:"HeadingPair",t:d3|ab},13:{n:"DocParts",t:d3|B},14:{n:"Manager",t:cO},15:{n:"Company",t:cO},16:{n:"LinksDirty",t:du},17:{n:"CharacterCount",t:fc},19:{n:"SharedDoc",t:du},22:{n:"HLinksChanged",t:du},23:{n:"AppVersion",t:fc,p:"version"},26:{n:"ContentType",t:cO},27:{n:"ContentStatus",t:cO},28:{n:"Language",t:cO},29:{n:"Version",t:cO},255:{}};var ed={1:{n:"CodePage",t:ff},2:{n:"Title",t:cO},3:{n:"Subject",t:cO},4:{n:"Author",t:cO},5:{n:"Keywords",t:cO},6:{n:"Comments",t:cO},7:{n:"Template",t:cO},8:{n:"LastAuthor",t:cO},9:{n:"RevNumber",t:cO},10:{n:"EditTime",t:aj},11:{n:"LastPrinted",t:aj},12:{n:"CreatedDate",t:aj},13:{n:"ModifiedDate",t:aj},14:{n:"PageCount",t:fc},15:{n:"WordCount",t:fc},16:{n:"CharCount",t:fc},17:{n:"Thumbnail",t:gn},18:{n:"ApplicationName",t:B},19:{n:"DocumentSecurity",t:fc},255:{}};var hG={2147483648:{n:"Locale",t:bN},2147483651:{n:"Behavior",t:bN},1768515945:{}};(function(){for(var fs in hG){if(hG.hasOwnProperty(fs)){ge[fs]=ed[fs]=hG[fs]}}})();function hA(kR){var kS=kR.read_shift(4),fs=kR.read_shift(4);return new Date(((fs/10000000*Math.pow(2,32)+kS/10000000)-11644473600)*1000).toISOString().replace(/\.000/,"")}function y(fs,kR,kS){var kT=fs.read_shift(0,"lpstr");if(kS){fs.l+=(4-((kT.length+1)&3))&3}return kT}function jj(fs,kR,kS){var kT=fs.read_shift(0,"lpwstr");if(kS){fs.l+=(4-((kT.length+1)&3))&3}return kT}function d2(kR,fs,kS){if(fs===31){return jj(kR)}return y(kR,fs,kS)}function kt(fs,kR,kS){return d2(fs,kR,kS===false?0:4)}function gb(fs,kR){if(!kR){throw new Error("dafuq?")}return d2(fs,kR,0)}function at(fs){var kT=fs.read_shift(4);var kR=[];for(var kS=0;kS!=kT;++kS){kR[kS]=fs.read_shift(0,"lpstr")}return kR}function e8(fs){return at(fs)}function ig(fs){var kS=b4(fs,j);var kR=b4(fs,fc);return[kS,kR]}function jP(fs){var kT=fs.read_shift(4);var kR=[];for(var kS=0;kS!=kT/2;++kS){kR.push(ig(fs))}return kR}function fd(fs){return jP(fs)}function dp(kS,kV){var kU=kS.read_shift(4);var kW={};for(var kT=0;kT!=kU;++kT){var kR=kS.read_shift(4);var fs=kS.read_shift(4);kW[kR]=kS.read_shift(fs,(kV===1200?"utf16le":"utf8")).replace(a8,"").replace(a7,"!")}if(kS.l&3){kS.l=(kS.l>>2+1)<<2}return kW}function iy(kR){var kS=kR.read_shift(4);var fs=kR.slice(kR.l,kR.l+kS);if(kS&3>0){kR.l+=(4-(kS&3))&3}return fs}function M(fs){var kR={};kR.Size=fs.read_shift(4);fs.l+=kR.Size;return kR}function R(kR,fs){}function b4(fs,kU,kT){var kS=fs.read_shift(2),kR,kV=kT||{};fs.l+=2;if(kU!==ab){if(kS!==kU&&iG.indexOf(kU)===-1){throw new Error("Expected type "+kU+" saw "+kS)}}switch(kU===ab?kS:kU){case 2:kR=fs.read_shift(2,"i");if(!kV.raw){fs.l+=2}return kR;case 3:kR=fs.read_shift(4,"i");return kR;case 11:return fs.read_shift(4)!==0;case 19:kR=fs.read_shift(4);return kR;case 30:return y(fs,kS,4).replace(a8,"");case 31:return jj(fs);case 64:return hA(fs);case 65:return iy(fs);case 71:return M(fs);case 80:return kt(fs,kS,!kV.raw&&4).replace(a8,"");case 81:return gb(fs,kS,4).replace(a8,"");case 4108:return fd(fs);case 4126:return e8(fs);default:throw new Error("TypedPropertyValue unrecognized type "+kU+" "+kS)}}function kE(fs,kX){var k0=fs.l;var kY=fs.read_shift(4);var kR=fs.read_shift(4);var kV=[],k2=0;var k3=0;var k4=-1,kZ;for(k2=0;k2!=kR;++k2){var k5=fs.read_shift(4);var kS=fs.read_shift(4);kV[k2]=[k5,kS+k0]}var kU={};for(k2=0;k2!=kR;++k2){if(fs.l!==kV[k2][1]){var kT=true;if(k2>0&&kX){switch(kX[kV[k2-1][0]].t){case 2:if(fs.l+2===kV[k2][1]){fs.l+=2;kT=false}break;case 80:if(fs.l<=kV[k2][1]){fs.l=kV[k2][1];kT=false}break;case 4108:if(fs.l<=kV[k2][1]){fs.l=kV[k2][1];kT=false}break}}if(!kX&&fs.l<=kV[k2][1]){kT=false;fs.l=kV[k2][1]}if(kT){throw new Error("Read Error: Expected address "+kV[k2][1]+" at "+fs.l+" :"+k2)}}if(kX){var k1=kX[kV[k2][0]];kU[k1.n]=b4(fs,k1.t,{raw:true});if(k1.p==="version"){kU[k1.n]=String(kU[k1.n]>>16)+"."+String(kU[k1.n]&65535)}if(k1.n=="CodePage"){switch(kU[k1.n]){case 0:kU[k1.n]=1252;case 10000:case 1252:case 874:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 932:case 936:case 949:case 950:case 1200:case 1201:case 65000:case -536:case 65001:case -535:ew(k3=kU[k1.n]);break;default:throw new Error("Unsupported CodePage: "+kU[k1.n])}}}else{if(kV[k2][0]===1){k3=kU.CodePage=b4(fs,ff);ew(k3);if(k4!==-1){var kW=fs.l;fs.l=kV[k4][1];kZ=dp(fs,k3);fs.l=kW}}else{if(kV[k2][0]===0){if(k3===0){k4=k2;fs.l=kV[k2+1][1];continue}kZ=dp(fs,k3)}else{var k7=kZ[kV[k2][0]];var k6;switch(fs[fs.l]){case 65:fs.l+=4;k6=iy(fs);break;case 30:fs.l+=4;k6=kt(fs,fs[fs.l-4]);break;case 31:fs.l+=4;k6=kt(fs,fs[fs.l-4]);break;case 3:fs.l+=4;k6=fs.read_shift(4,"i");break;case 19:fs.l+=4;k6=fs.read_shift(4);break;case 5:fs.l+=4;k6=fs.read_shift(8,"f");break;case 11:fs.l+=4;k6=ih(fs,4);break;case 64:fs.l+=4;k6=new Date(hA(fs));break;default:throw new Error("unparsed value: "+fs[fs.l])}kU[k7]=k6}}}}fs.l=k0+kY;return kU}function fb(kR,kY){var fs=kR.content;ht(fs,0);var kW,k0,kZ,k4,k2;fs.chk("feff","Byte Order: ");var kU=fs.read_shift(2);var kT=fs.read_shift(4);fs.chk(f4.utils.consts.HEADER_CLSID,"CLSID: ");kW=fs.read_shift(4);if(kW!==1&&kW!==2){throw"Unrecognized #Sets: "+kW}k0=fs.read_shift(16);k4=fs.read_shift(4);if(kW===1&&k4!==fs.l){throw"Length mismatch"}else{if(kW===2){kZ=fs.read_shift(16);k2=fs.read_shift(4)}}var k3=kE(fs,kY);var kS={SystemIdentifier:kT};for(var kX in k3){kS[kX]=k3[kX]}kS.FMTID=k0;if(kW===1){return kS}if(fs.l!==k2){throw"Length mismatch 2: "+fs.l+" !== "+k2}var k1;try{k1=kE(fs,null)}catch(kV){}for(kX in k1){kS[kX]=k1[kX]}kS.FMTID=[k0,kZ];return kS}var an=true;var f4=(function jk(){var k9={};k9.version="0.10.2";function k0(lt){var lk=3;var ld=512;var lv=0;var lw=0;var ll=0;var lh=0;var lc=0;var lx=[];var lb=lt.slice(0,512);ht(lb,0);var ln=k7(lb);lk=ln[0];switch(lk){case 3:ld=512;break;case 4:ld=4096;break;default:throw"Major Version: Expected 3 or 4 saw "+lk}if(ld!==512){lb=lt.slice(0,ld);ht(lb,28)}var lr=lt.slice(0,ld);k1(lb,lk);var li=lb.read_shift(4,"i");if(lk===3&&li!==0){throw"# Directory Sectors: Expected 0 saw "+li}lb.l+=4;ll=lb.read_shift(4,"i");lb.l+=4;lb.chk("00100000","Mini Stream Cutoff Size: ");lh=lb.read_shift(4,"i");lv=lb.read_shift(4,"i");lc=lb.read_shift(4,"i");lw=lb.read_shift(4,"i");for(var lo,lq=0;lq<109;++lq){lo=lb.read_shift(4,"i");if(lo<0){break}lx[lq]=lo}var lm=kV(lt,ld);kW(lc,lw,lm,ld,lx);var lp=k3(lm,ll,lx,ld);lp[ll].name="!Directory";if(lv>0&&lh!==k5){lp[lh].name="!MiniFAT"}lp[lx[0]].name="!FAT";lp.fat_addrs=lx;lp.ssz=ld;var lf={},lu=[],fs=[],lg=[],le={};la(ll,lp,lm,lu,lv,lf,fs);k8(fs,le,lg,lu);var lj=lu.shift();lu.root=lj;var ls=kX(lg,lu,fs,lf,lj);return{raw:{header:lr,sectors:lm},FileIndex:fs,FullPaths:lg,FullPathDir:le,find:ls}}function k7(fs){fs.chk(kT,"Header Signature: ");fs.chk(kR,"CLSID: ");var lb=fs.read_shift(2,"u");return[fs.read_shift(2,"u"),lb]}function k1(lb,lc){var fs=9;lb.chk("feff","Byte Order: ");switch((fs=lb.read_shift(2))){case 9:if(lc!==3){throw"MajorVersion/SectorShift Mismatch"}break;case 12:if(lc!==4){throw"MajorVersion/SectorShift Mismatch"}break;default:throw"Sector Shift: Expected 9 or 12 saw "+fs}lb.chk("0600","Mini Sector Shift: ");lb.chk("000000000000","Reserved: ")}function kV(lc,le){var fs=Math.ceil(lc.length/le)-1;var ld=new Array(fs);for(var lb=1;lb<fs;++lb){ld[lb-1]=lc.slice(lb*le,(lb+1)*le)}ld[fs-1]=lc.slice(fs*le);return ld}function k8(li,lf,lc,ll){var lh=0,lk=0,lg=0,lb=0,le=0,ld=ll.length;var lj=new Array(ld),fs=new Array(ld);for(;lh<ld;++lh){lj[lh]=fs[lh]=lh;lc[lh]=ll[lh]}for(;le<fs.length;++le){lh=fs[le];lk=li[lh].L;lg=li[lh].R;lb=li[lh].C;if(lj[lh]===lh){if(lk!==-1&&lj[lk]!==lk){lj[lh]=lj[lk]}if(lg!==-1&&lj[lg]!==lg){lj[lh]=lj[lg]}}if(lb!==-1){lj[lb]=lh}if(lk!==-1){lj[lk]=lj[lh];fs.push(lk)}if(lg!==-1){lj[lg]=lj[lh];fs.push(lg)}}for(lh=1;lh!==ld;++lh){if(lj[lh]===lh){if(lg!==-1&&lj[lg]!==lg){lj[lh]=lj[lg]}else{if(lk!==-1&&lj[lk]!==lk){lj[lh]=lj[lk]}}}}for(lh=1;lh<ld;++lh){if(li[lh].type===0){continue}le=lj[lh];if(le===0){lc[lh]=lc[0]+"/"+lc[lh]}else{while(le!==0){lc[lh]=lc[le]+"/"+lc[lh];le=lj[le]}}lj[lh]=0}lc[0]+="/";for(lh=1;lh<ld;++lh){if(li[lh].type!==2){lc[lh]+="/"}lf[lc[lh]]=li[lh]}}function kX(lg,lf,lb,fs,li){var lh=new Array(lg.length);var le=new Array(lf.length),ld;for(ld=0;ld<lg.length;++ld){lh[ld]=lg[ld].toUpperCase().replace(a8,"").replace(a7,"!")}for(ld=0;ld<lf.length;++ld){le[ld]=lf[ld].toUpperCase().replace(a8,"").replace(a7,"!")}return function lc(lm){var lk;if(lm.charCodeAt(0)===47){lk=true;lm=li+lm}else{lk=lm.indexOf("/")!==-1}var ll=lm.toUpperCase().replace(a8,"").replace(a7,"!");var lj=lk===true?lh.indexOf(ll):le.indexOf(ll);if(lj===-1){return null}return lk===true?lb[lj]:fs[lf[lj]]}}function kW(lh,lb,li,lg,lf){var fs;if(lh===k5){if(lb!==0){throw"DIFAT chain shorter than expected"}}else{if(lh!==-1){var ld=li[lh],lc=(lg>>>2)-1;for(var le=0;le<lc;++le){if((fs=f1(ld,le*4))===k5){break}lf.push(fs)}kW(f1(ld,lg-4),lb-1,li,lg,lf)}}}function k6(ll,fs,lf,li,lc){var ld=ll.length;var lb,lk;if(!lc){lc=new Array(ld)}var lj=li-1,le,lg;lb=[];lk=[];for(le=fs;le>=0;){lc[le]=true;lb[lb.length]=le;lk.push(ll[le]);var lh=lf[Math.floor(le*4/li)];lg=((le*4)&lj);if(li<4+lg){throw"FAT boundary crossed: "+le+" 4 "+li}le=f1(ll[lh],lg)}return{nodes:lb,data:fK([lk])}}function k3(lo,li,lg,lk){var lc=lo.length,ln=new Array(lc);var lb=new Array(lc),fs,lm;var ll=lk-1,lf,le,ld,lh;for(lf=0;lf<lc;++lf){fs=[];ld=(lf+li);if(ld>=lc){ld-=lc}if(lb[ld]===true){continue}lm=[];for(le=ld;le>=0;){lb[le]=true;fs[fs.length]=le;lm.push(lo[le]);var lj=lg[Math.floor(le*4/lk)];lh=((le*4)&ll);if(lk<4+lh){throw"FAT boundary crossed: "+le+" 4 "+lk}le=f1(lo[lj],lh)}ln[ld]={nodes:fs,data:fK([lm])}}return ln}function la(lk,lp,lq,lo,ll,le,li){var lb;var fs=0,lh=(lo.length?2:0);var lg=lp[lk].data;var lj=0,ld=0,lc,lf,lm,ln;for(;lj<lg.length;lj+=128){lb=lg.slice(lj,lj+128);ht(lb,64);ld=lb.read_shift(2);if(ld===0){continue}lc=iY(lb,0,ld-lh);lo.push(lc);lf={name:lc,type:lb.read_shift(1),color:lb.read_shift(1),L:lb.read_shift(4,"i"),R:lb.read_shift(4,"i"),C:lb.read_shift(4,"i"),clsid:lb.read_shift(16),state:lb.read_shift(4,"i")};lm=lb.read_shift(2)+lb.read_shift(2)+lb.read_shift(2)+lb.read_shift(2);if(lm!==0){lf.ctime=lm;lf.ct=kS(lb,lb.l-8)}ln=lb.read_shift(2)+lb.read_shift(2)+lb.read_shift(2)+lb.read_shift(2);if(ln!==0){lf.mtime=ln;lf.mt=kS(lb,lb.l-8)}lf.start=lb.read_shift(4,"i");lf.size=lb.read_shift(4,"i");if(lf.type===5){fs=lf.start;if(ll>0&&fs!==k5){lp[fs].name="!StreamData"}}else{if(lf.size>=4096){lf.storage="fat";if(lp[lf.start]===undefined){lp[lf.start]=k6(lq,lf.start,lp.fat_addrs,lp.ssz)}lp[lf.start].name=lf.name;lf.content=lp[lf.start].data.slice(0,lf.size);ht(lf.content,0)}else{lf.storage="minifat";if(fs!==k5&&lf.start!==k5){lf.content=lp[fs].data.slice(lf.start*k4,lf.start*k4+lf.size);ht(lf.content,0)}}}le[lc]=lf;li.push(lf)}}function kS(fs,lb){return new Date((((a5(fs,lb+4)/10000000)*Math.pow(2,32)+a5(fs,lb)/10000000)-11644473600)*1000)}var kU;function k2(fs,lb){if(kU===undefined){kU=require("fs")}return k0(kU.readFileSync(fs),lb)}function kY(fs,lb){switch(lb!==undefined&&lb.type!==undefined?lb.type:"base64"){case"file":return k2(fs,lb);case"base64":return k0(jY(bm.decode(fs)),lb);case"binary":return k0(jY(fs),lb)}return k0(fs)}var k4=64;var k5=-2;var kT="d0cf11e0a1b11ae1";var kR="00000000000000000000000000000000";var kZ={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:k5,FREESECT:-1,HEADER_SIGNATURE:kT,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:kR,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};k9.read=kY;k9.parse=k0;k9.utils={ReadShift:d0,CheckField:ev,prep_blob:ht,bconcat:hQ,consts:kZ};return k9})();if(typeof require!=="undefined"&&typeof module!=="undefined"&&typeof an==="undefined"){module.exports=f4}function jH(fs,kR){fs.read_shift(kR);return}function cb(fs,kR){fs.read_shift(kR);return null}function z(kS,kT,kR){var fs=[],kU=kS.l+kT;while(kS.l<kU){fs.push(kR(kS,kU-kS.l))}if(kU!==kS.l){throw new Error("Slurp error")}return fs}function gT(kT,kU,kS){var kR=[],kV=kT.l+kU,fs=kT.read_shift(2);while(fs--!==0){kR.push(kS(kT,kV-kT.l))}if(kV!==kT.l){throw new Error("Slurp error")}return kR}function ih(fs,kR){return fs.read_shift(kR)===1}function gd(fs){return fs.read_shift(2,"u")}function fI(fs,kR){return z(fs,kR,gd)}var ku=ih;function dE(kR){var fs=kR.read_shift(1),kS=kR.read_shift(1);return kS===1?fs:fs===1}function W(fs,kW,kV){var kS=fs.read_shift(1);var kR=1,kU="sbcs";if(kV===undefined||kV.biff!==5){var kT=fs.read_shift(1);if(kT){kR=2;kU="dbcs"}}return kS?fs.read_shift(kS,kU):""}function ie(fs){var k0=fs.read_shift(2),kV=fs.read_shift(1);var kR=kV&1,kX=kV&4,kW=kV&8;var kS=1+(kV&1);var kZ,kY;var k1={};if(kW){kZ=fs.read_shift(2)}if(kX){kY=fs.read_shift(4)}var kT=(kV&1)?"dbcs":"sbcs";var kU=k0===0?"":fs.read_shift(k0,kT);if(kW){fs.l+=4*kZ}if(kX){fs.l+=kY}k1.t=kU;if(!kW){k1.raw="<t>"+k1.t+"</t>";k1.r=k1.t}return k1}function cw(kR,kS,kU){var fs;var kT=kR.read_shift(1);if(kT===0){fs=kR.read_shift(kS,"sbcs")}else{fs=kR.read_shift(kS,"dbcs")}return fs}function bF(fs,kT,kS){var kR=fs.read_shift(kS!==undefined&&kS.biff>0&&kS.biff<8?1:2);if(kR===0){fs.l++;return""}return cw(fs,kR,kS)}function dY(fs,kT,kS){if(kS.biff!==5&&kS.biff!==2){return bF(fs,kT,kS)}var kR=fs.read_shift(1);if(kR===0){fs.l++;return""}return fs.read_shift(kR,"sbcs")}function hK(fs){return fs.read_shift(8,"f")}var g2=jH;var eA=function(kS,kU){var kR=kS.read_shift(4),kV=kS.l;var fs=false;if(kR>24){kS.l+=kR-24;if(kS.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"){fs=true}kS.l=kV}var kT=kS.read_shift((fs?kR-24:kR)>>1,"utf16le").replace(a8,"");if(fs){kS.l+=24}return kT};var ec=function(fs,kT){var kU=fs.read_shift(2);var kS=fs.read_shift(4);var kX=fs.read_shift(kS,"cstr");var kW=fs.read_shift(2);var kZ=fs.read_shift(2);var kV=fs.read_shift(4);if(kV===0){return kX.replace(/\\/g,"/")}var kR=fs.read_shift(4);var k0=fs.read_shift(2);var kY=fs.read_shift(kR>>1,"utf16le").replace(a8,"");return kY};var X=function(fs,kR){var kS=fs.read_shift(16);kR-=16;switch(kS){case"e0c9ea79f9bace118c8200aa004ba90b":return eA(fs,kR);case"0303000000000000c000000000000046":return ec(fs,kR);default:throw"unsupported moniker "+kS}};var km=function(kR,kS){var fs=kR.read_shift(4);var kT=kR.read_shift(fs,"utf16le").replace(a8,"");return kT};var iZ=function(fs,kR){var kU=fs.l+kR;var kY=fs.read_shift(4);if(kY!==2){throw new Error("Unrecognized streamVersion: "+kY)}var kS=fs.read_shift(2);fs.l+=2;var k0,k2,kV,kT,k1,kZ,kW;if(kS&16){k0=km(fs,kU-fs.l)}if(kS&128){k2=km(fs,kU-fs.l)}if((kS&257)===257){kV=km(fs,kU-fs.l)}if((kS&257)===1){kT=X(fs,kU-fs.l)}if(kS&8){k1=km(fs,kU-fs.l)}if(kS&32){kZ=fs.read_shift(16)}if(kS&64){kW=hA(fs,8)}fs.l=kU;var kX=(k2||kV||kT);if(k1){kX+="#"+k1}return{Target:kX}};function a2(kS,kV){var kU=kS.read_shift(1),kT=kS.read_shift(1),fs=kS.read_shift(1),kR=kS.read_shift(1);return[kU,kT,fs,kR]}function hM(kR,kS){var fs=a2(kR,kS);fs[3]=0;return fs}var gZ=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function ai(fs){return fs.map(function(kR){return[(kR>>16)&255,(kR>>8)&255,kR&255]})}var bz=ai([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0]);function hI(fs){return fs!==undefined&&fs!==null}function gc(fs){return Object.keys(fs)}function dK(kU,fs){var kV={};var kR=gc(kU);for(var kT=0;kT<kR.length;++kT){var kS=kR[kT];if(!fs){kV[kU[kS]]=kS}else{(kV[kU[kS]]=kV[kU[kS]]||[]).push(kS)}}return kV}function ae(fs){for(var kR=0,kS=1;kR!=3;++kR){kS=kS*256+(fs[kR]>255?255:fs[kR]<0?0:fs[kR])}return kS.toString(16).toUpperCase().substr(1)}function aL(kR,kT){var kU=kR.read_shift(2);var kS=kR.read_shift(2);var fs=kR.read_shift(2);return{r:kU,c:kS,ixfe:fs}}function l(kS){var kR=kS.read_shift(2);var fs=kS.read_shift(2);kS.l+=8;return{type:kR,flags:fs}}function gH(fs,kS,kR){return kS===0?"":dY(fs,kS,kR)}var b5=["SHOWALL","SHOWPLACEHOLDER","HIDEALL"];var bO=gd;function kz(kR,kU){var kT=kR.read_shift(2),fs=kR.read_shift(2,"i"),kS=kR.read_shift(2,"i");return[kT,fs,kS]}function dL(kU){var kS=kU.slice(kU.l,kU.l+4);var kT=kS[0]&1,kR=kS[0]&2;kU.l+=4;kS[0]&=~3;var fs=kR===0?gv([0,0,0,0,kS[0],kS[1],kS[2],kS[3]],0):f1(kS,0)>>2;return kT?fs/100:fs}function hF(kS,kT){var kR=kS.read_shift(2);var fs=dL(kS);return[kR,fs]}function kO(kS,kT){kS.l+=4;kT-=4;var kR=kS.l+kT;var kU=W(kS,kT);var fs=kS.read_shift(2);kR-=kS.l;if(fs!==kR){throw"Malformed AddinUdf: padding = "+kR+" != "+fs}kS.l+=fs;return kU}function f0(kS,kT){var kR=kS.read_shift(2);var fs=kS.read_shift(2);var kV=kS.read_shift(2);var kU=kS.read_shift(2);return{s:{c:kV,r:kR},e:{c:kU,r:fs}}}function aU(kS,kT){var kR=kS.read_shift(2);var fs=kS.read_shift(2);var kV=kS.read_shift(1);var kU=kS.read_shift(1);return{s:{c:kV,r:kR},e:{c:kU,r:fs}}}var dx=aU;function g(kR,kT){kR.l+=4;var kS=kR.read_shift(2);var kU=kR.read_shift(2);var fs=kR.read_shift(2);kR.l+=12;return[kU,kS,fs]}function kw(fs,kS){var kR={};fs.l+=4;fs.l+=16;kR.fSharedNote=fs.read_shift(2);fs.l+=4;return kR}function dh(fs,kS){var kR={};fs.l+=4;fs.cf=fs.read_shift(2);return kR}var az={21:g,19:jH,18:function(fs,kR){fs.l+=12},17:function(fs,kR){fs.l+=8},16:jH,15:jH,13:kw,12:function(fs,kR){fs.l+=24},11:function(fs,kR){fs.l+=10},10:function(fs,kR){fs.l+=16},9:jH,8:function(fs,kR){fs.l+=6},7:dh,6:function(fs,kR){fs.l+=6},4:jH,0:function(fs,kR){fs.l+=4}};function eS(fs,kU,kT){var kS=fs.l;var kR=[];while(fs.l<kS+kU){var kW=fs.read_shift(2);fs.l-=2;try{kR.push(az[kW](fs,kS+kU-fs.l))}catch(kV){fs.l=kS+kU;return kR}}if(fs.l!=kS+kU){fs.l=kS+kU}return kR}var b0=gd;function jm(fs,kR){var kS={};kS.BIFFVer=fs.read_shift(2);kR-=2;switch(kS.BIFFVer){case 1536:case 1280:case 2:case 7:break;default:throw"Unexpected BIFF Ver "+kS.BIFFVer}fs.read_shift(kR);return kS}function gg(fs,kR){if(kR===0){return 1200}var kS;if((kS=fs.read_shift(2))!==1200){throw"InterfaceHdr codePage "+kS}return 1200}function jT(kR,kT,kS){if(kS.enc){kR.l+=kT;return""}var fs=kR.l;var kU=bF(kR,0,kS);kR.read_shift(kT+fs-kR.l);return kU}function eU(fs,kU,kT){var kW=fs.read_shift(4);var kV=fs.read_shift(1)>>6;var kS=fs.read_shift(1);switch(kS){case 0:kS="Worksheet";break;case 1:kS="Macrosheet";break;case 2:kS="Chartsheet";break;case 6:kS="VBAModule";break}var kR=W(fs,0,kT);if(kR.length===0){kR="Sheet1"}return{pos:kW,hs:kV,dt:kS,name:kR}}function aD(fs,kU){var kS=fs.read_shift(4);var kT=fs.read_shift(4);var kV=[];for(var kR=0;kR!=kT;++kR){kV.push(ie(fs))}kV.Count=kS;kV.Unique=kT;return kV}function am(fs,kS){var kR={};kR.dsst=fs.read_shift(2);fs.l+=kS-2;return kR}function a0(kR,kT){var kV=kR.read_shift(2),kS=kR.read_shift(2),kW=kR.read_shift(2),kU=kR.read_shift(2);kR.read_shift(4);var fs=kR.read_shift(1);kR.read_shift(1);kR.read_shift(2);return{r:kV,c:kS,cnt:kW-kS}}function fu(kR,kS){var kT=l(kR);if(kT.type!=2211){throw"Invalid Future Record "+kT.type}var fs=kR.read_shift(4);return fs!==0}var a9=cb;function jJ(fs,kR){fs.read_shift(2);return fs.read_shift(4)}function j1(fs,kR){var kT=fs.read_shift(2),kU;kU=fs.read_shift(2);var kS={Unsynced:kT&1,DyZero:(kT&2)>>1,ExAsc:(kT&4)>>2,ExDsc:(kT&8)>>3};return[kS,kU]}function jh(fs,kS){var kR=fs.read_shift(2),kV=fs.read_shift(2),k0=fs.read_shift(2),kT=fs.read_shift(2);var kU=fs.read_shift(2),kZ=fs.read_shift(2),kW=fs.read_shift(2);var kY=fs.read_shift(2),kX=fs.read_shift(2);return{Pos:[kR,kV],Dim:[k0,kT],Flags:kU,CurTab:kZ,FirstTab:kW,Selected:kY,TabRatio:kX}}function f9(fs,kT,kS){fs.l+=14;var kR=W(fs,0,kS);return kR}function eV(kR,kS){var fs=aL(kR);fs.isst=kR.read_shift(4);return fs}function gG(kR,kT,kS){var fs=aL(kR,6);var kU=bF(kR,kT-6,kS);fs.val=kU;return fs}function bq(fs,kU,kT){var kR=fs.read_shift(2);var kS=dY(fs,0,kT);return[kR,kS]}function f(kR,kU){var fs=kU===10?2:4;var kT=kR.read_shift(fs),kS=kR.read_shift(fs),kW=kR.read_shift(2),kV=kR.read_shift(2);kR.l+=2;return{s:{r:kT,c:kW},e:{r:kS,c:kV}}}function c7(fs,kS){var kU=fs.read_shift(2),kR=fs.read_shift(2);var kT=hF(fs);return{r:kU,c:kR,ixfe:kT[0],rknum:kT[1]}}function kC(fs,kT){var kU=fs.l+kT-2;var kW=fs.read_shift(2),kR=fs.read_shift(2);var kV=[];while(fs.l<kU){kV.push(hF(fs))}if(fs.l!==kU){throw"MulRK read error"}var kS=fs.read_shift(2);if(kV.length!=kS-kR+1){throw"MulRK length mismatch"}return{r:kW,c:kR,C:kS,rkrec:kV}}function ja(kS,kU,kT){var kW={};var kR=kS.read_shift(4),fs=kS.read_shift(4);var kX=kS.read_shift(4),kV=kS.read_shift(2);kW.patternType=gZ[kX>>26];kW.icvFore=kV&127;kW.icvBack=(kV>>7)&127;return kW}function gC(fs,kR){return ja(fs,kR,0)}function bP(fs,kR){return ja(fs,kR,1)}function bw(fs,kR){var kS={};kS.ifnt=fs.read_shift(2);kS.ifmt=fs.read_shift(2);kS.flags=fs.read_shift(2);kS.fStyle=(kS.flags>>2)&1;kR-=6;kS.data=ja(fs,kR,kS.fStyle);return kS}function cS(fs,kS){fs.l+=4;var kR=[fs.read_shift(2),fs.read_shift(2)];if(kR[0]!==0){kR[0]--}if(kR[1]!==0){kR[1]--}if(kR[0]>7||kR[1]>7){throw"Bad Gutters: "+kR}return kR}function gE(kR,kS){var fs=aL(kR,6);var kT=dE(kR,2);fs.val=kT;fs.t=(kT===true||kT===false)?"b":"e";return fs}function jL(kR,kT){var fs=aL(kR,6);var kS=hK(kR,8);fs.val=kS;return fs}var gh=gH;function eR(kR,kW,kV){var fs=kR.l+kW;var kU=kR.read_shift(2);var kT=kR.read_shift(2);var kS;if(kT>=1&&kT<=255){kS=cw(kR,kT)}var kX=kR.read_shift(fs-kR.l);kV.sbcch=kT;return[kT,kU,kS,kX]}function da(kS,kU,kT){var kR=kS.read_shift(2);var fs;var kV={fBuiltIn:kR&1,fWantAdvise:(kR>>>1)&1,fWantPict:(kR>>>2)&1,fOle:(kR>>>3)&1,fOleLink:(kR>>>4)&1,cf:(kR>>>5)&1023,fIcon:kR>>>15&1};if(kT.sbcch===14849){fs=kO(kS,kU-2)}kV.body=fs||kS.read_shift(kU-2);return kV}function bd(kR,kU,fs){if(fs.biff<8){return gG(kR,kU,fs)}var kX=kR.l+kU;var kV=kR.read_shift(2);var kT=kR.read_shift(1);var kW=kR.read_shift(1);var kY=kR.read_shift(2);kR.l+=2;var k0=kR.read_shift(2);kR.l+=4;var kS=cw(kR,kW,fs);var kZ=ip(kR,kX-kR.l,fs,kY);return{chKey:kT,Name:kS,rgce:kZ}}function c0(kR,kU,kT){if(kT.biff<8){return W(kR,kU,kT)}var kV=gT(kR,kU,kz);var fs=[];if(kT.sbcch===1025){for(var kS=0;kS!=kV.length;++kS){fs.push(kT.snames[kV[kS][1]])}return fs}else{return kV}}function hH(fs,kT,kS){var kR=aU(fs,6);fs.l++;var kU=fs.read_shift(1);kT-=8;return[gV(fs,kT,kS),kU]}function jb(fs,kT,kS){var kR=dx(fs,6);fs.l+=6;kT-=12;return[kR,dI(fs,kT,kS,kR)]}function E(kR,kT){var kS=kR.read_shift(4)!==0;var kU=kR.read_shift(4)!==0;var fs=kR.read_shift(4);return[kS,kU,fs]}function dH(kS,kW,kV){if(kV.biff<8){return}var kX=kS.read_shift(2),kT=kS.read_shift(2);var fs=kS.read_shift(2),kU=kS.read_shift(2);var kR=dY(kS,0,kV);if(kV.biff<8){kS.read_shift(1)}return[{r:kX,c:kT},kR,kU,fs]}function bJ(fs,kS,kR){return dH(fs,kS,kR)}function iO(fs,kR){var kS=[];var kT=fs.read_shift(2);while(kT--){kS.push(f0(fs,kR))}return kS}function cM(fs,kS){var kT=g(fs,22);var kR=eS(fs,kS-22,kT[1]);return{cmo:kT,ft:kR}}function hL(kR,kS,fs){var k4=kR.l;try{kR.l+=4;var kV=(fs.lastobj||{cmo:[0,0]}).cmo[1];var kZ;if([0,5,7,11,12,14].indexOf(kV)==-1){kR.l+=6}else{kZ=g2(kR,6,fs)}var kU=kR.read_shift(2);var k0=kR.read_shift(2);var k1=b0(kR,2);var kX=kR.read_shift(2);kR.l+=kX;var kT="";for(var kW=1;kW<kR.lens.length-1;++kW){if(kR.l-k4!=kR.lens[kW]){throw"TxO: bad continue record"}var k2=kR[kR.l];var k3=cw(kR,kR.lens[kW+1]-kR.lens[kW]-1);kT+=k3;if(kT.length>=(k2?kU:2*kU)){break}}if(kT.length!==kU&&kT.length!==kU*2){throw"cchText: "+kU+" != "+kT.length}kR.l=k4+kS;return{t:kT}}catch(kY){kR.l=k4+kS;return{t:kT||""}}}var bI=function(fs,kT){var kS=f0(fs,8);fs.l+=16;var kR=iZ(fs,kT-24);return[kS,kR]};var df=function(kR,kT){var fs=kR.l+kT;kR.read_shift(2);var kS=f0(kR,8);var kU=kR.read_shift((kT-10)/2,"dbcs");kU=kU.replace(a8,"");return[kS,kU]};function cn(fs,kR){var kT=[],kS;kS=fs.read_shift(2);kT[0]=ia[kS]||kS;kS=fs.read_shift(2);kT[1]=ia[kS]||kS;return kT}function eQ(kR,kS){var fs=kR.read_shift(2);var kT=[];while(fs-->0){kT.push(hM(kR,8))}return kT}function fp(kR,kS){var fs=kR.read_shift(2);var kT=[];while(fs-->0){kT.push(hM(kR,8))}return kT}function h6(fs,kR){fs.l+=2;var kS={cxfs:0,crc:0};kS.cxfs=fs.read_shift(2);kS.crc=fs.read_shift(4);return kS}var jv=jH;var hp=jH;var aN=jH;var je=jH;var iP=ih;var D=aL;var kF=hK;var aA=gd;var hE=gd;var g9=hK;var ek=ih;var kp=gd;var aq=ih;var hr=cb;var ci=ih;var bX=gd;var cd=ih;var e5=ih;var gj=gd;var fj=cb;var bH=cb;var kx=cb;var f3=cb;var C=cb;var kQ=gd;var kv=gh;var dm=gd;var il=ih;var cB=gh;var gD=bO;var cI=cb;var i=hK;var c5=cb;var jX=ih;var cv=gd;var av=ih;var x=ih;var e6=gd;var Q=ih;var eY=gd;var g1=ih;var hO=ih;var cH=hK;var iV=fI;var hT=ih;var ic=fI;var dB=bF;var ga=ih;var aZ=hK;var kn=ih;var fP=ih;var aS=ih;var u=jH;var j8=jH;var ky=jH;var cm=jH;var jn=jH;var cF=jH;var eN=jH;var kf=jH;var ft=jH;var bc=jH;var cQ=jH;var a1=jH;var cc=jH;var f7=jH;var aY=jH;var jE=jH;var a4=jH;var bx=jH;var J=jH;var fy=jH;var iA=jH;var fY=jH;var iH=jH;var ap=jH;var bW=jH;var j4=jH;var f6=jH;var ch=jH;var dQ=jH;var e9=jH;var bv=jH;var ag=jH;var d1=jH;var c4=jH;var hJ=jH;var b8=jH;var eG=jH;var fR=jH;var fU=jH;var N=jH;var dd=jH;var v=jH;var gM=jH;var cE=jH;var af=jH;var cK=jH;var bB=jH;var gF=jH;var im=jH;var dG=jH;var iw=jH;var iX=jH;var jK=jH;var gL=jH;var ah=jH;var cG=jH;var hh=jH;var fC=jH;var bp=jH;var bn=jH;var eW=jH;var kG=jH;var dq=jH;var j0=jH;var dJ=jH;var fl=jH;var id=jH;var jg=jH;var aJ=jH;var fi=jH;var d9=jH;var c3=jH;var cC=jH;var et=jH;var hS=jH;var cJ=jH;var dl=jH;var kk=jH;var j3=jH;var A=jH;var fM=jH;var jW=jH;var bt=jH;var fL=jH;var jy=jH;var bY=jH;var aK=jH;var ix=jH;var ir=jH;var dT=jH;var t=jH;var aH=jH;var gR=jH;var cV=jH;var b=jH;var jx=jH;var fo=jH;var kr=jH;var gJ=jH;var ib=jH;var jd=jH;var ao=jH;var ka=jH;var f8=jH;var bl=jH;var iv=jH;var he=jH;var hw=jH;var gy=jH;var c8=jH;var eM=jH;var aF=jH;var jZ=bF;var kJ=jH;var hX=jH;var fZ=jH;var r=jH;var dC=jH;var Z=jH;var fJ=jH;var dS=jH;var eg=jH;var fQ=jH;var i1=jH;var m=jH;var hc=jH;var hg=jH;var kA=jH;var hq=jH;var gI=jH;var hZ=jH;var ce=jH;var Y=jH;var fT=jH;var bC=jH;var cl=jH;var gk=jH;var au=jH;var iq=jH;var gW=jH;var dU=jH;var jl=jH;var hN=jH;var ij=jH;var ea=jH;var dD=jH;var i6=jH;var aC=jH;var aT=jH;var j9=jH;var gP=jH;var dO=jH;var iz=jH;var aE=jH;var iN=jH;var eh=jH;var dN=jH;var cy=jH;var iK=jH;var j6=jH;var dW=jH;var g8=jH;var iE=jH;var iJ=jH;var ck=jH;var hU=jH;var cU=jH;var fe=jH;var dV=jH;var ex=jH;var j5=jH;var d7=jH;var b1=jH;var db=jH;var g0=jH;var bi=jH;var aO=jH;var eb=jH;var bG=jH;var fV=jH;var fn=jH;var hu=jH;var aP=jH;var a6=jH;var hV=jH;var dv=jH;var bo=jH;var fq=jH;var eE=jH;var fN=jH;var h8=jH;var kH=jH;var eq=jH;var d8=jH;var e1=jH;var jA=jH;var kb=jH;var be=jH;var bj=jH;var by=jH;var ez=jH;var hm=jH;var bk=jH;var hW=jH;var fW=jH;var q=jH;var dP=jH;var em=jH;var eD=jH;var jU=jH;var fx=jH;var kl=jH;var bA=jH;var k=jH;var ar=jH;var jw=jH;var e0=jH;var aa=jH;var eF=jH;var h=jH;var a3=jH;var kj=jH;var n=jH;var F=jH;var bZ=jH;var c1=jH;var P=jH;var aW=jH;var fm=jH;var S=jH;var go=jH;var eL=jH;var gB=jH;var bE=jH;var jM=jH;var gs=jH;var di=jH;var ds=jH;var ks=jH;var fX=jH;var eP=jH;var ax=jH;var d4=jH;var eO=jH;var cX=jH;var iU=jH;var j7=jH;var g3=jH;var kd=jH;var fB=jH;var gU=jH;var bu=jH;var ej=jH;var i0=jH;var dc=jH;var e3=jH;var jz=jH;function br(kR){var fs=kR.read_shift(1);return kR.read_shift(fs,"sbcs")}function jF(kR,kT,kS){var fs=aL(kR,6);++kR.l;var kU=dY(kR,kT-7,kS);fs.val=kU;return fs}function d(kR,kU,kT){var fs=aL(kR,6);++kR.l;var kS=hK(kR,8);fs.val=kS;return fs}var ak=function(fs){return String.fromCharCode(fs)};var iM=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g;var en=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function aB(kY,fs){var kU=kY.split(/\s+/);var kV=[];if(!fs){kV[0]=kU[0]}if(kU.length===1){return kV}var kR=kY.match(iM),kW,kS,kX,kT;if(kR){for(kT=0;kT!=kR.length;++kT){kW=kR[kT].match(en);if((kS=kW[1].indexOf(":"))===-1){kV[kW[1]]=kW[2].substr(1,kW[2].length-2)}else{if(kW[1].substr(0,6)==="xmlns:"){kX="xmlns"+kW[1].substr(6)}else{kX=kW[1].substr(kS+1)}kV[kX]=kW[2].substr(1,kW[2].length-2)}}}return kV}function b3(kR){var kW=kR.split(/\s+/);var kV={};if(kW.length===1){return kV}var fs=kR.match(iM),kX,kT,kS,kU;if(fs){for(kU=0;kU!=fs.length;++kU){kX=fs[kU].match(en);if((kT=kX[1].indexOf(":"))===-1){kV[kX[1]]=kX[2].substr(1,kX[2].length-2)}else{if(kX[1].substr(0,6)==="xmlns:"){kS="xmlns"+kX[1].substr(6)}else{kS=kX[1].substr(kT+1)}kV[kS]=kX[2].substr(1,kX[2].length-2)}}}return kV}var g6={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"};var ba=dK(g6);var e="&<>'\"".split("");var hi='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n';var p={};var ki=function(kS,kT){var fs;if(typeof kT!=="undefined"){fs=kT}else{if(typeof require!=="undefined"){try{fs=require("crypto")}catch(kR){fs=null}}}kS.rc4=function(kY,kZ){var kX=new Array(256);var k0=0,kW=0,kU=0,kV=0;for(kW=0;kW!=256;++kW){kX[kW]=kW}for(kW=0;kW!=256;++kW){kU=(kU+kX[kW]+(kY[kW%kY.length]).charCodeAt(0))&255;kV=kX[kW];kX[kW]=kX[kU];kX[kU]=kV}kW=kU=0;out=Buffer(kZ.length);for(k0=0;k0!=kZ.length;++k0){kW=(kW+1)&255;kU=(kU+kX[kW])%256;kV=kX[kW];kX[kW]=kX[kU];kX[kU]=kV;out[k0]=(kZ[k0]^kX[(kX[kW]+kX[kU])&255])}return out};if(fs){kS.md5=function(kU){return fs.createHash("md5").update(kU).digest("hex")}}else{kS.md5=function(kU){throw"unimplemented"}}};ki(p,typeof crypto!=="undefined"?crypto:undefined);function d6(fs){if(typeof cptable!=="undefined"){return cptable.utils.encode(1252,fs)}return fs.split("").map(function(kR){return kR.charCodeAt(0)})}function i4(fs,kR){var kS={};kS.Major=fs.read_shift(2);kS.Minor=fs.read_shift(2);return kS}function aw(fs,kS){var kT={};kT.Flags=fs.read_shift(4);var kR=fs.read_shift(4);if(kR!==0){throw"Unrecognized SizeExtra: "+kR}kT.AlgID=fs.read_shift(4);switch(kT.AlgID){case 0:case 26625:case 26126:case 26127:case 26128:break;default:throw"Unrecognized encryption algorithm: "+kT.AlgID}jH(fs,kS-12);return kT}function fO(fs,kR){return jH(fs,kR)}function gm(fs,kS){var kU={};var kR=kU.EncryptionVersionInfo=i4(fs,4);kS-=4;if(kR.Minor!=2){throw"unrecognized minor version code: "+kR.Minor}if(kR.Major>4||kR.Major<2){throw"unrecognized major version code: "+kR.Major}kU.Flags=fs.read_shift(4);kS-=4;var kT=fs.read_shift(4);kS-=4;kU.EncryptionHeader=aw(fs,kT);kS-=kT;kU.EncryptionVerifier=fO(fs,kS);return kU}function hb(fs,kS){var kT={};var kR=kT.EncryptionVersionInfo=i4(fs,4);kS-=4;if(kR.Major!=1||kR.Minor!=1){throw"unrecognized version code "+kR.Major+" : "+kR.Minor}kT.Salt=fs.read_shift(16);kT.EncryptedVerifier=fs.read_shift(16);kT.EncryptedVerifierHash=fs.read_shift(16);return kT}function cY(kX){var kT=0,kY;var kW=d6(kX);var kV=kW.length+1,kS,kZ;var kU,kR,fs;kY=dr(kV);kY[0]=kW.length;for(kS=1;kS!=kV;++kS){kY[kS]=kW[kS-1]}for(kS=kV-1;kS>=0;--kS){kZ=kY[kS];kU=((kT&16384)===0)?0:1;kR=(kT<<1)&32767;fs=kU|kR;kT=fs^kZ}return kT^52811}var cP=(function(){var kU=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0];var kR=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163];var fs=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628];var kV=function(kW){return((kW/2)|(kW*128))&255};var kS=function(kX,kW){return kV(kX^kW)};var kT=function(kZ){var k0=kR[kZ.length-1];var k1=104;for(var kY=kZ.length-1;kY>=0;--kY){var kW=kZ[kY];for(var kX=0;kX!=7;++kX){if(kW&64){k0^=fs[k1]}kW*=2;--k1}}return k0};return function(k3){var k2=d6(k3);var k1=kT(k2);var kZ=k2.length;var kX=dr(16);for(var k0=0;k0!=16;++k0){kX[k0]=0}var kW,k4,kY;if((kZ&1)===1){kW=k1>>8;kX[kZ]=kS(kU[0],kW);--kZ;kW=k1&255;k4=k2[k2.length-1];kX[kZ]=kS(k4,kW)}while(kZ>0){--kZ;kW=k1>>8;kX[kZ]=kS(k2[kZ],kW);--kZ;kW=k1&255;kX[kZ]=kS(k2[kZ],kW)}kZ=15;kY=15-k2.length;while(kY>0){kW=k1>>8;kX[kZ]=kS(kU[kY],kW);--kZ;--kY;kW=k1&255;kX[kZ]=kS(k2[kZ],kW);--kZ;--kY}return kX}})();var gY=function(kR,kS,kT,kV,kU){if(!kU){kU=kS}if(!kV){kV=cP(kR)}var kW,fs;for(kW=0;kW!=kS.length;++kW){fs=kS[kW];fs^=kV[kT];fs=((fs>>5)|(fs<<3))&255;kU[kW]=fs;++kT}return[kU,kT,kV]};var dA=function(fs){var kR=0,kS=cP(fs);return function(kT){var kU=gY(null,kT,kR,kS);kR=kU[1];return kU[0]}};function iW(fs,kT,kS,kR){var kU={key:gd(fs),verificationBytes:gd(fs)};if(kS.password){kU.verifier=cY(kS.password)}kR.valid=kU.verificationBytes===kU.verifier;if(kR.valid){kR.insitu_decrypt=dA(kS.password)}return kU}function bf(kR,kS,fs){var kT=fs||{};kT.Info=kR.read_shift(2);kR.l-=2;if(kT.Info===1){kT.Data=hb(kR,kS)}else{kT.Data=gm(kR,kS)}return kT}function eJ(fs,kS,kR){var kT={Type:fs.read_shift(2)};if(kT.Type){bf(fs,kS-2,kT)}else{iW(fs,kS-2,kR,kT)}return kT}function iL(fs){return function(kR,kS){kR.l+=fs;return}}function hR(fs,kR){fs.l+=1;return}function kP(fs,kR){var kS=fs.read_shift(2);return[kS&16383,(kS>>14)&1,(kS>>15)&1]}function eI(fs,kT){var kS=fs.read_shift(2),kR=fs.read_shift(2);var kV=kP(fs,2);var kU=kP(fs,2);return{s:{r:kS,c:kV[0],cRel:kV[1],rRel:kV[2]},e:{r:kR,c:kU[0],cRel:kU[1],rRel:kU[2]}}}function fE(fs,kT){var kS=fs.read_shift(2),kR=fs.read_shift(2);var kV=kP(fs,2);var kU=kP(fs,2);return{s:{r:kS,c:kV[0],cRel:kV[1],rRel:kV[2]},e:{r:kR,c:kU[0],cRel:kU[1],rRel:kU[2]}}}function fz(fs,kS){var kR=fs.read_shift(2);var kT=kP(fs,2);return{r:kR,c:kT[0],cRel:kT[1],rRel:kT[2]}}function fh(kR,kU){var kT=kR.read_shift(2);var fs=kR.read_shift(2);var kV=(fs&32768)>>15,kS=(fs&16384)>>14;fs&=16383;if(kV!==0){while(fs>=256){fs-=256}}return{r:kT,c:fs,cRel:kV,rRel:kS}}function gz(fs,kT){var kR=(fs[fs.l++]&96)>>5;var kS=eI(fs,8);return[kR,kS]}function jN(kR,kU){var kS=(kR[kR.l++]&96)>>5;var fs=kR.read_shift(2);var kT=eI(kR,8);return[kS,fs,kT]}function bU(fs,kS){var kR=(fs[fs.l++]&96)>>5;fs.l+=8;return[kR]}function f5(kR,kT){var kS=(kR[kR.l++]&96)>>5;var fs=kR.read_shift(2);kR.l+=8;return[kS,fs]}function gi(fs,kT){var kR=(fs[fs.l++]&96)>>5;var kS=fE(fs,8);return[kR,kS]}function eu(fs,kS){var kR=(fs[fs.l++]&96)>>5;fs.l+=7;return[kR]}function gN(fs,kR){var kT=fs[fs.l+1]&1;var kS=1;fs.l+=4;return[kT,kS]}function aR(fs,kS){fs.l+=2;var kU=fs.read_shift(2);var kT=[];for(var kR=0;kR<=kU;++kR){kT.push(fs.read_shift(2))}return kT}function hs(kR,kS){var fs=(kR[kR.l+1]&255)?1:0;kR.l+=2;return[fs,kR.read_shift(2)]}function dZ(fs,kS){var kR=(fs[fs.l+1]&255)?1:0;fs.l+=2;return[kR,fs.read_shift(2)]}function b9(fs,kR){var kS=(fs[fs.l+1]&255)?1:0;fs.l+=4;return[kS]}function ct(fs,kT){var kS=fs.read_shift(1),kR=fs.read_shift(1);return[kS,kR]}function g4(fs,kR){fs.read_shift(2);return ct(fs,2)}function cq(fs,kR){fs.read_shift(2);return ct(fs,2)}function bb(fs,kS){var kU=fs[fs.l]&31;var kR=(fs[fs.l]&96)>>5;fs.l+=1;var kT=fz(fs,4);return[kR,kT]}function i5(fs,kS){var kU=fs[fs.l]&31;var kR=(fs[fs.l]&96)>>5;fs.l+=1;var kT=fh(fs,4);return[kR,kT]}function cz(kR,kT){var kV=kR[kR.l]&31;var kS=(kR[kR.l]&96)>>5;kR.l+=1;var fs=kR.read_shift(2);var kU=fz(kR,4);return[kS,fs,kU]}function fv(fs,kS){var kU=fs[fs.l]&31;var kR=(fs[fs.l]&96)>>5;fs.l+=1;var kT=fs.read_shift(2);return[dk[kT],iD[kT]]}function ei(fs,kT){fs.l++;var kR=fs.read_shift(1),kS=ju(fs);return[kR,(kS[0]===0?iD:aG)[kS[1]]]}function ju(fs,kR){return[fs[fs.l+1]>>7,fs.read_shift(2)&32767]}var o=iL(4);var aQ=hR;function j2(fs,kS){fs.l++;var kT=fs.read_shift(2);var kR=fs.read_shift(2);return[kT,kR]}function L(fs,kR){fs.l++;return e7[fs.read_shift(1)]}function gq(fs,kR){fs.l++;return fs.read_shift(2)}function jQ(fs,kR){fs.l++;return fs.read_shift(1)!==0}function dn(fs,kR){fs.l++;return hK(fs,8)}function ca(fs,kR){fs.l++;return W(fs)}function bV(fs){var kR=[];switch((kR[0]=fs.read_shift(1))){case 4:kR[1]=ih(fs,1)?"TRUE":"FALSE";fs.l+=7;break;case 16:kR[1]=e7[fs[fs.l]];fs.l+=8;break;case 0:fs.l+=8;break;case 1:kR[1]=hK(fs,8);break;case 2:kR[1]=bF(fs);break}return kR}function kI(fs,kU){var kT=fs.read_shift(2);var kR=[];for(var kS=0;kS!=kT;++kS){kR.push(f0(fs,8))}return kR}function kB(fs){var kU=1+fs.read_shift(1);var kT=1+fs.read_shift(2);for(var kS=0,kV=[];kS!=kT&&(kV[kS]=[]);++kS){for(var kR=0;kR!=kU;++kR){kV[kS][kR]=bV(fs)}}return kV}function iS(kR,kT){var kS=(kR.read_shift(1)>>>5)&3;var fs=kR.read_shift(4);return[kS,0,fs]}function al(kS,kU){var kT=(kS.read_shift(1)>>>5)&3;var kR=kS.read_shift(2);var fs=kS.read_shift(4);return[kT,kR,fs]}function cZ(fs,kS){var kR=(fs.read_shift(1)>>>5)&3;fs.l+=4;var kT=fs.read_shift(2);return[kR,kT]}function bK(fs,kS){var kR=(fs.read_shift(1)>>>5)&3;var kT=fs.read_shift(2);return[kR,kT]}function fS(fs,kS){var kR=(fs.read_shift(1)>>>5)&3;fs.l+=4;return[kR]}var jf=hR;var jp=hR;var ji=hR;var iQ=hR;var iI=hR;var c=hR;var hf=hR;var g7=hR;var i9=hR;var kK=hR;var gQ=hR;var gO=hR;var eC=hR;var i2=hR;var jo=hR;var b2=hR;var hC=hR;var f2=hR;var h1=hR;var cx=jH;var eK=jH;var bQ=jH;var kM=jH;var b6={1:{n:"PtgExp",f:j2},2:{n:"PtgTbl",f:kM},3:{n:"PtgAdd",f:jf},4:{n:"PtgSub",f:b2},5:{n:"PtgMul",f:kK},6:{n:"PtgDiv",f:jp},7:{n:"PtgPower",f:i2},8:{n:"PtgConcat",f:aQ},9:{n:"PtgLt",f:g7},10:{n:"PtgLe",f:hf},11:{n:"PtgEq",f:ji},12:{n:"PtgGe",f:iQ},13:{n:"PtgGt",f:iI},14:{n:"PtgNe",f:gQ},15:{n:"PtgIsect",f:c},16:{n:"PtgUnion",f:f2},17:{n:"PtgRange",f:jo},18:{n:"PtgUplus",f:h1},19:{n:"PtgUminus",f:hC},20:{n:"PtgPercent",f:eC},21:{n:"PtgParen",f:gO},22:{n:"PtgMissArg",f:i9},23:{n:"PtgStr",f:ca},28:{n:"PtgErr",f:L},29:{n:"PtgBool",f:jQ},30:{n:"PtgInt",f:gq},31:{n:"PtgNum",f:dn},32:{n:"PtgArray",f:eu},33:{n:"PtgFunc",f:fv},34:{n:"PtgFuncVar",f:ei},35:{n:"PtgName",f:iS},36:{n:"PtgRef",f:bb},37:{n:"PtgArea",f:gz},38:{n:"PtgMemArea",f:cZ},39:{n:"PtgMemErr",f:cx},40:{n:"PtgMemNoMem",f:eK},41:{n:"PtgMemFunc",f:bK},42:{n:"PtgRefErr",f:fS},43:{n:"PtgAreaErr",f:bU},44:{n:"PtgRefN",f:i5},45:{n:"PtgAreaN",f:gi},57:{n:"PtgNameX",f:al},58:{n:"PtgRef3d",f:cz},59:{n:"PtgArea3d",f:jN},60:{n:"PtgRefErr3d",f:bQ},61:{n:"PtgAreaErr3d",f:f5},255:{}};var aX={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61};(function(){for(var fs in aX){b6[fs]=b6[aX[fs]]}})();var io={};var ik={1:{n:"PtgAttrSemi",f:b9},2:{n:"PtgAttrIf",f:dZ},4:{n:"PtgAttrChoose",f:aR},8:{n:"PtgAttrGoto",f:hs},16:{n:"PtgAttrSum",f:o},32:{n:"PtgAttrBaxcel",f:gN},64:{n:"PtgAttrSpace",f:g4},65:{n:"PtgAttrSpaceSemi",f:cq},255:{}};var cj=/(^|[^A-Za-z])R(\[?)(-?\d+|)\]?C(\[?)(-?\d+|)\]?/g;var ee;function dy(kR,fs,kX,kW,kU,kT){var kS=kW.length>0?parseInt(kW,10)|0:0,kV=kT.length>0?parseInt(kT,10)|0:0;if(kV<0&&kU.length===0){kV=0}if(kU.length>0){kV+=ee.c}if(kX.length>0){kS+=ee.r}return fs+cA(kV)+jI(kS)}function hn(fs,kR){ee=kR;return fs.replace(cj,dy)}function fk(kS,kV,kU){var fs=aL(kS,6);var kX=ef(kS,8);var kR=kS.read_shift(1);kS.read_shift(1);var kW=kS.read_shift(4);var kT="";if(kU.biff===5){kS.l+=kV-20}else{kT=i8(kS,kV-20,kU)}return{cell:fs,val:kX[0],formula:kT,shared:(kR>>3)&1,tt:kX[1]}}function ef(kR){var fs;if(eT(kR,kR.l+6)!==65535){return[hK(kR),"n"]}switch(kR[kR.l]){case 0:kR.l+=8;return["String","s"];case 1:fs=kR[kR.l+2]===1;kR.l+=8;return[fs,"b"];case 2:fs=kR[kR.l+2];kR.l+=8;return[fs,"e"];case 3:kR.l+=8;return["","s"]}}function kN(kR,kU,fs,kT){if(kT.biff<8){return jH(kR,kU)}var kV=kR.l+kU;var kW=[];for(var kS=0;kS!==fs.length;++kS){switch(fs[kS][0]){case"PtgArray":fs[kS][1]=kB(kR);kW.push(fs[kS][1]);break;case"PtgMemArea":fs[kS][2]=kI(kR,fs[kS][1]);kW.push(fs[kS][2]);break;default:break}}kU=kV-kR.l;if(kU!==0){kW.push(jH(kR,kU))}return kW}function ip(kR,kU,kT,kW){var kV=kR.l+kU;var fs=kg(kR,kW);var kS;if(kV!==kR.l){kS=kN(kR,kV-kR.l,fs,kT)}return[fs,kS]}function i8(kR,kU,kT){var kW=kR.l+kU;var kS,kV=kR.read_shift(2);if(kV==65535){return[[],jH(kR,kU-2)]}var fs=kg(kR,kV);if(kU!==kV+2){kS=kN(kR,kU-kV-2,fs,kT)}return[fs,kS]}function gV(kR,kU,kT){var kW=kR.l+kU;var kS,kV=kR.read_shift(2);var fs=kg(kR,kV);if(kV==65535){return[[],jH(kR,kU-2)]}if(kU!==kV+2){kS=kN(kR,kW-kV-2,fs,kT)}return[fs,kS]}function dI(kR,kV,kU,kT){var kX=kR.l+kV;var kS,kW=kR.read_shift(2);if(kW==65535){return[[],jH(kR,kV-2)]}var fs=kg(kR,kW);if(kV!==kW+2){kS=kN(kR,kX-kW-2,fs,kU)}return[fs,kS]}function kg(fs,kT){var kU=fs.l+kT;var kS,kV,kR=[];while(kU!=fs.l){kT=kU-fs.l;kV=fs[fs.l];kS=b6[kV];if(kV===24||kV===25){kV=fs[fs.l+1];kS=(kV===24?io:ik)[kV]}if(!kS||!kS.f){kR.push(jH(fs,kT))}else{kR.push([kS.n,kS.f(fs,kT)])}}return kR}function es(fs){return fs.map(function kR(kS){return kS[1]}).join(",")}function ey(fs,k4,kR,k2,k3){if(k3!==undefined&&k3.biff===5){return"BIFF5??"}var kT=k4!==undefined?k4:{s:{c:0,r:0}};var kY=[],k0,kZ,kV,le,kX,kU,k6;if(!fs[0]||!fs[0][0]){return""}for(var k5=0,lf=fs[0].length;k5<lf;++k5){var ld=fs[0][k5];switch(ld[0]){case"PtgUminus":kY.push("-"+kY.pop());break;case"PtgUplus":kY.push("+"+kY.pop());break;case"PtgPercent":kY.push(kY.pop()+"%");break;case"PtgAdd":k0=kY.pop();kZ=kY.pop();kY.push(kZ+"+"+k0);break;case"PtgSub":k0=kY.pop();kZ=kY.pop();kY.push(kZ+"-"+k0);break;case"PtgMul":k0=kY.pop();kZ=kY.pop();kY.push(kZ+"*"+k0);break;case"PtgDiv":k0=kY.pop();kZ=kY.pop();kY.push(kZ+"/"+k0);break;case"PtgPower":k0=kY.pop();kZ=kY.pop();kY.push(kZ+"^"+k0);break;case"PtgConcat":k0=kY.pop();kZ=kY.pop();kY.push(kZ+"&"+k0);break;case"PtgLt":k0=kY.pop();kZ=kY.pop();kY.push(kZ+"<"+k0);break;case"PtgLe":k0=kY.pop();kZ=kY.pop();kY.push(kZ+"<="+k0);break;case"PtgEq":k0=kY.pop();kZ=kY.pop();kY.push(kZ+"="+k0);break;case"PtgGe":k0=kY.pop();kZ=kY.pop();kY.push(kZ+">="+k0);break;case"PtgGt":k0=kY.pop();kZ=kY.pop();kY.push(kZ+">"+k0);break;case"PtgNe":k0=kY.pop();kZ=kY.pop();kY.push(kZ+"<>"+k0);break;case"PtgIsect":k0=kY.pop();kZ=kY.pop();kY.push(kZ+" "+k0);break;case"PtgUnion":k0=kY.pop();kZ=kY.pop();kY.push(kZ+","+k0);break;case"PtgRange":break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgRef":kV=ld[1][0];le=aV(bh(gX(ld[1][1])),kT);kY.push(gX(le));break;case"PtgRefN":kV=ld[1][0];le=aV(bh(gX(ld[1][1])),kR);kY.push(gX(le));break;case"PtgRef3d":kV=ld[1][0];kX=ld[1][1];le=aV(ld[1][2],kT);kY.push(k2[1][kX+1]+"!"+gX(le));break;case"PtgFunc":case"PtgFuncVar":var k1=ld[1][0],kW=ld[1][1];if(!k1){k1=0}var kS=kY.slice(-k1);kY.length-=k1;if(kW==="User"){kW=kS.shift()}kY.push(kW+"("+kS.join(",")+")");break;case"PtgBool":kY.push(ld[1]?"TRUE":"FALSE");break;case"PtgInt":kY.push(ld[1]);break;case"PtgNum":kY.push(String(ld[1]));break;case"PtgStr":kY.push('"'+ld[1]+'"');break;case"PtgErr":kY.push(ld[1]);break;case"PtgArea":kV=ld[1][0];k6=eZ(ld[1][1],kT);kY.push(cR(k6));break;case"PtgArea3d":kV=ld[1][0];kX=ld[1][1];k6=ld[1][2];kY.push(k2[1][kX+1]+"!"+cR(k6));break;case"PtgAttrSum":kY.push("SUM("+kY.pop()+")");break;case"PtgAttrSemi":break;case"PtgName":kU=ld[1][2];var lb=k2[0][kU];var lg=lb.Name;if(lg in cu){lg=cu[lg]}kY.push(lg);break;case"PtgNameX":var k9=ld[1][1];kU=ld[1][2];var la;if(k2[k9+1]){la=k2[k9+1][kU]}else{if(k2[k9-1]){la=k2[k9-1][kU]}}if(!la){la={body:"??NAMEX??"}}kY.push(la.body);break;case"PtgParen":kY.push("("+kY.pop()+")");break;case"PtgRefErr":kY.push("#REF!");break;case"PtgExp":le={c:ld[1][1],r:ld[1][0]};var k7={c:kR.c,r:kR.r};if(k2.sharedf[gX(le)]){var lc=(k2.sharedf[gX(le)]);kY.push(ey(lc,kT,k7,k2,k3))}else{var k8=false;for(k0=0;k0!=k2.arrayf.length;++k0){kZ=k2.arrayf[k0];if(le.c<kZ[0].s.c||le.c>kZ[0].e.c){continue}if(le.r<kZ[0].s.r||le.r>kZ[0].e.r){continue}kY.push(ey(kZ[1],kT,k7,k2,k3))}if(!k8){kY.push(ld[1])}}break;case"PtgArray":kY.push("{"+ld[1].map(es).join(";")+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":kY.push("");break;case"PtgAreaErr":break;case"PtgAreaN":kY.push("");break;case"PtgRefErr3d":break;case"PtgMemFunc":break;default:throw"Unrecognized Formula Token: "+ld}}return kY[0]}var e4={1:"REFERENCE",2:"VALUE",3:"ARRAY"};var e7={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"};var i3=dK(e7);var aG={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"};var iD={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD"};var dk={2:1,3:1,15:1,16:1,17:1,18:1,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,65:3,66:3,67:1,68:1,69:1,71:1,72:1,73:1,75:1,76:1,77:1,79:2,80:2,83:1,86:1,90:1,97:2,98:1,99:1,105:1,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,189:3,190:1,195:3,196:3,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,65535:0};var cu={"_xlfn.ACOT":"ACOT","_xlfn.ACOTH":"ACOTH","_xlfn.AGGREGATE":"AGGREGATE","_xlfn.ARABIC":"ARABIC","_xlfn.AVERAGEIF":"AVERAGEIF","_xlfn.AVERAGEIFS":"AVERAGEIFS","_xlfn.BASE":"BASE","_xlfn.BETA.DIST":"BETA.DIST","_xlfn.BETA.INV":"BETA.INV","_xlfn.BINOM.DIST":"BINOM.DIST","_xlfn.BINOM.DIST.RANGE":"BINOM.DIST.RANGE","_xlfn.BINOM.INV":"BINOM.INV","_xlfn.BITAND":"BITAND","_xlfn.BITLSHIFT":"BITLSHIFT","_xlfn.BITOR":"BITOR","_xlfn.BITRSHIFT":"BITRSHIFT","_xlfn.BITXOR":"BITXOR","_xlfn.CEILING.MATH":"CEILING.MATH","_xlfn.CEILING.PRECISE":"CEILING.PRECISE","_xlfn.CHISQ.DIST":"CHISQ.DIST","_xlfn.CHISQ.DIST.RT":"CHISQ.DIST.RT","_xlfn.CHISQ.INV":"CHISQ.INV","_xlfn.CHISQ.INV.RT":"CHISQ.INV.RT","_xlfn.CHISQ.TEST":"CHISQ.TEST","_xlfn.COMBINA":"COMBINA","_xlfn.CONFIDENCE.NORM":"CONFIDENCE.NORM","_xlfn.CONFIDENCE.T":"CONFIDENCE.T","_xlfn.COT":"COT","_xlfn.COTH":"COTH","_xlfn.COUNTIFS":"COUNTIFS","_xlfn.COVARIANCE.P":"COVARIANCE.P","_xlfn.COVARIANCE.S":"COVARIANCE.S","_xlfn.CSC":"CSC","_xlfn.CSCH":"CSCH","_xlfn.DAYS":"DAYS","_xlfn.DECIMAL":"DECIMAL","_xlfn.ECMA.CEILING":"ECMA.CEILING","_xlfn.ERF.PRECISE":"ERF.PRECISE","_xlfn.ERFC.PRECISE":"ERFC.PRECISE","_xlfn.EXPON.DIST":"EXPON.DIST","_xlfn.F.DIST":"F.DIST","_xlfn.F.DIST.RT":"F.DIST.RT","_xlfn.F.INV":"F.INV","_xlfn.F.INV.RT":"F.INV.RT","_xlfn.F.TEST":"F.TEST","_xlfn.FILTERXML":"FILTERXML","_xlfn.FLOOR.MATH":"FLOOR.MATH","_xlfn.FLOOR.PRECISE":"FLOOR.PRECISE","_xlfn.FORMULATEXT":"FORMULATEXT","_xlfn.GAMMA":"GAMMA","_xlfn.GAMMA.DIST":"GAMMA.DIST","_xlfn.GAMMA.INV":"GAMMA.INV","_xlfn.GAMMALN.PRECISE":"GAMMALN.PRECISE","_xlfn.GAUSS":"GAUSS","_xlfn.HYPGEOM.DIST":"HYPGEOM.DIST","_xlfn.IFNA":"IFNA","_xlfn.IFERROR":"IFERROR","_xlfn.IMCOSH":"IMCOSH","_xlfn.IMCOT":"IMCOT","_xlfn.IMCSC":"IMCSC","_xlfn.IMCSCH":"IMCSCH","_xlfn.IMSEC":"IMSEC","_xlfn.IMSECH":"IMSECH","_xlfn.IMSINH":"IMSINH","_xlfn.IMTAN":"IMTAN","_xlfn.ISFORMULA":"ISFORMULA","_xlfn.ISO.CEILING":"ISO.CEILING","_xlfn.ISOWEEKNUM":"ISOWEEKNUM","_xlfn.LOGNORM.DIST":"LOGNORM.DIST","_xlfn.LOGNORM.INV":"LOGNORM.INV","_xlfn.MODE.MULT":"MODE.MULT","_xlfn.MODE.SNGL":"MODE.SNGL","_xlfn.MUNIT":"MUNIT","_xlfn.NEGBINOM.DIST":"NEGBINOM.DIST","_xlfn.NETWORKDAYS.INTL":"NETWORKDAYS.INTL","_xlfn.NIGBINOM":"NIGBINOM","_xlfn.NORM.DIST":"NORM.DIST","_xlfn.NORM.INV":"NORM.INV","_xlfn.NORM.S.DIST":"NORM.S.DIST","_xlfn.NORM.S.INV":"NORM.S.INV","_xlfn.NUMBERVALUE":"NUMBERVALUE","_xlfn.PDURATION":"PDURATION","_xlfn.PERCENTILE.EXC":"PERCENTILE.EXC","_xlfn.PERCENTILE.INC":"PERCENTILE.INC","_xlfn.PERCENTRANK.EXC":"PERCENTRANK.EXC","_xlfn.PERCENTRANK.INC":"PERCENTRANK.INC","_xlfn.PERMUTATIONA":"PERMUTATIONA","_xlfn.PHI":"PHI","_xlfn.POISSON.DIST":"POISSON.DIST","_xlfn.QUARTILE.EXC":"QUARTILE.EXC","_xlfn.QUARTILE.INC":"QUARTILE.INC","_xlfn.QUERYSTRING":"QUERYSTRING","_xlfn.RANK.AVG":"RANK.AVG","_xlfn.RANK.EQ":"RANK.EQ","_xlfn.RRI":"RRI","_xlfn.SEC":"SEC","_xlfn.SECH":"SECH","_xlfn.SHEET":"SHEET","_xlfn.SHEETS":"SHEETS","_xlfn.SKEW.P":"SKEW.P","_xlfn.STDEV.P":"STDEV.P","_xlfn.STDEV.S":"STDEV.S","_xlfn.SUMIFS":"SUMIFS","_xlfn.T.DIST":"T.DIST","_xlfn.T.DIST.2T":"T.DIST.2T","_xlfn.T.DIST.RT":"T.DIST.RT","_xlfn.T.INV":"T.INV","_xlfn.T.INV.2T":"T.INV.2T","_xlfn.T.TEST":"T.TEST","_xlfn.UNICHAR":"UNICHAR","_xlfn.UNICODE":"UNICODE","_xlfn.VAR.P":"VAR.P","_xlfn.VAR.S":"VAR.S","_xlfn.WEBSERVICE":"WEBSERVICE","_xlfn.WEIBULL.DIST":"WEIBULL.DIST","_xlfn.WORKDAY.INTL":"WORKDAY.INTL","_xlfn.XOR":"XOR","_xlfn.Z.TEST":"Z.TEST"};function gp(fs,kS){var kR=fs.read_shift(4);if(kR===124226){return}fs.l+=kS-4}function kq(fs,kR){return fs.read_shift(4)}function aM(fs,kR){var kS={};kS.xclrType=fs.read_shift(2);kS.nTintShade=fs.read_shift(2);switch(kS.xclrType){case 0:fs.l+=4;break;case 1:kS.xclrValue=parse_IcvXF(fs,4);break;case 2:kS.xclrValue=a2(fs,4);break;case 3:kS.xclrValue=kq(fs,4);break;case 4:fs.l+=4;break}fs.l+=8;return kS}function iB(kR,kS){var kT=kR.read_shift(2);var fs=kR.read_shift(2);var kU=[kT];switch(kT){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:kU[1]=aM(kR,fs);break;case 6:kU[1]=parse_XFExtGradient(kR,fs);break;case 14:case 15:kU[1]=kR.read_shift(fs===5?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+kT+" "+fs)}return kU}function hk(kS,kV){var kR=kS.l+kV;kS.l+=2;var fs=kS.read_shift(2);kS.l+=2;var kT=kS.read_shift(2);var kU=[];while(kT-->0){kU.push(iB(kS,kR-kS.l))}return{ixfe:fs,ext:kU}}function cp(kR,fs){fs.forEach(function(kS){switch(kS[0]){case 4:break;case 5:break;case 7:case 8:case 9:case 10:break;case 13:break;case 14:break;default:throw"bafuq"+kS[0].toString(16)}})}var gw={3:{n:"BIFF2NUM",f:d},4:{n:"BIFF2STR",f:jF},6:{n:"Formula",f:fk},9:{n:"BOF",f:jm},10:{n:"EOF",f:kx},12:{n:"CalcCount",f:hE},13:{n:"CalcMode",f:kp},14:{n:"CalcPrecision",f:aq},15:{n:"CalcRefMode",f:hr},16:{n:"CalcDelta",f:g9},17:{n:"CalcIter",f:ek},18:{n:"Protect",f:g1},19:{n:"Password",f:cv},20:{n:"Header",f:cB},21:{n:"Footer",f:kv},23:{n:"ExternSheet",f:c0},24:{n:"Lbl",f:bd},25:{n:"WinProtect",f:aS},26:{n:"VerticalPageBreaks",f:j8},27:{n:"HorizontalPageBreaks",f:ky},28:{n:"Note",f:bJ},29:{n:"Selection",f:cm},34:{n:"Date1904",f:e5},35:{n:"ExternName",f:da},38:{n:"LeftMargin",f:i},39:{n:"RightMargin",f:cH},40:{n:"TopMargin",f:aZ},41:{n:"BottomMargin",f:kF},42:{n:"PrintRowCol",f:x},43:{n:"PrintGrid",f:av},47:{n:"FilePass",f:eJ},49:{n:"Font",f:f9},51:{n:"PrintSize",f:e6},60:{n:"Continue",f:jn},61:{n:"Window1",f:jh},64:{n:"Backup",f:iP},65:{n:"Pane",f:cF},66:{n:"CodePage",f:bX},77:{n:"Pls",f:eN},80:{n:"DCon",f:kf},81:{n:"DConRef",f:ft},82:{n:"DConName",f:bc},85:{n:"DefColWidth",f:gj},89:{n:"XCT",f:cQ},90:{n:"CRN",f:a1},91:{n:"FileSharing",f:cc},92:{n:"WriteAccess",f:jT},93:{n:"Obj",f:cM},94:{n:"Uncalced",f:f7},95:{n:"CalcSaveRecalc",f:ci},96:{n:"Template",f:aY},97:{n:"Intl",f:jE},99:{n:"ObjProtect",f:jX},125:{n:"ColInfo",f:aN},128:{n:"Guts",f:cS},129:{n:"WsBool",f:a4},130:{n:"GridSet",f:dm},131:{n:"HCenter",f:il},132:{n:"VCenter",f:fP},133:{n:"BoundSheet8",f:eU},134:{n:"WriteProtect",f:u},140:{n:"Country",f:cn},141:{n:"HideObj",f:gD},144:{n:"Sort",f:bx},146:{n:"Palette",f:fp},151:{n:"Sync",f:J},152:{n:"LPr",f:fy},153:{n:"DxGCol",f:iA},154:{n:"FnGroupName",f:fY},155:{n:"FilterMode",f:iH},156:{n:"BuiltInFnGroupCount",f:aA},157:{n:"AutoFilterInfo",f:ap},158:{n:"AutoFilter",f:bW},160:{n:"Scl",f:ic},161:{n:"Setup",f:j4},174:{n:"ScenMan",f:f6},175:{n:"SCENARIO",f:ch},176:{n:"SxView",f:dQ},177:{n:"Sxvd",f:e9},178:{n:"SXVI",f:bv},180:{n:"SxIvd",f:ag},181:{n:"SXLI",f:d1},182:{n:"SXPI",f:c4},184:{n:"DocRoute",f:hJ},185:{n:"RecipName",f:b8},189:{n:"MulRk",f:kC},190:{n:"MulBlank",f:eG},193:{n:"Mms",f:c5},197:{n:"SXDI",f:fR},198:{n:"SXDB",f:fU},199:{n:"SXFDB",f:N},200:{n:"SXDBB",f:dd},201:{n:"SXNum",f:v},202:{n:"SxBool",f:ga},203:{n:"SxErr",f:gM},204:{n:"SXInt",f:cE},205:{n:"SXString",f:af},206:{n:"SXDtr",f:cK},207:{n:"SxNil",f:bB},208:{n:"SXTbl",f:gF},209:{n:"SXTBRGIITM",f:im},210:{n:"SxTbpg",f:dG},211:{n:"ObProj",f:iw},213:{n:"SXStreamID",f:iX},215:{n:"DBCell",f:jK},216:{n:"SXRng",f:gL},217:{n:"SxIsxoper",f:ah},218:{n:"BookBool",f:cG},220:{n:"DbOrParamQry",f:hh},221:{n:"ScenarioProtect",f:hT},222:{n:"OleObjectSize",f:fC},224:{n:"XF",f:bw},225:{n:"InterfaceHdr",f:gg},226:{n:"InterfaceEnd",f:cI},227:{n:"SXVS",f:bp},229:{n:"MergeCells",f:iO},233:{n:"BkHim",f:bn},235:{n:"MsoDrawingGroup",f:eW},236:{n:"MsoDrawing",f:kG},237:{n:"MsoDrawingSelection",f:dq},239:{n:"PhoneticInfo",f:j0},240:{n:"SxRule",f:dJ},241:{n:"SXEx",f:fl},242:{n:"SxFilt",f:id},244:{n:"SxDXF",f:jg},245:{n:"SxItm",f:aJ},246:{n:"SxName",f:fi},247:{n:"SxSelect",f:d9},248:{n:"SXPair",f:c3},249:{n:"SxFmla",f:cC},251:{n:"SxFormat",f:et},252:{n:"SST",f:aD},253:{n:"LabelSst",f:eV},255:{n:"ExtSST",f:am},256:{n:"SXVDEx",f:hS},259:{n:"SXFormula",f:cJ},290:{n:"SXDBEx",f:dl},311:{n:"RRDInsDel",f:kk},312:{n:"RRDHead",f:j3},315:{n:"RRDChgCell",f:A},317:{n:"RRTabId",f:iV},318:{n:"RRDRenSheet",f:fM},319:{n:"RRSort",f:jW},320:{n:"RRDMove",f:bt},330:{n:"RRFormat",f:fL},331:{n:"RRAutoFmt",f:jy},333:{n:"RRInsertSh",f:bY},334:{n:"RRDMoveBegin",f:aK},335:{n:"RRDMoveEnd",f:ix},336:{n:"RRDInsDelBegin",f:ir},337:{n:"RRDInsDelEnd",f:dT},338:{n:"RRDConflict",f:t},339:{n:"RRDDefName",f:aH},340:{n:"RRDRstEtxp",f:gR},351:{n:"LRng",f:cV},352:{n:"UsesELFs",f:kn},353:{n:"DSF",f:fj},401:{n:"CUsr",f:b},402:{n:"CbUsr",f:jx},403:{n:"UsrInfo",f:fo},404:{n:"UsrExcl",f:kr},405:{n:"FileLock",f:gJ},406:{n:"RRDInfo",f:ib},407:{n:"BCUsrs",f:jd},408:{n:"UsrChk",f:ao},425:{n:"UserBView",f:ka},426:{n:"UserSViewBegin",f:f8},427:{n:"UserSViewEnd",f:bl},428:{n:"RRDUserView",f:iv},429:{n:"Qsi",f:he},430:{n:"SupBook",f:eR},431:{n:"Prot4Rev",f:Q},432:{n:"CondFmt",f:hw},433:{n:"CF",f:gy},434:{n:"DVal",f:c8},437:{n:"DConBin",f:eM},438:{n:"TxO",f:hL},439:{n:"RefreshAll",f:hO},440:{n:"HLink",f:bI},441:{n:"Lel",f:aF},442:{n:"CodeName",f:jZ},443:{n:"SXFDBType",f:kJ},444:{n:"Prot4RevPass",f:eY},445:{n:"ObNoMacros",f:hX},446:{n:"Dv",f:fZ},448:{n:"Excel9File",f:f3},449:{n:"RecalcId",f:jJ,r:2},450:{n:"EntExU2",f:bH},512:{n:"Dimensions",f:f},513:{n:"Blank",f:D},515:{n:"Number",f:jL},516:{n:"Label",f:gG},517:{n:"BoolErr",f:gE},519:{n:"String",f:dB},520:{n:"Row",f:a0},523:{n:"Index",f:r},545:{n:"Array",f:jb},549:{n:"DefaultRowHeight",f:j1},566:{n:"Table",f:dC},574:{n:"Window2",f:je},638:{n:"RK",f:c7},659:{n:"Style",f:jv},1048:{n:"BigName",f:Z},1054:{n:"Format",f:bq},1084:{n:"ContinueBigName",f:fJ},1212:{n:"ShrFmla",f:hH},2048:{n:"HLinkTooltip",f:df},2049:{n:"WebPub",f:dS},2050:{n:"QsiSXTag",f:eg},2051:{n:"DBQueryExt",f:fQ},2052:{n:"ExtString",f:i1},2053:{n:"TxtQry",f:m},2054:{n:"Qsir",f:hc},2055:{n:"Qsif",f:hg},2056:{n:"RRDTQSIF",f:kA},2057:{n:"BOF",f:jm},2058:{n:"OleDbConn",f:hq},2059:{n:"WOpt",f:gI},2060:{n:"SXViewEx",f:hZ},2061:{n:"SXTH",f:ce},2062:{n:"SXPIEx",f:Y},2063:{n:"SXVDTEx",f:fT},2064:{n:"SXViewEx9",f:bC},2066:{n:"ContinueFrt",f:cl},2067:{n:"RealTimeData",f:gk},2128:{n:"ChartFrtInfo",f:au},2129:{n:"FrtWrapper",f:iq},2130:{n:"StartBlock",f:gW},2131:{n:"EndBlock",f:dU},2132:{n:"StartObject",f:jl},2133:{n:"EndObject",f:hN},2134:{n:"CatLab",f:ij},2135:{n:"YMult",f:ea},2136:{n:"SXViewLink",f:dD},2137:{n:"PivotChartBits",f:i6},2138:{n:"FrtFontList",f:aC},2146:{n:"SheetExt",f:aT},2147:{n:"BookExt",f:j9,r:12},2148:{n:"SXAddl",f:gP},2149:{n:"CrErr",f:dO},2150:{n:"HFPicture",f:iz},2151:{n:"FeatHdr",f:C},2152:{n:"Feat",f:aE},2154:{n:"DataLabExt",f:iN},2155:{n:"DataLabExtContents",f:eh},2156:{n:"CellWatch",f:dN},2161:{n:"FeatHdr11",f:cy},2162:{n:"Feature11",f:iK},2164:{n:"DropDownObjIds",f:j6},2165:{n:"ContinueFrt11",f:dW},2166:{n:"DConn",f:g8},2167:{n:"List12",f:iE},2168:{n:"Feature12",f:iJ},2169:{n:"CondFmt12",f:ck},2170:{n:"CF12",f:hU},2171:{n:"CFEx",f:cU},2172:{n:"XFCRC",f:h6,r:12},2173:{n:"XFExt",f:hk,r:12},2174:{n:"AutoFilter12",f:fe},2175:{n:"ContinueFrt12",f:dV},2180:{n:"MDTInfo",f:ex},2181:{n:"MDXStr",f:j5},2182:{n:"MDXTuple",f:d7},2183:{n:"MDXSet",f:b1},2184:{n:"MDXProp",f:db},2185:{n:"MDXKPI",f:g0},2186:{n:"MDB",f:bi},2187:{n:"PLV",f:aO},2188:{n:"Compat12",f:cd,r:12},2189:{n:"DXF",f:eb},2190:{n:"TableStyles",f:bG,r:12},2191:{n:"TableStyle",f:fV},2192:{n:"TableStyleElement",f:fn},2194:{n:"StyleExt",f:hp},2195:{n:"NamePublish",f:hu},2196:{n:"NameCmt",f:aP},2197:{n:"SortData",f:a6},2198:{n:"Theme",f:gp,r:12},2199:{n:"GUIDTypeLib",f:hV},2200:{n:"FnGrp12",f:dv},2201:{n:"NameFnGrp12",f:bo},2202:{n:"MTRSettings",f:E,r:12},2203:{n:"CompressPictures",f:a9},2204:{n:"HeaderFooter",f:fq},2205:{n:"CrtLayout12",f:eE},2206:{n:"CrtMlFrt",f:fN},2207:{n:"CrtMlFrtContinue",f:h8},2211:{n:"ForceFullCalculation",f:fu},2212:{n:"ShapePropsStream",f:kH},2213:{n:"TextPropsStream",f:eq},2214:{n:"RichTextStream",f:d8},2215:{n:"CrtLayout12A",f:e1},4097:{n:"Units",f:jA},4098:{n:"Chart",f:kb},4099:{n:"Series",f:be},4102:{n:"DataFormat",f:bj},4103:{n:"LineFormat",f:by},4105:{n:"MarkerFormat",f:ez},4106:{n:"AreaFormat",f:hm},4107:{n:"PieFormat",f:bk},4108:{n:"AttachedLabel",f:hW},4109:{n:"SeriesText",f:fW},4116:{n:"ChartFormat",f:q},4117:{n:"Legend",f:dP},4118:{n:"SeriesList",f:em},4119:{n:"Bar",f:eD},4120:{n:"Line",f:jU},4121:{n:"Pie",f:fx},4122:{n:"Area",f:kl},4123:{n:"Scatter",f:bA},4124:{n:"CrtLine",f:k},4125:{n:"Axis",f:ar},4126:{n:"Tick",f:jw},4127:{n:"ValueRange",f:e0},4128:{n:"CatSerRange",f:aa},4129:{n:"AxisLine",f:eF},4130:{n:"CrtLink",f:h},4132:{n:"DefaultText",f:a3},4133:{n:"Text",f:kj},4134:{n:"FontX",f:kQ},4135:{n:"ObjectLink",f:n},4146:{n:"Frame",f:F},4147:{n:"Begin",f:bZ},4148:{n:"End",f:c1},4149:{n:"PlotArea",f:P},4154:{n:"Chart3d",f:aW},4156:{n:"PicF",f:fm},4157:{n:"DropBar",f:S},4158:{n:"Radar",f:go},4159:{n:"Surf",f:eL},4160:{n:"RadarArea",f:gB},4161:{n:"AxisParent",f:bE},4163:{n:"LegendException",f:jM},4164:{n:"ShtProps",f:gs},4165:{n:"SerToCrt",f:di},4166:{n:"AxesUsed",f:ds},4168:{n:"SBaseRef",f:ks},4170:{n:"SerParent",f:fX},4171:{n:"SerAuxTrend",f:eP},4174:{n:"IFmtRecord",f:ax},4175:{n:"Pos",f:d4},4176:{n:"AlRuns",f:eO},4177:{n:"BRAI",f:cX},4187:{n:"SerAuxErrBar",f:iU},4188:{n:"ClrtClient",f:eQ},4189:{n:"SerFmt",f:j7},4191:{n:"Chart3DBarShape",f:g3},4192:{n:"Fbi",f:kd},4193:{n:"BopPop",f:fB},4194:{n:"AxcExt",f:gU},4195:{n:"Dat",f:bu},4196:{n:"PlotGrowth",f:ej},4197:{n:"SIIndex",f:i0},4198:{n:"GelFrame",f:dc},4199:{n:"BopPopCustom",f:e3},4200:{n:"Fbi2",f:jz},22:{n:"ExternCount",f:jH},126:{n:"RK",f:jH},127:{n:"ImData",f:jH},135:{n:"Addin",f:jH},136:{n:"Edg",f:jH},137:{n:"Pub",f:jH},145:{n:"Sub",f:jH},148:{n:"LHRecord",f:jH},149:{n:"LHNGraph",f:jH},150:{n:"Sound",f:jH},169:{n:"CoordList",f:jH},171:{n:"GCW",f:jH},188:{n:"ShrFmla",f:jH},194:{n:"AddMenu",f:jH},195:{n:"DelMenu",f:jH},214:{n:"RString",f:jH},223:{n:"UDDesc",f:jH},234:{n:"TabIdConf",f:jH},354:{n:"XL5Modify",f:jH},421:{n:"FileSharing2",f:jH},536:{n:"Name",f:jH},547:{n:"ExternName",f:da},561:{n:"Font",f:jH},1030:{n:"Formula",f:fk},2157:{n:"FeatInfo",f:jH},2163:{n:"FeatInfo11",f:jH},2177:{n:"SXAddl12",f:jH},2240:{n:"AutoWebPub",f:jH},2241:{n:"ListObj",f:jH},2242:{n:"ListField",f:jH},2243:{n:"ListDV",f:jH},2244:{n:"ListCondFmt",f:jH},2245:{n:"ListCF",f:jH},2246:{n:"FMQry",f:jH},2247:{n:"FMSQry",f:jH},2248:{n:"PLV",f:jH},2249:{n:"LnExt",f:jH},2250:{n:"MkrExt",f:jH},2251:{n:"CrtCoopt",f:jH},0:{}};var ia={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"};function dR(kR){return function fs(kT){for(var kS=0;kS!=kR.length;++kS){var kU=kR[kS];if(kT[kU[0]]===undefined){kT[kU[0]]=kU[1]}if(kU[2]==="n"){kT[kU[0]]=Number(kT[kU[0]])}}}}var jR=dR([["cellNF",false],["cellFormula",true],["cellStyles",false],["sheetRows",0,"n"],["bookSheets",false],["bookProps",false],["bookFiles",false],["password",""],["WTF",false]]);function hj(kT){var kS={};var kU=kT.content;var kR=28,fs;fs=jq(kU,kR);kR+=4+a5(kU,kR);kS.UserType=fs;fs=a5(kU,kR);kR+=4;switch(fs){case 0:break;case 4294967295:case 4294967294:kR+=4;break;default:if(fs>400){throw new Error("Unsupported Clipboard: "+fs.toString(16))}kR+=fs}fs=jq(kU,kR);kR+=fs.length===0?0:5+fs.length;kS.Reserved1=fs;if((fs=a5(kU,kR))!==1907550708){return kS}throw"Unsupported Unicode Extension"}function eB(kW,kR,kS,fs){var kT=kS;var kV=[];var kY=kR.slice(kR.l,kR.l+kT);if(fs&&fs.enc&&fs.enc.insitu_decrypt){switch(kW.n){case"BOF":case"FilePass":case"FileLock":case"InterfaceHdr":case"RRDInfo":case"RRDHead":case"UsrExcl":break;default:if(kY.length===0){break}fs.enc.insitu_decrypt(kY)}}kV.push(kY);kR.l+=kT;var kX=(gw[eT(kR,kR.l)]);while(kX!=null&&kX.n==="Continue"){kT=eT(kR,kR.l+2);kV.push(kR.slice(kR.l+4,kR.l+4+kT));kR.l+=4+kT;kX=(gw[eT(kR,kR.l)])}var k0=hQ(kV);ht(k0,0);var kZ=0;k0.lens=[];for(var kU=0;kU<kV.length;++kU){k0.lens.push(kZ);kZ+=kV[kU].length}return kW.f(k0,k0.length,fs)}function eX(kT,fs){if(!kT.XF){return}try{var kR=kT.XF.ifmt||0;if(kT.t==="e"){kT.w=kT.w||e7[kT.v]}else{if(kR===0){if(kT.t==="n"){if((kT.v|0)===kT.v){kT.w=cN._general_int(kT.v)}else{kT.w=cN._general_num(kT.v)}}else{kT.w=cN._general(kT.v)}}else{kT.w=cN.format(kR,kT.v)}}if(fs.cellNF){kT.z=cN._table[kR]}}catch(kS){if(fs.WTF){throw kS}}}function kh(kS,fs,kR){return{v:kS,ixfe:fs,t:kR}}function gu(la,lb){var kZ={opts:{}};var kW={};var lp={};var lw={};var lm=false;var k1={};var lh=null;var lF=[];var fs="";var k2={};var lB,k5,lk,lE,ly,lq,lj;var kS={};var kX=[];var lc;var ls;var kT=true;var lr=[];var lD=[];var lt=function k3(lH){if(lH<8){return bz[lH]}if(lH<64){return lD[lH-8]||bz[lH]}return bz[lH]};var kR=function ld(lH,lI){var lK=lI.XF.data;if(!lK||!lK.patternType){return}lI.s={};lI.s.patternType=lK.patternType;var lJ;if((lJ=ae(lt(lK.icvFore)))){lI.s.fgColor={rgb:lJ}}if((lJ=ae(lt(lK.icvBack)))){lI.s.bgColor={rgb:lJ}}};var kU=function kU(lH,lI,lJ){if(!kT){return}if(lJ.cellStyles&&lI.XF&&lI.XF.data){kR(lH,lI)}lB=lH;k5=gX(lH);if(k1.s){if(lH.r<k1.s.r){k1.s.r=lH.r}if(lH.c<k1.s.c){k1.s.c=lH.c}}if(k1.e){if(lH.r+1>k1.e.r){k1.e.r=lH.r+1}if(lH.c+1>k1.e.c){k1.e.c=lH.c+1}}if(lJ.sheetRows&&lB.r>=lJ.sheetRows){kT=false}else{lp[k5]=lI}};var le={enc:false,sbcch:0,snames:[],sharedf:kS,arrayf:kX,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,wtf:false};if(lb.password){le.password=lb.password}var k7=[];var lv=[];var lA=[[]];var ll=0,k9=0,lG=0;lA.SheetNames=le.snames;lA.sharedf=le.sharedf;lA.arrayf=le.arrayf;var lg="";var lx=0;while(la.l<la.length-1){var lu=la.l;var k8=la.read_shift(2);if(k8===0&&lg==="EOF"){break}var k6=(la.l===la.length?0:la.read_shift(2)),lo;var kY=gw[k8];if(kY&&kY.f){if(lb.bookSheets){if(lg==="BoundSheet8"&&kY.n!=="BoundSheet8"){break}}lg=kY.n;if(kY.r===2||kY.r==12){var li=la.read_shift(2);k6-=2;if(!le.enc&&li!==k8){throw"rt mismatch"}if(kY.r==12){la.l+=10;k6-=10}}var lf;if(kY.n==="EOF"){lf=kY.f(la,k6,le)}else{lf=eB(kY,la,k6,le)}var kV=kY.n;if(le.biff===5||le.biff===2){switch(kV){case"Lbl":kV="Label";break}}switch(kV){case"Date1904":kZ.opts.Date1904=lf;break;case"WriteProtect":kZ.opts.WriteProtect=true;break;case"FilePass":if(!le.enc){la.l=0}le.enc=lf;if(le.WTF){console.error(lf)}if(!lb.password){throw new Error("File is password-protected")}if(lf.Type!==0){throw new Error("Encryption scheme unsupported")}if(!lf.valid){throw new Error("Password is incorrect")}break;case"WriteAccess":le.lastuser=lf;break;case"FileSharing":break;case"CodePage":if(lf===21010){lf=1200}else{if(lf===32769){lf=1252}}le.codepage=lf;ew(lf);break;case"RRTabId":le.rrtabid=lf;break;case"WinProtect":le.winlocked=lf;break;case"Template":break;case"RefreshAll":kZ.opts.RefreshAll=lf;break;case"BookBool":break;case"UsesELFs":break;case"MTRSettings":if(lf[0]&&lf[1]){throw"Unsupported threads: "+lf}break;case"CalcCount":kZ.opts.CalcCount=lf;break;case"CalcDelta":kZ.opts.CalcDelta=lf;break;case"CalcIter":kZ.opts.CalcIter=lf;break;case"CalcMode":kZ.opts.CalcMode=lf;break;case"CalcPrecision":kZ.opts.CalcPrecision=lf;break;case"CalcSaveRecalc":kZ.opts.CalcSaveRecalc=lf;break;case"CalcRefMode":le.CalcRefMode=lf;break;case"Uncalced":break;case"ForceFullCalculation":kZ.opts.FullCalc=lf;break;case"WsBool":break;case"XF":lr.push(lf);break;case"ExtSST":break;case"BookExt":break;case"RichTextStream":break;case"BkHim":break;case"SupBook":lA[++ll]=[lf];k9=0;break;case"ExternName":lA[ll][++k9]=lf;break;case"Index":break;case"Lbl":lA[0][++lG]=lf;break;case"ExternSheet":lA[ll]=lA[ll].concat(lf);k9+=lf.length;break;case"Protect":lp["!protect"]=lf;break;case"Password":if(lf!==0&&le.WTF){console.error("Password verifier: "+lf)}break;case"Prot4Rev":case"Prot4RevPass":break;case"BoundSheet8":lw[lf.pos]=lf;le.snames.push(lf.name);break;case"EOF":if(--lx){break}if(k1.e){lp["!range"]=k1;if(k1.e.r>0&&k1.e.c>0){k1.e.r--;k1.e.c--;lp["!ref"]=cR(k1);k1.e.r++;k1.e.c++}if(k7.length>0){lp["!merges"]=k7}if(lv.length>0){lp["!objects"]=lv}}if(fs===""){k2=lp}else{kW[fs]=lp}lp={};break;case"BOF":if(le.biff!==8){}else{if(lf.BIFFVer===1280){le.biff=5}else{if(lf.BIFFVer===2){le.biff=2}else{if(lf.BIFFVer===7){le.biff=2}}}}if(lx++){break}kT=true;lp={};if(le.biff===2){if(fs===""){fs="Sheet1"}k1={s:{r:0,c:0},e:{r:0,c:0}}}else{fs=(lw[lu]||{name:""}).name}k7=[];lv=[];break;case"Number":case"BIFF2NUM":lc={ixfe:lf.ixfe,XF:lr[lf.ixfe],v:lf.val,t:"n"};if(lc.XF){eX(lc,lb)}kU({c:lf.c,r:lf.r},lc,lb);break;case"BoolErr":lc={ixfe:lf.ixfe,XF:lr[lf.ixfe],v:lf.val,t:lf.t};if(lc.XF){eX(lc,lb)}kU({c:lf.c,r:lf.r},lc,lb);break;case"RK":lc={ixfe:lf.ixfe,XF:lr[lf.ixfe],v:lf.rknum,t:"n"};if(lc.XF){eX(lc,lb)}kU({c:lf.c,r:lf.r},lc,lb);break;case"MulRk":for(var lC=lf.c;lC<=lf.C;++lC){var lz=lf.rkrec[lC-lf.c][0];lc={ixfe:lz,XF:lr[lz],v:lf.rkrec[lC-lf.c][1],t:"n"};if(lc.XF){eX(lc,lb)}kU({c:lC,r:lf.r},lc,lb)}break;case"Formula":switch(lf.val){case"String":lh=lf;break;case"Array Formula":throw"Array Formula unsupported";default:lc={v:lf.val,ixfe:lf.cell.ixfe,t:lf.tt};lc.XF=lr[lc.ixfe];if(lb.cellFormula){lc.f="="+ey(lf.formula,k1,lf.cell,lA,le)}if(lc.XF){eX(lc,lb)}kU(lf.cell,lc,lb);lh=lf}break;case"String":if(lh){lh.val=lf;lc={v:lh.val,ixfe:lh.cell.ixfe,t:"s"};lc.XF=lr[lc.ixfe];if(lb.cellFormula){lc.f="="+ey(lh.formula,k1,lh.cell,lA,le)}if(lc.XF){eX(lc,lb)}kU(lh.cell,lc,lb);lh=null}break;case"Array":kX.push(lf);break;case"ShrFmla":if(!kT){break}kS[gX(lh.cell)]=lf[0];break;case"LabelSst":lc=kh(lF[lf.isst].t,lf.ixfe,"s");lc.XF=lr[lc.ixfe];if(lc.XF){eX(lc,lb)}kU({c:lf.c,r:lf.r},lc,lb);break;case"Label":case"BIFF2STR":lc=kh(lf.val,lf.ixfe,"s");lc.XF=lr[lc.ixfe];if(lc.XF){eX(lc,lb)}kU({c:lf.c,r:lf.r},lc,lb);break;case"Dimensions":if(lx===1){k1=lf}break;case"SST":lF=lf;break;case"Format":cN.load(lf[1],lf[0]);break;case"MergeCells":k7=k7.concat(lf);break;case"Obj":lv[lf.cmo[0]]=le.lastobj=lf;break;case"TxO":le.lastobj.TxO=lf;break;case"HLink":for(lj=lf[0].s.r;lj<=lf[0].e.r;++lj){for(lq=lf[0].s.c;lq<=lf[0].e.c;++lq){if(lp[gX({c:lq,r:lj})]){lp[gX({c:lq,r:lj})].l=lf[1]}}}break;case"HLinkTooltip":for(lj=lf[0].s.r;lj<=lf[0].e.r;++lj){for(lq=lf[0].s.c;lq<=lf[0].e.c;++lq){if(lp[gX({c:lq,r:lj})]){lp[gX({c:lq,r:lj})].l.tooltip=lf[1]}}}break;case"Note":if(le.biff<=5&&le.biff>=2){break}lk=lp[gX(lf[0])];var k4=lv[lf[2]];if(!lk){break}if(!lk.c){lk.c=[]}lE={a:lf[1],t:k4.TxO.t};lk.c.push(lE);break;default:switch(kY.n){case"ClrtClient":break;case"XFExt":cp(lr[lf.ixfe],lf.ext);break;case"NameCmt":break;case"Header":break;case"Footer":break;case"HCenter":break;case"VCenter":break;case"Pls":break;case"Setup":break;case"DefColWidth":break;case"GCW":break;case"LHRecord":break;case"ColInfo":break;case"Row":break;case"DBCell":break;case"MulBlank":break;case"EntExU2":break;case"SxView":break;case"Sxvd":break;case"SXVI":break;case"SXVDEx":break;case"SxIvd":break;case"SXDI":break;case"SXLI":break;case"SXEx":break;case"QsiSXTag":break;case"Selection":break;case"Feat":break;case"FeatHdr":case"FeatHdr11":break;case"Feature11":case"Feature12":case"List12":break;case"Blank":break;case"Country":ls=lf;break;case"RecalcId":break;case"DefaultRowHeight":case"DxGCol":break;case"Fbi":case"Fbi2":case"GelFrame":break;case"Font":break;case"XFCRC":break;case"Style":break;case"StyleExt":break;case"Palette":lD=lf;break;case"Theme":break;case"ScenarioProtect":break;case"ObjProtect":break;case"CondFmt12":break;case"Table":break;case"TableStyles":break;case"TableStyle":break;case"TableStyleElement":break;case"SXStreamID":break;case"SXVS":break;case"DConRef":break;case"SXAddl":break;case"DConBin":break;case"DConName":break;case"SXPI":break;case"SxFormat":break;case"SxSelect":break;case"SxRule":break;case"SxFilt":break;case"SxItm":break;case"SxDXF":break;case"ScenMan":break;case"DCon":break;case"CellWatch":break;case"PrintRowCol":break;case"PrintGrid":break;case"PrintSize":break;case"XCT":break;case"CRN":break;case"Scl":break;case"SheetExt":break;case"SheetExtOptional":break;case"ObNoMacros":break;case"ObProj":break;case"CodeName":break;case"GUIDTypeLib":break;case"WOpt":break;case"PhoneticInfo":break;case"OleObjectSize":break;case"DXF":case"DXFN":case"DXFN12":case"DXFN12List":case"DXFN12NoCB":break;case"Dv":case"DVal":break;case"BRAI":case"Series":case"SeriesText":break;case"DConn":break;case"DbOrParamQry":break;case"DBQueryExt":break;case"IFmtRecord":break;case"CondFmt":case"CF":case"CF12":case"CFEx":break;case"Excel9File":break;case"Units":break;case"InterfaceHdr":case"Mms":case"InterfaceEnd":case"DSF":case"BuiltInFnGroupCount":case"Window1":case"Window2":case"HideObj":case"GridSet":case"Guts":case"UserBView":case"UserSViewBegin":case"UserSViewEnd":case"Pane":break;default:switch(kY.n){case"Dat":case"Begin":case"End":case"StartBlock":case"EndBlock":case"Frame":case"Area":case"Axis":case"AxisLine":case"Tick":break;case"AxesUsed":case"CrtLayout12":case"CrtLayout12A":case"CrtLink":case"CrtLine":case"CrtMlFrt":case"CrtMlFrtContinue":break;case"LineFormat":case"AreaFormat":case"Chart":case"Chart3d":case"Chart3DBarShape":case"ChartFormat":case"ChartFrtInfo":break;case"PlotArea":case"PlotGrowth":break;case"SeriesList":case"SerParent":case"SerAuxTrend":break;case"DataFormat":case"SerToCrt":case"FontX":break;case"CatSerRange":case"AxcExt":case"SerFmt":break;case"ShtProps":break;case"DefaultText":case"Text":case"CatLab":break;case"DataLabExtContents":break;case"Legend":case"LegendException":break;case"Pie":case"Scatter":break;case"PieFormat":case"MarkerFormat":break;case"StartObject":case"EndObject":break;case"AlRuns":case"ObjectLink":break;case"SIIndex":break;case"AttachedLabel":case"YMult":break;case"Line":case"Bar":break;case"Surf":break;case"AxisParent":break;case"Pos":break;case"ValueRange":break;case"SXViewEx9":break;case"SXViewLink":break;case"PivotChartBits":break;case"SBaseRef":break;case"TextPropsStream":break;case"LnExt":break;case"MkrExt":break;case"CrtCoopt":break;case"Qsi":case"Qsif":case"Qsir":case"QsiSXTag":break;case"TxtQry":break;case"FilterMode":break;case"AutoFilter":case"AutoFilterInfo":break;case"AutoFilter12":break;case"DropDownObjIds":break;case"Sort":break;case"SortData":break;case"ShapePropsStream":break;case"MsoDrawing":case"MsoDrawingGroup":case"MsoDrawingSelection":break;case"ImData":break;case"WebPub":case"AutoWebPub":case"RightMargin":case"LeftMargin":case"TopMargin":case"BottomMargin":case"HeaderFooter":case"HFPicture":case"PLV":case"HorizontalPageBreaks":case"VerticalPageBreaks":case"Backup":case"CompressPictures":case"Compat12":break;case"Continue":case"ContinueFrt12":break;case"FrtFontList":case"FrtWrapper":break;case"ExternCount":break;case"RString":break;case"TabIdConf":case"Radar":case"RadarArea":case"DropBar":case"Intl":case"CoordList":case"SerAuxErrBar":break;default:switch(kY.n){case"SCENARIO":case"DConBin":case"PicF":case"DataLabExt":case"Lel":case"BopPop":case"BopPopCustom":case"RealTimeData":case"Name":break;default:if(lb.WTF){throw"Unrecognized Record "+kY.n}}}}}}else{la.l+=k6}}var ln=le.biff===2?["Sheet1"]:Object.keys(lw).sort(function(lI,lH){return Number(lI)-Number(lH)}).map(function(lH){return lw[lH].name});var k0=ln.slice();kZ.Directory=ln;kZ.SheetNames=ln;if(!lb.bookSheets){kZ.Sheets=kW}kZ.Preamble=k2;kZ.Strings=lF;kZ.SSF=cN.get_table();if(le.enc){kZ.Encryption=le.enc}kZ.Metadata={};if(ls!==undefined){kZ.Metadata.Country=ls}return kZ}function dX(kY,kZ){if(!kZ){kZ={}}jR(kZ);fD();var kS,fs,kW;if(kY.find){kS=kY.find("!CompObj");fs=kY.find("!SummaryInformation");kW=kY.find("/Workbook")}else{ht(kY,0);kW={content:kY}}if(!kW){kW=kY.find("/Book")}var kR,kU,kT;if(kS){kR=hj(kS)}if(kZ.bookProps&&!kZ.bookSheets){kT={}}else{if(kW){kT=gu(kW.content,kZ,!!kW.find)}else{throw new Error("Cannot find Workbook stream")}}if(kY.find){bS(kY)}var kV={};for(var kX in kY.Summary){kV[kX]=kY.Summary[kX]}for(kX in kY.DocSummary){kV[kX]=kY.DocSummary[kX]}kT.Props=kT.Custprops=kV;if(kZ.bookFiles){kT.cfb=kY}kT.CompObjP=kR;return kT}function bS(kR){var kS=kR.find("!DocumentSummaryInformation");if(kS){try{kR.DocSummary=fb(kS,ge)}catch(kT){}}var fs=kR.find("!SummaryInformation");if(fs){try{kR.Summary=fb(fs,ed)}catch(kT){}}}var d5=/&[a-z]*;/g,bg=/_x([0-9a-fA-F]+)_/g;function it(fs,kR){return ak(parseInt(kR,16))}function gK(fs){return g6[fs]}function G(fs){if(fs.indexOf("&")>-1){fs=fs.replace(d5,gK)}return fs.indexOf("_")===-1?fs:fs.replace(bg,it)}function iR(kR,fs){switch(kR){case"1":case"true":case"TRUE":return true;default:return false}}function h4(kR,fs){return new RegExp("<"+kR+'(?: xml:space="preserve")?>([^]*)</'+kR+">",(fs||"")+"m")}var H=/&#(\d+);/g;function hB(kR,fs){return String.fromCharCode(parseInt(fs,10))}function cf(fs){return fs.replace(H,hB)}var ep={"General Number":"General","General Date":cN._table[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":cN._table[15],"Short Date":cN._table[14],"Long Time":cN._table[19],"Medium Time":cN._table[18],"Short Time":cN._table[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:cN._table[2],Standard:cN._table[4],Percent:cN._table[10],Scientific:cN._table[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var b7={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function ad(kR,fs,kS){switch(fs){case"Description":fs="Comments";break}kR[fs]=kS}function fr(kS,kR){var fs=ep[kS]||G(kS);if(fs==="General"){return cN._general(kR)}return cN.format(fs,kR)}function eo(fs,kT,kR,kS){switch((kR[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":kS=iR(kS);break;case"i2":case"int":kS=parseInt(kS,10);break;case"r4":case"float":kS=parseFloat(kS);break;case"date":case"dateTime.tz":kS=new Date(kS);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw"bad custprop:"+kR[0]}fs[G(kT[3])]=kS}function dw(fs,kR,kT){try{if(fs.t==="e"){fs.w=fs.w||e7[fs.v]}else{if(kR==="General"){if(fs.t==="n"){if((fs.v|0)===fs.v){fs.w=cN._general_int(fs.v)}else{fs.w=cN._general_num(fs.v)}}else{fs.w=cN._general(fs.v)}}else{fs.w=fr(kR||"General",fs.v)}}if(kT.cellNF){fs.z=ep[kR]||kR||"General"}}catch(kS){if(kT.WTF){throw kS}}}function hY(kS,kT,kR){if(kR.cellStyles){if(kT.Interior){var fs=kT.Interior;if(fs.Pattern){fs.patternType=b7[fs.Pattern]||fs.Pattern}}}kS[kT.ID]=kT}function jt(kW,k2,kV,kZ,kR,k0,kX,k1,kS){var kT="General",fs=kZ.StyleID,kU={};kS=kS||{};var kY=[];if(fs===undefined&&k1){fs=k1.StyleID}if(fs===undefined&&kX){fs=kX.StyleID}while(k0[fs]!==undefined){if(k0[fs].nf){kT=k0[fs].nf}if(k0[fs].Interior){kY.push(k0[fs].Interior)}if(!k0[fs].Parent){break}fs=k0[fs].Parent}switch(kV.Type){case"Boolean":kZ.t="b";kZ.v=iR(kW);break;case"String":kZ.t="s";kZ.r=cf(G(kW));kZ.v=kW.indexOf("<")>-1?k2:kZ.r;break;case"DateTime":kZ.v=(Date.parse(kW)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1000);if(kZ.v!==kZ.v){kZ.v=G(kW)}else{if(kZ.v>=1&&kZ.v<60){kZ.v=kZ.v-1}}if(!kT||kT=="General"){kT="yyyy-mm-dd"}case"Number":if(kZ.v===undefined){kZ.v=+kW}if(!kZ.t){kZ.t="n"}break;case"Error":kZ.t="e";kZ.v=i3[kW];kZ.w=kW;break;default:kZ.t="s";kZ.v=cf(k2);break}dw(kZ,kT,kS);if(kS.cellFormula!=null&&kZ.Formula){kZ.f=hn(G(kZ.Formula),kR);kZ.Formula=undefined}if(kS.cellStyles){kY.forEach(function(k3){if(!kU.patternType&&k3.patternType){kU.patternType=k3.patternType}});kZ.s=kU}kZ.ixfe=kZ.StyleID!==undefined?kZ.StyleID:"Default"}function jC(fs){fs.t=fs.v;fs.v=fs.w=fs.ixfe=undefined}function kL(fs){if(I&&Buffer.isBuffer(fs)){return fs.toString("utf8")}if(typeof fs==="string"){return fs}throw"badf"}var iC=/<(\/?)([a-z0-9]*:|)(\w+)[^>]*>/mg;function hv(ll,k6){var lb=kL(ll);var kS;var lp=[],lg;var k8={},kU=[],kX={},kR="";var k4={},k7={},k0={},li,lo;var lm=0,lf=0;var kW={s:{r:1000000,c:1000000},e:{r:0,c:0}};var k9={},fs={};var kY="",lh=0;var k1=[];var kZ={},k2={},lk=0,k5={};var kT=[],lc={};var ln=[],kV;while((kS=iC.exec(lb))){switch(kS[3]){case"Data":if(lp[lp.length-1][1]){break}if(kS[1]==="/"){jt(lb.slice(lo,kS.index),kY,li,lp[lp.length-1][0]=="Comment"?lc:k7,{c:lm,r:lf},k9,ln[lm],k0,k6)}else{kY="";li=aB(kS[0]);lo=kS.index+kS[0].length}break;case"Cell":if(kS[1]==="/"){if(kT.length>0){k7.c=kT}if((!k6.sheetRows||k6.sheetRows>lf)&&k7.v!==undefined){kX[cA(lm)+jI(lf)]=k7}if(k7.HRef){k7.l={Target:k7.HRef,tooltip:k7.HRefScreenTip};k7.HRef=k7.HRefScreenTip=undefined}if(k7.MergeAcross||k7.MergeDown){var ld=lm+(parseInt(k7.MergeAcross,10)|0);var la=lf+(parseInt(k7.MergeDown,10)|0);k1.push({s:{c:lm,r:lf},e:{c:ld,r:la}})}++lm;if(k7.MergeAcross){lm+=+k7.MergeAcross}}else{k7=b3(kS[0]);if(k7.Index){lm=+k7.Index-1}if(lm<kW.s.c){kW.s.c=lm}if(lm>kW.e.c){kW.e.c=lm}if(kS[0].substr(-2)==="/>"){++lm}kT=[]}break;case"Row":if(kS[1]==="/"||kS[0].substr(-2)==="/>"){if(lf<kW.s.r){kW.s.r=lf}if(lf>kW.e.r){kW.e.r=lf}if(kS[0].substr(-2)==="/>"){k0=aB(kS[0]);if(k0.Index){lf=+k0.Index-1}}lm=0;++lf}else{k0=aB(kS[0]);if(k0.Index){lf=+k0.Index-1}}break;case"Worksheet":if(kS[1]==="/"){if((lg=lp.pop())[0]!==kS[3]){throw"Bad state: "+lg}kU.push(kR);if(kW.s.r<=kW.e.r&&kW.s.c<=kW.e.c){kX["!ref"]=cR(kW)}if(k1.length){kX["!merges"]=k1}k8[kR]=kX}else{kW={s:{r:1000000,c:1000000},e:{r:0,c:0}};lf=lm=0;lp.push([kS[3],false]);lg=aB(kS[0]);kR=lg.Name;kX={};k1=[]}break;case"Table":if(kS[1]==="/"){if((lg=lp.pop())[0]!==kS[3]){throw"Bad state: "+lg}}else{if(kS[0].slice(-2)=="/>"){break}else{k4=aB(kS[0]);lp.push([kS[3],false]);ln=[]}}break;case"Style":if(kS[1]==="/"){hY(k9,fs,k6)}else{fs=aB(kS[0])}break;case"NumberFormat":fs.nf=aB(kS[0]).Format||"General";break;case"Column":if(lp[lp.length-1][0]!=="Table"){break}kV=aB(kS[0]);ln[(kV.Index-1||ln.length)]=kV;for(var lj=0;lj<+kV.Span;++lj){ln[ln.length]=kV}break;case"NamedRange":break;case"NamedCell":break;case"B":break;case"I":break;case"U":break;case"S":break;case"Sub":break;case"Sup":break;case"Span":break;case"Border":break;case"Alignment":break;case"Borders":break;case"Font":if(kS[0].substr(-2)==="/>"){break}else{if(kS[1]==="/"){kY+=lb.slice(lh,kS.index)}else{lh=kS.index+kS[0].length}}break;case"Interior":if(!k6.cellStyles){break}fs.Interior=aB(kS[0]);break;case"Protection":break;case"Author":case"Title":case"Description":case"Created":case"Keywords":case"Subject":case"Category":case"Company":case"LastAuthor":case"LastSaved":case"LastPrinted":case"Version":case"Revision":case"TotalTime":case"HyperlinkBase":case"Manager":if(kS[0].substr(-2)==="/>"){break}else{if(kS[1]==="/"){ad(kZ,kS[3],lb.slice(lk,kS.index))}else{lk=kS.index+kS[0].length}}break;case"Paragraphs":break;case"Styles":case"Workbook":if(kS[1]==="/"){if((lg=lp.pop())[0]!==kS[3]){throw"Bad state: "+lg}}else{lp.push([kS[3],false])}break;case"Comment":if(kS[1]==="/"){if((lg=lp.pop())[0]!==kS[3]){throw"Bad state: "+lg}jC(lc);kT.push(lc)}else{lp.push([kS[3],false]);lg=aB(kS[0]);lc={a:lg.Author}}break;case"Name":break;case"ComponentOptions":case"DocumentProperties":case"CustomDocumentProperties":case"OfficeDocumentSettings":case"PivotTable":case"PivotCache":case"Names":case"MapInfo":case"PageBreaks":case"QueryTable":case"DataValidation":case"AutoFilter":case"Sorting":case"Schema":case"data":case"ConditionalFormatting":case"SmartTagType":case"SmartTags":case"ExcelWorkbook":case"WorkbookOptions":case"WorksheetOptions":if(kS[1]==="/"){if((lg=lp.pop())[0]!==kS[3]){throw"Bad state: "+lg}}else{if(kS[0].charAt(kS[0].length-2)!=="/"){lp.push([kS[3],true])}}break;default:var k3=true;switch(lp[lp.length-1][0]){case"OfficeDocumentSettings":switch(kS[3]){case"AllowPNG":break;case"RemovePersonalInformation":break;case"DownloadComponents":break;case"LocationOfComponents":break;case"Colors":break;case"Color":break;case"Index":break;case"RGB":break;case"PixelsPerInch":break;case"TargetScreenSize":break;case"ReadOnlyRecommended":break;default:k3=false}break;case"ComponentOptions":switch(kS[3]){case"Toolbar":break;case"HideOfficeLogo":break;case"SpreadsheetAutoFit":break;case"Label":break;case"Caption":break;case"MaxHeight":break;case"MaxWidth":break;case"NextSheetNumber":break;default:k3=false}break;case"ExcelWorkbook":switch(kS[3]){case"WindowHeight":break;case"WindowWidth":break;case"WindowTopX":break;case"WindowTopY":break;case"TabRatio":break;case"ProtectStructure":break;case"ProtectWindows":break;case"ActiveSheet":break;case"DisplayInkNotes":break;case"FirstVisibleSheet":break;case"SupBook":break;case"SheetName":break;case"SheetIndex":break;case"SheetIndexFirst":break;case"SheetIndexLast":break;case"Dll":break;case"AcceptLabelsInFormulas":break;case"DoNotSaveLinkValues":break;case"Date1904":break;case"Iteration":break;case"MaxIterations":break;case"MaxChange":break;case"Path":break;case"Xct":break;case"Count":break;case"SelectedSheets":break;case"Calculation":break;case"Uncalced":break;case"StartupPrompt":break;case"Crn":break;case"ExternName":break;case"Formula":break;case"ColFirst":break;case"ColLast":break;case"WantAdvise":break;case"Boolean":break;case"Error":break;case"Text":break;case"OLE":break;case"NoAutoRecover":break;case"PublishObjects":break;case"DoNotCalculateBeforeSave":break;case"Number":break;case"RefModeR1C1":break;case"EmbedSaveSmartTags":break;default:k3=false}break;case"WorkbookOptions":switch(kS[3]){case"OWCVersion":break;case"Height":break;case"Width":break;default:k3=false}break;case"WorksheetOptions":switch(kS[3]){case"Unsynced":break;case"Visible":break;case"Print":break;case"Panes":break;case"Scale":break;case"Pane":break;case"Number":break;case"Layout":break;case"Header":break;case"Footer":break;case"PageSetup":break;case"PageMargins":break;case"Selected":break;case"ProtectObjects":break;case"EnableSelection":break;case"ProtectScenarios":break;case"ValidPrinterInfo":break;case"HorizontalResolution":break;case"VerticalResolution":break;case"NumberofCopies":break;case"ActiveRow":break;case"ActiveCol":break;case"ActivePane":break;case"TopRowVisible":break;case"TopRowBottomPane":break;case"LeftColumnVisible":break;case"LeftColumnRightPane":break;case"FitToPage":break;case"RangeSelection":break;case"PaperSizeIndex":break;case"PageLayoutZoom":break;case"PageBreakZoom":break;case"FilterOn":break;case"DoNotDisplayGridlines":break;case"SplitHorizontal":break;case"SplitVertical":break;case"FreezePanes":break;case"FrozenNoSplit":break;case"FitWidth":break;case"FitHeight":break;case"CommentsLayout":break;case"Zoom":break;case"LeftToRight":break;case"Gridlines":break;case"AllowSort":break;case"AllowFilter":break;case"AllowInsertRows":break;case"AllowDeleteRows":break;case"AllowInsertCols":break;case"AllowDeleteCols":break;case"AllowInsertHyperlinks":break;case"AllowFormatCells":break;case"AllowSizeCols":break;case"AllowSizeRows":break;case"NoSummaryRowsBelowDetail":break;case"TabColorIndex":break;case"DoNotDisplayHeadings":break;case"ShowPageLayoutZoom":break;case"NoSummaryColumnsRightDetail":break;case"BlackAndWhite":break;case"DoNotDisplayZeros":break;case"DisplayPageBreak":break;case"RowColHeadings":break;case"DoNotDisplayOutline":break;case"NoOrientation":break;case"AllowUsePivotTables":break;case"ZeroHeight":break;case"ViewableRange":break;case"Selection":break;case"ProtectContents":break;default:k3=false}break;case"PivotTable":case"PivotCache":switch(kS[3]){case"ImmediateItemsOnDrop":break;case"ShowPageMultipleItemLabel":break;case"CompactRowIndent":break;case"Location":break;case"PivotField":break;case"Orientation":break;case"LayoutForm":break;case"LayoutSubtotalLocation":break;case"LayoutCompactRow":break;case"Position":break;case"PivotItem":break;case"DataType":break;case"DataField":break;case"SourceName":break;case"ParentField":break;case"PTLineItems":break;case"PTLineItem":break;case"CountOfSameItems":break;case"Item":break;case"ItemType":break;case"PTSource":break;case"CacheIndex":break;case"ConsolidationReference":break;case"FileName":break;case"Reference":break;case"NoColumnGrand":break;case"NoRowGrand":break;case"BlankLineAfterItems":break;case"Hidden":break;case"Subtotal":break;case"BaseField":break;case"MapChildItems":break;case"Function":break;case"RefreshOnFileOpen":break;case"PrintSetTitles":break;case"MergeLabels":break;case"DefaultVersion":break;case"RefreshName":break;case"RefreshDate":break;case"RefreshDateCopy":break;case"VersionLastRefresh":break;case"VersionLastUpdate":break;case"VersionUpdateableMin":break;case"VersionRefreshableMin":break;case"Calculation":break;default:k3=false}break;case"PageBreaks":switch(kS[3]){case"ColBreaks":break;case"ColBreak":break;case"RowBreaks":break;case"RowBreak":break;case"ColStart":break;case"ColEnd":break;case"RowEnd":break;default:k3=false}break;case"AutoFilter":switch(kS[3]){case"AutoFilterColumn":break;case"AutoFilterCondition":break;case"AutoFilterAnd":break;case"AutoFilterOr":break;default:k3=false}break;case"QueryTable":switch(kS[3]){case"Id":break;case"AutoFormatFont":break;case"AutoFormatPattern":break;case"QuerySource":break;case"QueryType":break;case"EnableRedirections":break;case"RefreshedInXl9":break;case"URLString":break;case"HTMLTables":break;case"Connection":break;case"CommandText":break;case"RefreshInfo":break;case"NoTitles":break;case"NextId":break;case"ColumnInfo":break;case"OverwriteCells":break;case"DoNotPromptForFile":break;case"TextWizardSettings":break;case"Source":break;case"Number":break;case"Decimal":break;case"ThousandSeparator":break;case"TrailingMinusNumbers":break;case"FormatSettings":break;case"FieldType":break;case"Delimiters":break;case"Tab":break;case"Comma":break;case"AutoFormatName":break;case"VersionLastEdit":break;case"VersionLastRefresh":break;default:k3=false}break;case"Sorting":case"ConditionalFormatting":case"DataValidation":switch(kS[3]){case"Range":break;case"Type":break;case"Min":break;case"Max":break;case"Sort":break;case"Descending":break;case"Order":break;case"CaseSensitive":break;case"Value":break;case"ErrorStyle":break;case"ErrorMessage":break;case"ErrorTitle":break;case"CellRangeList":break;case"InputMessage":break;case"InputTitle":break;case"ComboHide":break;case"InputHide":break;case"Condition":break;case"Qualifier":break;case"UseBlank":break;case"Value1":break;case"Value2":break;case"Format":break;default:k3=false}break;case"MapInfo":case"Schema":case"data":switch(kS[3]){case"Map":break;case"Entry":break;case"Range":break;case"XPath":break;case"Field":break;case"XSDType":break;case"FilterOn":break;case"Aggregate":break;case"ElementType":break;case"AttributeType":break;case"schema":case"element":case"complexType":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:k3=false}break;case"SmartTags":break;default:k3=false;break}if(k3){break}if(!lp[lp.length-1][1]){throw"Unrecognized tag: "+kS[3]+"|"+lp.join("|")}if(lp[lp.length-1][0]==="CustomDocumentProperties"){if(kS[0].substr(-2)==="/>"){break}else{if(kS[1]==="/"){eo(k2,kS,k5,lb.slice(lk,kS.index))}else{k5=kS;lk=kS.index+kS[0].length}}break}if(k6.WTF){throw"Unrecognized tag: "+kS[3]+"|"+lp.join("|")}}}var le={};if(!k6.bookSheets&&!k6.bookProps){le.Sheets=k8}le.SheetNames=kU;le.SSF=cN.get_table();le.Props=kZ;le.Custprops=k2;return le}function ay(kR,fs){jR(fs=fs||{});switch(fs.type||"base64"){case"base64":return hv(bm.decode(kR),fs);case"binary":case"buffer":case"file":return hv(kR,fs);case"array":return hv(kR.map(ak).join(""),fs)}}function cr(kR,fs){}var jr;if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){jr=require("fs")}}function h5(fs,kR){switch((kR||{}).type||"base64"){case"buffer":return fs[0];case"base64":return bm.decode(fs.substr(0,12)).charCodeAt(0);case"binary":return fs.charCodeAt(0);case"array":return fs[0];default:throw new Error("Unrecognized type "+kR.type)}}function aI(fs,kR){if(!kR){kR={}}if(!kR.type){kR.type=(I&&Buffer.isBuffer(fs))?"buffer":"base64"}switch(h5(fs,kR)){case 208:return dX(f4.read(fs,kR),kR);case 9:return dX(jY(kR.type==="base64"?bm.decode(fs):fs),kR);case 60:return ay(fs,kR);default:throw"Unsupported file"}}var ke=function(fs,kS){var kR=jr.readFileSync(fs);if(!kS){kS={}}switch(h5(kR,{type:"buffer"})){case 208:return dX(f4.read(kR,{type:"buffer"}),kS);case 9:return dX(kR,kS);case 60:return ay(kR,(kS.type="buffer",kS));default:throw"Unsupported file"}};function iF(kR,fs){var kS=fs||{};switch(kS.bookType){case"xml":return cr(kR,kS);default:throw"unsupported output format "+kS.bookType}}function jS(kS,fs,kR){var kT=kR|{};kT.type="file";kT.file=fs;switch(kT.file.substr(-4).toLowerCase()){case".xls":kT.bookType="xls";break;case".xml":kT.bookType="xml";break}return iF(kS,kT)}function aV(fs,kR){if(kR.s){if(fs.cRel){fs.c+=kR.s.c}if(fs.rRel){fs.r+=kR.s.r}}else{fs.c+=kR.c;fs.r+=kR.r}fs.cRel=fs.rRel=0;while(fs.c>=256){fs.c-=256}while(fs.r>=65536){fs.r-=65536}return fs}function eZ(fs,kR){fs.s=aV(fs.s,kR.s);fs.e=aV(fs.e,kR.s);return fs}function dz(fs){return parseInt(cL(fs),10)-1}function jI(fs){return""+(fs+1)}function T(fs){return fs.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function cL(fs){return fs.replace(/\$(\d+)$/,"$1")}function h2(fs){var kT=g5(fs),kS=0,kR=0;for(;kR!==kT.length;++kR){kS=26*kS+kT.charCodeAt(kR)-64}return kS-1}function cA(fs){var kR="";for(++fs;fs;fs=Math.floor((fs-1)/26)){kR=String.fromCharCode(((fs-1)%26)+65)+kR}return kR}function eH(fs){return fs.replace(/^([A-Z])/,"$$$1")}function g5(fs){return fs.replace(/^\$([A-Z])/,"$1")}function ko(fs){return fs.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function bh(fs){var kR=ko(fs);return{c:h2(kR[0]),r:dz(kR[1])}}function gX(fs){return cA(fs.c)+jI(fs.r)}function dF(fs){return eH(T(fs))}function kc(fs){return g5(cL(fs))}function cW(kR){var fs=kR.split(":").map(bh);return{s:fs[0],e:fs[fs.length-1]}}function cR(fs,kR){if(kR===undefined||typeof kR==="number"){return cR(fs.s,fs.e)}if(typeof fs!=="string"){fs=gX(fs)}if(typeof kR!=="string"){kR=gX(kR)}return fs==kR?fs:fs+":"+kR}function dt(kS){var kU={s:{c:0,r:0},e:{c:0,r:0}};var kR=0,kT=0,kV=0;var fs=kS.length;for(kR=0;kT<fs;++kT){if((kV=kS.charCodeAt(kT)-64)<1||kV>26){break}kR=26*kR+kV}kU.s.c=--kR;for(kR=0;kT<fs;++kT){if((kV=kS.charCodeAt(kT)-48)<0||kV>9){break}kR=10*kR+kV}kU.s.r=--kR;if(kT===fs||kS.charCodeAt(++kT)===58){kU.e.c=kU.s.c;kU.e.r=kU.s.r;return kU}for(kR=0;kT!=fs;++kT){if((kV=kS.charCodeAt(kT)-64)<1||kV>26){break}kR=26*kR+kV}kU.e.c=--kR;for(kR=0;kT!=fs;++kT){if((kV=kS.charCodeAt(kT)-48)<0||kV>9){break}kR=10*kR+kV}kU.e.r=--kR;return kU}function c9(fs,kR){if(fs.z!==undefined){try{return(fs.w=cN.format(fs.z,kR))}catch(kS){}}if(!fs.XF){return kR}try{return(fs.w=cN.format(fs.XF.ifmt||0,kR))}catch(kS){return""+kR}}function iu(fs,kR){if(fs==null||fs.t==null){return""}if(fs.w!==undefined){return fs.w}if(kR===undefined){return c9(fs,fs.v)}return c9(fs,kR)}function i7(kR,k0){var k8,kV,k2,k7=0,kT=1,k4,fs=[],kU,kS,k3,kY;var k5=k0!=null?k0:{};var k1=k5.raw;if(kR==null||kR["!ref"]==null){return[]}k2=k5.range!==undefined?k5.range:kR["!ref"];if(k5.header===1){k7=1}else{if(k5.header==="A"){k7=2}else{if(Array.isArray(k5.header)){k7=3}}}switch(typeof k2){case"string":k4=dt(k2);break;case"number":k4=dt(kR["!ref"]);k4.s.r=k2;break;default:k4=k2}if(k7>0){kT=0}var kW=jI(k4.s.r);var kX=new Array(k4.e.c-k4.s.c+1);var k6=new Array(k4.e.r-k4.s.r-kT+1);var kZ=0;for(k3=k4.s.c;k3<=k4.e.c;++k3){kX[k3]=cA(k3);k8=kR[kX[k3]+kW];switch(k7){case 1:fs[k3]=k3;break;case 2:fs[k3]=kX[k3];break;case 3:fs[k3]=k5.header[k3-k4.s.c];break;default:if(k8===undefined){continue}fs[k3]=iu(k8)}}for(kS=k4.s.r+kT;kS<=k4.e.r;++kS){kW=jI(kS);kU=true;if(k7===1){kV=[]}else{kV={};if(Object.defineProperty){Object.defineProperty(kV,"__rowNum__",{value:kS,enumerable:false})}else{kV.__rowNum__=kS}}for(k3=k4.s.c;k3<=k4.e.c;++k3){k8=kR[kX[k3]+kW];if(k8===undefined||k8.t===undefined){continue}kY=k8.v;switch(k8.t){case"e":continue;case"s":break;case"b":case"n":break;default:throw"unrecognized type "+k8.t}if(kY!==undefined){kV[fs[k3]]=k1?kY:iu(k8,kY);kU=false}}if(kU===false||k7===1){k6[kZ++]=kV}}k6.length=kZ;return k6}function jV(fs,kR){return i7(fs,kR!=null?kR:{})}function s(kU,k1){var k8="",k2="",kS=/"/g;var k6=k1==null?{}:k1;if(kU==null||kU["!ref"]==null){return""}var k4=dt(kU["!ref"]);var kR=k6.FS!==undefined?k6.FS:",",kW=kR.charCodeAt(0);var kT=k6.RS!==undefined?k6.RS:"\n",kY=kT.charCodeAt(0);var kX="",kZ="",k0=[];var k7=0,k5=0,k9;var kV=0,k3=0;for(k3=k4.s.c;k3<=k4.e.c;++k3){k0[k3]=cA(k3)}for(kV=k4.s.r;kV<=k4.e.r;++kV){kX="";kZ=jI(kV);for(k3=k4.s.c;k3<=k4.e.c;++k3){k9=kU[k0[k3]+kZ];k2=k9!==undefined?""+iu(k9):"";for(k7=0,k5=0;k7!==k2.length;++k7){if((k5=k2.charCodeAt(k7))===kW||k5===kY||k5===34){k2='"'+k2.replace(kS,'""')+'"';break}}kX+=(k3===k4.s.c?"":kR)+k2}k8+=kX+kT}return k8}var gA=s;function fF(kX){var kS,kY="",k0,kT="";if(kX==null||kX["!ref"]==null){return""}var fs=dt(kX["!ref"]),kU="",kZ=[],kR;kS=new Array((fs.e.r-fs.s.r+1)*(fs.e.c-fs.s.c+1));var kW=0;for(kR=fs.s.c;kR<=fs.e.c;++kR){kZ[kR]=cA(kR)}for(var kV=fs.s.r;kV<=fs.e.r;++kV){kU=jI(kV);for(kR=fs.s.c;kR<=fs.e.c;++kR){kY=kZ[kR]+kU;k0=kX[kY];kT="";if(k0===undefined){continue}if(k0.f!=null){kT=k0.f}else{if(k0.w!==undefined){kT="'"+k0.w}else{if(k0.v===undefined){continue}else{kT=""+k0.v}}}kS[kW++]=kY+"="+kT}}kS.length=kW;return kS}var fw={encode_col:cA,encode_row:jI,encode_cell:gX,encode_range:cR,decode_col:h2,decode_row:dz,split_cell:ko,decode_cell:bh,decode_range:cW,format_cell:iu,get_formulae:fF,make_csv:s,make_json:i7,make_formulae:fF,sheet_to_csv:s,sheet_to_json:i7,sheet_to_formulae:fF,sheet_to_row_object_array:jV};cT.parse_xlscfb=dX;cT.read=aI;cT.readFile=ke;cT.utils=fw;cT.CFB=f4;cT.SSF=cN})(typeof exports!=="undefined"?exports:XLS);var XLSX={};(function(a1){a1.version="0.7.11";var bO=1252,c5;if(typeof module!=="undefined"&&typeof require!=="undefined"){if(typeof cptable==="undefined"){cptable=require("./dist/cpexcel")}c5=cptable[bO]}function cS(){aF(1252)}var aF=function(er){bO=er};function dO(et){var eu=[];for(var es=0,er=et.length;es<er;++es){eu[es]=et.charCodeAt(es)}return eu}var bq=function(er){return er};if(typeof cptable!=="undefined"){aF=function(er){bO=er;c5=cptable[er]};bq=function(er){if(er.charCodeAt(0)===255&&er.charCodeAt(1)===254){return cptable.utils.decode(1200,dO(er.substr(2)))}return er}}var ch={};var cn=function cn(eP){eP.version="0.8.1";function eG(e3){var e5="",e4=e3.length-1;while(e4>=0){e5+=e3.charAt(e4--)}return e5}function eI(e5,e3){var e4="";while(e4.length<e3){e4+=e5}return e4}function eQ(e3,e5){var e4=""+e3;return e4.length>=e5?e4:eI("0",e5-e4.length)+e4}function eA(e3,e5){var e4=""+e3;return e4.length>=e5?e4:eI(" ",e5-e4.length)+e4}function eZ(e3,e5){var e4=""+e3;return e4.length>=e5?e4:e4+eI(" ",e5-e4.length)}function ev(e3,e5){var e4=""+Math.round(e3);return e4.length>=e5?e4:eI("0",e5-e4.length)+e4}function et(e3,e5){var e4=""+e3;return e4.length>=e5?e4:eI("0",e5-e4.length)+e4}var eS=Math.pow(2,32);function eT(e3,e5){if(e3>eS||e3<-eS){return ev(e3,e5)}var e4=Math.round(e3);return et(e4,e5)}function eK(e4,e3){return e4.length>=7+e3&&(e4.charCodeAt(e3)|32)===103&&(e4.charCodeAt(e3+1)|32)===101&&(e4.charCodeAt(e3+2)|32)===110&&(e4.charCodeAt(e3+3)|32)===101&&(e4.charCodeAt(e3+4)|32)===114&&(e4.charCodeAt(e3+5)|32)===97&&(e4.charCodeAt(e3+6)|32)===108}var eU=[["date1904",0],["output",""],["WTF",false]];function eD(e3){for(var e4=0;e4!=eU.length;++e4){if(e3[eU[e4][0]]===undefined){e3[eU[e4][0]]=eU[e4][1]}}}eP.opts=eU;var eV={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "',65535:"General"};var eC=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]];var eJ=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function e2(ff,e3,fe){var fa=ff<0?-1:1;var e5=ff*fa;var e7=0,e8=1,fd=0;var e9=1,fb=0,fc=0;var e6=Math.floor(e5);while(fb<e3){e6=Math.floor(e5);fd=e6*e8+e7;fc=e6*fb+e9;if((e5-e6)<5e-10){break}e5=1/(e5-e6);e7=e8;e8=fd;e9=fb;fb=fc}if(fc>e3){fc=fb;fd=e8}if(fc>e3){fc=e9;fd=e7}if(!fe){return[0,fa*fd,fc]}if(fc===0){throw"Unexpected state: "+fd+" "+e8+" "+e7+" "+fc+" "+fb+" "+e9}var e4=Math.floor(fa*fd/fc);return[e4,fa*fd-e4*fc,fc]}function ex(e3,e4){return""+e3}eP._general_int=ex;var eH=(function eX(){var e7=/\.(\d*[1-9])0+$/,e6=/\.0*$/,e5=/\.(\d*[1-9])0+/,e4=/\.0*[Ee]/,e3=/(E[+-])(\d)$/;function fc(fe){var fd=(fe<0?12:11);var ff=e8(fe.toFixed(12));if(ff.length<=fd){return ff}ff=fe.toPrecision(10);if(ff.length<=fd){return ff}return fe.toExponential(5)}function fa(fd){var fe=fd.toFixed(11).replace(e7,".$1");if(fe.length>(fd<0?12:11)){fe=fd.toPrecision(6)}return fe}function e9(fe){for(var fd=0;fd!=fe.length;++fd){if((fe.charCodeAt(fd)|32)===101){return fe.replace(e5,".$1").replace(e4,"E").replace("e","E").replace(e3,"$10$2")}}return fe}function e8(fd){return fd.indexOf(".")>-1?fd.replace(e6,"").replace(e7,".$1"):fd}return function fb(fe,ff){var fd=Math.floor(Math.log(Math.abs(fe))*Math.LOG10E),fg;if(fd>=-4&&fd<=-1){fg=fe.toPrecision(10+fd)}else{if(Math.abs(fd)<=9){fg=fc(fe)}else{if(fd===10){fg=fe.toFixed(10).substr(0,12)}else{fg=fa(fe)}}}return e8(e9(fg))}})();eP._general_num=eH;function e0(e3,e4){switch(typeof e3){case"string":return e3;case"boolean":return e3?"TRUE":"FALSE";case"number":return(e3|0)===e3?ex(e3,e4):eH(e3,e4)}throw new Error("unsupported value in General format: "+e3)}eP._general=e0;function ey(e3,e4){return 0}function eR(fa,e3,e9){if(fa>2958465||fa<0){return null}var e5=(fa|0),e4=Math.floor(86400*(fa-e5)),fb=0;var e6=[];var e7={D:e5,T:e4,u:86400*(fa-e5)-e4,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(e7.u)<0.000001){e7.u=0}eD(e3!=null?e3:(e3=[]));if(e3.date1904){e5+=1462}if(e7.u>0.999){e7.u=0;if(++e4==86400){e4=0;++e5}}if(e5===60){e6=e9?[1317,10,29]:[1900,2,29];fb=3}else{if(e5===0){e6=e9?[1317,8,29]:[1900,1,0];fb=6}else{if(e5>60){--e5}var e8=new Date(1900,0,1);e8.setDate(e8.getDate()+e5-1);e6=[e8.getFullYear(),e8.getMonth()+1,e8.getDate()];fb=e8.getDay();if(e5<60){fb=(fb+6)%7}if(e9){fb=ey(e8,e6)}}}e7.y=e6[0];e7.m=e6[1];e7.d=e6[2];e7.S=e4%60;e4=Math.floor(e4/60);e7.M=e4%60;e4=Math.floor(e4/60);e7.H=e4;e7.q=fb;return e7}eP.parse_date_code=eR;function eW(e9,e5,e4,fb){var e3="",fc=0,e8=0,fa=e4.y,e6,e7=0;switch(e9){case 98:fa=e4.y+543;case 121:switch(e5.length){case 1:case 2:e6=fa%100;e7=2;break;default:e6=fa%10000;e7=4;break}break;case 109:switch(e5.length){case 1:case 2:e6=e4.m;e7=e5.length;break;case 3:return eJ[e4.m-1][1];case 5:return eJ[e4.m-1][0];default:return eJ[e4.m-1][2]}break;case 100:switch(e5.length){case 1:case 2:e6=e4.d;e7=e5.length;break;case 3:return eC[e4.q][0];default:return eC[e4.q][1]}break;case 104:switch(e5.length){case 1:case 2:e6=1+(e4.H+11)%12;e7=e5.length;break;default:throw"bad hour format: "+e5}break;case 72:switch(e5.length){case 1:case 2:e6=e4.H;e7=e5.length;break;default:throw"bad hour format: "+e5}break;case 77:switch(e5.length){case 1:case 2:e6=e4.M;e7=e5.length;break;default:throw"bad minute format: "+e5}break;case 115:if(e4.u===0){switch(e5){case"s":case"ss":return eQ(e4.S,e5.length);case".0":case".00":case".000":}}switch(e5){case"s":case"ss":case".0":case".00":case".000":if(fb>=2){e8=fb===3?1000:100}else{e8=fb===1?10:1}fc=Math.round((e8)*(e4.S+e4.u));if(fc>=60*e8){fc=0}if(e5==="s"){return fc===0?"0":""+fc/e8}e3=eQ(fc,2+fb);if(e5==="ss"){return e3.substr(0,2)}return"."+e3.substr(2,e5.length-1);default:throw"bad second format: "+e5}case 90:switch(e5){case"[h]":case"[hh]":e6=e4.D*24+e4.H;break;case"[m]":case"[mm]":e6=(e4.D*24+e4.H)*60+e4.M;break;case"[s]":case"[ss]":e6=((e4.D*24+e4.H)*60+e4.M)*60+Math.round(e4.S+e4.u);break;default:throw"bad abstime format: "+e5}e7=e5.length===3?1:2;break;case 101:e6=fa;e7=1}if(e7>0){return eQ(e6,e7)}else{return""}}function eN(e4){if(e4.length<=3){return e4}var e3=(e4.length%3),e5=e4.substr(0,e3);for(;e3!=e4.length;e3+=3){e5+=(e5.length>0?",":"")+e4.substr(e3,3)}return e5}var ew=(function eu(){var fk=/%/g;function e6(fo,fn,fr){var fq=fn.replace(fk,""),fp=fn.length-fq.length;return fm(fo,fq,fr*Math.pow(10,2*fp))+eI("%",fp)}function e5(fp,fo,fq){var fn=fo.length-1;while(fo.charCodeAt(fn-1)===44){--fn}return fm(fp,fo.substr(0,fn),fq/Math.pow(10,3*(fo.length-fn)))}function fa(fp,ft){var fs;var fn=fp.indexOf("E")-fp.indexOf(".")-1;if(fp.match(/^#+0.0E\+0$/)){var fr=fp.indexOf(".");if(fr===-1){fr=fp.indexOf("E")}var fo=Math.floor(Math.log(Math.abs(ft))*Math.LOG10E)%fr;if(fo<0){fo+=fr}fs=(ft/Math.pow(10,fo)).toPrecision(fn+1+(fr+fo)%fr);if(fs.indexOf("e")===-1){var fq=Math.floor(Math.log(Math.abs(ft))*Math.LOG10E);if(fs.indexOf(".")===-1){fs=fs[0]+"."+fs.substr(1)+"E+"+(fq-fs.length+fo)}else{fs+="E+"+(fq-fo)}while(fs.substr(0,2)==="0."){fs=fs[0]+fs.substr(2,fr)+"."+fs.substr(2+fr);fs=fs.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.")}fs=fs.replace(/\+-/,"-")}fs=fs.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(fv,fu,fx,fw){return fu+fx+fw.substr(0,(fr+fo)%fr)+"."+fw.substr(fo)+"E"})}else{fs=ft.toExponential(fn)}if(fp.match(/E\+00$/)&&fs.match(/e[+-]\d$/)){fs=fs.substr(0,fs.length-1)+"0"+fs[fs.length-1]}if(fp.match(/E\-/)&&fs.match(/e\+/)){fs=fs.replace(/e\+/,"e")}return fs.replace("e","E")}var e7=/# (\?+)( ?)\/( ?)(\d+)/;function fd(fs,fr,fn){var fu=parseInt(fs[4]),fq=Math.round(fr*fu),ft=Math.floor(fq/fu);var fp=(fq-ft*fu),fo=fu;return fn+(ft===0?"":""+ft)+" "+(fp===0?eI(" ",fs[1].length+1+fs[4].length):eA(fp,fs[1].length)+fs[2]+"/"+fs[3]+eQ(fo,fs[4].length))}function fb(fp,fo,fn){return fn+(fo===0?"":""+fo)+eI(" ",fp[1].length+2+fp[4].length)}var fe=/^#*0*\.(0+)/;var fl=/\).*[0#]/;var e9=/\(###\) ###\\?-####/;function e8(fp){var fo="",fq;for(var fn=0;fn!=fp.length;++fn){switch((fq=fp.charCodeAt(fn))){case 35:break;case 63:fo+=" ";break;case 48:fo+="0";break;default:fo+=String.fromCharCode(fq)}}return fo}function fc(fp,fo){var fn=Math.pow(10,fo);return""+(Math.round(fp*fn)/fn)}function fg(fo,fn){return Math.round((fo-Math.floor(fo))*Math.pow(10,fn))}function fi(fn){if(fn<2147483647&&fn>-2147483648){return""+(fn>=0?(fn|0):(fn-1|0))}return""+Math.floor(fn)}function fh(fx,ft,fs){if(fx.charCodeAt(0)===40&&!ft.match(fl)){var fw=ft.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");if(fs>=0){return fh("n",fw,fs)}return"("+fh("n",fw,-fs)+")"}if(ft.charCodeAt(ft.length-1)===44){return e5(fx,ft,fs)}if(ft.indexOf("%")!==-1){return e6(fx,ft,fs)}if(ft.indexOf("E")!==-1){return fa(ft,fs)}if(ft.charCodeAt(0)===36){return"$"+fh(fx,ft.substr(ft[1]==" "?2:1),fs)}var fq,fv;var fn,fz,fo,fB=Math.abs(fs),fr=fs<0?"-":"";if(ft.match(/^00+$/)){return fr+eT(fB,ft.length)}if(ft.match(/^[#?]+$/)){fq=eT(fs,0);if(fq==="0"){fq=""}return fq.length>ft.length?fq:e8(ft.substr(0,ft.length-fq.length))+fq}if((fn=ft.match(e7))!==null){return fd(fn,fB,fr)}if(ft.match(/^#+0+$/)!==null){return fr+eT(fB,ft.length-ft.indexOf("0"))}if((fn=ft.match(fe))!==null){fq=fc(fs,fn[1].length).replace(/^([^\.]+)$/,"$1."+fn[1]).replace(/\.$/,"."+fn[1]).replace(/\.(\d*)$/,function(fD,fC){return"."+fC+eI("0",fn[1].length-fC.length)});return ft.indexOf("0.")!==-1?fq:fq.replace(/^0\./,".")}ft=ft.replace(/^#+([0.])/,"$1");if((fn=ft.match(/^(0*)\.(#*)$/))!==null){return fr+fc(fB,fn[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,fn[1].length?"0.":".")}if((fn=ft.match(/^#,##0(\.?)$/))!==null){return fr+eN(eT(fB,0))}if((fn=ft.match(/^#,##0\.([#0]*0)$/))!==null){return fs<0?"-"+fh(fx,ft,-fs):eN(""+(Math.floor(fs)))+"."+eQ(fg(fs,fn[1].length),fn[1].length)}if((fn=ft.match(/^#,#*,#0/))!==null){return fh(fx,ft.replace(/^#,#*,/,""),fs)}if((fn=ft.match(/^([0#]+)(\\?-([0#]+))+$/))!==null){fq=eG(fh(fx,ft.replace(/[\\-]/g,""),fs));fz=0;return eG(eG(ft.replace(/\\/g,"")).replace(/[0#]/g,function(fC){return fz<fq.length?fq[fz++]:fC==="0"?"0":""}))}if(ft.match(e9)!==null){fq=fh(fx,"##########",fs);return"("+fq.substr(0,3)+") "+fq.substr(3,3)+"-"+fq.substr(6)}var fp="";if((fn=ft.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))!==null){fz=Math.min(fn[4].length,7);fo=e2(fB,Math.pow(10,fz)-1,false);fq=""+fr;fp=fm("n",fn[1],fo[1]);if(fp[fp.length-1]==" "){fp=fp.substr(0,fp.length-1)+"0"}fq+=fp+fn[2]+"/"+fn[3];fp=eZ(fo[2],fz);if(fp.length<fn[4].length){fp=e8(fn[4].substr(fn[4].length-fp.length))+fp}fq+=fp;return fq}if((fn=ft.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))!==null){fz=Math.min(Math.max(fn[1].length,fn[4].length),7);fo=e2(fB,Math.pow(10,fz)-1,true);return fr+(fo[0]||(fo[1]?"":"0"))+" "+(fo[1]?eA(fo[1],fz)+fn[2]+"/"+fn[3]+eZ(fo[2],fz):eI(" ",2*fz+1+fn[2].length+fn[3].length))}if((fn=ft.match(/^[#0?]+$/))!==null){fq=eT(fs,0);if(ft.length<=fq.length){return fq}return e8(ft.substr(0,ft.length-fq.length))+fq}if((fn=ft.match(/^([#0?]+)\.([#0]+)$/))!==null){fq=""+fs.toFixed(Math.min(fn[2].length,10)).replace(/([^0])0+$/,"$1");fz=fq.indexOf(".");var fu=ft.indexOf(".")-fz,fA=ft.length-fq.length-fu;return e8(ft.substr(0,fu)+fq+ft.substr(ft.length-fA))}if((fn=ft.match(/^00,000\.([#0]*0)$/))!==null){fz=fg(fs,fn[1].length);return fs<0?"-"+fh(fx,ft,-fs):eN(fi(fs)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(fC){return"00,"+(fC.length<3?eQ(0,3-fC.length):"")+fC})+"."+eQ(fz,fn[1].length)}switch(ft){case"#,###":var fy=eN(eT(fB,0));return fy!=="0"?fr+fy:"";default:}throw new Error("unsupported format |"+ft+"|")}function fj(fp,fo,fq){var fn=fo.length-1;while(fo.charCodeAt(fn-1)===44){--fn}return fm(fp,fo.substr(0,fn),fq/Math.pow(10,3*(fo.length-fn)))}function ff(fo,fn,fr){var fq=fn.replace(fk,""),fp=fn.length-fq.length;return fm(fo,fq,fr*Math.pow(10,2*fp))+eI("%",fp)}function e4(fp,ft){var fs;var fn=fp.indexOf("E")-fp.indexOf(".")-1;if(fp.match(/^#+0.0E\+0$/)){var fr=fp.indexOf(".");if(fr===-1){fr=fp.indexOf("E")}var fo=Math.floor(Math.log(Math.abs(ft))*Math.LOG10E)%fr;if(fo<0){fo+=fr}fs=(ft/Math.pow(10,fo)).toPrecision(fn+1+(fr+fo)%fr);if(!fs.match(/[Ee]/)){var fq=Math.floor(Math.log(Math.abs(ft))*Math.LOG10E);if(fs.indexOf(".")===-1){fs=fs[0]+"."+fs.substr(1)+"E+"+(fq-fs.length+fo)}else{fs+="E+"+(fq-fo)}fs=fs.replace(/\+-/,"-")}fs=fs.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(fv,fu,fx,fw){return fu+fx+fw.substr(0,(fr+fo)%fr)+"."+fw.substr(fo)+"E"})}else{fs=ft.toExponential(fn)}if(fp.match(/E\+00$/)&&fs.match(/e[+-]\d$/)){fs=fs.substr(0,fs.length-1)+"0"+fs[fs.length-1]}if(fp.match(/E\-/)&&fs.match(/e\+/)){fs=fs.replace(/e\+/,"e")}return fs.replace("e","E")}function e3(fw,ft,fs){if(fw.charCodeAt(0)===40&&!ft.match(fl)){var fv=ft.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");if(fs>=0){return e3("n",fv,fs)}return"("+e3("n",fv,-fs)+")"}if(ft.charCodeAt(ft.length-1)===44){return fj(fw,ft,fs)}if(ft.indexOf("%")!==-1){return ff(fw,ft,fs)}if(ft.indexOf("E")!==-1){return e4(ft,fs)}if(ft.charCodeAt(0)===36){return"$"+e3(fw,ft.substr(ft[1]==" "?2:1),fs)}var fq;var fn,fy,fo,fA=Math.abs(fs),fr=fs<0?"-":"";if(ft.match(/^00+$/)){return fr+eQ(fA,ft.length)}if(ft.match(/^[#?]+$/)){fq=(""+fs);if(fs===0){fq=""}return fq.length>ft.length?fq:e8(ft.substr(0,ft.length-fq.length))+fq}if((fn=ft.match(e7))!==null){return fb(fn,fA,fr)}if(ft.match(/^#+0+$/)!==null){return fr+eQ(fA,ft.length-ft.indexOf("0"))}if((fn=ft.match(fe))!==null){fq=(""+fs).replace(/^([^\.]+)$/,"$1."+fn[1]).replace(/\.$/,"."+fn[1]).replace(/\.(\d*)$/,function(fC,fB){return"."+fB+eI("0",fn[1].length-fB.length)});return ft.indexOf("0.")!==-1?fq:fq.replace(/^0\./,".")}ft=ft.replace(/^#+([0.])/,"$1");if((fn=ft.match(/^(0*)\.(#*)$/))!==null){return fr+(""+fA).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,fn[1].length?"0.":".")}if((fn=ft.match(/^#,##0(\.?)$/))!==null){return fr+eN((""+fA))}if((fn=ft.match(/^#,##0\.([#0]*0)$/))!==null){return fs<0?"-"+e3(fw,ft,-fs):eN((""+fs))+"."+eI("0",fn[1].length)}if((fn=ft.match(/^#,#*,#0/))!==null){return e3(fw,ft.replace(/^#,#*,/,""),fs)}if((fn=ft.match(/^([0#]+)(\\?-([0#]+))+$/))!==null){fq=eG(e3(fw,ft.replace(/[\\-]/g,""),fs));fy=0;return eG(eG(ft.replace(/\\/g,"")).replace(/[0#]/g,function(fB){return fy<fq.length?fq[fy++]:fB==="0"?"0":""}))}if(ft.match(e9)!==null){fq=e3(fw,"##########",fs);return"("+fq.substr(0,3)+") "+fq.substr(3,3)+"-"+fq.substr(6)}var fp="";if((fn=ft.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))!==null){fy=Math.min(fn[4].length,7);fo=e2(fA,Math.pow(10,fy)-1,false);fq=""+fr;fp=fm("n",fn[1],fo[1]);if(fp[fp.length-1]==" "){fp=fp.substr(0,fp.length-1)+"0"}fq+=fp+fn[2]+"/"+fn[3];fp=eZ(fo[2],fy);if(fp.length<fn[4].length){fp=e8(fn[4].substr(fn[4].length-fp.length))+fp}fq+=fp;return fq}if((fn=ft.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))!==null){fy=Math.min(Math.max(fn[1].length,fn[4].length),7);fo=e2(fA,Math.pow(10,fy)-1,true);return fr+(fo[0]||(fo[1]?"":"0"))+" "+(fo[1]?eA(fo[1],fy)+fn[2]+"/"+fn[3]+eZ(fo[2],fy):eI(" ",2*fy+1+fn[2].length+fn[3].length))}if((fn=ft.match(/^[#0?]+$/))!==null){fq=""+fs;if(ft.length<=fq.length){return fq}return e8(ft.substr(0,ft.length-fq.length))+fq}if((fn=ft.match(/^([#0]+)\.([#0]+)$/))!==null){fq=""+fs.toFixed(Math.min(fn[2].length,10)).replace(/([^0])0+$/,"$1");fy=fq.indexOf(".");var fu=ft.indexOf(".")-fy,fz=ft.length-fq.length-fu;return e8(ft.substr(0,fu)+fq+ft.substr(ft.length-fz))}if((fn=ft.match(/^00,000\.([#0]*0)$/))!==null){return fs<0?"-"+e3(fw,ft,-fs):eN(""+fs).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(fB){return"00,"+(fB.length<3?eQ(0,3-fB.length):"")+fB})+"."+eQ(0,fn[1].length)}switch(ft){case"#,###":var fx=eN(""+fA);return fx!=="0"?fr+fx:"";default:}throw new Error("unsupported format |"+ft+"|")}return function fm(fo,fn,fp){return(fp|0)===fp?e3(fo,fn,fp):fh(fo,fn,fp)}})();function eY(e3){var e5=[];var e7=false,e8;for(var e6=0,e4=0;e6<e3.length;++e6){switch((e8=e3.charCodeAt(e6))){case 34:e7=!e7;break;case 95:case 42:case 92:++e6;break;case 59:e5[e5.length]=e3.substr(e4,e6-e4);e4=e6+1}}e5[e5.length]=e3.substr(e4);if(e7===true){throw new Error("Format |"+e3+"| unterminated string ")}return e5}eP._split=eY;var eE=/\[[HhMmSs]*\]/;function ez(e4,fa,fc,fs){var fm=[],fh="",fl=0,fp="",e7="t",fg,fd,fk,ff;var ft="H";while(fl<e4.length){switch((fp=e4[fl])){case"G":if(!eK(e4,fl)){throw new Error("unrecognized character "+fp+" in "+e4)}fm[fm.length]={t:"G",v:"General"};fl+=7;break;case'"':for(fh="";(ff=e4.charCodeAt(++fl))!==34&&fl<e4.length;){fh+=String.fromCharCode(ff)}fm[fm.length]={t:"t",v:fh};++fl;break;case"\\":var e9=e4[++fl],fb=(e9==="("||e9===")")?e9:"t";fm[fm.length]={t:fb,v:e9};++fl;break;case"_":fm[fm.length]={t:"t",v:" "};fl+=2;break;case"@":fm[fm.length]={t:"T",v:fa};++fl;break;case"B":case"b":if(e4[fl+1]==="1"||e4[fl+1]==="2"){if(fd==null){fd=eR(fa,fc,e4[fl+1]==="2");if(fd==null){return""}}fm[fm.length]={t:"X",v:e4.substr(fl,2)};e7=fp;fl+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":fp=fp.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(fa<0){return""}if(fd==null){fd=eR(fa,fc);if(fd==null){return""}}fh=fp;while(++fl<e4.length&&e4[fl].toLowerCase()===fp){fh+=fp}if(fp==="m"&&e7.toLowerCase()==="h"){fp="M"}if(fp==="h"){fp=ft}fm[fm.length]={t:fp,v:fh};e7=fp;break;case"A":fg={t:fp,v:"A"};if(fd==null){fd=eR(fa,fc)}if(e4.substr(fl,3)==="A/P"){if(fd!=null){fg.v=fd.H>=12?"P":"A"}fg.t="T";ft="h";fl+=3}else{if(e4.substr(fl,5)==="AM/PM"){if(fd!=null){fg.v=fd.H>=12?"PM":"AM"}fg.t="T";fl+=5;ft="h"}else{fg.t="t";++fl}}if(fd==null&&fg.t==="T"){return""}fm[fm.length]=fg;e7=fp;break;case"[":fh=fp;while(e4[fl++]!=="]"&&fl<e4.length){fh+=e4[fl]}if(fh.substr(-1)!=="]"){throw'unterminated "[" block: |'+fh+"|"}if(fh.match(eE)){if(fd==null){fd=eR(fa,fc);if(fd==null){return""}}fm[fm.length]={t:"Z",v:fh.toLowerCase()}}else{fh=""}break;case".":if(fd!=null){fh=fp;while((fp=e4[++fl])==="0"){fh+=fp}fm[fm.length]={t:"s",v:fh};break}case"0":case"#":fh=fp;while("0#?.,E+-%".indexOf(fp=e4[++fl])>-1||fp=="\\"&&e4[fl+1]=="-"&&"0#".indexOf(e4[fl+2])>-1){fh+=fp}fm[fm.length]={t:"n",v:fh};break;case"?":fh=fp;while(e4[++fl]===fp){fh+=fp}fg={t:fp,v:fh};fm[fm.length]=fg;e7=fp;break;case"*":++fl;if(e4[fl]==" "||e4[fl]=="*"){++fl}break;case"(":case")":fm[fm.length]={t:(fs===1?"t":fp),v:fp};++fl;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":fh=fp;while("0123456789".indexOf(e4[++fl])>-1){fh+=e4[fl]}fm[fm.length]={t:"D",v:fh};break;case" ":fm[fm.length]={t:fp,v:fp};++fl;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxz".indexOf(fp)===-1){throw new Error("unrecognized character "+fp+" in "+e4)}fm[fm.length]={t:"t",v:fp};++fl;break}}var fo=0,fj=0,e8;for(fl=fm.length-1,e7="t";fl>=0;--fl){switch(fm[fl].t){case"h":case"H":fm[fl].t=ft;e7="h";if(fo<1){fo=1}break;case"s":if((e8=fm[fl].v.match(/\.0+$/))){fj=Math.max(fj,e8[0].length-1)}if(fo<3){fo=3}case"d":case"y":case"M":case"e":e7=fm[fl].t;break;case"m":if(e7==="s"){fm[fl].t="M";if(fo<2){fo=2}}break;case"X":if(fm[fl].v==="B2"){}break;case"Z":if(fo<1&&fm[fl].v.match(/[Hh]/)){fo=1}if(fo<2&&fm[fl].v.match(/[Mm]/)){fo=2}if(fo<3&&fm[fl].v.match(/[Ss]/)){fo=3}}}switch(fo){case 0:break;case 1:if(fd.u>=0.5){fd.u=0;++fd.S}if(fd.S>=60){fd.S=0;++fd.M}if(fd.M>=60){fd.M=0;++fd.H}break;case 2:if(fd.u>=0.5){fd.u=0;++fd.S}if(fd.S>=60){fd.S=0;++fd.M}break}var e3="",fn;for(fl=0;fl<fm.length;++fl){switch(fm[fl].t){case"t":case"T":case" ":case"D":break;case"X":fm[fl]=undefined;break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":fm[fl].v=eW(fm[fl].t.charCodeAt(0),fm[fl].v,fd,fj);fm[fl].t="t";break;case"n":case"(":case"?":fn=fl+1;while(fm[fn]!=null&&((fp=fm[fn].t)==="?"||fp==="D"||(fp===" "||fp==="t")&&fm[fn+1]!=null&&(fm[fn+1].t==="?"||fm[fn+1].t==="t"&&fm[fn+1].v==="/")||fm[fl].t==="("&&(fp===" "||fp==="n"||fp===")")||fp==="t"&&(fm[fn].v==="/"||"$".indexOf(fm[fn].v)>-1||fm[fn].v===" "&&fm[fn+1]!=null&&fm[fn+1].t=="?"))){fm[fl].v+=fm[fn].v;fm[fn]=undefined;++fn}e3+=fm[fl].v;fl=fn-1;break;case"G":fm[fl].t="t";fm[fl].v=e0(fa,fc);break}}var fi="",fr,e6;if(e3.length>0){fr=(fa<0&&e3.charCodeAt(0)===45?-fa:fa);e6=ew(e3.charCodeAt(0)===40?"(":"n",e3,fr);fn=e6.length-1;var e5=fm.length;for(fl=0;fl<fm.length;++fl){if(fm[fl]!=null&&fm[fl].v.indexOf(".")>-1){e5=fl;break}}var fq=fm.length;if(e5===fm.length&&e6.indexOf("E")===-1){for(fl=fm.length-1;fl>=0;--fl){if(fm[fl]==null||"n?(".indexOf(fm[fl].t)===-1){continue}if(fn>=fm[fl].v.length-1){fn-=fm[fl].v.length;fm[fl].v=e6.substr(fn+1,fm[fl].v.length)}else{if(fn<0){fm[fl].v=""}else{fm[fl].v=e6.substr(0,fn+1);fn=-1}}fm[fl].t="t";fq=fl}if(fn>=0&&fq<fm.length){fm[fq].v=e6.substr(0,fn+1)+fm[fq].v}}else{if(e5!==fm.length&&e6.indexOf("E")===-1){fn=e6.indexOf(".")-1;for(fl=e5;fl>=0;--fl){if(fm[fl]==null||"n?(".indexOf(fm[fl].t)===-1){continue}fk=fm[fl].v.indexOf(".")>-1&&fl===e5?fm[fl].v.indexOf(".")-1:fm[fl].v.length-1;fi=fm[fl].v.substr(fk+1);for(;fk>=0;--fk){if(fn>=0&&(fm[fl].v[fk]==="0"||fm[fl].v[fk]==="#")){fi=e6[fn--]+fi}}fm[fl].v=fi;fm[fl].t="t";fq=fl}if(fn>=0&&fq<fm.length){fm[fq].v=e6.substr(0,fn+1)+fm[fq].v}fn=e6.indexOf(".")+1;for(fl=e5;fl<fm.length;++fl){if(fm[fl]==null||"n?(".indexOf(fm[fl].t)===-1&&fl!==e5){continue}fk=fm[fl].v.indexOf(".")>-1&&fl===e5?fm[fl].v.indexOf(".")+1:0;fi=fm[fl].v.substr(0,fk);for(;fk<fm[fl].v.length;++fk){if(fn<e6.length){fi+=e6[fn++]}}fm[fl].v=fi;fm[fl].t="t";fq=fl}}}}for(fl=0;fl<fm.length;++fl){if(fm[fl]!=null&&"n(?".indexOf(fm[fl].t)>-1){fr=(fs>1&&fa<0&&fl>0&&fm[fl-1].v==="-"?-fa:fa);fm[fl].v=ew(fm[fl].t,fm[fl].v,fr);fm[fl].t="t"}}var fe="";for(fl=0;fl!==fm.length;++fl){if(fm[fl]!=null){fe+=fm[fl].v}}return fe}eP._eval=ez;var er=/\[[=<>]/;var eB=/\[([=<>]*)(-?\d+\.?\d*)\]/;function eL(e3,e4){if(e4==null){return false}var e5=parseFloat(e4[2]);switch(e4[1]){case"=":if(e3==e5){return true}break;case">":if(e3>e5){return true}break;case"<":if(e3<e5){return true}break;case"<>":if(e3!=e5){return true}break;case">=":if(e3>=e5){return true}break;case"<=":if(e3<=e5){return true}break}return false}function e1(e9,e7){var e4=eY(e9);var e3=e4.length,fa=e4[e3-1].indexOf("@");if(e3<4&&fa>-1){--e3}if(e4.length>4){throw"cannot find right format for |"+e4+"|"}if(typeof e7!=="number"){return[4,e4.length===4||fa>-1?e4[e4.length-1]:"@"]}switch(e4.length){case 1:e4=fa>-1?["General","General","General",e4[0]]:[e4[0],e4[0],e4[0],"@"];break;case 2:e4=fa>-1?[e4[0],e4[0],e4[0],e4[1]]:[e4[0],e4[1],e4[0],"@"];break;case 3:e4=fa>-1?[e4[0],e4[1],e4[0],e4[2]]:[e4[0],e4[1],e4[2],"@"];break;case 4:break}var e6=e7>0?e4[0]:e7<0?e4[1]:e4[2];if(e4[0].indexOf("[")===-1&&e4[1].indexOf("[")===-1){return[e3,e6]}if(e4[0].match(er)!=null||e4[1].match(er)!=null){var e8=e4[0].match(eB);var e5=e4[1].match(eB);return eL(e7,e8)?[e3,e4[0]]:eL(e7,e5)?[e3,e4[1]]:[e3,e4[e8!=null&&e5!=null?2:1]]}return[e3,e6]}function eO(e3,e4,e7){eD(e7!=null?e7:(e7=[]));var e6="";switch(typeof e3){case"string":e6=e3;break;case"number":e6=(e7.table!=null?e7.table:eV)[e3];break}if(eK(e6,0)){return e0(e4,e7)}var e5=e1(e6,e4);if(eK(e5[1])){return e0(e4,e7)}if(e4===true){e4="TRUE"}else{if(e4===false){e4="FALSE"}else{if(e4===""||e4==null){return""}}}return ez(e5[1],e4,e7,e5[0])}eP._table=eV;eP.load=function eF(e4,e3){eV[e3]=e4};eP.format=eO;eP.get_table=function eM(){return eV};eP.load_table=function es(e4){for(var e3=0;e3!=392;++e3){if(e4[e3]!==undefined){eP.load(e4[e3],e3)}}}};cn(ch);function U(er){return er!==undefined&&er!==null}function bI(er){return Object.keys(er)}function W(eu,et){var ev=[],er=bI(eu);for(var es=0;es!==er.length;++es){ev[eu[er[es]][et]]=er[es]}return ev}function bZ(et){var eu=[],er=bI(et);for(var es=0;es!==er.length;++es){eu[et[er[es]]]=er[es]}return eu}function df(et){var eu=[],er=bI(et);for(var es=0;es!==er.length;++es){eu[et[er[es]]]=parseInt(er[es],10)}return eu}function Z(et){var eu=[],er=bI(et);for(var es=0;es!==er.length;++es){if(eu[et[er[es]]]==null){eu[et[er[es]]]=[]}eu[et[er[es]]].push(er[es])}return eu}function dc(es,er){if(er){es+=1462}var et=Date.parse(es);return(et+2209161600000)/(24*60*60*1000)}function bD(er){var et="";for(var es=0;es!=er.length;++es){et+=String.fromCharCode(er[es])}return et}var dQ=(typeof Buffer!=="undefined");function bG(er){if(!er){return null}if(er.name.substr(-4)===".bin"){if(er.data){return dO(er.data)}if(er.asNodeBuffer&&dQ){return er.asNodeBuffer()}if(er._data&&er._data.getContent){return Array.prototype.slice.call(er._data.getContent())}}else{if(er.data){return er.name.substr(-4)!==".bin"?bq(er.data):dO(er.data)}if(er.asNodeBuffer&&dQ){return bq(er.asNodeBuffer().toString("binary"))}if(er.asBinary){return bq(er.asBinary())}if(er._data&&er._data.getContent){return bq(bD(Array.prototype.slice.call(er._data.getContent(),0)))}}return null}function dI(es,er){var et=er;if(es.files[et]){return es.files[et]}et=er.toLowerCase();if(es.files[et]){return es.files[et]}et=et.replace(/\//g,"\\");if(es.files[et]){return es.files[et]}return null}function d4(es,er){var et=dI(es,er);if(et==null){throw new Error("Cannot find file "+er+" in zip")}return et}function a4(es,er,et){if(!et){return bG(d4(es,er))}if(!er){return null}try{return a4(es,er)}catch(eu){return null}}var c1,c8;if(typeof JSZip!=="undefined"){c8=JSZip}if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){if(dQ&&typeof c8==="undefined"){c8=require("jszip")}if(typeof c8==="undefined"){c8=require("./jszip").JSZip}c1=require("fs")}}var cc=/\b[\w:]+=["'][^"]*['"]/g;var c9=/<[^>]*>/g;var ak=/<\w*:/,bP=/<(\/?)\w+:/;function aH(eC,es){var ey=[];var eB=0,ex=0;for(;eB!==eC.length;++eB){if((ex=eC.charCodeAt(eB))===32||ex===10||ex===13){break}}if(!es){ey[0]=eC.substr(0,eB)}if(eB===eC.length){return ey}var eu=eC.match(cc),ev=0,ez="",eA="",ew=0,er="",et="";if(eu){for(ew=0;ew!=eu.length;++ew){et=eu[ew];for(ex=0;ex!=et.length;++ex){if(et.charCodeAt(ex)===61){break}}er=et.substr(0,ex);eA=et.substring(ex+2,et.length-1);for(ev=0;ev!=er.length;++ev){if(er.charCodeAt(ev)===58){break}}if(ev===er.length){ey[er]=eA}else{ey[(ev===5&&er.substr(0,5)==="xmlns"?"xmlns":"")+er.substr(ev+1)]=eA}}}return ey}function ce(er){return er.replace(bP,"<$1")}var bb={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"};var cL=bZ(bb);var ai="&<>'\"".split("");var eq=/&[a-z]*;/g,L=/_x([\da-fA-F]+)_/g;function cj(es){var er=es+"";return er.replace(eq,function(et){return bb[et]}).replace(L,function(et,eu){return String.fromCharCode(parseInt(eu,16))})}var bo=/[&<>'"]/g,br=/[\u0000-\u0008\u000b-\u001f]/g;function cv(es){var er=es+"";return er.replace(bo,function(et){return cL[et]}).replace(br,function(et){return"_x"+("000"+et.charCodeAt(0).toString(16)).substr(-4)+"_"})}function dz(es,er){switch(es){case"1":case"true":case"TRUE":return true;default:return false}}var c3=function aS(ey){var es="",et=0,ex=0,ew=0,ev=0,eu=0,er=0;while(et<ey.length){ex=ey.charCodeAt(et++);if(ex<128){es+=String.fromCharCode(ex);continue}ew=ey.charCodeAt(et++);if(ex>191&&ex<224){es+=String.fromCharCode(((ex&31)<<6)|(ew&63));continue}ev=ey.charCodeAt(et++);if(ex<240){es+=String.fromCharCode(((ex&15)<<12)|((ew&63)<<6)|(ev&63));continue}eu=ey.charCodeAt(et++);er=(((ex&7)<<18)|((ew&63)<<12)|((ev&63)<<6)|(eu&63))-65536;es+=String.fromCharCode(55296+((er>>>10)&1023));es+=String.fromCharCode(56320+(er&1023))}return es};if(dQ){var aP=function aP(ew){var eu=new Buffer(2*ew.length),er,ev,et=1,es=0,ex=0,ey;for(ev=0;ev<ew.length;ev+=et){et=1;if((ey=ew.charCodeAt(ev))<128){er=ey}else{if(ey<224){er=(ey&31)*64+(ew.charCodeAt(ev+1)&63);et=2}else{if(ey<240){er=(ey&15)*4096+(ew.charCodeAt(ev+1)&63)*64+(ew.charCodeAt(ev+2)&63);et=3}else{et=4;er=(ey&7)*262144+(ew.charCodeAt(ev+1)&63)*4096+(ew.charCodeAt(ev+2)&63)*64+(ew.charCodeAt(ev+3)&63);er-=65536;ex=55296+((er>>>10)&1023);er=56320+(er&1023)}}}if(ex!==0){eu[es++]=ex&255;eu[es++]=ex>>>8;ex=0}eu[es++]=er%256;eu[es++]=er>>>8}eu.length=es;return eu.toString("ucs2")};var b0="foo bar baz";if(c3(b0)==aP(b0)){c3=aP}var aN=function aN(er){return Buffer(er,"binary").toString("utf8")};if(c3(b0)==aN(b0)){c3=aN}}var bj=(function(){var es={};return function er(ev,eu){var et=ev+"|"+eu;if(es[et]!==undefined){return es[et]}return(es[et]=new RegExp("<(?:\\w+:)?"+ev+'(?: xml:space="preserve")?(?:[^>]*)>([^]*)</(?:\\w+:)?'+ev+">",(eu||"")))}})();var cY=(function(){var er={};return function es(et){if(er[et]!==undefined){return er[et]}return(er[et]=new RegExp("<vt:"+et+">(.*?)</vt:"+et+">","g"))}})();var l=/<\/?vt:variant>/g,a3=/<vt:([^>]*)>(.*)</;function ba(eu){var es=aH(eu);var et=eu.match(cY(es.baseType))||[];if(et.length!=es.size){throw"unexpected vector length "+et.length+" != "+es.size}var er=[];et.forEach(function(ev){var ew=ev.replace(l,"").match(a3);er.push({v:ew[2],t:ew[1]})});return er}var aU=/(^\s|\s$|\n)/;function b3(es,er){return"<"+es+(er.match(aU)?' xml:space="preserve"':"")+">"+er+"</"+es+">"}function aK(er){return bI(er).map(function(es){return" "+es+'="'+er[es]+'"'}).join("")}function dp(et,es,er){return"<"+et+(U(er)?aK(er):"")+(U(es)?(es.match(aU)?' xml:space="preserve"':"")+">"+es+"</"+et:"/")+">"}function j(et,er){try{return et.toISOString().replace(/\.\d*/,"")}catch(es){if(er){throw es}}}function ea(er){switch(typeof er){case"string":return dp("vt:lpwstr",er);case"number":return dp((er|0)==er?"vt:i4":"vt:r8",String(er));case"boolean":return dp("vt:bool",er?"true":"false")}if(er instanceof Date){return dp("vt:filetime",j(er))}throw new Error("Unable to serialize "+er)}var cU='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n';var cV={dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"};cV.main=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function C(eu,eC,ev,er,ex){if(ev===undefined){ev=true}if(!er){er=8}if(!ex&&er===8){ex=52}var eA,ew,et=er*8-ex-1,ez=(1<<et)-1,es=ez>>1;var eD=-7,eB=ev?-1:1,ey=ev?(er-1):0,eE=eu[eC+ey];ey+=eB;eA=eE&((1<<(-eD))-1);eE>>>=(-eD);eD+=et;for(;eD>0;eA=eA*256+eu[eC+ey],ey+=eB,eD-=8){}ew=eA&((1<<(-eD))-1);eA>>>=(-eD);eD+=ex;for(;eD>0;ew=ew*256+eu[eC+ey],ey+=eB,eD-=8){}if(eA===ez){return ew?NaN:((eE?-1:1)*Infinity)}else{if(eA===0){eA=1-es}else{ew=ew+Math.pow(2,ex);eA=eA-es}}return(eE?-1:1)*ew*Math.pow(2,eA-ex)}var k,ct;k=ct=function bR(et){var er=[];for(var es=0;es<et[0].length;++es){er.push.apply(er,et[0][es])}return er};var d,cf;d=cf=function(es,er){return C(es,er)};var dY=function dn(er){return Array.isArray(er)};if(dQ){k=function(er){return(er[0].length>0&&Buffer.isBuffer(er[0][0]))?Buffer.concat(er[0]):ct(er)};d=function bn(er,es){if(Buffer.isBuffer(er)){return er.readDoubleLE(es)}return cf(er,es)};dY=function dm(er){return Buffer.isBuffer(er)||Array.isArray(er)}}var bl=function(es,er){return es[er]};var ap=function(es,er){return es[er+1]*(1<<8)+es[er]};var s=function(es,er){var et=es[er+1]*(1<<8)+es[er];return(et<32768)?et:(65535-et+1)*-1};var b8=function(es,er){return es[er+3]*(1<<24)+(es[er+2]<<16)+(es[er+1]<<8)+es[er]};var bt=function(es,er){return(es[er+3]<<24)|(es[er+2]<<16)|(es[er+1]<<8)|es[er]};function ag(ev,eu){var ey="",er=[],es,ew,et,ex;if(eu==="dbcs"){ex=this.l;if(dQ&&Buffer.isBuffer(this)){ey=this.slice(this.l,this.l+2*ev).toString("utf16le")}else{for(et=0;et!=ev;++et){ey+=String.fromCharCode(ap(this,ex));ex+=2}}ev*=2}else{switch(ev){case 1:ey=bl(this,this.l);break;case 2:ey=(eu==="i"?s:ap)(this,this.l);break;case 4:ey=b8(this,this.l);break;case 8:if(eu==="f"){ey=d(this,this.l);break}}}this.l+=ev;return ey}function dq(et,ev,eu){var es,er;if(eu==="dbcs"){for(er=0;er!=ev.length;++er){this.writeUInt16LE(ev.charCodeAt(er),this.l+2*er)}es=2*ev.length}else{switch(et){case 1:es=1;this[this.l]=ev&255;break;case 3:es=3;this[this.l+2]=ev&255;ev>>>=8;this[this.l+1]=ev&255;ev>>>=8;this[this.l]=ev&255;break;case 4:es=4;this.writeUInt32LE(ev,this.l);break;case 8:es=8;if(eu==="f"){this.writeDoubleLE(ev,this.l);break}case 16:break;case -4:es=4;this.writeInt32LE(ev,this.l);break}}this.l+=es;return this}function b2(er,es){er.l=es;er.read_shift=ag;er.write_shift=dq}function z(er,es){er.l+=es}function dS(er,es){er.l+=es}function at(er){var es=dQ?new Buffer(er):new Array(er);b2(es,0);return es}function H(ev,et,er){var ey,eu,es;b2(ev,ev.l||0);while(ev.l<ev.length){var ez=ev.read_shift(1);if(ez&128){ez=(ez&127)+((ev.read_shift(1)&127)<<7)}var ew=aM[ez]||aM[65535];ey=ev.read_shift(1);es=ey&127;for(eu=1;eu<4&&(ey&128);++eu){es+=((ey=ev.read_shift(1))&127)<<(7*eu)}var ex=ew.f(ev,es,er);if(et(ex,ew,ez)){return}}}function az(){var ew=[],eu=2048;var eD=function eA(eE){var eF=at(eE);b2(eF,0);return eF};var ez=eD(eu);var ey=function eC(){ez.length=ez.l;if(ez.length>0){ew.push(ez)}ez=null};var ex=function er(eE){if(eE<ez.length-ez.l){return ez}ey();return(ez=eD(Math.max(eE+1,eu)))};var ev=function es(){ey();return k([ew])};var eB=function et(eE){ey();ez=eE;ex(eu)};return{next:ex,push:eB,end:ev,_bufs:ew}}function cl(ey,eu,ew,ev){var et=d5[eu],er;if(!ev){ev=aM[et].p||(ew||[]).length||0}er=1+(et>=128?1:0)+1+ev;if(ev>=128){++er}if(ev>=16384){++er}if(ev>=2097152){++er}var ex=ey.next(er);if(et<=127){ex.write_shift(1,et)}else{ex.write_shift(1,(et&127)+128);ex.write_shift(1,(et>>7))}for(var es=0;es!=4;++es){if(ev>=128){ex.write_shift(1,(ev&127)+128);ev>>=7}else{ex.write_shift(1,ev);break}}if(ev>0&&dY(ew)){ey.push(ew)}}function bu(es,er){return{ich:es.read_shift(2),ifnt:es.read_shift(2)}}function cA(ew,es){var er=ew.l;var et=ew.read_shift(1);var ex=bg(ew);var eu=[];var ey={t:ex,h:ex};if((et&1)!==0){var ez=ew.read_shift(4);for(var ev=0;ev!=ez;++ev){eu.push(bu(ew))}ey.r=eu}else{ey.r="<t>"+cv(ex)+"</t>"}if((et&2)!==0){}ew.l=er+es;return ey}function aB(es,er){if(er==null){er=at(5+2*es.t.length)}er.write_shift(1,0);dJ(es.t,er);return er}function bE(eu){var es=eu.read_shift(4);var er=eu.read_shift(2);er+=eu.read_shift(1)<<16;var et=eu.read_shift(1);return{c:es,iStyleRef:er}}function F(er,es){if(es==null){es=at(8)}es.write_shift(-4,er.c);es.write_shift(3,er.iStyleRef===undefined?er.iStyleRef:er.s);es.write_shift(1,0);return es}function T(es,er){return bg(es,er)}function cr(es){var er=es.read_shift(4);return er===0||er===4294967295?"":es.read_shift(er,"dbcs")}function bN(er,es){if(!es){es=at(127)}es.write_shift(4,er.length>0?er.length:4294967295);if(er.length>0){es.write_shift(0,er,"dbcs")}return es}function bg(es){var er=es.read_shift(4);return er===0?"":es.read_shift(er,"dbcs")}function dJ(er,es){if(es==null){es=at(4+2*er.length)}es.write_shift(4,er.length);if(er.length>0){es.write_shift(0,er,"dbcs")}return es}var a0=cr;var cI=bN;function cT(ev){var et=ev.slice(ev.l,ev.l+4);var eu=et[0]&1,es=et[0]&2;ev.l+=4;et[0]&=252;var er=es===0?d([0,0,0,0,et[0],et[1],et[2],et[3]],0):bt(et,0)>>2;return eu?er/100:er}function r(es){var er={s:{},e:{}};er.s.r=es.read_shift(4);er.e.r=es.read_shift(4);er.s.c=es.read_shift(4);er.e.c=es.read_shift(4);return er}function dN(er,es){if(!es){es=at(16)}es.write_shift(4,er.s.r);es.write_shift(4,er.e.r);es.write_shift(4,er.s.c);es.write_shift(4,er.e.c);return es}function S(es,er){return es.read_shift(8,"f")}function du(er,es){return(es||at(8)).write_shift(8,"f",er)}var aW={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"};var cE=df(aW);function cs(et,es){var er={};var eu=et.read_shift(1);er.fValidRGB=eu&1;er.xColorType=eu>>>1;er.index=et.read_shift(1);er.nTintAndShade=et.read_shift(2,"i");er.bRed=et.read_shift(1);er.bGreen=et.read_shift(1);er.bBlue=et.read_shift(1);er.bAlpha=et.read_shift(1)}function co(et,es){var eu=et.read_shift(1);et.l++;var er={fItalic:eu&2,fStrikeout:eu&8,fOutline:eu&16,fShadow:eu&32,fCondense:eu&64,fExtend:eu&128};return er}var dA={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.ms-excel.chartsheet":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"TODO","application/vnd.ms-excel.dialogsheet":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"TODO","application/vnd.ms-excel.macrosheet":"TODO","application/vnd.ms-excel.macrosheet+xml":"TODO","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.ms-excel.comments":"comments","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"TODO","application/vnd.ms-excel.sheetMetadata":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"TODO","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"vba","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO",sheet:"js"};var ee=(function(){var er={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};bI(er).forEach(function(es){if(!er[es].xlsm){er[es].xlsm=er[es].xlsx}});bI(er).forEach(function(es){bI(er[es]).forEach(function(et){dA[er[es][et]]=es})});return er})();var P=Z(dA);cV.CT="http://schemas.openxmlformats.org/package/2006/content-types";function q(et,es){var eu={};if(!et||!et.match){return et}var er={workbooks:[],sheets:[],calcchains:[],themes:[],styles:[],coreprops:[],extprops:[],custprops:[],strs:[],comments:[],vba:[],TODO:[],rels:[],xmlns:""};(et.match(c9)||[]).forEach(function(ev){var ew=aH(ev);switch(ew[0].replace(ak,"<")){case"<?xml":break;case"<Types":er.xmlns=ew["xmlns"+(ew[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":eu[ew.Extension]=ew.ContentType;break;case"<Override":if(er[dA[ew.ContentType]]!==undefined){er[dA[ew.ContentType]].push(ew.PartName)}else{if(es.WTF){console.error(ew)}}break}});if(er.xmlns!==cV.CT){throw new Error("Unknown Namespace: "+er.xmlns)}er.calcchain=er.calcchains.length>0?er.calcchains[0]:"";er.sst=er.strs.length>0?er.strs[0]:"";er.style=er.styles.length>0?er.styles[0]:"";er.defaults=eu;delete er.calcchains;return er}var bQ=dp("Types",null,{xmlns:cV.CT,"xmlns:xsd":cV.xsd,"xmlns:xsi":cV.xsi});var bx=[["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["rels",P.rels[0]]].map(function(er){return dp("Default",null,{Extension:er[0],ContentType:er[1]})});function c7(et,eu){var ew=[],es;ew[ew.length]=(cU);ew[ew.length]=(bQ);ew=ew.concat(bx);var er=function(ey){if(et[ey]&&et[ey].length>0){es=et[ey][0];ew[ew.length]=(dp("Override",null,{PartName:(es[0]=="/"?"":"/")+es,ContentType:ee[ey][eu.bookType||"xlsx"]}))}};var ex=function(ey){et[ey].forEach(function(ez){ew[ew.length]=(dp("Override",null,{PartName:(ez[0]=="/"?"":"/")+ez,ContentType:ee[ey][eu.bookType||"xlsx"]}))})};var ev=function(ey){(et[ey]||[]).forEach(function(ez){ew[ew.length]=(dp("Override",null,{PartName:(ez[0]=="/"?"":"/")+ez,ContentType:P[ey][0]}))})};er("workbooks");ex("sheets");ev("themes");["strs","styles"].forEach(er);["coreprops","extprops","custprops"].forEach(ev);if(ew.length>2){ew[ew.length]=("</Types>");ew[1]=ew[1].replace("/>",">")}return ew.join("")}var bz={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument"};function dU(et,er){if(!et){return et}if(er.charAt(0)!=="/"){er="/"+er}var es={};var ev={};var eu=function(eA){var ey=er.split("/");ey.pop();var ex=eA.split("/");var ez=[];while(ex.length!==0){var ew=ex.shift();if(ew===".."){ey.pop()}else{if(ew!=="."){ey.push(ew)}}}return ey.join("/")};et.match(c9).forEach(function(ex){var ez=aH(ex);if(ez[0]==="<Relationship"){var ew={};ew.Type=ez.Type;ew.Target=ez.Target;ew.Id=ez.Id;ew.TargetMode=ez.TargetMode;var ey=ez.TargetMode==="External"?ez.Target:eu(ez.Target);es[ey]=ew;ev[ez.Id]=ew}});es["!id"]=ev;return es}cV.RELS="http://schemas.openxmlformats.org/package/2006/relationships";var dy=dp("Relationships",null,{xmlns:cV.RELS});function ci(er){var es=[];es[es.length]=(cU);es[es.length]=(dy);bI(er["!id"]).forEach(function(eu){var et=er["!id"][eu];es[es.length]=(dp("Relationship",null,et))});if(es.length>2){es[es.length]=("</Relationships>");es[1]=es[1].replace("/>",">")}return es.join("")}var dg=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];cV.CORE_PROPS="http://schemas.openxmlformats.org/package/2006/metadata/core-properties";bz.CORE_PROPS="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties";var aX=(function(){var et=new Array(dg.length);for(var er=0;er<dg.length;++er){var eu=dg[er];var es="(?:"+eu[0].substr(0,eu[0].indexOf(":"))+":)"+eu[0].substr(eu[0].indexOf(":")+1);et[er]=new RegExp("<"+es+"[^>]*>(.*)</"+es+">")}return et})();function aE(et){var eu={};for(var er=0;er<dg.length;++er){var es=dg[er],ev=et.match(aX[er]);if(ev!=null&&ev.length>0){eu[es[1]]=ev[1]}if(es[2]==="date"&&eu[es[1]]){eu[es[1]]=new Date(eu[es[1]])}}return eu}var be=dp("cp:coreProperties",null,{"xmlns:cp":cV.CORE_PROPS,"xmlns:dc":cV.dc,"xmlns:dcterms":cV.dcterms,"xmlns:dcmitype":cV.dcmitype,"xmlns:xsi":cV.xsi});function b6(et,es,er,ev,eu){if(eu[et]!=null||es==null||es===""){return}eu[et]=es;ev[ev.length]=(er?dp(et,es,er):b3(et,es))}function d8(ev,es){var ew=[cU,be],eu={};if(!ev){return ew.join("")}if(ev.CreatedDate!=null){b6("dcterms:created",typeof ev.CreatedDate==="string"?ev.CreatedDate:j(ev.CreatedDate,es.WTF),{"xsi:type":"dcterms:W3CDTF"},ew,eu)}if(ev.ModifiedDate!=null){b6("dcterms:modified",typeof ev.ModifiedDate==="string"?ev.ModifiedDate:j(ev.ModifiedDate,es.WTF),{"xsi:type":"dcterms:W3CDTF"},ew,eu)}for(var er=0;er!=dg.length;++er){var et=dg[er];b6(et[0],ev[et[1]],null,ew,eu)}if(ew.length>2){ew[ew.length]=("</cp:coreProperties>");ew[1]=ew[1].replace("/>",">")}return ew.join("")}var cN=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];cV.EXT_PROPS="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties";bz.EXT_PROPS="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties";function Q(ew,ey){var ev={};if(!ey){ey={}}cN.forEach(function(ez){switch(ez[2]){case"string":ey[ez[1]]=(ew.match(bj(ez[0]))||[])[1];break;case"bool":ey[ez[1]]=(ew.match(bj(ez[0]))||[])[1]==="true";break;case"raw":var eA=ew.match(new RegExp("<"+ez[0]+"[^>]*>(.*)</"+ez[0]+">"));if(eA&&eA.length>0){ev[ez[1]]=eA[1]}break}});if(ev.HeadingPairs&&ev.TitlesOfParts){var er=ba(ev.HeadingPairs);var es=0,eu=0;for(var et=0;et!==er.length;++et){switch(er[et].v){case"Worksheets":eu=es;ey.Worksheets=+(er[++et].v);break;case"Named Ranges":++et;break}}var ex=ba(ev.TitlesOfParts).map(function(ez){return c3(ez.v)});ey.SheetNames=ex.slice(eu,eu+ey.Worksheets)}return ey}var aJ=dp("Properties",null,{xmlns:cV.EXT_PROPS,"xmlns:vt":cV.vt});function bV(eu,es){var ev=[],et={},er=dp;if(!eu){eu={}}eu.Application="SheetJS";ev[ev.length]=(cU);ev[ev.length]=(aJ);cN.forEach(function(ex){if(eu[ex[1]]===undefined){return}var ew;switch(ex[2]){case"string":ew=eu[ex[1]];break;case"bool":ew=eu[ex[1]]?"true":"false";break}if(ew!==undefined){ev[ev.length]=(er(ex[0],ew))}});ev[ev.length]=(er("HeadingPairs",er("vt:vector",er("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+er("vt:variant",er("vt:i4",String(eu.Worksheets))),{size:2,baseType:"variant"})));ev[ev.length]=(er("TitlesOfParts",er("vt:vector",eu.SheetNames.map(function(ew){return"<vt:lpstr>"+ew+"</vt:lpstr>"}).join(""),{size:eu.Worksheets,baseType:"lpstr"})));if(ev.length>2){ev[ev.length]=("</Properties>");ev[1]=ev[1].replace("/>",">")}return ev.join("")}cV.CUST_PROPS="http://schemas.openxmlformats.org/officeDocument/2006/custom-properties";bz.CUST_PROPS="http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties";var cm=/<[^>]+>[^<]*/g;function am(ev,er){var et={},es;var eu=ev.match(cm);if(eu){for(var ew=0;ew!=eu.length;++ew){var eA=eu[ew],ez=aH(eA);switch(ez[0]){case"<?xml":break;case"<Properties":if(ez.xmlns!==cV.CUST_PROPS){throw"unrecognized xmlns "+ez.xmlns}if(ez.xmlnsvt&&ez.xmlnsvt!==cV.vt){throw"unrecognized vt "+ez.xmlnsvt}break;case"<property":es=ez.name;break;case"</property>":es=null;break;default:if(eA.indexOf("<vt:")===0){var ex=eA.split(">");var ey=ex[0].substring(4),eB=ex[1];switch(ey){case"lpstr":case"lpwstr":case"bstr":case"lpwstr":et[es]=cj(eB);break;case"bool":et[es]=dz(eB,"<vt:bool>");break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":et[es]=parseInt(eB,10);break;case"r4":case"r8":case"decimal":et[es]=parseFloat(eB);break;case"filetime":case"date":et[es]=new Date(eB);break;case"cy":case"error":et[es]=cj(eB);break;default:if(typeof console!=="undefined"){console.warn("Unexpected",eA,ey,ex)}}}else{if(eA.substr(0,2)==="</"){}else{if(er.WTF){throw new Error(eA)}}}}}}return et}var ec=dp("Properties",null,{xmlns:cV.CUST_PROPS,"xmlns:vt":cV.vt});function dP(eu,es){var ev=[cU,ec];if(!eu){return ev.join("")}var er=1;bI(eu).forEach(function et(ew){++er;ev[ev.length]=(dp("property",ea(eu[ew]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:er,name:ew}))});if(ev.length>2){ev[ev.length]="</Properties>";ev[1]=ev[1].replace("/>",">")}return ev.join("")}var O={0:1252,1:65001,2:65001,77:10000,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969};var bM=(function dZ(){var eu=bj("t"),ey=bj("rPr"),ev=/<r>/g,es=/<\/r>/,et=/\r\n/g;var ew=function ew(eG,eH,eD){var eA={},eE=65001;var eB=eG.match(c9),eC=0;if(eB){for(;eC!=eB.length;++eC){var eF=aH(eB[eC]);switch(eF[0]){case"<condense":break;case"<extend":break;case"<shadow":case"<shadow/>":break;case"<charset":if(eF.val=="1"){break}eE=O[parseInt(eF.val,10)];break;case"<outline":case"<outline/>":break;case"<rFont":eA.name=eF.val;break;case"<sz":eA.sz=eF.val;break;case"<strike":if(!eF.val){break}case"<strike/>":eA.strike=1;break;case"</strike>":break;case"<u":if(!eF.val){break}case"<u/>":eA.u=1;break;case"</u>":break;case"<b":if(!eF.val){break}case"<b/>":eA.b=1;break;case"</b>":break;case"<i":if(!eF.val){break}case"<i/>":eA.i=1;break;case"</i>":break;case"<color":if(eF.rgb){eA.color=eF.rgb.substr(2,6)}break;case"<family":eA.family=eF.val;break;case"<vertAlign":break;case"<scheme":break;default:if(eF[0].charCodeAt(1)!==47){throw"Unrecognized rich format "+eF[0]}}}}var ez=[];if(eA.b){ez.push("font-weight: bold;")}if(eA.i){ez.push("font-style: italic;")}eH.push('<span style="'+ez.join("")+'">');eD.push("</span>");return eE};function er(eC){var eB=[[],"",[]];var ez=eC.match(eu),eD=65001;if(!U(ez)){return""}eB[1]=ez[1];var eA=eC.match(ey);if(U(eA)){eD=ew(eA[1],eB[0],eB[2])}return eB[0].join("")+eB[1].replace(et,"<br/>")+eB[2].join("")}return function ex(ez){return ez.replace(ev,"").split(es).map(er).join("")}})();var bY=/<t[^>]*>([^<]*)<\/t>/g,dk=/<r>/;function bB(er,et){var es=et?et.cellHTML:true;var eu={};if(!er){return null}var ev;if(er.charCodeAt(1)===116){eu.t=c3(cj(er.substr(er.indexOf(">")+1).split(/<\/t>/)[0]));eu.r=er;if(es){eu.h=eu.t}}else{if((ev=er.match(dk))){eu.r=er;eu.t=c3(cj(er.match(bY).join("").replace(c9,"")));if(es){eu.h=bM(er)}}}return eu}var bd=/<sst([^>]*)>([\s\S]*)<\/sst>/;var bc=/<(?:si|sstItem)>/g;var a9=/<\/(?:si|sstItem)>/;function v(ew,ev){var eu=[],es;var et=ew.match(bd);if(U(et)){es=et[2].replace(bc,"").split(a9);for(var er=0;er!=es.length;++er){var ex=bB(es[er],ev);if(ex!=null){eu[eu.length]=ex}}et=aH(et[1]);eu.Count=et.count;eu.Unique=et.uniqueCount}return eu}bz.SST="http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings";var a6=/^\s|\s$|[\t\n\r]/;function ep(eu,ev){if(!ev.bookSST){return""}var ew=[cU];ew[ew.length]=(dp("sst",null,{xmlns:cV.main[0],count:eu.Count,uniqueCount:eu.Unique}));for(var es=0;es!=eu.length;++es){if(eu[es]==null){continue}var et=eu[es];var er="<si>";if(et.r){er+=et.r}else{er+="<t";if(et.t.match(a6)){er+=' xml:space="preserve"'}er+=">"+cv(et.t)+"</t>"}er+="</si>";ew[ew.length]=(er)}if(ew.length>2){ew[ew.length]=("</sst>");ew[1]=ew[1].replace("/>",">")}return ew.join("")}function bp(es,er){return[es.read_shift(4),es.read_shift(4)]}function dr(ev,eu){var es=[];var et=false;H(ev,function er(ey,ex,ew){switch(ex.n){case"BrtBeginSst":es.Count=ey[0];es.Unique=ey[1];break;case"BrtSSTItem":es.push(ey);break;case"BrtEndSst":return true;case"BrtFRTBegin":et=true;break;case"BrtFRTEnd":et=false;break;default:if(!et||eu.WTF){throw new Error("Unexpected record "+ew+" "+ex.n)}}});return es}function G(er,es){if(!es){es=at(8)}es.write_shift(4,er.Count);es.write_shift(4,er.Unique);return es}var cy=aB;function c6(es,et){var eu=az();cl(eu,"BrtBeginSst",G(es));for(var er=0;er<es.length;++er){cl(eu,"BrtSSTItem",cy(es[er]))}cl(eu,"BrtEndSst");return eu.end()}function dh(er){var es=er.substr(er[0]==="#"?1:0,6);return[parseInt(es.substr(0,2),16),parseInt(es.substr(0,2),16),parseInt(es.substr(0,2),16)]}function bs(er){for(var es=0,et=1;es!=3;++es){et=et*256+(er[es]>255?255:er[es]<0?0:er[es])}return et.toString(16).toUpperCase().substr(1)}function al(ez){var ew=ez[0]/255,eA=ez[1]/255,es=ez[2]/255;var ey=Math.max(ew,eA,es),et=Math.min(ew,eA,es),er=ey-et;if(er===0){return[0,0,ew]}var ex=0,ev=0,eu=(ey+et);ev=er/(eu>1?2-eu:eu);switch(ey){case ew:ex=((eA-es)/er+6)%6;break;case eA:ex=((es-ew)/er+2);break;case es:ex=((ew-eA)/er+4);break}return[ex/6,ev,eu/2]}function cq(eA){var ez=eA[0],eu=eA[1],ey=eA[2];var er=eu*2*(ey<0.5?ey:1-ey),et=ey-er/2;var ex=[et,et,et],ew=6*ez;var es;if(eu!==0){switch(ew|0){case 0:case 6:es=er*ew;ex[0]+=er;ex[1]+=es;break;case 1:es=er*(2-ew);ex[0]+=es;ex[1]+=er;break;case 2:es=er*(ew-2);ex[1]+=er;ex[2]+=es;break;case 3:es=er*(4-ew);ex[1]+=es;ex[2]+=er;break;case 4:es=er*(ew-4);ex[2]+=er;ex[0]+=es;break;case 5:es=er*(6-ew);ex[2]+=es;ex[0]+=er;break}}for(var ev=0;ev!=3;++ev){ex[ev]=Math.round(ex[ev]*255)}return ex}function e(et,es){if(es===0){return et}var er=al(dh(et));if(es<0){er[2]=er[2]*(1+es)}else{er[2]=1-(1-er[2])*(1-es)}return bs(cq(er))}var a8=7,d2=15,bU=1,cP=a8;function au(er){return((er+((128/cP)|0)/256)*cP)|0}function cQ(er){return(((er-5)/cP*100+0.5)|0)/100}function i(er){return(((er*cP+5)/cP*256)|0)/256}function J(er){return i(cQ(au(er)))}function dj(er,es){if(J(er)!=er){for(cP=a8;cP>bU;--cP){if(J(er)===er){break}}if(cP===bU){for(cP=a8+1;cP<d2;++cP){if(J(er)===er){break}}}if(cP===d2){cP=a8}}}var cK={};var dW={};function y(er,es){cK.Fills=[];var et={};er[0].match(c9).forEach(function(eu){var ev=aH(eu);switch(ev[0]){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":break;case"</fill>":cK.Fills.push(et);et={};break;case"<patternFill":if(ev.patternType){et.patternType=ev.patternType}break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":if(!et.bgColor){et.bgColor={}}if(ev.indexed){et.bgColor.indexed=parseInt(ev.indexed,10)}if(ev.theme){et.bgColor.theme=parseInt(ev.theme,10)}if(ev.tint){et.bgColor.tint=parseFloat(ev.tint)}if(ev.rgb){et.bgColor.rgb=ev.rgb.substring(ev.rgb.length-6)}break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":if(!et.fgColor){et.fgColor={}}if(ev.theme){et.fgColor.theme=parseInt(ev.theme,10)}if(ev.tint){et.fgColor.tint=parseFloat(ev.tint)}if(ev.rgb){et.fgColor.rgb=ev.rgb.substring(ev.rgb.length-6)}break;case"<bgColor/>":case"</fgColor>":break;default:if(es.WTF){throw"unrecognized "+ev[0]+" in fills"}}})}function aw(ev,ew){cK.NumberFmt=[];var es=bI(ch._table);for(var eu=0;eu<es.length;++eu){cK.NumberFmt[es[eu]]=ch._table[es[eu]]}var er=ev[0].match(c9);for(eu=0;eu<er.length;++eu){var ey=aH(er[eu]);switch(ey[0]){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":var ex=cj(c3(ey.formatCode)),et=parseInt(ey.numFmtId,10);cK.NumberFmt[et]=ex;if(et>0){ch.load(ex,et)}break;default:if(ew.WTF){throw"unrecognized "+ey[0]+" in numFmts"}}}}function V(es,er){var et=["<numFmts>"];[[5,8],[23,26],[41,44],[63,66],[164,392]].forEach(function(ev){for(var eu=ev[0];eu<=ev[1];++eu){if(es[eu]!==undefined){et[et.length]=(dp("numFmt",null,{numFmtId:eu,formatCode:cv(es[eu])}))}}});if(et.length===1){return""}et[et.length]=("</numFmts>");et[0]=dp("numFmts",null,{count:et.length-2}).replace("/>",">");return et.join("")}function db(er,es){cK.CellXf=[];er[0].match(c9).forEach(function(et){var eu=aH(et);switch(eu[0]){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":delete eu[0];if(eu.numFmtId){eu.numFmtId=parseInt(eu.numFmtId,10)}if(eu.fillId){eu.fillId=parseInt(eu.fillId,10)}cK.CellXf.push(eu);break;case"</xf>":break;case"<alignment":case"<alignment/>":break;case"<protection":case"</protection>":case"<protection/>":break;case"<extLst":case"</extLst>":break;case"<ext":break;default:if(es.WTF){throw"unrecognized "+eu[0]+" in cellXfs"}}})}function bh(es){var er=[];er[er.length]=(dp("cellXfs",null));es.forEach(function(et){er[er.length]=(dp("xf",null,et))});er[er.length]=("</cellXfs>");if(er.length===2){return""}er[0]=dp("cellXfs",null,{count:er.length-2}).replace("/>",">");return er.join("")}var ck=(function cH(){var es=/<numFmts([^>]*)>.*<\/numFmts>/;var et=/<cellXfs([^>]*)>.*<\/cellXfs>/;var er=/<fills([^>]*)>.*<\/fills>/;return function eu(ex,ew){var ev;if((ev=ex.match(es))){aw(ev,ew)}if((ev=ex.match(er))){y(ev,ew)}if((ev=ex.match(et))){db(ev,ew)}return cK}})();var cM=dp("styleSheet",null,{xmlns:cV.main[0],"xmlns:vt":cV.vt});bz.STY="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles";function b4(et,es){var eu=[cU,cM],er;if((er=V(et.SSF))!=null){eu[eu.length]=er}eu[eu.length]=('<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>');eu[eu.length]=('<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>');eu[eu.length]=('<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>');eu[eu.length]=('<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>');if((er=bh(es.cellXfs))){eu[eu.length]=(er)}eu[eu.length]=('<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>');eu[eu.length]=('<dxfs count="0"/>');eu[eu.length]=('<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>');if(eu.length>2){eu[eu.length]=("</styleSheet>");eu[1]=eu[1].replace("/>",">")}return eu.join("")}function cC(eu,es){var er=eu.read_shift(2);var et=bg(eu,es-2);return[er,et]}function aQ(et,es){var er={flags:{}};er.dyHeight=et.read_shift(2);er.grbit=co(et,2);er.bls=et.read_shift(2);er.sss=et.read_shift(2);er.uls=et.read_shift(1);er.bFamily=et.read_shift(1);er.bCharSet=et.read_shift(1);et.l++;er.brtColor=cs(et,8);er.bFontScheme=et.read_shift(1);er.name=bg(et,es-21);er.flags.Bold=er.bls===700;er.flags.Italic=er.grbit.fItalic;er.flags.Strikeout=er.grbit.fStrikeout;er.flags.Outline=er.grbit.fOutline;er.flags.Shadow=er.grbit.fShadow;er.flags.Condense=er.grbit.fCondense;er.flags.Extend=er.grbit.fExtend;er.flags.Sub=er.sss&2;er.flags.Sup=er.sss&1;return er}function dK(eu,et){var er=eu.read_shift(2);var es=eu.read_shift(2);z(eu,et-4);return{ixfe:er,ifmt:es}}function a2(ev,et){cK.NumberFmt=[];for(var ew in ch._table){cK.NumberFmt[ew]=ch._table[ew]}cK.CellXf=[];var eu="";var es=false;H(ev,function er(ez,ey,ex){switch(ey.n){case"BrtFmt":cK.NumberFmt[ez[0]]=ez[1];ch.load(ez[1],ez[0]);break;case"BrtFont":break;case"BrtKnownFonts":break;case"BrtFill":break;case"BrtBorder":break;case"BrtXF":if(eu==="CELLXFS"){cK.CellXf.push(ez)}break;case"BrtStyle":break;case"BrtDXF":break;case"BrtMRUColor":break;case"BrtIndexedColor":break;case"BrtBeginStyleSheet":break;case"BrtEndStyleSheet":break;case"BrtBeginTableStyle":break;case"BrtTableStyleElement":break;case"BrtEndTableStyle":break;case"BrtBeginFmts":eu="FMTS";break;case"BrtEndFmts":eu="";break;case"BrtBeginFonts":eu="FONTS";break;case"BrtEndFonts":eu="";break;case"BrtACBegin":eu="ACFONTS";break;case"BrtACEnd":eu="";break;case"BrtBeginFills":eu="FILLS";break;case"BrtEndFills":eu="";break;case"BrtBeginBorders":eu="BORDERS";break;case"BrtEndBorders":eu="";break;case"BrtBeginCellStyleXFs":eu="CELLSTYLEXFS";break;case"BrtEndCellStyleXFs":eu="";break;case"BrtBeginCellXFs":eu="CELLXFS";break;case"BrtEndCellXFs":eu="";break;case"BrtBeginStyles":eu="STYLES";break;case"BrtEndStyles":eu="";break;case"BrtBeginDXFs":eu="DXFS";break;case"BrtEndDXFs":eu="";break;case"BrtBeginTableStyles":eu="TABLESTYLES";break;case"BrtEndTableStyles":eu="";break;case"BrtBeginColorPalette":eu="COLORPALETTE";break;case"BrtEndColorPalette":eu="";break;case"BrtBeginIndexedColors":eu="INDEXEDCOLORS";break;case"BrtEndIndexedColors":eu="";break;case"BrtBeginMRUColors":eu="MRUCOLORS";break;case"BrtEndMRUColors":eu="";break;case"BrtFRTBegin":es=true;break;case"BrtFRTEnd":es=false;break;case"BrtBeginStyleSheetExt14":break;case"BrtBeginSlicerStyles":break;case"BrtEndSlicerStyles":break;case"BrtBeginTimelineStylesheetExt15":break;case"BrtEndTimelineStylesheetExt15":break;case"BrtBeginTimelineStyles":break;case"BrtEndTimelineStyles":break;case"BrtEndStyleSheetExt14":break;default:if(!es||et.WTF){throw new Error("Unexpected record "+ex+" "+ey.n)}}});return cK}function aA(es,er){var et=az();cl(et,"BrtBeginStyleSheet");cl(et,"BrtEndStyleSheet");return et.end()}bz.THEME="http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme";function da(es,et){dW.themeElements.clrScheme=[];var er={};es[0].match(c9).forEach(function(eu){var ev=aH(eu);switch(ev[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":er.rgb=ev.val;break;case"<a:sysClr":er.rgb=ev.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt1>":case"</a:lt1>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":if(ev[0][1]==="/"){dW.themeElements.clrScheme.push(er);er={}}else{er.name=ev[0].substring(3,ev[0].length-1)}break;default:if(et.WTF){throw"unrecognized "+ev[0]+" in clrScheme"}}})}var bX=/<a:clrScheme([^>]*)>.*<\/a:clrScheme>/;function g(et,es){if(!et||et.length===0){return dW}dW.themeElements={};var er;if((er=et.match(bX))){da(er,es)}return dW}function m(){return'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme"><a:themeElements><a:clrScheme name="Office"><a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1><a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1><a:dk2><a:srgbClr val="1F497D"/></a:dk2><a:lt2><a:srgbClr val="EEECE1"/></a:lt2><a:accent1><a:srgbClr val="4F81BD"/></a:accent1><a:accent2><a:srgbClr val="C0504D"/></a:accent2><a:accent3><a:srgbClr val="9BBB59"/></a:accent3><a:accent4><a:srgbClr val="8064A2"/></a:accent4><a:accent5><a:srgbClr val="4BACC6"/></a:accent5><a:accent6><a:srgbClr val="F79646"/></a:accent6><a:hlink><a:srgbClr val="0000FF"/></a:hlink><a:folHlink><a:srgbClr val="800080"/></a:folHlink></a:clrScheme><a:fontScheme name="Office"><a:majorFont><a:latin typeface="Cambria"/><a:ea typeface=""/><a:cs typeface=""/><a:font script="Jpan" typeface=" "/><a:font script="Hang" typeface=" "/><a:font script="Hans" typeface=""/><a:font script="Hant" typeface=""/><a:font script="Arab" typeface="Times New Roman"/><a:font script="Hebr" typeface="Times New Roman"/><a:font script="Thai" typeface="Tahoma"/><a:font script="Ethi" typeface="Nyala"/><a:font script="Beng" typeface="Vrinda"/><a:font script="Gujr" typeface="Shruti"/><a:font script="Khmr" typeface="MoolBoran"/><a:font script="Knda" typeface="Tunga"/><a:font script="Guru" typeface="Raavi"/><a:font script="Cans" typeface="Euphemia"/><a:font script="Cher" typeface="Plantagenet Cherokee"/><a:font script="Yiii" typeface="Microsoft Yi Baiti"/><a:font script="Tibt" typeface="Microsoft Himalaya"/><a:font script="Thaa" typeface="MV Boli"/><a:font script="Deva" typeface="Mangal"/><a:font script="Telu" typeface="Gautami"/><a:font script="Taml" typeface="Latha"/><a:font script="Syrc" typeface="Estrangelo Edessa"/><a:font script="Orya" typeface="Kalinga"/><a:font script="Mlym" typeface="Kartika"/><a:font script="Laoo" typeface="DokChampa"/><a:font script="Sinh" typeface="Iskoola Pota"/><a:font script="Mong" typeface="Mongolian Baiti"/><a:font script="Viet" typeface="Times New Roman"/><a:font script="Uigh" typeface="Microsoft Uighur"/><a:font script="Geor" typeface="Sylfaen"/></a:majorFont><a:minorFont><a:latin typeface="Calibri"/><a:ea typeface=""/><a:cs typeface=""/><a:font script="Jpan" typeface=" "/><a:font script="Hang" typeface=" "/><a:font script="Hans" typeface=""/><a:font script="Hant" typeface=""/><a:font script="Arab" typeface="Arial"/><a:font script="Hebr" typeface="Arial"/><a:font script="Thai" typeface="Tahoma"/><a:font script="Ethi" typeface="Nyala"/><a:font script="Beng" typeface="Vrinda"/><a:font script="Gujr" typeface="Shruti"/><a:font script="Khmr" typeface="DaunPenh"/><a:font script="Knda" typeface="Tunga"/><a:font script="Guru" typeface="Raavi"/><a:font script="Cans" typeface="Euphemia"/><a:font script="Cher" typeface="Plantagenet Cherokee"/><a:font script="Yiii" typeface="Microsoft Yi Baiti"/><a:font script="Tibt" typeface="Microsoft Himalaya"/><a:font script="Thaa" typeface="MV Boli"/><a:font script="Deva" typeface="Mangal"/><a:font script="Telu" typeface="Gautami"/><a:font script="Taml" typeface="Latha"/><a:font script="Syrc" typeface="Estrangelo Edessa"/><a:font script="Orya" typeface="Kalinga"/><a:font script="Mlym" typeface="Kartika"/><a:font script="Laoo" typeface="DokChampa"/><a:font script="Sinh" typeface="Iskoola Pota"/><a:font script="Mong" typeface="Mongolian Baiti"/><a:font script="Viet" typeface="Arial"/><a:font script="Uigh" typeface="Microsoft Uighur"/><a:font script="Geor" typeface="Sylfaen"/></a:minorFont></a:fontScheme><a:fmtScheme name="Office"><a:fillStyleLst><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs><a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs></a:gsLst><a:lin ang="16200000" scaled="1"/></a:gradFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs></a:gsLst><a:lin ang="16200000" scaled="0"/></a:gradFill></a:fillStyleLst><a:lnStyleLst><a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln><a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln><a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln></a:lnStyleLst><a:effectStyleLst><a:effectStyle><a:effectLst><a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw></a:effectLst><a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d><a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d></a:effectStyle></a:effectStyleLst><a:bgFillStyleLst><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs><a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs></a:gsLst><a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path></a:gradFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs></a:gsLst><a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path></a:gradFill></a:bgFillStyleLst></a:fmtScheme></a:themeElements><a:objectDefaults><a:spDef><a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style></a:spDef><a:lnDef><a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style></a:lnDef></a:objectDefaults><a:extraClrSchemeLst/></a:theme>'}function ek(eu,et){var ev=[];var er=0,es=1;(eu.match(c9)||[]).forEach(function(ew){var ex=aH(ew);switch(ex[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete ex[0];if(ex.i){es=ex.i}else{ex.i=es}ev.push(ex);break}});return ev}function X(es,er){}function cO(ev,eu){var et={};et.i=ev.read_shift(4);var er={};er.r=ev.read_shift(4);er.c=ev.read_shift(4);et.r=cF(er);var es=ev.read_shift(1);if(es&2){et.l="1"}if(es&8){et.a="1"}return et}function c4(eu,et){var er=[];var es=false;H(eu,function ev(ey,ex,ew){switch(ex.n){case"BrtCalcChainItem$":er.push(ey);break;case"BrtBeginCalcChain$":break;case"BrtEndCalcChain$":break;default:if(!es||et.WTF){throw new Error("Unexpected record "+ew+" "+ex.n)}}});return er}function dM(es,er){}function ad(eu,eB,ey,eC,es){for(var ex=0;ex!=eB.length;++ex){var ev=eB[ex];var ez=bv(a4(eu,ev.replace(/^\//,""),true),ev,es);if(!ez||!ez.length){continue}var er=bI(ey);for(var ew=0;ew!=er.length;++ew){var et=er[ew];var eA=eC[et];if(eA){var eD=eA[ev];if(eD){aa(et,ey[et],ez)}}}}}function aa(es,er,et){et.forEach(function(ez){var eu=er[ez.ref];if(!eu){eu={};er[ez.ref]=eu;var ev=c0(er["!ref"]||"BDWGO1000001:A1");var ey=ac(ez.ref);if(ev.s.r>ey.r){ev.s.r=ey.r}if(ev.e.r<ey.r){ev.e.r=ey.r}if(ev.s.c>ey.c){ev.s.c=ey.c}if(ev.e.c<ey.c){ev.e.c=ey.c}var ew=bC(ev);if(ew!==er["!ref"]){er["!ref"]=ew}}if(!eu.c){eu.c=[]}var ex={a:ez.author,t:ez.t,r:ez.r};if(ez.h){ex.h=ez.h}eu.c.push(ex)})}function cB(eu,et){if(eu.match(/<(?:\w+:)?comments *\/>/)){return[]}var er=[];var es=[];eu.match(/<(?:\w+:)?authors>([^\u2603]*)<\/(?:\w+:)?authors>/)[1].split(/<\/\w*:?author>/).forEach(function(ev){if(ev===""||ev.trim()===""){return}er.push(ev.match(/<(?:\w+:)?author[^>]*>(.*)/)[1])});(eu.match(/<(?:\w+:)?commentList>([^\u2603]*)<\/(?:\w+:)?commentList>/)||["",""])[1].split(/<\/\w*:?comment>/).forEach(function(ew,ey){if(ew===""||ew.trim()===""){return}var eB=aH(ew.match(/<(?:\w+:)?comment[^>]*>/)[0]);var eA={author:eB.authorId&&er[eB.authorId]?er[eB.authorId]:undefined,ref:eB.ref,guid:eB.guid};var ev=ac(eB.ref);if(et.sheetRows&&et.sheetRows<=ev.r){return}var ez=ew.match(/<text>([^\u2603]*)<\/text>/);if(!ez||!ez[1]){return}var ex=bB(ez[1]);eA.r=ex.r;eA.t=ex.t;if(et.cellHTML){eA.h=ex.h}es.push(eA)});return es}function K(es,er){}function c(eu,et){var es={};es.iauthor=eu.read_shift(4);var er=r(eu,16);es.rfx=er.s;es.ref=cF(er.s);eu.l+=16;return es}var dG=bg;var dC=cA;function bf(ew,ev){var et=[];var es=[];var ex={};var eu=false;H(ew,function er(eA,ez,ey){switch(ez.n){case"BrtCommentAuthor":es.push(eA);break;case"BrtBeginComment":ex=eA;break;case"BrtCommentText":ex.t=eA.t;ex.h=eA.h;ex.r=eA.r;break;case"BrtEndComment":ex.author=es[ex.iauthor];delete ex.iauthor;if(ev.sheetRows&&ev.sheetRows<=ex.rfx.r){break}delete ex.rfx;et.push(ex);break;case"BrtBeginComments":break;case"BrtEndComments":break;case"BrtBeginCommentAuthors":break;case"BrtEndCommentAuthors":break;case"BrtBeginCommentList":break;case"BrtEndCommentList":break;default:if(!eu||ev.WTF){throw new Error("Unexpected record "+ey+" "+ez.n)}}});return et}function dH(es,er){}function dl(es,er){var et=es.read_shift(4);return z(es,er-4)}var aq={};var aO={};bz.WS="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet";function ds(et,eu){for(var es=0,er=et.length;es<er;++es){if(et[es].t===eu){et.Count++;return es}}et[er]={t:eu};et.Count++;et.Unique++;return er}function aR(ev,es,eu){var ew=eu.revssf[es.z!=null?es.z:"General"];for(var et=0,er=ev.length;et!=er;++et){if(ev[et].numFmtId===ew){return et}}ev[er]={numFmtId:ew,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1};return er}function N(ev,et,er,es){try{if(et===0){if(ev.t==="n"){if((ev.v|0)===ev.v){ev.w=ch._general_int(ev.v,aO)}else{ev.w=ch._general_num(ev.v,aO)}}else{if(ev.v===undefined){return""}else{ev.w=ch._general(ev.v,aO)}}}else{ev.w=ch.format(et,ev.v,aO)}if(es.cellNF){ev.z=ch._table[et]}}catch(eu){if(es.WTF){throw eu}}if(er){try{ev.s=cK.Fills[er];if(ev.s.fgColor&&ev.s.fgColor.theme){ev.s.fgColor.rgb=e(dW.themeElements.clrScheme[ev.s.fgColor.theme].rgb,ev.s.fgColor.tint||0);if(es.WTF){ev.s.fgColor.raw_rgb=dW.themeElements.clrScheme[ev.s.fgColor.theme].rgb}}if(ev.s.bgColor&&ev.s.bgColor.theme){ev.s.bgColor.rgb=e(dW.themeElements.clrScheme[ev.s.bgColor.theme].rgb,ev.s.bgColor.tint||0);if(es.WTF){ev.s.bgColor.raw_rgb=dW.themeElements.clrScheme[ev.s.bgColor.theme].rgb}}}catch(eu){if(es.WTF){throw eu}}}}function bk(er,es){var et=c0(es);if(et.s.r<=et.e.r&&et.s.c<=et.e.c&&et.s.r>=0&&et.s.c>=0){er["!ref"]=bC(et)}}var D=/<mergeCell ref="[A-Z0-9:]+"\s*\/>/g;var f=/<(?:\w+:)?sheetData>([^\u2603]*)<\/(?:\w+:)?sheetData>/;var dX=/<hyperlink[^>]*\/>/g;var d7=/"(\w*:\w*)"/;var dV=/<col[^>]*\/>/g;function bi(ey,es,ez){if(!ey){return ey}var eD={};var eu=ey.indexOf("<dimension");if(eu>0){var ew=ey.substr(eu,50).match(d7);if(ew!=null){bk(eD,ew[1])}}var eC=[];if(ey.indexOf("</mergeCells>")!==-1){var ev=ey.match(D);for(eu=0;eu!=ev.length;++eu){eC[eu]=c0(ev[eu].substr(ev[eu].indexOf('"')+1))}}var ex=[];if(es.cellStyles&&ey.indexOf("</cols>")!==-1){var eA=ey.match(dV);aV(ex,eA)}var er={s:{r:1000000,c:1000000},e:{r:0,c:0}};var eB=ey.match(f);if(eB){cX(eB[1],eD,es,er)}if(ey.indexOf("</hyperlinks>")!==-1){E(eD,ey.match(dX),ez)}if(!eD["!ref"]&&er.e.c>=er.s.c&&er.e.r>=er.s.r){eD["!ref"]=bC(er)}if(es.sheetRows>0&&eD["!ref"]){var et=c0(eD["!ref"]);if(es.sheetRows<+et.e.r){et.e.r=es.sheetRows-1;if(et.e.r>er.e.r){et.e.r=er.e.r}if(et.e.r<et.s.r){et.s.r=et.e.r}if(et.e.c>er.e.c){et.e.c=er.e.c}if(et.e.c<et.s.c){et.s.c=et.e.c}eD["!fullref"]=eD["!ref"];eD["!ref"]=bC(et)}}if(eC.length>0){eD["!merges"]=eC}if(ex.length>0){eD["!cols"]=ex}return eD}function cZ(es){if(es.length==0){return""}var et='<mergeCells count="'+es.length+'">';for(var er=0;er!=es.length;++er){et+='<mergeCell ref="'+bC(es[er])+'"/>'}return et+"</mergeCells>"}function E(eA,eu,ex){for(var ew=0;ew!=eu.length;++ew){var et=aH(eu[ew],true);if(!et.ref){return}var ez=ex["!id"][et.id];if(ez){et.Target=ez.Target;if(et.location){et.Target+="#"+et.location}et.Rel=ez}var er=c0(et.ref);for(var ev=er.s.r;ev<=er.e.r;++ev){for(var es=er.s.c;es<=er.e.c;++es){var ey=cF({c:es,r:ev});if(!eA[ey]){eA[ey]={t:"str",v:undefined}}eA[ey].l=et}}}}function aV(eu,ew){var ex=false;for(var ev=0;ev!=ew.length;++ev){var et=aH(ew[ev],true);var es=parseInt(et.min,10)-1,er=parseInt(et.max,10)-1;delete et.min;delete et.max;if(!ex&&et.width){ex=true;dj(+et.width,et)}if(et.width){et.wpx=au(+et.width);et.wch=cQ(et.wpx);et.MDW=cP}while(es<=er){eu[es++]=et}}}function b(er,ew){var ex=["<cols>"],es,eu;for(var et=0;et!=ew.length;++et){if(!(es=ew[et])){continue}var ev={min:et+1,max:et+1};eu=-1;if(es.wpx){eu=cQ(es.wpx)}else{if(es.wch){eu=es.wch}}if(eu>-1){ev.width=i(eu);ev.customWidth=1}ex[ex.length]=(dp("col",null,ev))}ex[ex.length]="</cols>";return ex.join("")}function cd(eA,et,ew,er,ey,eu){if(eA.v===undefined){return""}var ex="";switch(eA.t){case"b":ex=eA.v?"1":"0";break;case"n":case"e":ex=""+eA.v;break;default:ex=eA.v;break}var ez=b3("v",cv(ex)),es={r:et};var ev=aR(er.cellXfs,eA,er);if(ev!==0){es.s=ev}switch(eA.t){case"n":break;case"b":es.t="b";break;case"e":es.t="e";break;default:if(er.bookSST){ez=b3("v",""+ds(er.Strings,eA.v));es.t="s";break}es.t="str";break}return dp("c",ez,es)}var cX=(function aT(){var er=/<(?:\w+:)?c[ >]/,ev=/<\/(?:\w+:)?row>/;var eu=/r=["']([^"']*)["']/,es=/<is>([\S\s]*?)<\/is>/;var et=bj("v"),ew=bj("f");return function ex(eU,eG,eF,eH){var eJ=0,eD="",eA=[],ey=[],eI=0,eQ=0,eL=0,eS="",eM;var eW,eK=0,eT=0;var eR;var eV=0,eP=0,ez=Array.isArray(cK.CellXf),eE;for(var eB=eU.split(ev),eN=0,eC=eB.length;eN!=eC;++eN){eD=eB[eN].trim();var eO=eD.length;if(eO===0){continue}for(eJ=0;eJ<eO;++eJ){if(eD.charCodeAt(eJ)===62){break}}++eJ;eW=aH(eD.substr(0,eJ),true);eK=typeof eW.r!=="undefined"?parseInt(eW.r,10):eK+1;eT=-1;if(eF.sheetRows&&eF.sheetRows<eK){continue}if(eH.s.r>eK-1){eH.s.r=eK-1}if(eH.e.r<eK-1){eH.e.r=eK-1}eA=eD.substr(eJ).split(er);for(eJ=typeof eW.r==="undefined"?0:1;eJ!=eA.length;++eJ){eD=eA[eJ].trim();if(eD.length===0){continue}ey=eD.match(eu);eI=eJ;eQ=0;eL=0;eD="<c "+(eD.substr(0,1)=="<"?">":"")+eD;if(ey!==null&&ey.length===2){eI=0;eS=ey[1];for(eQ=0;eQ!=eS.length;++eQ){if((eL=eS.charCodeAt(eQ)-64)<1||eL>26){break}eI=26*eI+eL}--eI;eT=eI}else{++eT}for(eQ=0;eQ!=eD.length;++eQ){if(eD.charCodeAt(eQ)===62){break}}++eQ;eW=aH(eD.substr(0,eQ),true);if(!eW.r){eW.r=aY.encode_cell({r:eK-1,c:eT})}eS=eD.substr(eQ);eM={t:""};if((ey=eS.match(et))!==null&&ey[1]!==""){eM.v=cj(ey[1])}if(eF.cellFormula&&(ey=eS.match(ew))!==null){eM.f=cj(ey[1])}if(eW.t===undefined&&eM.v===undefined){if(!eF.sheetStubs){continue}eM.t="str"}else{eM.t=eW.t||"n"}if(eH.s.c>eI){eH.s.c=eI}if(eH.e.c<eI){eH.e.c=eI}switch(eM.t){case"n":eM.v=parseFloat(eM.v);break;case"s":eR=aq[parseInt(eM.v,10)];eM.v=eR.t;eM.r=eR.r;if(eF.cellHTML){eM.h=eR.h}break;case"str":if(eM.v!=null){eM.v=c3(eM.v)}else{eM.v=""}break;case"inlineStr":ey=eS.match(es);eM.t="str";if(ey!==null){eR=bB(ey[1]);eM.v=eR.t}else{eM.v=""}break;case"b":eM.v=dz(eM.v);break;case"d":eM.v=dc(eM.v);eM.t="n";break;case"e":eM.raw=cE[eM.v];break}eV=eP=0;if(ez&&eW.s!==undefined){eE=cK.CellXf[eW.s];if(eE!=null){if(eE.numFmtId!=null){eV=eE.numFmtId}if(eF.cellStyles&&eE.fillId!=null){eP=eE.fillId}}}N(eM,eV,eP,eF);eG[eW.r]=eM}}}})();function by(eA,er,eC,ew){var eu=[],es=[],ez=c0(eA["!ref"]),eD,ev,ex="",eB=[],ey,et;for(et=ez.s.c;et<=ez.e.c;++et){eB[et]=cD(et)}for(ey=ez.s.r;ey<=ez.e.r;++ey){es=[];ex=dB(ey);for(et=ez.s.c;et<=ez.e.c;++et){ev=eB[et]+ex;if(eA[ev]===undefined){continue}if((eD=cd(eA[ev],ev,eA,er,eC,ew))!=null){es.push(eD)}}if(es.length>0){eu[eu.length]=(dp("row",es.join(""),{r:ex}))}}return eu.join("")}var ej=dp("worksheet",null,{xmlns:cV.main[0],"xmlns:r":cV.r});function an(ey,er,eu){var es=[cU,ej];var ez=eu.SheetNames[ey],ex=0,ev="";var ew=eu.Sheets[ez];if(ew===undefined){ew={}}var et=ew["!ref"];if(et===undefined){et="A1"}es[es.length]=(dp("dimension",null,{ref:et}));if(ew["!cols"]!==undefined&&ew["!cols"].length>0){es[es.length]=(b(ew,ew["!cols"]))}es[ex=es.length]="<sheetData/>";if(ew["!ref"]!==undefined){ev=by(ew,er,ey,eu);if(ev.length>0){es[es.length]=(ev)}}if(es.length>ex+1){es[es.length]=("</sheetData>");es[ex]=es[ex].replace("/>",">")}if(ew["!merges"]!==undefined&&ew["!merges"].length>0){es[es.length]=(cZ(ew["!merges"]))}if(es.length>2){es[es.length]=("</worksheet>");es[1]=es[1].replace("/>",">")}return es.join("")}function di(es,er){var et=[];et.r=es.read_shift(4);es.l+=er-4;return et}var ax=r;var o=dN;function dw(es,er){var et={};es.l+=19;et.name=T(es,er-19);return et}function cw(et,es){var er=bE(et);return[er]}function I(er,et,es){if(es==null){es=at(8)}return F(et,es)}function d3(eu,et){var er=bE(eu);var es=eu.read_shift(1);return[er,es,"b"]}function a(eu,et){var er=bE(eu);var es=eu.read_shift(1);return[er,es,"e"]}function dL(et,es){var er=bE(et);var eu=et.read_shift(4);return[er,eu,"s"]}function cg(eu,es){var er=bE(eu);var et=S(eu);return[er,et,"n"]}function bT(eu,es){var er=bE(eu);var et=cT(eu);return[er,et,"n"]}function bw(eu,es){var er=bE(eu);var et=bg(eu);return[er,et,"str"]}function bF(ev,et,es){var er=bE(ev);var eu=ev.read_shift(1);var ew=[er,eu,"b"];if(es.cellFormula){var ex=dl(ev,et-9);ew[3]=""}else{ev.l+=et-9}return ew}function bH(ev,et,es){var er=bE(ev);var eu=ev.read_shift(1);var ew=[er,eu,"e"];if(es.cellFormula){var ex=dl(ev,et-9);ew[3]=""}else{ev.l+=et-9}return ew}function M(ev,et,es){var er=bE(ev);var eu=S(ev);var ew=[er,eu,"n"];if(es.cellFormula){var ex=dl(ev,et-16);ew[3]=""}else{ev.l+=et-16}return ew}function em(ev,et,es){var ey=ev.l;var er=bE(ev);var eu=bg(ev);var ew=[er,eu,"str"];if(es.cellFormula){var ex=dl(ev,ey+et-ev.l)}else{ev.l=ey+et}return ew}var bK=r;function b1(ev,et,er){var eu=ev.l+et;var es=r(ev,16);var ew=cr(ev);var ex=bg(ev);var ez=bg(ev);var ey=bg(ev);ev.l=eu;return{rfx:es,relId:ew,loc:ex,tooltip:ez,display:ey}}function t(eJ,eD,es){if(!eJ){return eJ}if(!es){es={"!id":{}}}var eE={};var ev;var ez={s:{r:1000000,c:1000000},e:{r:0,c:0}};var er=false,et=false;var ew,eG,eC,eu,eF,ex,eI,ey;var eB=[];H(eJ,function eH(eM,eL){if(et){return}switch(eL.n){case"BrtWsDim":ev=eM;break;case"BrtRowHdr":ew=eM;if(eD.sheetRows&&eD.sheetRows<=ew.r){et=true}ey=dB(ew.r);break;case"BrtFmlaBool":case"BrtFmlaError":case"BrtFmlaNum":case"BrtFmlaString":case"BrtCellBool":case"BrtCellError":case"BrtCellIsst":case"BrtCellReal":case"BrtCellRk":case"BrtCellSt":eG={t:eM[2]};switch(eM[2]){case"n":eG.v=eM[1];break;case"s":eI=aq[eM[1]];eG.v=eI.t;eG.r=eI.r;break;case"b":eG.v=eM[1]?true:false;break;case"e":eG.raw=eM[1];eG.v=aW[eG.raw];break;case"str":eG.v=c3(eM[1]);break}if(eD.cellFormula&&eM.length>3){eG.f=eM[3]}if((eC=cK.CellXf[eM[0].iStyleRef])){N(eG,eC.ifmt,null,eD)}eE[cD(eF=eM[0].c)+ey]=eG;if(ez.s.r>ew.r){ez.s.r=ew.r}if(ez.s.c>eF){ez.s.c=eF}if(ez.e.r<ew.r){ez.e.r=ew.r}if(ez.e.c<eF){ez.e.c=eF}break;case"BrtCellBlank":if(!eD.sheetStubs){break}eG={t:"str",v:undefined};eE[cD(eF=eM[0].c)+ey]=eG;if(ez.s.r>ew.r){ez.s.r=ew.r}if(ez.s.c>eF){ez.s.c=eF}if(ez.e.r<ew.r){ez.e.r=ew.r}if(ez.e.c<eF){ez.e.c=eF}break;case"BrtBeginMergeCells":break;case"BrtEndMergeCells":break;case"BrtMergeCell":eB.push(eM);break;case"BrtHLink":var eK=es["!id"][eM.relId];if(eK){eM.Target=eK.Target;if(eM.loc){eM.Target+="#"+eM.loc}eM.Rel=eK}for(eL=eM.rfx.s.r;eL<=eM.rfx.e.r;++eL){for(eF=eM.rfx.s.c;eF<=eM.rfx.e.c;++eF){ex=cF({c:eF,r:eL});if(!eE[ex]){eE[ex]={t:"str",v:undefined}}eE[ex].l=eM}}break;case"BrtArrFmla":break;case"BrtShrFmla":break;case"BrtBeginSheet":break;case"BrtWsProp":break;case"BrtSheetCalcProp":break;case"BrtBeginWsViews":break;case"BrtBeginWsView":break;case"BrtPane":break;case"BrtSel":break;case"BrtEndWsView":break;case"BrtEndWsViews":break;case"BrtACBegin":break;case"BrtRwDescent":break;case"BrtACEnd":break;case"BrtWsFmtInfoEx14":break;case"BrtWsFmtInfo":break;case"BrtBeginColInfos":break;case"BrtColInfo":break;case"BrtEndColInfos":break;case"BrtBeginSheetData":break;case"BrtEndSheetData":break;case"BrtSheetProtection":break;case"BrtPrintOptions":break;case"BrtMargins":break;case"BrtPageSetup":break;case"BrtFRTBegin":er=true;break;case"BrtFRTEnd":er=false;break;case"BrtEndSheet":break;case"BrtDrawing":break;case"BrtLegacyDrawing":break;case"BrtLegacyDrawingHF":break;case"BrtPhoneticInfo":break;case"BrtBeginHeaderFooter":break;case"BrtEndHeaderFooter":break;case"BrtBrk":break;case"BrtBeginRwBrk":break;case"BrtEndRwBrk":break;case"BrtBeginColBrk":break;case"BrtEndColBrk":break;case"BrtBeginUserShViews":break;case"BrtBeginUserShView":break;case"BrtEndUserShView":break;case"BrtEndUserShViews":break;case"BrtBkHim":break;case"BrtBeginOleObjects":break;case"BrtOleObject":break;case"BrtEndOleObjects":break;case"BrtBeginListParts":break;case"BrtListPart":break;case"BrtEndListParts":break;case"BrtBeginSortState":break;case"BrtBeginSortCond":break;case"BrtEndSortCond":break;case"BrtEndSortState":break;case"BrtBeginConditionalFormatting":break;case"BrtEndConditionalFormatting":break;case"BrtBeginCFRule":break;case"BrtEndCFRule":break;case"BrtBeginDVals":break;case"BrtDVal":break;case"BrtEndDVals":break;case"BrtRangeProtection":break;case"BrtBeginDCon":break;case"BrtEndDCon":break;case"BrtBeginDRefs":break;case"BrtDRef":break;case"BrtEndDRefs":break;case"BrtBeginActiveXControls":break;case"BrtActiveX":break;case"BrtEndActiveXControls":break;case"BrtBeginAFilter":break;case"BrtEndAFilter":break;case"BrtBeginFilterColumn":break;case"BrtBeginFilters":break;case"BrtFilter":break;case"BrtEndFilters":break;case"BrtEndFilterColumn":break;case"BrtDynamicFilter":break;case"BrtTop10Filter":break;case"BrtBeginCustomFilters":break;case"BrtCustomFilter":break;case"BrtEndCustomFilters":break;case"BrtBeginSmartTags":break;case"BrtBeginCellSmartTags":break;case"BrtBeginCellSmartTag":break;case"BrtCellSmartTagProperty":break;case"BrtEndCellSmartTag":break;case"BrtEndCellSmartTags":break;case"BrtEndSmartTags":break;case"BrtBeginCellWatches":break;case"BrtCellWatch":break;case"BrtEndCellWatches":break;case"BrtTable":break;case"BrtBeginCellIgnoreECs":break;case"BrtCellIgnoreEC":break;case"BrtEndCellIgnoreECs":break;default:if(!er||eD.WTF){throw new Error("Unexpected record "+eL.n)}}},eD);if(!eE["!ref"]&&(ez.s.r<1000000||ev.e.r>0||ev.e.c>0||ev.s.r>0||ev.s.c>0)){eE["!ref"]=bC(ev)}if(eD.sheetRows&&eE["!ref"]){var eA=c0(eE["!ref"]);if(eD.sheetRows<+eA.e.r){eA.e.r=eD.sheetRows-1;if(eA.e.r>ez.e.r){eA.e.r=ez.e.r}if(eA.e.r<eA.s.r){eA.s.r=eA.e.r}if(eA.e.c>ez.e.c){eA.e.c=ez.e.c}if(eA.e.c<eA.s.c){eA.s.c=eA.e.c}eE["!fullref"]=eE["!ref"];eE["!ref"]=bC(eA)}}if(eB.length>0){eE["!merges"]=eB}return eE}function b5(ex,er,es,ew,et){if(er.v===undefined){return""}var eu="";switch(er.t){case"b":eu=er.v?"1":"0";break;case"n":case"e":eu=""+er.v;break;default:eu=er.v;break}var ev={r:es,c:ew};ev.s=aR(et.cellXfs,er,et);switch(er.t){case"s":case"str":if(et.bookSST){eu=ds(et.Strings,er.v);ev.t="s";break}ev.t="str";break;case"n":break;case"b":ev.t="b";break;case"e":ev.t="e";break}cl(ex,"BrtCellBlank",I(er,ev))}function eo(ez,ey,eB,er,eu){var ex=c0(ey["!ref"]||"A1"),et,ev="",eA=[];cl(ez,"BrtBeginSheetData");for(var ew=ex.s.r;ew<=ex.e.r;++ew){ev=dB(ew);for(var es=ex.s.c;es<=ex.e.c;++es){if(ew===ex.s.r){eA[es]=cD(es)}et=eA[es]+ev;if(!ey[et]){continue}b5(ez,ey[et],ew,es,er)}}cl(ez,"BrtEndSheetData")}function d0(er,ev,ew){var ex=az();var et=ew.SheetNames[er],es=ew.Sheets[et]||{};var eu=c0(es["!ref"]||"A1");cl(ex,"BrtBeginSheet");cl(ex,"BrtWsDim",o(eu));eo(ex,es,er,ev,ew);cl(ex,"BrtEndSheet");return ex.end()}var ah=[["allowRefreshQuery","0"],["autoCompressPictures","1"],["backupFile","0"],["checkCompatibility","0"],["codeName",""],["date1904","0"],["dateCompatibility","1"],["filterPrivacy","0"],["hidePivotFieldList","0"],["promptedSolutions","0"],["publishItems","0"],["refreshAllConnections",false],["saveExternalLinkValues","1"],["showBorderUnselectedTables","1"],["showInkAnnotation","1"],["showObjects","all"],["showPivotChartFilter","0"]];var dt=[["activeTab","0"],["autoFilterDateGrouping","1"],["firstSheet","0"],["minimized","0"],["showHorizontalScroll","1"],["showSheetTabs","1"],["showVerticalScroll","1"],["tabRatio","600"],["visibility","visible"]];var B=[["state","visible"]];var av=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];var cx=[["autoUpdate","false"],["changesSavedWin","false"],["includeHiddenRowCol","true"],["includePrintSettings","true"],["maximized","false"],["minimized","false"],["onlySync","false"],["personalView","false"],["showComments","commIndicator"],["showFormulaBar","true"],["showHorizontalScroll","true"],["showObjects","all"],["showSheetTabs","true"],["showStatusbar","true"],["showVerticalScroll","true"],["tabRatio","600"],["xWindow","0"],["yWindow","0"]];function cG(ev,eu){for(var es=0;es!=ev.length;++es){var er=ev[es];for(var et=0;et!=eu.length;++et){var ew=eu[et];if(er[ew[0]]==null){er[ew[0]]=ew[1]}}}}function cb(et,es){for(var er=0;er!=es.length;++er){var eu=es[er];if(et[eu[0]]==null){et[eu[0]]=eu[1]}}}function aG(er){cb(er.WBProps,ah);cb(er.CalcPr,av);cG(er.WBView,dt);cG(er.Sheets,B);aO.date1904=dz(er.WBProps.date1904,"date1904")}var dx=/<\w+:workbook/;function b7(ev,et){var eu={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""};var es=false,ew="xmlns";ev.match(c9).forEach(function er(ex){var ey=aH(ex);switch(ce(ey[0])){case"<?xml":break;case"<workbook":if(ex.match(dx)){ew="xmlns"+ex.match(/<(\w+):/)[1]}eu.xmlns=ey[ew];break;case"</workbook>":break;case"<fileVersion":delete ey[0];eu.AppVersion=ey;break;case"<fileVersion/>":break;case"<fileSharing":case"<fileSharing/>":break;case"<workbookPr":delete ey[0];eu.WBProps=ey;break;case"<workbookPr/>":delete ey[0];eu.WBProps=ey;break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews>":case"</bookViews>":break;case"<workbookView":delete ey[0];eu.WBView.push(ey);break;case"<sheets>":case"</sheets>":break;case"<sheet":delete ey[0];ey.name=c3(ey.name);eu.Sheets.push(ey);break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":es=true;break;case"</definedNames>":es=false;break;case"<definedName":case"<definedName/>":case"</definedName>":break;case"<calcPr":delete ey[0];eu.CalcPr=ey;break;case"<calcPr/>":delete ey[0];eu.CalcPr=ey;break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":es=true;break;case"</ext>":es=false;break;case"<ArchID":break;case"<AlternateContent":es=true;break;case"</AlternateContent>":es=false;break;default:if(!es&&et.WTF){throw"unrecognized "+ey[0]+" in workbook"}}});if(cV.main.indexOf(eu.xmlns)===-1){throw new Error("Unknown Namespace: "+eu.xmlns)}aG(eu);return eu}var d9=dp("workbook",null,{xmlns:cV.main[0],"xmlns:r":cV.r});function en(er){try{return dz(er.Workbook.WBProps.date1904)?"true":"false"}catch(es){return"false"}}function bm(et,es){var eu=[cU];eu[eu.length]=d9;eu[eu.length]=(dp("workbookPr",null,{date1904:en(et)}));eu[eu.length]="<sheets>";for(var er=0;er!=et.SheetNames.length;++er){eu[eu.length]=(dp("sheet",null,{name:et.SheetNames[er].substr(0,31),sheetId:""+(er+1),"r:id":"rId"+(er+1)}))}eu[eu.length]="</sheets>";if(eu.length>2){eu[eu.length]="</workbook>";eu[1]=eu[1].replace("/>",">")}return eu.join("")}function dv(es,er){var et={};et.hsState=es.read_shift(4);et.iTabID=es.read_shift(4);et.strRelID=a0(es,er-8);et.name=bg(es);return et}function b9(er,es){if(!es){es=at(127)}es.write_shift(4,er.hsState);es.write_shift(4,er.iTabID);cI(er.strRelID,es);dJ(er.name.substr(0,31),es);return es}function eh(eu,et){eu.read_shift(4);var es=eu.read_shift(4);var er=(et>8)?bg(eu):"";return[es,er]}function a7(er,es){if(!es){es=at(8)}es.write_shift(4,0);es.write_shift(4,0);return es}function h(es,er){var et={};es.read_shift(4);et.ArchID=es.read_shift(4);es.l+=er-8;return et}function aC(ev,es){var eu={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""};var er=false,ew;H(ev,function et(ey,ex){switch(ex.n){case"BrtBundleSh":eu.Sheets.push(ey);break;case"BrtBeginBook":break;case"BrtFileVersion":break;case"BrtWbProp":break;case"BrtACBegin":break;case"BrtAbsPath15":break;case"BrtACEnd":break;case"BrtWbFactoid":break;case"BrtBookProtection":break;case"BrtBeginBookViews":break;case"BrtBookView":break;case"BrtEndBookViews":break;case"BrtBeginBundleShs":break;case"BrtEndBundleShs":break;case"BrtBeginFnGroup":break;case"BrtEndFnGroup":break;case"BrtBeginExternals":break;case"BrtSupSelf":break;case"BrtSupBookSrc":break;case"BrtExternSheet":break;case"BrtEndExternals":break;case"BrtName":break;case"BrtCalcProp":break;case"BrtUserBookView":break;case"BrtBeginPivotCacheIDs":break;case"BrtBeginPivotCacheID":break;case"BrtEndPivotCacheID":break;case"BrtEndPivotCacheIDs":break;case"BrtWebOpt":break;case"BrtFileRecover":break;case"BrtFileSharing":break;case"BrtBeginSmartTagTypes":break;case"BrtSmartTagType":break;case"BrtEndSmartTagTypes":break;case"BrtFRTBegin":er=true;break;case"BrtFRTArchID$":break;case"BrtWorkBookPr15":break;case"BrtFRTEnd":er=false;break;case"BrtEndBook":break;default:if(!er||es.WTF){throw new Error("Unexpected record "+ex.n)}}});aG(eu);return eu}function dD(ev,et,es){cl(ev,"BrtBeginBundleShs");for(var er=0;er!=et.SheetNames.length;++er){var eu={hsState:0,iTabID:er+1,strRelID:"rId"+(er+1),name:et.SheetNames[er]};cl(ev,"BrtBundleSh",b9(eu))}cl(ev,"BrtEndBundleShs")}function bL(es,et){if(!et){et=at(127)}for(var er=0;er!=4;++er){et.write_shift(4,0)}dJ("SheetJS",et);dJ(a1.version,et);dJ(a1.version,et);dJ("7262",et);et.length=et.l;return et}function dd(et,es,er){cl(et,"BrtBeginBookViews");cl(et,"BrtEndBookViews")}function de(er,es){if(!es){es=at(26)}es.write_shift(4,0);es.write_shift(4,1);es.write_shift(4,0);du(0,es);es.write_shift(-4,1023);es.write_shift(1,51);es.write_shift(1,0);return es}function eg(er,es){if(!es){es=at(1)}es.write_shift(1,0);return es}function x(es,er){var et=az();cl(et,"BrtBeginBook");cl(et,"BrtFileVersion",bL());cl(et,"BrtWbProp",a7());dd(et,es,er);dD(et,es,er);cl(et,"BrtCalcProp",de());cl(et,"BrtFileRecover",eg());cl(et,"BrtEndBook");return et.end()}function aI(et,er,es){return(er.substr(-4)===".bin"?aC:b7)(et,es)}function aD(eu,es,et,er){return(es.substr(-4)===".bin"?t:bi)(eu,et,er)}function bW(et,er,es){return(er.substr(-4)===".bin"?a2:ck)(et,es)}function c2(et,er,es){return g(et,es)}function ca(et,er,es){return(er.substr(-4)===".bin"?dr:v)(et,es)}function bv(et,er,es){return(er.substr(-4)===".bin"?bf:cB)(et,es)}function w(et,er,es){return(er.substr(-4)===".bin"?c4:ek)(et,es)}function d6(et,er,es){return(er.substr(-4)===".bin"?x:bm)(et,es)}function d1(eu,er,es,et){return(er.substr(-4)===".bin"?d0:an)(eu,es,et)}function aL(et,er,es){return(er.substr(-4)===".bin"?aA:b4)(et,es)}function a5(et,er,es){return(er.substr(-4)===".bin"?c6:ep)(et,es)}var aM={0:{n:"BrtRowHdr",f:di},1:{n:"BrtCellBlank",f:cw},2:{n:"BrtCellRk",f:bT},3:{n:"BrtCellError",f:a},4:{n:"BrtCellBool",f:d3},5:{n:"BrtCellReal",f:cg},6:{n:"BrtCellSt",f:bw},7:{n:"BrtCellIsst",f:dL},8:{n:"BrtFmlaString",f:em},9:{n:"BrtFmlaNum",f:M},10:{n:"BrtFmlaBool",f:bF},11:{n:"BrtFmlaError",f:bH},16:{n:"BrtFRTArchID$",f:h},19:{n:"BrtSSTItem",f:cA},20:{n:"BrtPCDIMissing",f:z},21:{n:"BrtPCDINumber",f:z},22:{n:"BrtPCDIBoolean",f:z},23:{n:"BrtPCDIError",f:z},24:{n:"BrtPCDIString",f:z},25:{n:"BrtPCDIDatetime",f:z},26:{n:"BrtPCDIIndex",f:z},27:{n:"BrtPCDIAMissing",f:z},28:{n:"BrtPCDIANumber",f:z},29:{n:"BrtPCDIABoolean",f:z},30:{n:"BrtPCDIAError",f:z},31:{n:"BrtPCDIAString",f:z},32:{n:"BrtPCDIADatetime",f:z},33:{n:"BrtPCRRecord",f:z},34:{n:"BrtPCRRecordDt",f:z},35:{n:"BrtFRTBegin",f:z},36:{n:"BrtFRTEnd",f:z},37:{n:"BrtACBegin",f:z},38:{n:"BrtACEnd",f:z},39:{n:"BrtName",f:z},40:{n:"BrtIndexRowBlock",f:z},42:{n:"BrtIndexBlock",f:z},43:{n:"BrtFont",f:aQ},44:{n:"BrtFmt",f:cC},45:{n:"BrtFill",f:z},46:{n:"BrtBorder",f:z},47:{n:"BrtXF",f:dK},48:{n:"BrtStyle",f:z},49:{n:"BrtCellMeta",f:z},50:{n:"BrtValueMeta",f:z},51:{n:"BrtMdb",f:z},52:{n:"BrtBeginFmd",f:z},53:{n:"BrtEndFmd",f:z},54:{n:"BrtBeginMdx",f:z},55:{n:"BrtEndMdx",f:z},56:{n:"BrtBeginMdxTuple",f:z},57:{n:"BrtEndMdxTuple",f:z},58:{n:"BrtMdxMbrIstr",f:z},59:{n:"BrtStr",f:z},60:{n:"BrtColInfo",f:z},62:{n:"BrtCellRString",f:z},63:{n:"BrtCalcChainItem$",f:cO},64:{n:"BrtDVal",f:z},65:{n:"BrtSxvcellNum",f:z},66:{n:"BrtSxvcellStr",f:z},67:{n:"BrtSxvcellBool",f:z},68:{n:"BrtSxvcellErr",f:z},69:{n:"BrtSxvcellDate",f:z},70:{n:"BrtSxvcellNil",f:z},128:{n:"BrtFileVersion",f:z},129:{n:"BrtBeginSheet",f:z},130:{n:"BrtEndSheet",f:z},131:{n:"BrtBeginBook",f:z,p:0},132:{n:"BrtEndBook",f:z},133:{n:"BrtBeginWsViews",f:z},134:{n:"BrtEndWsViews",f:z},135:{n:"BrtBeginBookViews",f:z},136:{n:"BrtEndBookViews",f:z},137:{n:"BrtBeginWsView",f:z},138:{n:"BrtEndWsView",f:z},139:{n:"BrtBeginCsViews",f:z},140:{n:"BrtEndCsViews",f:z},141:{n:"BrtBeginCsView",f:z},142:{n:"BrtEndCsView",f:z},143:{n:"BrtBeginBundleShs",f:z},144:{n:"BrtEndBundleShs",f:z},145:{n:"BrtBeginSheetData",f:z},146:{n:"BrtEndSheetData",f:z},147:{n:"BrtWsProp",f:dw},148:{n:"BrtWsDim",f:ax,p:16},151:{n:"BrtPane",f:z},152:{n:"BrtSel",f:z},153:{n:"BrtWbProp",f:eh},154:{n:"BrtWbFactoid",f:z},155:{n:"BrtFileRecover",f:z},156:{n:"BrtBundleSh",f:dv},157:{n:"BrtCalcProp",f:z},158:{n:"BrtBookView",f:z},159:{n:"BrtBeginSst",f:bp},160:{n:"BrtEndSst",f:z},161:{n:"BrtBeginAFilter",f:z},162:{n:"BrtEndAFilter",f:z},163:{n:"BrtBeginFilterColumn",f:z},164:{n:"BrtEndFilterColumn",f:z},165:{n:"BrtBeginFilters",f:z},166:{n:"BrtEndFilters",f:z},167:{n:"BrtFilter",f:z},168:{n:"BrtColorFilter",f:z},169:{n:"BrtIconFilter",f:z},170:{n:"BrtTop10Filter",f:z},171:{n:"BrtDynamicFilter",f:z},172:{n:"BrtBeginCustomFilters",f:z},173:{n:"BrtEndCustomFilters",f:z},174:{n:"BrtCustomFilter",f:z},175:{n:"BrtAFilterDateGroupItem",f:z},176:{n:"BrtMergeCell",f:bK},177:{n:"BrtBeginMergeCells",f:z},178:{n:"BrtEndMergeCells",f:z},179:{n:"BrtBeginPivotCacheDef",f:z},180:{n:"BrtEndPivotCacheDef",f:z},181:{n:"BrtBeginPCDFields",f:z},182:{n:"BrtEndPCDFields",f:z},183:{n:"BrtBeginPCDField",f:z},184:{n:"BrtEndPCDField",f:z},185:{n:"BrtBeginPCDSource",f:z},186:{n:"BrtEndPCDSource",f:z},187:{n:"BrtBeginPCDSRange",f:z},188:{n:"BrtEndPCDSRange",f:z},189:{n:"BrtBeginPCDFAtbl",f:z},190:{n:"BrtEndPCDFAtbl",f:z},191:{n:"BrtBeginPCDIRun",f:z},192:{n:"BrtEndPCDIRun",f:z},193:{n:"BrtBeginPivotCacheRecords",f:z},194:{n:"BrtEndPivotCacheRecords",f:z},195:{n:"BrtBeginPCDHierarchies",f:z},196:{n:"BrtEndPCDHierarchies",f:z},197:{n:"BrtBeginPCDHierarchy",f:z},198:{n:"BrtEndPCDHierarchy",f:z},199:{n:"BrtBeginPCDHFieldsUsage",f:z},200:{n:"BrtEndPCDHFieldsUsage",f:z},201:{n:"BrtBeginExtConnection",f:z},202:{n:"BrtEndExtConnection",f:z},203:{n:"BrtBeginECDbProps",f:z},204:{n:"BrtEndECDbProps",f:z},205:{n:"BrtBeginECOlapProps",f:z},206:{n:"BrtEndECOlapProps",f:z},207:{n:"BrtBeginPCDSConsol",f:z},208:{n:"BrtEndPCDSConsol",f:z},209:{n:"BrtBeginPCDSCPages",f:z},210:{n:"BrtEndPCDSCPages",f:z},211:{n:"BrtBeginPCDSCPage",f:z},212:{n:"BrtEndPCDSCPage",f:z},213:{n:"BrtBeginPCDSCPItem",f:z},214:{n:"BrtEndPCDSCPItem",f:z},215:{n:"BrtBeginPCDSCSets",f:z},216:{n:"BrtEndPCDSCSets",f:z},217:{n:"BrtBeginPCDSCSet",f:z},218:{n:"BrtEndPCDSCSet",f:z},219:{n:"BrtBeginPCDFGroup",f:z},220:{n:"BrtEndPCDFGroup",f:z},221:{n:"BrtBeginPCDFGItems",f:z},222:{n:"BrtEndPCDFGItems",f:z},223:{n:"BrtBeginPCDFGRange",f:z},224:{n:"BrtEndPCDFGRange",f:z},225:{n:"BrtBeginPCDFGDiscrete",f:z},226:{n:"BrtEndPCDFGDiscrete",f:z},227:{n:"BrtBeginPCDSDTupleCache",f:z},228:{n:"BrtEndPCDSDTupleCache",f:z},229:{n:"BrtBeginPCDSDTCEntries",f:z},230:{n:"BrtEndPCDSDTCEntries",f:z},231:{n:"BrtBeginPCDSDTCEMembers",f:z},232:{n:"BrtEndPCDSDTCEMembers",f:z},233:{n:"BrtBeginPCDSDTCEMember",f:z},234:{n:"BrtEndPCDSDTCEMember",f:z},235:{n:"BrtBeginPCDSDTCQueries",f:z},236:{n:"BrtEndPCDSDTCQueries",f:z},237:{n:"BrtBeginPCDSDTCQuery",f:z},238:{n:"BrtEndPCDSDTCQuery",f:z},239:{n:"BrtBeginPCDSDTCSets",f:z},240:{n:"BrtEndPCDSDTCSets",f:z},241:{n:"BrtBeginPCDSDTCSet",f:z},242:{n:"BrtEndPCDSDTCSet",f:z},243:{n:"BrtBeginPCDCalcItems",f:z},244:{n:"BrtEndPCDCalcItems",f:z},245:{n:"BrtBeginPCDCalcItem",f:z},246:{n:"BrtEndPCDCalcItem",f:z},247:{n:"BrtBeginPRule",f:z},248:{n:"BrtEndPRule",f:z},249:{n:"BrtBeginPRFilters",f:z},250:{n:"BrtEndPRFilters",f:z},251:{n:"BrtBeginPRFilter",f:z},252:{n:"BrtEndPRFilter",f:z},253:{n:"BrtBeginPNames",f:z},254:{n:"BrtEndPNames",f:z},255:{n:"BrtBeginPName",f:z},256:{n:"BrtEndPName",f:z},257:{n:"BrtBeginPNPairs",f:z},258:{n:"BrtEndPNPairs",f:z},259:{n:"BrtBeginPNPair",f:z},260:{n:"BrtEndPNPair",f:z},261:{n:"BrtBeginECWebProps",f:z},262:{n:"BrtEndECWebProps",f:z},263:{n:"BrtBeginEcWpTables",f:z},264:{n:"BrtEndECWPTables",f:z},265:{n:"BrtBeginECParams",f:z},266:{n:"BrtEndECParams",f:z},267:{n:"BrtBeginECParam",f:z},268:{n:"BrtEndECParam",f:z},269:{n:"BrtBeginPCDKPIs",f:z},270:{n:"BrtEndPCDKPIs",f:z},271:{n:"BrtBeginPCDKPI",f:z},272:{n:"BrtEndPCDKPI",f:z},273:{n:"BrtBeginDims",f:z},274:{n:"BrtEndDims",f:z},275:{n:"BrtBeginDim",f:z},276:{n:"BrtEndDim",f:z},277:{n:"BrtIndexPartEnd",f:z},278:{n:"BrtBeginStyleSheet",f:z},279:{n:"BrtEndStyleSheet",f:z},280:{n:"BrtBeginSXView",f:z},281:{n:"BrtEndSXVI",f:z},282:{n:"BrtBeginSXVI",f:z},283:{n:"BrtBeginSXVIs",f:z},284:{n:"BrtEndSXVIs",f:z},285:{n:"BrtBeginSXVD",f:z},286:{n:"BrtEndSXVD",f:z},287:{n:"BrtBeginSXVDs",f:z},288:{n:"BrtEndSXVDs",f:z},289:{n:"BrtBeginSXPI",f:z},290:{n:"BrtEndSXPI",f:z},291:{n:"BrtBeginSXPIs",f:z},292:{n:"BrtEndSXPIs",f:z},293:{n:"BrtBeginSXDI",f:z},294:{n:"BrtEndSXDI",f:z},295:{n:"BrtBeginSXDIs",f:z},296:{n:"BrtEndSXDIs",f:z},297:{n:"BrtBeginSXLI",f:z},298:{n:"BrtEndSXLI",f:z},299:{n:"BrtBeginSXLIRws",f:z},300:{n:"BrtEndSXLIRws",f:z},301:{n:"BrtBeginSXLICols",f:z},302:{n:"BrtEndSXLICols",f:z},303:{n:"BrtBeginSXFormat",f:z},304:{n:"BrtEndSXFormat",f:z},305:{n:"BrtBeginSXFormats",f:z},306:{n:"BrtEndSxFormats",f:z},307:{n:"BrtBeginSxSelect",f:z},308:{n:"BrtEndSxSelect",f:z},309:{n:"BrtBeginISXVDRws",f:z},310:{n:"BrtEndISXVDRws",f:z},311:{n:"BrtBeginISXVDCols",f:z},312:{n:"BrtEndISXVDCols",f:z},313:{n:"BrtEndSXLocation",f:z},314:{n:"BrtBeginSXLocation",f:z},315:{n:"BrtEndSXView",f:z},316:{n:"BrtBeginSXTHs",f:z},317:{n:"BrtEndSXTHs",f:z},318:{n:"BrtBeginSXTH",f:z},319:{n:"BrtEndSXTH",f:z},320:{n:"BrtBeginISXTHRws",f:z},321:{n:"BrtEndISXTHRws",f:z},322:{n:"BrtBeginISXTHCols",f:z},323:{n:"BrtEndISXTHCols",f:z},324:{n:"BrtBeginSXTDMPS",f:z},325:{n:"BrtEndSXTDMPs",f:z},326:{n:"BrtBeginSXTDMP",f:z},327:{n:"BrtEndSXTDMP",f:z},328:{n:"BrtBeginSXTHItems",f:z},329:{n:"BrtEndSXTHItems",f:z},330:{n:"BrtBeginSXTHItem",f:z},331:{n:"BrtEndSXTHItem",f:z},332:{n:"BrtBeginMetadata",f:z},333:{n:"BrtEndMetadata",f:z},334:{n:"BrtBeginEsmdtinfo",f:z},335:{n:"BrtMdtinfo",f:z},336:{n:"BrtEndEsmdtinfo",f:z},337:{n:"BrtBeginEsmdb",f:z},338:{n:"BrtEndEsmdb",f:z},339:{n:"BrtBeginEsfmd",f:z},340:{n:"BrtEndEsfmd",f:z},341:{n:"BrtBeginSingleCells",f:z},342:{n:"BrtEndSingleCells",f:z},343:{n:"BrtBeginList",f:z},344:{n:"BrtEndList",f:z},345:{n:"BrtBeginListCols",f:z},346:{n:"BrtEndListCols",f:z},347:{n:"BrtBeginListCol",f:z},348:{n:"BrtEndListCol",f:z},349:{n:"BrtBeginListXmlCPr",f:z},350:{n:"BrtEndListXmlCPr",f:z},351:{n:"BrtListCCFmla",f:z},352:{n:"BrtListTrFmla",f:z},353:{n:"BrtBeginExternals",f:z},354:{n:"BrtEndExternals",f:z},355:{n:"BrtSupBookSrc",f:z},357:{n:"BrtSupSelf",f:z},358:{n:"BrtSupSame",f:z},359:{n:"BrtSupTabs",f:z},360:{n:"BrtBeginSupBook",f:z},361:{n:"BrtPlaceholderName",f:z},362:{n:"BrtExternSheet",f:z},363:{n:"BrtExternTableStart",f:z},364:{n:"BrtExternTableEnd",f:z},366:{n:"BrtExternRowHdr",f:z},367:{n:"BrtExternCellBlank",f:z},368:{n:"BrtExternCellReal",f:z},369:{n:"BrtExternCellBool",f:z},370:{n:"BrtExternCellError",f:z},371:{n:"BrtExternCellString",f:z},372:{n:"BrtBeginEsmdx",f:z},373:{n:"BrtEndEsmdx",f:z},374:{n:"BrtBeginMdxSet",f:z},375:{n:"BrtEndMdxSet",f:z},376:{n:"BrtBeginMdxMbrProp",f:z},377:{n:"BrtEndMdxMbrProp",f:z},378:{n:"BrtBeginMdxKPI",f:z},379:{n:"BrtEndMdxKPI",f:z},380:{n:"BrtBeginEsstr",f:z},381:{n:"BrtEndEsstr",f:z},382:{n:"BrtBeginPRFItem",f:z},383:{n:"BrtEndPRFItem",f:z},384:{n:"BrtBeginPivotCacheIDs",f:z},385:{n:"BrtEndPivotCacheIDs",f:z},386:{n:"BrtBeginPivotCacheID",f:z},387:{n:"BrtEndPivotCacheID",f:z},388:{n:"BrtBeginISXVIs",f:z},389:{n:"BrtEndISXVIs",f:z},390:{n:"BrtBeginColInfos",f:z},391:{n:"BrtEndColInfos",f:z},392:{n:"BrtBeginRwBrk",f:z},393:{n:"BrtEndRwBrk",f:z},394:{n:"BrtBeginColBrk",f:z},395:{n:"BrtEndColBrk",f:z},396:{n:"BrtBrk",f:z},397:{n:"BrtUserBookView",f:z},398:{n:"BrtInfo",f:z},399:{n:"BrtCUsr",f:z},400:{n:"BrtUsr",f:z},401:{n:"BrtBeginUsers",f:z},403:{n:"BrtEOF",f:z},404:{n:"BrtUCR",f:z},405:{n:"BrtRRInsDel",f:z},406:{n:"BrtRREndInsDel",f:z},407:{n:"BrtRRMove",f:z},408:{n:"BrtRREndMove",f:z},409:{n:"BrtRRChgCell",f:z},410:{n:"BrtRREndChgCell",f:z},411:{n:"BrtRRHeader",f:z},412:{n:"BrtRRUserView",f:z},413:{n:"BrtRRRenSheet",f:z},414:{n:"BrtRRInsertSh",f:z},415:{n:"BrtRRDefName",f:z},416:{n:"BrtRRNote",f:z},417:{n:"BrtRRConflict",f:z},418:{n:"BrtRRTQSIF",f:z},419:{n:"BrtRRFormat",f:z},420:{n:"BrtRREndFormat",f:z},421:{n:"BrtRRAutoFmt",f:z},422:{n:"BrtBeginUserShViews",f:z},423:{n:"BrtBeginUserShView",f:z},424:{n:"BrtEndUserShView",f:z},425:{n:"BrtEndUserShViews",f:z},426:{n:"BrtArrFmla",f:z},427:{n:"BrtShrFmla",f:z},428:{n:"BrtTable",f:z},429:{n:"BrtBeginExtConnections",f:z},430:{n:"BrtEndExtConnections",f:z},431:{n:"BrtBeginPCDCalcMems",f:z},432:{n:"BrtEndPCDCalcMems",f:z},433:{n:"BrtBeginPCDCalcMem",f:z},434:{n:"BrtEndPCDCalcMem",f:z},435:{n:"BrtBeginPCDHGLevels",f:z},436:{n:"BrtEndPCDHGLevels",f:z},437:{n:"BrtBeginPCDHGLevel",f:z},438:{n:"BrtEndPCDHGLevel",f:z},439:{n:"BrtBeginPCDHGLGroups",f:z},440:{n:"BrtEndPCDHGLGroups",f:z},441:{n:"BrtBeginPCDHGLGroup",f:z},442:{n:"BrtEndPCDHGLGroup",f:z},443:{n:"BrtBeginPCDHGLGMembers",f:z},444:{n:"BrtEndPCDHGLGMembers",f:z},445:{n:"BrtBeginPCDHGLGMember",f:z},446:{n:"BrtEndPCDHGLGMember",f:z},447:{n:"BrtBeginQSI",f:z},448:{n:"BrtEndQSI",f:z},449:{n:"BrtBeginQSIR",f:z},450:{n:"BrtEndQSIR",f:z},451:{n:"BrtBeginDeletedNames",f:z},452:{n:"BrtEndDeletedNames",f:z},453:{n:"BrtBeginDeletedName",f:z},454:{n:"BrtEndDeletedName",f:z},455:{n:"BrtBeginQSIFs",f:z},456:{n:"BrtEndQSIFs",f:z},457:{n:"BrtBeginQSIF",f:z},458:{n:"BrtEndQSIF",f:z},459:{n:"BrtBeginAutoSortScope",f:z},460:{n:"BrtEndAutoSortScope",f:z},461:{n:"BrtBeginConditionalFormatting",f:z},462:{n:"BrtEndConditionalFormatting",f:z},463:{n:"BrtBeginCFRule",f:z},464:{n:"BrtEndCFRule",f:z},465:{n:"BrtBeginIconSet",f:z},466:{n:"BrtEndIconSet",f:z},467:{n:"BrtBeginDatabar",f:z},468:{n:"BrtEndDatabar",f:z},469:{n:"BrtBeginColorScale",f:z},470:{n:"BrtEndColorScale",f:z},471:{n:"BrtCFVO",f:z},472:{n:"BrtExternValueMeta",f:z},473:{n:"BrtBeginColorPalette",f:z},474:{n:"BrtEndColorPalette",f:z},475:{n:"BrtIndexedColor",f:z},476:{n:"BrtMargins",f:z},477:{n:"BrtPrintOptions",f:z},478:{n:"BrtPageSetup",f:z},479:{n:"BrtBeginHeaderFooter",f:z},480:{n:"BrtEndHeaderFooter",f:z},481:{n:"BrtBeginSXCrtFormat",f:z},482:{n:"BrtEndSXCrtFormat",f:z},483:{n:"BrtBeginSXCrtFormats",f:z},484:{n:"BrtEndSXCrtFormats",f:z},485:{n:"BrtWsFmtInfo",f:z},486:{n:"BrtBeginMgs",f:z},487:{n:"BrtEndMGs",f:z},488:{n:"BrtBeginMGMaps",f:z},489:{n:"BrtEndMGMaps",f:z},490:{n:"BrtBeginMG",f:z},491:{n:"BrtEndMG",f:z},492:{n:"BrtBeginMap",f:z},493:{n:"BrtEndMap",f:z},494:{n:"BrtHLink",f:b1},495:{n:"BrtBeginDCon",f:z},496:{n:"BrtEndDCon",f:z},497:{n:"BrtBeginDRefs",f:z},498:{n:"BrtEndDRefs",f:z},499:{n:"BrtDRef",f:z},500:{n:"BrtBeginScenMan",f:z},501:{n:"BrtEndScenMan",f:z},502:{n:"BrtBeginSct",f:z},503:{n:"BrtEndSct",f:z},504:{n:"BrtSlc",f:z},505:{n:"BrtBeginDXFs",f:z},506:{n:"BrtEndDXFs",f:z},507:{n:"BrtDXF",f:z},508:{n:"BrtBeginTableStyles",f:z},509:{n:"BrtEndTableStyles",f:z},510:{n:"BrtBeginTableStyle",f:z},511:{n:"BrtEndTableStyle",f:z},512:{n:"BrtTableStyleElement",f:z},513:{n:"BrtTableStyleClient",f:z},514:{n:"BrtBeginVolDeps",f:z},515:{n:"BrtEndVolDeps",f:z},516:{n:"BrtBeginVolType",f:z},517:{n:"BrtEndVolType",f:z},518:{n:"BrtBeginVolMain",f:z},519:{n:"BrtEndVolMain",f:z},520:{n:"BrtBeginVolTopic",f:z},521:{n:"BrtEndVolTopic",f:z},522:{n:"BrtVolSubtopic",f:z},523:{n:"BrtVolRef",f:z},524:{n:"BrtVolNum",f:z},525:{n:"BrtVolErr",f:z},526:{n:"BrtVolStr",f:z},527:{n:"BrtVolBool",f:z},528:{n:"BrtBeginCalcChain$",f:z},529:{n:"BrtEndCalcChain$",f:z},530:{n:"BrtBeginSortState",f:z},531:{n:"BrtEndSortState",f:z},532:{n:"BrtBeginSortCond",f:z},533:{n:"BrtEndSortCond",f:z},534:{n:"BrtBookProtection",f:z},535:{n:"BrtSheetProtection",f:z},536:{n:"BrtRangeProtection",f:z},537:{n:"BrtPhoneticInfo",f:z},538:{n:"BrtBeginECTxtWiz",f:z},539:{n:"BrtEndECTxtWiz",f:z},540:{n:"BrtBeginECTWFldInfoLst",f:z},541:{n:"BrtEndECTWFldInfoLst",f:z},542:{n:"BrtBeginECTwFldInfo",f:z},548:{n:"BrtFileSharing",f:z},549:{n:"BrtOleSize",f:z},550:{n:"BrtDrawing",f:z},551:{n:"BrtLegacyDrawing",f:z},552:{n:"BrtLegacyDrawingHF",f:z},553:{n:"BrtWebOpt",f:z},554:{n:"BrtBeginWebPubItems",f:z},555:{n:"BrtEndWebPubItems",f:z},556:{n:"BrtBeginWebPubItem",f:z},557:{n:"BrtEndWebPubItem",f:z},558:{n:"BrtBeginSXCondFmt",f:z},559:{n:"BrtEndSXCondFmt",f:z},560:{n:"BrtBeginSXCondFmts",f:z},561:{n:"BrtEndSXCondFmts",f:z},562:{n:"BrtBkHim",f:z},564:{n:"BrtColor",f:z},565:{n:"BrtBeginIndexedColors",f:z},566:{n:"BrtEndIndexedColors",f:z},569:{n:"BrtBeginMRUColors",f:z},570:{n:"BrtEndMRUColors",f:z},572:{n:"BrtMRUColor",f:z},573:{n:"BrtBeginDVals",f:z},574:{n:"BrtEndDVals",f:z},577:{n:"BrtSupNameStart",f:z},578:{n:"BrtSupNameValueStart",f:z},579:{n:"BrtSupNameValueEnd",f:z},580:{n:"BrtSupNameNum",f:z},581:{n:"BrtSupNameErr",f:z},582:{n:"BrtSupNameSt",f:z},583:{n:"BrtSupNameNil",f:z},584:{n:"BrtSupNameBool",f:z},585:{n:"BrtSupNameFmla",f:z},586:{n:"BrtSupNameBits",f:z},587:{n:"BrtSupNameEnd",f:z},588:{n:"BrtEndSupBook",f:z},589:{n:"BrtCellSmartTagProperty",f:z},590:{n:"BrtBeginCellSmartTag",f:z},591:{n:"BrtEndCellSmartTag",f:z},592:{n:"BrtBeginCellSmartTags",f:z},593:{n:"BrtEndCellSmartTags",f:z},594:{n:"BrtBeginSmartTags",f:z},595:{n:"BrtEndSmartTags",f:z},596:{n:"BrtSmartTagType",f:z},597:{n:"BrtBeginSmartTagTypes",f:z},598:{n:"BrtEndSmartTagTypes",f:z},599:{n:"BrtBeginSXFilters",f:z},600:{n:"BrtEndSXFilters",f:z},601:{n:"BrtBeginSXFILTER",f:z},602:{n:"BrtEndSXFilter",f:z},603:{n:"BrtBeginFills",f:z},604:{n:"BrtEndFills",f:z},605:{n:"BrtBeginCellWatches",f:z},606:{n:"BrtEndCellWatches",f:z},607:{n:"BrtCellWatch",f:z},608:{n:"BrtBeginCRErrs",f:z},609:{n:"BrtEndCRErrs",f:z},610:{n:"BrtCrashRecErr",f:z},611:{n:"BrtBeginFonts",f:z},612:{n:"BrtEndFonts",f:z},613:{n:"BrtBeginBorders",f:z},614:{n:"BrtEndBorders",f:z},615:{n:"BrtBeginFmts",f:z},616:{n:"BrtEndFmts",f:z},617:{n:"BrtBeginCellXFs",f:z},618:{n:"BrtEndCellXFs",f:z},619:{n:"BrtBeginStyles",f:z},620:{n:"BrtEndStyles",f:z},625:{n:"BrtBigName",f:z},626:{n:"BrtBeginCellStyleXFs",f:z},627:{n:"BrtEndCellStyleXFs",f:z},628:{n:"BrtBeginComments",f:z},629:{n:"BrtEndComments",f:z},630:{n:"BrtBeginCommentAuthors",f:z},631:{n:"BrtEndCommentAuthors",f:z},632:{n:"BrtCommentAuthor",f:dG},633:{n:"BrtBeginCommentList",f:z},634:{n:"BrtEndCommentList",f:z},635:{n:"BrtBeginComment",f:c},636:{n:"BrtEndComment",f:z},637:{n:"BrtCommentText",f:dC},638:{n:"BrtBeginOleObjects",f:z},639:{n:"BrtOleObject",f:z},640:{n:"BrtEndOleObjects",f:z},641:{n:"BrtBeginSxrules",f:z},642:{n:"BrtEndSxRules",f:z},643:{n:"BrtBeginActiveXControls",f:z},644:{n:"BrtActiveX",f:z},645:{n:"BrtEndActiveXControls",f:z},646:{n:"BrtBeginPCDSDTCEMembersSortBy",f:z},648:{n:"BrtBeginCellIgnoreECs",f:z},649:{n:"BrtCellIgnoreEC",f:z},650:{n:"BrtEndCellIgnoreECs",f:z},651:{n:"BrtCsProp",f:z},652:{n:"BrtCsPageSetup",f:z},653:{n:"BrtBeginUserCsViews",f:z},654:{n:"BrtEndUserCsViews",f:z},655:{n:"BrtBeginUserCsView",f:z},656:{n:"BrtEndUserCsView",f:z},657:{n:"BrtBeginPcdSFCIEntries",f:z},658:{n:"BrtEndPCDSFCIEntries",f:z},659:{n:"BrtPCDSFCIEntry",f:z},660:{n:"BrtBeginListParts",f:z},661:{n:"BrtListPart",f:z},662:{n:"BrtEndListParts",f:z},663:{n:"BrtSheetCalcProp",f:z},664:{n:"BrtBeginFnGroup",f:z},665:{n:"BrtFnGroup",f:z},666:{n:"BrtEndFnGroup",f:z},667:{n:"BrtSupAddin",f:z},668:{n:"BrtSXTDMPOrder",f:z},669:{n:"BrtCsProtection",f:z},671:{n:"BrtBeginWsSortMap",f:z},672:{n:"BrtEndWsSortMap",f:z},673:{n:"BrtBeginRRSort",f:z},674:{n:"BrtEndRRSort",f:z},675:{n:"BrtRRSortItem",f:z},676:{n:"BrtFileSharingIso",f:z},677:{n:"BrtBookProtectionIso",f:z},678:{n:"BrtSheetProtectionIso",f:z},679:{n:"BrtCsProtectionIso",f:z},680:{n:"BrtRangeProtectionIso",f:z},1024:{n:"BrtRwDescent",f:z},1025:{n:"BrtKnownFonts",f:z},1026:{n:"BrtBeginSXTupleSet",f:z},1027:{n:"BrtEndSXTupleSet",f:z},1028:{n:"BrtBeginSXTupleSetHeader",f:z},1029:{n:"BrtEndSXTupleSetHeader",f:z},1030:{n:"BrtSXTupleSetHeaderItem",f:z},1031:{n:"BrtBeginSXTupleSetData",f:z},1032:{n:"BrtEndSXTupleSetData",f:z},1033:{n:"BrtBeginSXTupleSetRow",f:z},1034:{n:"BrtEndSXTupleSetRow",f:z},1035:{n:"BrtSXTupleSetRowItem",f:z},1036:{n:"BrtNameExt",f:z},1037:{n:"BrtPCDH14",f:z},1038:{n:"BrtBeginPCDCalcMem14",f:z},1039:{n:"BrtEndPCDCalcMem14",f:z},1040:{n:"BrtSXTH14",f:z},1041:{n:"BrtBeginSparklineGroup",f:z},1042:{n:"BrtEndSparklineGroup",f:z},1043:{n:"BrtSparkline",f:z},1044:{n:"BrtSXDI14",f:z},1045:{n:"BrtWsFmtInfoEx14",f:z},1046:{n:"BrtBeginConditionalFormatting14",f:z},1047:{n:"BrtEndConditionalFormatting14",f:z},1048:{n:"BrtBeginCFRule14",f:z},1049:{n:"BrtEndCFRule14",f:z},1050:{n:"BrtCFVO14",f:z},1051:{n:"BrtBeginDatabar14",f:z},1052:{n:"BrtBeginIconSet14",f:z},1053:{n:"BrtDVal14",f:z},1054:{n:"BrtBeginDVals14",f:z},1055:{n:"BrtColor14",f:z},1056:{n:"BrtBeginSparklines",f:z},1057:{n:"BrtEndSparklines",f:z},1058:{n:"BrtBeginSparklineGroups",f:z},1059:{n:"BrtEndSparklineGroups",f:z},1061:{n:"BrtSXVD14",f:z},1062:{n:"BrtBeginSxview14",f:z},1063:{n:"BrtEndSxview14",f:z},1066:{n:"BrtBeginPCD14",f:z},1067:{n:"BrtEndPCD14",f:z},1068:{n:"BrtBeginExtConn14",f:z},1069:{n:"BrtEndExtConn14",f:z},1070:{n:"BrtBeginSlicerCacheIDs",f:z},1071:{n:"BrtEndSlicerCacheIDs",f:z},1072:{n:"BrtBeginSlicerCacheID",f:z},1073:{n:"BrtEndSlicerCacheID",f:z},1075:{n:"BrtBeginSlicerCache",f:z},1076:{n:"BrtEndSlicerCache",f:z},1077:{n:"BrtBeginSlicerCacheDef",f:z},1078:{n:"BrtEndSlicerCacheDef",f:z},1079:{n:"BrtBeginSlicersEx",f:z},1080:{n:"BrtEndSlicersEx",f:z},1081:{n:"BrtBeginSlicerEx",f:z},1082:{n:"BrtEndSlicerEx",f:z},1083:{n:"BrtBeginSlicer",f:z},1084:{n:"BrtEndSlicer",f:z},1085:{n:"BrtSlicerCachePivotTables",f:z},1086:{n:"BrtBeginSlicerCacheOlapImpl",f:z},1087:{n:"BrtEndSlicerCacheOlapImpl",f:z},1088:{n:"BrtBeginSlicerCacheLevelsData",f:z},1089:{n:"BrtEndSlicerCacheLevelsData",f:z},1090:{n:"BrtBeginSlicerCacheLevelData",f:z},1091:{n:"BrtEndSlicerCacheLevelData",f:z},1092:{n:"BrtBeginSlicerCacheSiRanges",f:z},1093:{n:"BrtEndSlicerCacheSiRanges",f:z},1094:{n:"BrtBeginSlicerCacheSiRange",f:z},1095:{n:"BrtEndSlicerCacheSiRange",f:z},1096:{n:"BrtSlicerCacheOlapItem",f:z},1097:{n:"BrtBeginSlicerCacheSelections",f:z},1098:{n:"BrtSlicerCacheSelection",f:z},1099:{n:"BrtEndSlicerCacheSelections",f:z},1100:{n:"BrtBeginSlicerCacheNative",f:z},1101:{n:"BrtEndSlicerCacheNative",f:z},1102:{n:"BrtSlicerCacheNativeItem",f:z},1103:{n:"BrtRangeProtection14",f:z},1104:{n:"BrtRangeProtectionIso14",f:z},1105:{n:"BrtCellIgnoreEC14",f:z},1111:{n:"BrtList14",f:z},1112:{n:"BrtCFIcon",f:z},1113:{n:"BrtBeginSlicerCachesPivotCacheIDs",f:z},1114:{n:"BrtEndSlicerCachesPivotCacheIDs",f:z},1115:{n:"BrtBeginSlicers",f:z},1116:{n:"BrtEndSlicers",f:z},1117:{n:"BrtWbProp14",f:z},1118:{n:"BrtBeginSXEdit",f:z},1119:{n:"BrtEndSXEdit",f:z},1120:{n:"BrtBeginSXEdits",f:z},1121:{n:"BrtEndSXEdits",f:z},1122:{n:"BrtBeginSXChange",f:z},1123:{n:"BrtEndSXChange",f:z},1124:{n:"BrtBeginSXChanges",f:z},1125:{n:"BrtEndSXChanges",f:z},1126:{n:"BrtSXTupleItems",f:z},1128:{n:"BrtBeginSlicerStyle",f:z},1129:{n:"BrtEndSlicerStyle",f:z},1130:{n:"BrtSlicerStyleElement",f:z},1131:{n:"BrtBeginStyleSheetExt14",f:z},1132:{n:"BrtEndStyleSheetExt14",f:z},1133:{n:"BrtBeginSlicerCachesPivotCacheID",f:z},1134:{n:"BrtEndSlicerCachesPivotCacheID",f:z},1135:{n:"BrtBeginConditionalFormattings",f:z},1136:{n:"BrtEndConditionalFormattings",f:z},1137:{n:"BrtBeginPCDCalcMemExt",f:z},1138:{n:"BrtEndPCDCalcMemExt",f:z},1139:{n:"BrtBeginPCDCalcMemsExt",f:z},1140:{n:"BrtEndPCDCalcMemsExt",f:z},1141:{n:"BrtPCDField14",f:z},1142:{n:"BrtBeginSlicerStyles",f:z},1143:{n:"BrtEndSlicerStyles",f:z},1144:{n:"BrtBeginSlicerStyleElements",f:z},1145:{n:"BrtEndSlicerStyleElements",f:z},1146:{n:"BrtCFRuleExt",f:z},1147:{n:"BrtBeginSXCondFmt14",f:z},1148:{n:"BrtEndSXCondFmt14",f:z},1149:{n:"BrtBeginSXCondFmts14",f:z},1150:{n:"BrtEndSXCondFmts14",f:z},1152:{n:"BrtBeginSortCond14",f:z},1153:{n:"BrtEndSortCond14",f:z},1154:{n:"BrtEndDVals14",f:z},1155:{n:"BrtEndIconSet14",f:z},1156:{n:"BrtEndDatabar14",f:z},1157:{n:"BrtBeginColorScale14",f:z},1158:{n:"BrtEndColorScale14",f:z},1159:{n:"BrtBeginSxrules14",f:z},1160:{n:"BrtEndSxrules14",f:z},1161:{n:"BrtBeginPRule14",f:z},1162:{n:"BrtEndPRule14",f:z},1163:{n:"BrtBeginPRFilters14",f:z},1164:{n:"BrtEndPRFilters14",f:z},1165:{n:"BrtBeginPRFilter14",f:z},1166:{n:"BrtEndPRFilter14",f:z},1167:{n:"BrtBeginPRFItem14",f:z},1168:{n:"BrtEndPRFItem14",f:z},1169:{n:"BrtBeginCellIgnoreECs14",f:z},1170:{n:"BrtEndCellIgnoreECs14",f:z},1171:{n:"BrtDxf14",f:z},1172:{n:"BrtBeginDxF14s",f:z},1173:{n:"BrtEndDxf14s",f:z},1177:{n:"BrtFilter14",f:z},1178:{n:"BrtBeginCustomFilters14",f:z},1180:{n:"BrtCustomFilter14",f:z},1181:{n:"BrtIconFilter14",f:z},1182:{n:"BrtPivotCacheConnectionName",f:z},2048:{n:"BrtBeginDecoupledPivotCacheIDs",f:z},2049:{n:"BrtEndDecoupledPivotCacheIDs",f:z},2050:{n:"BrtDecoupledPivotCacheID",f:z},2051:{n:"BrtBeginPivotTableRefs",f:z},2052:{n:"BrtEndPivotTableRefs",f:z},2053:{n:"BrtPivotTableRef",f:z},2054:{n:"BrtSlicerCacheBookPivotTables",f:z},2055:{n:"BrtBeginSxvcells",f:z},2056:{n:"BrtEndSxvcells",f:z},2057:{n:"BrtBeginSxRow",f:z},2058:{n:"BrtEndSxRow",f:z},2060:{n:"BrtPcdCalcMem15",f:z},2067:{n:"BrtQsi15",f:z},2068:{n:"BrtBeginWebExtensions",f:z},2069:{n:"BrtEndWebExtensions",f:z},2070:{n:"BrtWebExtension",f:z},2071:{n:"BrtAbsPath15",f:z},2072:{n:"BrtBeginPivotTableUISettings",f:z},2073:{n:"BrtEndPivotTableUISettings",f:z},2075:{n:"BrtTableSlicerCacheIDs",f:z},2076:{n:"BrtTableSlicerCacheID",f:z},2077:{n:"BrtBeginTableSlicerCache",f:z},2078:{n:"BrtEndTableSlicerCache",f:z},2079:{n:"BrtSxFilter15",f:z},2080:{n:"BrtBeginTimelineCachePivotCacheIDs",f:z},2081:{n:"BrtEndTimelineCachePivotCacheIDs",f:z},2082:{n:"BrtTimelineCachePivotCacheID",f:z},2083:{n:"BrtBeginTimelineCacheIDs",f:z},2084:{n:"BrtEndTimelineCacheIDs",f:z},2085:{n:"BrtBeginTimelineCacheID",f:z},2086:{n:"BrtEndTimelineCacheID",f:z},2087:{n:"BrtBeginTimelinesEx",f:z},2088:{n:"BrtEndTimelinesEx",f:z},2089:{n:"BrtBeginTimelineEx",f:z},2090:{n:"BrtEndTimelineEx",f:z},2091:{n:"BrtWorkBookPr15",f:z},2092:{n:"BrtPCDH15",f:z},2093:{n:"BrtBeginTimelineStyle",f:z},2094:{n:"BrtEndTimelineStyle",f:z},2095:{n:"BrtTimelineStyleElement",f:z},2096:{n:"BrtBeginTimelineStylesheetExt15",f:z},2097:{n:"BrtEndTimelineStylesheetExt15",f:z},2098:{n:"BrtBeginTimelineStyles",f:z},2099:{n:"BrtEndTimelineStyles",f:z},2100:{n:"BrtBeginTimelineStyleElements",f:z},2101:{n:"BrtEndTimelineStyleElements",f:z},2102:{n:"BrtDxf15",f:z},2103:{n:"BrtBeginDxfs15",f:z},2104:{n:"brtEndDxfs15",f:z},2105:{n:"BrtSlicerCacheHideItemsWithNoData",f:z},2106:{n:"BrtBeginItemUniqueNames",f:z},2107:{n:"BrtEndItemUniqueNames",f:z},2108:{n:"BrtItemUniqueName",f:z},2109:{n:"BrtBeginExtConn15",f:z},2110:{n:"BrtEndExtConn15",f:z},2111:{n:"BrtBeginOledbPr15",f:z},2112:{n:"BrtEndOledbPr15",f:z},2113:{n:"BrtBeginDataFeedPr15",f:z},2114:{n:"BrtEndDataFeedPr15",f:z},2115:{n:"BrtTextPr15",f:z},2116:{n:"BrtRangePr15",f:z},2117:{n:"BrtDbCommand15",f:z},2118:{n:"BrtBeginDbTables15",f:z},2119:{n:"BrtEndDbTables15",f:z},2120:{n:"BrtDbTable15",f:z},2121:{n:"BrtBeginDataModel",f:z},2122:{n:"BrtEndDataModel",f:z},2123:{n:"BrtBeginModelTables",f:z},2124:{n:"BrtEndModelTables",f:z},2125:{n:"BrtModelTable",f:z},2126:{n:"BrtBeginModelRelationships",f:z},2127:{n:"BrtEndModelRelationships",f:z},2128:{n:"BrtModelRelationship",f:z},2129:{n:"BrtBeginECTxtWiz15",f:z},2130:{n:"BrtEndECTxtWiz15",f:z},2131:{n:"BrtBeginECTWFldInfoLst15",f:z},2132:{n:"BrtEndECTWFldInfoLst15",f:z},2133:{n:"BrtBeginECTWFldInfo15",f:z},2134:{n:"BrtFieldListActiveItem",f:z},2135:{n:"BrtPivotCacheIdVersion",f:z},2136:{n:"BrtSXDI15",f:z},65535:{n:"",f:z}};var d5=W(aM,"n");function Y(er,es){if(typeof module!=="undefined"&&typeof require!=="undefined"&&typeof ODS==="undefined"){ODS=require("./dist/ods")}if(typeof ODS==="undefined"||!ODS.parse_ods){throw new Error("Unsupported ODS")}return ODS.parse_ods(er,es)}function eb(es){return function er(eu){for(var et=0;et!=es.length;++et){var ev=es[et];if(eu[ev[0]]===undefined){eu[ev[0]]=ev[1]}if(ev[2]==="n"){eu[ev[0]]=Number(eu[ev[0]])}}}}var cW=eb([["cellNF",false],["cellHTML",true],["cellFormula",true],["cellStyles",false],["sheetStubs",false],["sheetRows",0,"n"],["bookDeps",false],["bookSheets",false],["bookProps",false],["bookFiles",false],["bookVBA",false],["WTF",false]]);var dT=eb([["bookSST",false],["bookType","xlsx"],["WTF",false]]);function bJ(er,eu){if(!er){return 0}try{er=eu.map(function es(ev){return[ev.name,er["!id"][ev.id].Target]})}catch(et){return null}return !er||er.length===0?null:er}function ao(et,ey,ev,er,es,ex,eu){try{es[er]=dU(a4(et,ev,true),ey);ex[er]=aD(a4(et,ey),ey,eu,es[er])}catch(ew){if(eu.WTF){throw ew}}}var cp=function cp(er){return er.substr(-1)!="/"};function af(eO,eF){cn(ch);eF=eF||{};cW(eF);cS();if(dI(eO,"META-INF/manifest.xml")){return Y(eO,eF)}var eE=bI(eO.files).filter(cp).sort();var eI=q(a4(eO,"[Content_Types].xml"),eF);var eJ=false;var et,eA;if(eI.workbooks.length===0){eA="xl/workbook.xml";if(a4(eO,eA,true)){eI.workbooks.push(eA)}}if(eI.workbooks.length===0){eA="xl/workbook.bin";if(!d4(eO,eA,true)){throw new Error("Could not find workbook")}eI.workbooks.push(eA);eJ=true}if(eI.workbooks[0].substr(-3)=="bin"){eJ=true}if(eJ){aF(1200)}if(!eF.bookSheets&&!eF.bookProps){aq=[];if(eI.sst){aq=ca(a4(eO,eI.sst.replace(/^\//,"")),eI.sst,eF)}cK={};if(eI.style){cK=bW(a4(eO,eI.style.replace(/^\//,"")),eI.style,eF)}dW={};if(eF.cellStyles&&eI.themes.length){dW=c2(a4(eO,eI.themes[0].replace(/^\//,""),true),eI.themes[0],eF)}}var eB=aI(a4(eO,eI.workbooks[0].replace(/^\//,"")),eI.workbooks[0],eF);var es={},ew="";if(eI.coreprops.length!==0){ew=a4(eO,eI.coreprops[0].replace(/^\//,""),true);if(ew){es=aE(ew)}if(eI.extprops.length!==0){ew=a4(eO,eI.extprops[0].replace(/^\//,""),true);if(ew){Q(ew,es)}}}var eG={};if(!eF.bookSheets||eF.bookProps){if(eI.custprops.length!==0){ew=a4(eO,eI.custprops[0].replace(/^\//,""),true);if(ew){eG=am(ew,eF)}}}var eM={};if(eF.bookSheets||eF.bookProps){if(es.Worksheets&&es.SheetNames.length>0){et=es.SheetNames}else{if(eB.Sheets){et=eB.Sheets.map(function ex(eP){return eP.name})}}if(eF.bookProps){eM.Props=es;eM.Custprops=eG}if(typeof et!=="undefined"){eM.SheetNames=et}if(eF.bookSheets?eM.SheetNames:eF.bookProps){return eM}}et={};var eC={};if(eF.bookDeps&&eI.calcchain){eC=w(a4(eO,eI.calcchain.replace(/^\//,"")),eI.calcchain,eF)}var eL=0;var er={};var eH,eD;if(!es.Worksheets){var ey=eB.Sheets;es.Worksheets=ey.length;es.SheetNames=[];for(var eK=0;eK!=ey.length;++eK){es.SheetNames[eK]=ey[eK].name}}var ev=eJ?"bin":"xml";var eN="xl/_rels/workbook."+ev+".rels";var eu=dU(a4(eO,eN,true),eN);if(eu){eu=bJ(eu,eB.Sheets)}var ez=(a4(eO,"xl/worksheets/sheet.xml",true))?1:0;for(eL=0;eL!=es.Worksheets;++eL){if(eu){eH="xl/"+(eu[eL][1]).replace(/[\/]?xl\//,"")}else{eH="xl/worksheets/sheet"+(eL+1-ez)+"."+ev;eH=eH.replace(/sheet0\./,"sheet.")}eD=eH.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels");ao(eO,eH,eD,es.SheetNames[eL],er,et,eF)}if(eI.comments){ad(eO,eI.comments,et,er,eF)}eM={Directory:eI,Workbook:eB,Props:es,Custprops:eG,Deps:eC,Sheets:et,SheetNames:es.SheetNames,Strings:aq,Styles:cK,Themes:dW,SSF:ch.get_table()};if(eF.bookFiles){eM.keys=eE;eM.files=eO.files}if(eF.bookVBA){if(eI.vba.length>0){eM.vbaraw=a4(eO,eI.vba[0],true)}else{if(eI.defaults.bin==="application/vnd.ms-office.vbaProject"){eM.vbaraw=a4(eO,"xl/vbaProject.bin",true)}}}return eM}function aj(es,ev,eu,et,er){if(!er){er={}}if(!es["!id"]){es["!id"]={}}er.Id="rId"+ev;er.Type=et;er.Target=eu;if(es["!id"][er.Id]){throw new Error("Cannot rewrite rId "+ev)}es["!id"][er.Id]=er;es[("/"+er.Target).replace("//","/")]=er}function ed(ex,et){if(ex&&!ex.SSF){ex.SSF=ch.get_table()}if(ex&&ex.SSF){cn(ch);ch.load_table(ex.SSF);et.revssf=df(ex.SSF);et.revssf[ex.SSF[65535]]=0}et.rels={};et.wbrels={};et.Strings=[];et.Strings.Count=0;et.Strings.Unique=0;var ew=et.bookType=="xlsb"?"bin":"xml";var er={workbooks:[],sheets:[],calcchains:[],themes:[],styles:[],coreprops:[],extprops:[],custprops:[],strs:[],comments:[],vba:[],TODO:[],rels:[],xmlns:""};dT(et=et||{});var es=new c8();var ev="",eu=0;et.cellXfs=[];aR(et.cellXfs,{},{revssf:{General:0}});ev="docProps/core.xml";es.file(ev,d8(ex.Props,et));er.coreprops.push(ev);aj(et.rels,2,ev,bz.CORE_PROPS);ev="docProps/app.xml";if(!ex.Props){ex.Props={}}ex.Props.SheetNames=ex.SheetNames;ex.Props.Worksheets=ex.SheetNames.length;es.file(ev,bV(ex.Props,et));er.extprops.push(ev);aj(et.rels,3,ev,bz.EXT_PROPS);if(ex.Custprops!==ex.Props&&bI(ex.Custprops||{}).length>0){ev="docProps/custom.xml";es.file(ev,dP(ex.Custprops,et));er.custprops.push(ev);aj(et.rels,4,ev,bz.CUST_PROPS)}ev="xl/workbook."+ew;es.file(ev,d6(ex,ev,et));er.workbooks.push(ev);aj(et.rels,1,ev,bz.WB);for(eu=1;eu<=ex.SheetNames.length;++eu){ev="xl/worksheets/sheet"+eu+"."+ew;es.file(ev,d1(eu-1,ev,et,ex));er.sheets.push(ev);aj(et.wbrels,eu,"worksheets/sheet"+eu+"."+ew,bz.WS)}if(et.Strings!=null&&et.Strings.length>0){ev="xl/sharedStrings."+ew;es.file(ev,a5(et.Strings,ev,et));er.strs.push(ev);aj(et.wbrels,++eu,"sharedStrings."+ew,bz.SST)}ev="xl/theme/theme1.xml";es.file(ev,m());er.themes.push(ev);aj(et.wbrels,++eu,"theme/theme1.xml",bz.THEME);ev="xl/styles."+ew;es.file(ev,aL(ex,ev,et));er.styles.push(ev);aj(et.wbrels,++eu,"styles."+ew,bz.STY);es.file("[Content_Types].xml",c7(er,et));es.file("_rels/.rels",ci(et.rels));es.file("xl/_rels/workbook."+ew+".rels",ci(et.wbrels));return es}function p(et,es){var er,ev=et;var eu=es||{};if(!eu.type){eu.type=(dQ&&Buffer.isBuffer(et))?"buffer":"base64"}switch(eu.type){case"base64":er=new c8(ev,{base64:true});break;case"binary":er=new c8(ev,{base64:false});break;case"buffer":er=new c8(ev);break;case"file":er=new c8(ev=c1.readFileSync(et));break;default:throw new Error("Unrecognized type "+eu.type)}return af(er,eu)}function cR(es,er){var et=er||{};et.type="file";return p(es,et)}function R(es,er){var eu=er||{};var et=ed(es,eu);switch(eu.type){case"base64":return et.generate({type:"base64"});case"binary":return et.generate({type:"string"});case"buffer":return et.generate({type:"nodebuffer"});case"file":return c1.writeFileSync(eu.file,et.generate({type:"nodebuffer"}));default:throw new Error("Unrecognized type "+eu.type)}}function dE(et,er,es){var eu=es||{};eu.type="file";eu.file=er;switch(eu.file.substr(-5).toLowerCase()){case".xlsm":eu.bookType="xlsm";break;case".xlsb":eu.bookType="xlsb";break}return R(et,eu)}function ae(er){return parseInt(cu(er),10)-1}function dB(er){return""+(er+1)}function u(er){return er.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function cu(er){return er.replace(/\$(\d+)$/,"$1")}function ef(er){var eu=bA(er),et=0,es=0;for(;es!==eu.length;++es){et=26*et+eu.charCodeAt(es)-64}return et-1}function cD(er){var es="";for(++er;er;er=Math.floor((er-1)/26)){es=String.fromCharCode(((er-1)%26)+65)+es}return es}function dR(er){return er.replace(/^([A-Z])/,"$$$1")}function bA(er){return er.replace(/^\$([A-Z])/,"$1")}function ei(er){return er.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function ac(er){var es=ei(er);return{c:ef(es[0]),r:ae(es[1])}}function cF(er){return cD(er.c)+dB(er.r)}function n(er){return dR(u(er))}function dF(er){return bA(cu(er))}function cJ(es){var er=es.split(":").map(ac);return{s:er[0],e:er[er.length-1]}}function bC(er,es){if(es===undefined||typeof es==="number"){return bC(er.s,er.e)}if(typeof er!=="string"){er=cF(er)}if(typeof es!=="string"){es=cF(es)}return er==es?er:er+":"+es}function c0(et){var ev={s:{c:0,r:0},e:{c:0,r:0}};var es=0,eu=0,ew=0;var er=et.length;for(es=0;eu<er;++eu){if((ew=et.charCodeAt(eu)-64)<1||ew>26){break}es=26*es+ew}ev.s.c=--es;for(es=0;eu<er;++eu){if((ew=et.charCodeAt(eu)-48)<0||ew>9){break}es=10*es+ew}ev.s.r=--es;if(eu===er||et.charCodeAt(++eu)===58){ev.e.c=ev.s.c;ev.e.r=ev.s.r;return ev}for(es=0;eu!=er;++eu){if((ew=et.charCodeAt(eu)-64)<1||ew>26){break}es=26*es+ew}ev.e.c=--es;for(es=0;eu!=er;++eu){if((ew=et.charCodeAt(eu)-48)<0||ew>9){break}es=10*es+ew}ev.e.r=--es;return ev}function ay(er,es){if(er.z!==undefined){try{return(er.w=ch.format(er.z,es))}catch(et){}}if(!er.XF){return es}try{return(er.w=ch.format(er.XF.ifmt||0,es))}catch(et){return""+es}}function ab(er,es){if(er==null||er.t==null){return""}if(er.w!==undefined){return er.w}if(es===undefined){return ay(er,er.v)}return ay(er,es)}function bS(es,eB){var eJ,ew,eD,eI=0,eu=1,eF,er=[],ev,et,eE,ez;var eG=eB!=null?eB:{};var eC=eG.raw;if(es==null||es["!ref"]==null){return[]}eD=eG.range!==undefined?eG.range:es["!ref"];if(eG.header===1){eI=1}else{if(eG.header==="A"){eI=2}else{if(Array.isArray(eG.header)){eI=3}}}switch(typeof eD){case"string":eF=c0(eD);break;case"number":eF=c0(es["!ref"]);eF.s.r=eD;break;default:eF=eD}if(eI>0){eu=0}var ex=dB(eF.s.r);var ey=new Array(eF.e.c-eF.s.c+1);var eH=new Array(eF.e.r-eF.s.r-eu+1);var eA=0;for(eE=eF.s.c;eE<=eF.e.c;++eE){ey[eE]=cD(eE);eJ=es[ey[eE]+ex];switch(eI){case 1:er[eE]=eE;break;case 2:er[eE]=ey[eE];break;case 3:er[eE]=eG.header[eE-eF.s.c];break;default:if(eJ===undefined){continue}er[eE]=ab(eJ)}}for(et=eF.s.r+eu;et<=eF.e.r;++et){ex=dB(et);ev=true;ew=eI===1?[]:Object.create({__rowNum__:et});for(eE=eF.s.c;eE<=eF.e.c;++eE){eJ=es[ey[eE]+ex];if(eJ===undefined||eJ.t===undefined){continue}ez=eJ.v;switch(eJ.t){case"e":continue;case"s":case"str":break;case"b":case"n":break;default:throw"unrecognized type "+eJ.t}if(ez!==undefined){ew[er[eE]]=eC?ez:ab(eJ,ez);ev=false}}if(ev===false){eH[eA++]=ew}}eH.length=eA;return eH}function ar(er,es){return bS(er,es!=null?es:{})}function aZ(eu,eB){var eI="",eC="",es=/"/g;var eG=eB==null?{}:eB;if(eu==null||eu["!ref"]==null){return""}var eE=c0(eu["!ref"]);var er=eG.FS!==undefined?eG.FS:",",ew=er.charCodeAt(0);var et=eG.RS!==undefined?eG.RS:"\n",ey=et.charCodeAt(0);var ex="",ez="",eA=[];var eH=0,eF=0,eJ;var ev=0,eD=0;for(eD=eE.s.c;eD<=eE.e.c;++eD){eA[eD]=cD(eD)}for(ev=eE.s.r;ev<=eE.e.r;++ev){ex="";ez=dB(ev);for(eD=eE.s.c;eD<=eE.e.c;++eD){eJ=eu[eA[eD]+ez];eC=eJ!==undefined?""+ab(eJ):"";for(eH=0,eF=0;eH!==eC.length;++eH){if((eF=eC.charCodeAt(eH))===ew||eF===ey||eF===34){eC='"'+eC.replace(es,'""')+'"';break}}ex+=(eD===eE.s.c?"":er)+eC}eI+=ex+et}return eI}var cz=aZ;function A(ey){var et,ez="",eB,eu="";if(ey==null||ey["!ref"]==null){return""}var er=c0(ey["!ref"]),ev="",eA=[],es;et=new Array((er.e.r-er.s.r+1)*(er.e.c-er.s.c+1));var ex=0;for(es=er.s.c;es<=er.e.c;++es){eA[es]=cD(es)}for(var ew=er.s.r;ew<=er.e.r;++ew){ev=dB(ew);for(es=er.s.c;es<=er.e.c;++es){ez=eA[es]+ev;eB=ey[ez];eu="";if(eB===undefined){continue}if(eB.f!=null){eu=eB.f}else{if(eB.w!==undefined){eu="'"+eB.w}else{if(eB.v===undefined){continue}else{eu=""+eB.v}}}et[ex++]=ez+"="+eu}}et.length=ex;return et}var aY={encode_col:cD,encode_row:dB,encode_cell:cF,encode_range:bC,decode_col:ef,decode_row:ae,split_cell:ei,decode_cell:ac,decode_range:cJ,format_cell:ab,get_formulae:A,make_csv:aZ,make_json:bS,make_formulae:A,sheet_to_csv:aZ,sheet_to_json:bS,sheet_to_formulae:A,sheet_to_row_object_array:ar};a1.parseZip=af;a1.read=p;a1.readFile=cR;a1.write=R;a1.writeFile=dE;a1.utils=aY;a1.SSF=ch})(typeof exports!=="undefined"?exports:XLSX);Ext.define("sl.panel.Panel",{extend:"Ext.panel.Panel",alias:["widget.slpanel"],uses:["Ext.toolbar.Spacer","sl.panel.StatusBar","sl.utils.Utilities"],defaults:{sortable:true},useStatusBar:true,statusBarPosition:"bottom",includeValidationStatus:false,defaultTitle:"",initComponent:function(){var b=this,a={plugins:b.createPlugins(),features:b.createFeatures()};b.defaultTitle=b.defaultTitle||b.title;if(b.useStatusBar){b.on({scope:b,afterrender:b.configureStatusBar})}Ext.apply(b,a);b.callParent(arguments)},createPlugins:function(){var b=this,a=b.plugins||[];return a},createFeatures:function(){var a=this,b=a.features||[];return b},configureStatusBar:function(){var b=this;if(b.createStatusBar()){var a=b.getItemsForStatusBar()||[];if(a.length){b.addItemsToStatusBar(a)}}},createStatusBar:function(){var b=this,d=(b.statusBarId?'[id="'+b.statusBarId+'"]':(b.statusBarPosition?'[dock="'+b.statusBarPosition+'"]':""))||"",c=Ext.String.format("toolbar{0}",d);b.statusBar=b.statusBar||b.getDockedItems(c)[0]||undefined;if(!b.statusBar){if(sl.utils.IsObjectChainDefined(Ext,"ux.statusbar.StatusBar")){var a=Ext.create("sl.panel.StatusBar",Ext.apply({panel:b,enableOverflow:true,dock:b.statusBarPosition||"bottom",hidden:true},b.statusBarConfig));b.statusBar=b.addDocked(a)[0]}else{if(b.includeValidationStatus){b.includeValidationStatus=false}b.statusBar=b.addDocked({xtype:"toolbar",dock:b.statusBarPosition,hidden:true,enableOverflow:true,items:[]})[0]}b.statusBar.on({single:true,add:function(){b.statusBar.show()}})}return b.statusBar},getItemsForStatusBar:function(){return[]},addItemsToStatusBar:function(h){var f=this,g=f.statusBar,c=false,a=[],k;if(g.fireEvent("beforeaddallitems",g,h)!==false){Ext.Array.forEach(h,function(j,i,l){if(sl.utils.isTBFill(j)){if(c){a.push(i)}else{c=true}}},h);if(a.length>0){for(var b=a.length-1;b>=0;b--){Ext.Array.removeAt(h,a[b])}}if(g.items.getCount()){k=Ext.Array.clone(g.items.items);Ext.Array.insert(k,0,[{xtype:"tbspacer",flex:1}]);g.removeAll(false);for(var d=0;d<h.length;d++){if(sl.utils.isTBFill(h[d])){break}}Ext.Array.insert(h,d,k)}if(sl.utils.isTBSeparator(h[0])){Ext.Array.erase(h,0)}for(var e=0;e<h.length;e++){f.addItemToStatusBar(h[e])}g.fireEvent("addallitems",f.statusBar,h)}},addItemToStatusBar:function(h){var d=this,f=d.statusBar,g;if(d.statusBar.fireEvent("beforeadditem",f,h)!==false){if(!Ext.isEmpty(h)){var a=sl.utils.isTBFill(h),b=sl.utils.isTBSeparator(h),c=f.items.getAt(f.items.getCount()-1),i=sl.utils.isTBFill(c),e=sl.utils.isTBSeparator(c);if(a){if(e){f.remove(c)}}else{if(b){if(e||i||Ext.isEmpty(c)){return false}else{if(h.removePriorTBSeparator){f.remove(c)}}}}g=f.add(h)}f.fireEvent("additem",f,h,Ext.isEmpty(g))}}});Ext.define("sl.panel.ReportPanel",{extend:"Ext.panel.Panel",alias:["widget.reportpanel"],config:{url:"",displayMode:"pdf",reportParams:{}},constructor:function(a){me=this;a=a||{};a.html='<iframe class="rpt-display-frame " style="width:100%;height:100%;" />';me.callParent(arguments)},renderReport:function(a,c){me=this;var b="position:absolute;margin:auto;top:0;bottom:0;left:0;right:0;height:0px;";b+="background-repeat:no-repeat,no-repeat;background-position:top,bottom;font:normal15pxtahoma,arial,verdana,sans-serif;";b+="font-style:normal;font-variant:normal;font-weight: normal;font-stretch: normal;font-size:15px;line-height:normal;";b+="font-family:tahoma,arial,verdana,sans-serif;color:#222;text-align:center;";a=Ext.apply(me.reportParams,a);a.$MODE=c=c||me.displayMode;displayPane=Ext.dom.Query.select("iframe.rpt-display-frame",me.getEl().dom,"select",true)[0];displayPane.setAttribute("src","about:blank");Ext.defer(function(){displayPane.contentDocument.documentElement.innerHTML='<div id="stewarts-splashscreen" class="centered-on-page" style="'+b+'"><img src="/resources/images/ajax-loader.gif" /><br>Report Loading...</div>';switch(c){case"pdfprint":case"toexcel":break;case"html":case"xml":case"tohtml":case"toxslfo":case"xslfo":case"ps":Ext.Ajax.request({url:me.url,scope:me,params:a,callback:function(e,f,d){if(f){displayPane.setAttribute("src","about:blank");Ext.defer(function(){displayPane.contentDocument.documentElement.innerHTML=(c=="html"?d.responseText:"<pre>"+Ext.htmlEncode(d.responseText)+"</pre>")},200)}}});break;case"displayxlsx":case"xlsx":case"excel":case"fo2pdf":case"foandpdf":case"pdf":case"tiff":queryString=Ext.Object.toQueryString(a);displayPane.setAttribute("src",me.url+"?"+queryString)}},200)}});Ext.define("sl.panel.StatusBar",{extend:"Ext.toolbar.Toolbar",alias:"widget.slstatusbar",mixins:{sbar:"Ext.ux.statusbar.StatusBar"},uses:["Ext.toolbar.Spacer","Ext.toolbar.TextItem","sl.utils.Toast","sl.utils.Utilities"],isStewarts:true,cls:"x-statusbar",busyIconCls:"x-status-busy",busyText:"Loading...",autoClear:5000,emptyText:"&#160;",validIconCls:"x-status-valid",validText:"&nbsp;",warningIconCls:"x-status-warning",warningText:"",errorIconCls:"x-status-error",errorText:"Error",savingIconCls:"x-status-saving",savingText:"&nbsp;",savedIconCls:"x-status-saved",savedText:"Saved",addToolbarItems:true,activeThreadId:0,constructor:function(a){var b=this;a=a||{};b=Ext.applyIf(b,b.mixins.sbar);b.mixins.sbar.constructor.apply(b,arguments)},initComponent:function(){var a=this;a.callParent(arguments);a.currIconCls=a.iconCls||a.defaultIconCls;a.statusEl=Ext.create("Ext.toolbar.TextItem",{cls:"x-status-text "+(a.currIconCls||""),text:a.text||a.defaultText||"&nbsp;"});a.statusMsg=a.statusEl;if(a.addToolbarItems){a.addItemsToToolbar()}},setStatus:function(h){var e=this;h=h||{};Ext.suspendLayouts();if(Ext.isString(h)){h={text:h}}if(h.text!==undefined){e.setText(h.text)}if(h.iconCls!==undefined){e.setIcon(h.iconCls)}if(h.clear){var i=h.clear,g=e.autoClear,f={useDefaults:true,anim:true};if(Ext.isObject(i)){i=Ext.applyIf(i,f);if(i.wait){g=i.wait}}else{if(Ext.isNumber(i)){g=i;i=f}else{if(Ext.isBoolean(i)){i=f}}}i.threadId=this.activeThreadId;Ext.defer(e.clearStatus,g,e,[i])}if(!Ext.isString(h)){e.status=h.status}var d=Ext.isEmpty(h.text,false)||(h.text===" ")||(h.text==="&nbsp;"),b=e.items.indexOf(e.statusMsg),a=e.items.getAt(b+1);if(a&&sl.utils.isTBSeparator(a)){a.setVisible(!d)}Ext.resumeLayouts(true);Ext.defer(function(){e.fireEvent("statusupdated",e,h)},10);return e},showValid:function(a){if(Ext.isString(a)){a={text:a}}a=Ext.applyIf(a||{},{text:this.validText||"&nbsp;",iconCls:this.validIconCls,status:"valid"});return this.setStatus(a)},showWarning:function(a){if(Ext.isString(a)){a={text:a}}a=Ext.applyIf(a||{},{text:this.warningText||"&nbsp;",iconCls:this.warningIconCls,status:"warning"});return this.setStatus(a)},showError:function(a){if(Ext.isString(a)){a={text:a}}a=Ext.applyIf(a||{},{text:this.errorText||"&nbsp;",iconCls:this.errorIconCls,status:"error"});return this.setStatus(a)},showSaving:function(a){if(Ext.isString(a)){a={text:a}}a=Ext.applyIf(a||{},{text:this.savingText||"&nbsp;",iconCls:this.savingIconCls,status:"saving"});return this.setStatus(a)},showSaved:function(a){if(Ext.isString(a)){a={text:a}}a=Ext.applyIf(a||{},{text:this.savedText||"&nbsp;",iconCls:this.savedIconCls,status:"saved"});return this.setStatus(a)},showBusy:function(a){if(Ext.isString(a)){a={text:a}}a=Ext.applyIf(a||{},{text:this.busyText,iconCls:this.busyIconCls,status:"busy"});return this.setStatus(a)},addItemsToToolbar:function(){var a=this.insertLoc||0,c=this.getItemsForToolbar();for(var b=c.length-1;b>=0;b--){this.insert(a,c[b])}},getItemsForToolbar:function(){var b=[];var a=this.statusAlign==="right";if(a){this.cls+=" x-status-right";b.push({xtype:"tbspacer",flex:1})}b.push(this.statusEl);return b}});Ext.define("sl.panel.grid.DisplayGrid",{extend:"Ext.grid.Panel",alias:["widget.displaygrid"],mixins:{panel:"sl.panel.Panel"},requires:["sl.field.button.RefreshButton","sl.field.button.ExcelButton"],uses:["sl.utils.ExportData","sl.panel.grid.GridRenderers","sl.panel.grid.plugin.GridRowCount","sl.panel.grid.plugin.GridStateViewPanel","sl.panel.grid.plugin.GridFilterField","sl.panel.grid.plugin.GridValidationStatus","sl.panel.grid.plugin.GridStatusBar","Ext.util.HashMap","Ext.state.Manager","Ext.state.LocalStorageProvider","Ext.util.Format","Ext.grid.column.Column","Ext.grid.Panel","Ext.toolbar.Separator"],config:{includeSearch:true,includeRowCount:true,includeBufferedRenderer:false,includeFilters:false,includeStateViewPanel:false,useStewartsRenderer:true,includeRefreshBtn:true,includeExcelBtn:false,isLocalExcelExport:true,includeValidationStatus:false,singleName:"",pluralName:""},rowCountConfig:{},searchAlign:"right",searchWidth:200,filterEncode:false,filterLocal:true,filterUpdateBuffer:550,filterParamPrefix:"filter",stateful:false,selModelMode:"MULTI",columnLines:true,keepSelectedInView:false,disableCellWrappedColumns:false,constructor:function(a){var b=this;a=a||{};if(!a.selModel&&!b.selModel){a.selModel={selType:"rowmodel",mode:a.selModelMode||b.selModelMode||"SINGLE"}}b=Ext.applyIf(b,b.mixins.panel);b.callParent(arguments)},initComponent:function(){var c=this,a={plugins:c.createPlugins(),features:c.createFeatures()},b=c.getColumns();c.setDefaultTitle(c.getDefaultTitle()||c.getTitle());if(c.stateful){c.configureStateful()}c.concatPropertyArrays(a,c,true);if(Ext.isArray(b)){c.configureColumns(b)}Ext.apply(c,a);c.callParent(arguments);if(!c.ownerLockable){if(c.useStewartsRenderer){c.addStewartsRendererToColumns();c.on({beforereconfigure:function(f,d,e){c.addStewartsRendererToColumns(e)}})}if(c.keepSelectedInView){c.getView().on({buffer:500,resize:c.onResizeKeepSelectedInView})}if(c.includeExcelBtn){c.configureExcelButton()}if(c.includeRefreshBtn){c.configureRefreshButton()}if(c.useStatusBar){c.on({scope:c,afterrender:c.configureStatusBar})}}else{this.showLockedGridError()}},onRender:function(){var a=this;a.callParent(arguments);if(a.enableKeyNav){a.initKeyNav()}},bindStore:function(b,c){var d=this,a=d.getView();if(b){d.store=b;if(a.store!==b){a.bindStore(b,false)}d.mon(b,{load:d.onStoreLoad,scope:d});d.storeRelayers=d.relayEvents(b,["filterchange","groupchange","beforeload","load","clear","datachanged"])}else{d.unbindStore()}},createPlugins:function(){var b=this,a=b.plugins||[];if(b.stateful&&b.includeStateViewPanel){b.gridStateViewPanel=Ext.create(Ext.apply({xclass:"sl.panel.grid.plugin.GridStateViewPanel"},b.viewPanelConfig));a.push(b.gridStateViewPanel)}else{if(b.includeStateViewPanel&&!b.stateful){b.includeStateViewPanel=false}}if(b.includeSearch){b.search=Ext.create(Ext.apply({xclass:"sl.panel.grid.plugin.GridFilterField",iconCls:false,dateFormat:"m/d/Y",align:b.searchAlign,fieldWidth:b.searchWidth,minChars:b.searchMinChars},b.searchConfig));a.push(b.search)}if(b.includeRowCount){b.rowCount=Ext.create(Ext.apply({xclass:"sl.panel.grid.plugin.GridRowCount"},b.rowCountConfig));a.push(b.rowCount)}if(b.includeBufferedRenderer){b.bufferedRenderer=Ext.create(Ext.apply({xclass:"Ext.grid.plugin.BufferedRenderer"},b.bufferedRendererConfig));a.push(b.bufferedRenderer);if(b.enableLocking||(!b.isLocked&&b.getColumnIndexByProperty("locked",undefined,true)>=0)){}}return a},createFeatures:function(){var a=this,b=a.features||[];return b},createStatusBar:function(){var d=this,c,a,b;if(d.statusBarId){c='toolbar[id="'+d.statusBarId+'"]'}else{if(d.statusBarPosition){c='toolbar[dock="'+d.statusBarPosition+'"]'}}if(c){d.statusBar=d.statusBar||d.getDockedItems(c)[0]}if(!d.statusBar){d.statusBarPosition=d.statusBarPosition||"bottom";if(Ext.isDefined(sl.panel.grid.plugin.GridStatusBar)){var e=d.includeValidationStatus?Ext.create("sl.panel.grid.plugin.GridValidationStatus",{grid:d}):undefined;a=Ext.create("sl.panel.grid.plugin.GridStatusBar",Ext.apply({grid:d,enableOverflow:true,addToolbarItems:false,dock:d.statusBarPosition,hidden:true,plugins:(e?[e]:undefined)},d.statusBarConfig))}else{if(d.includeValidationStatus){d.includeValidationStatus=false}a={xtype:"toolbar",dock:d.statusBarPosition,hidden:true,enableOverflow:true,items:[]}}if(a){b=(d.getToolbars(d.statusBarPosition)||[]).length;d.statusBar=d.addDocked(a,b)[0];d.statusBar.on({scope:d,single:true,add:function(){d.statusBar.show()}})}}return d.statusBar},getItemsForStatusBar:function(){var e=this,f=[];if(!e.hasListeners.beforegetstatusbaritems||e.fireEvent("beforegetstatusbaritems",e,f)!==false){var d=0,a=[],c=function(h,g){if(f[g]){f.splice(g,0,h)}else{f[g]=h}};if(e.includeExcelBtn){c(e.excelButton,e.excelButton.insertLoc||0);if(f.length){c("->",e.excelButton.insertLoc||0)}}if(e.includeSearch){a=e.search.getItemsForToolbar()||[];for(d=a.length-1;d>=0;d--){c(a[d],e.search.insertLoc||0)}if(f.length&&a.length){c({xtype:"tbseparator",cls:"includeSearch"},e.search.insertLoc||0)}}if(e.includeStateViewPanel){a=e.gridStateViewPanel.getItemsForToolbar()||[];for(d=a.length-1;d>=0;d--){c(a[d],e.gridStateViewPanel.insertLoc||0)}if(f.length&&a.length){c({xtype:"tbseparator",cls:"includeStateViewPanel"},e.gridStateViewPanel.insertLoc||0)}}if(e.includeRowCount){a=e.rowCount.getItemsForToolbar()||[];for(d=a.length-1;d>=0;d--){c(a[d],e.rowCount.insertLoc||0)}if(f.length&&a.length){c({xtype:"tbseparator",cls:"includeRowCount"},e.rowCount.insertLoc||0)}}if(e.includeValidationStatus){if(sl.utils.hasAlias(e.statusBar,"slstatusbar")){a=e.statusBar.getItemsForToolbar();for(d=a.length-1;d>=0;d--){c(a[d],e.statusBar.insertLoc||0)}if(f.length&&a.length){c({xtype:"tbseparator",cls:"includeValidationStatus"},e.statusBar.insertLoc||0)}}}if(e.includeRefreshBtn){var b=e.getRefreshButton();c(b,b.insertLoc||0);if(f.length){c({xtype:"tbseparator",cls:"selectionCountSeparator"},b.insertLoc||0)}}e.fireEvent("getstatusbaritems",e,f)}return f},getRefreshButton:function(b){var a=Ext.String.format("<b>Refresh Grid's Contents{0}</b><br/><br/><i>You will lose any unsaved changes</i>",this.enableKeyNav?" (<kbd>Ctrl</kbd> + <kbd>Alt</kbd> + <kbd>R</kbd>)":"");return this.getButtonByType("refreshButton","refreshbutton",b,{text:"",tooltip:a,overflowText:"Refresh",iconCls:Ext.baseCSSPrefix+"tbar-loading"})},getExcelButton:function(b){var a=Ext.String.format("<b>Excel Export{0}</b><br/><br/>Exports the Grid's Contents to New Excel File",this.enableKeyNav?" (<kbd>Ctrl</kbd> + <kbd>Alt</kbd> + <kbd>E</kbd>)":"");return this.getButtonByType("excelButton","excelbutton",b,{tooltip:a})},configureRefreshButton:function(){var b=this,a=b.getRefreshButton();if(!b._refreshEventsAttached){a.on({scope:b,click:function(){b.refreshGridData()}});b.getStore().on({load:function(){b.getRefreshButton().enable()},exception:function(){b.getRefreshButton().enable()},beforeload:function(){var c=b.getRefreshButton();if(b.rendered&&c){c.disable()}}});b._refreshEventsAttached=true}else{}},configureExcelButton:function(){var a=this;if(!a._excelEventsAttached){a.getExcelButton().on({scope:a,click:function(d,b){var c=a.isLocalExcelExport;sl.utils.ExportData.gridToExcel(a,c)}});a.getStore().on({load:function(){a.getExcelButton().enable()},exception:function(){a.getExcelButton().enable()},beforeload:function(){var b=a.getExcelButton();if(a.rendered&&b){b.disable()}}});a._excelEventsAttached=true}else{}},concatPropertyArrays:function(f,a,d){for(var e in f){if(a[e]){if(Ext.isArray(a[e])){f[e]=f[e].concat(a[e]);if(d){for(var c=0;c<f[e].length;++c){for(var b=c+1;b<f[e].length;++b){if(f[e][c]===f[e][b]){f[e].splice(b--,1)}}}}}}}},modifyCellClass:function(d,e,c,b){b=b||"highlighted";var a;if(e>=0&&c>=0){a=this.getView().getCellByPosition({row:e,column:c});if(d){a.addCls(b)}else{a.removeCls(b)}}return a},stewartsRenderer:function(n,l,b,j,m,h,k){var a=this,q=n,c,f,s,r,g,e;try{c=l.column;f=c.getColumnEditor();s=b.getField(c.dataIndex)||{};r=false;g=Ext.Array.from(k.plugins);if(f){if(Ext.isFunction(f.renderer)){n=f.renderer.apply(a,arguments)}else{if(sl.utils.hasAlias(f,"datefield")){r=true}}c._isColumnEditable=a.isColumnEditable(c,b);if(a.showEditCursor){k.cellValues.tdCls=String(k.cellValues.tdCls||"")+((c._isColumnEditable===true)?" can-edit-cell":" cannot-edit-cell")}}else{if(Ext.isDate(n)||(Ext.isFunction(s.getType)&&s.getType()==="date")){r=true}}if(r){n=Ext.util.Format.date(n,(c.format||s.dateFormat||Ext.Date.defaultFormat||"m/d/Y"))}n=sl.panel.grid.GridRenderers.highlightMatchesRenderer.apply(a,arguments);if(!a.disableTooltipRenderer&&!c.disableTooltipRenderer&&!Ext.isDefined(c.isCheckerHd)){n=sl.panel.grid.GridRenderers.tooltipRenderer.apply(a,arguments)}for(var p=0;p<g.length;p++){var d=g[p];if(d&&d.ptype==="gridviewdragdrop"&&d.dragZone){e=true;break}}if(e){k.cellValues.tdCls=String(k.cellValues.tdCls||"")+" can-drag-view";if(a.isFirstVisibleColumn(c)){k.cellValues.tdCls=String(k.cellValues.tdCls||"")+" first-visible-column"}}delete c._isColumnEditable}catch(o){n=q;console.error("["+a.$className+"] Renderer Error",{error:o,args:arguments})}return n},updateUI:function(h,e,c,b,g,d,f){var a=this,i;h=Ext.apply({},h);e=Ext.valueFrom(e,true);c=Ext.valueFrom(c,false);b=Ext.valueFrom(b,false);g=Ext.isFunction(g)?g:Ext.emptyFn;d=Ext.valueFrom(d,a);f=Ext.apply({_delegateDeleteHandling:true,updatedColor:undefined,insertedColor:undefined,deletedColor:"#D80000"},f);if(a.fireEvent("beforeuiupdate",a,h)!==false){if(!a._isUpdatingUI){a._isUpdatingUI=true;i=a.getStore();if(i.getSource){i=i.getSource()||i}if(!i.syncRecordData(h,e,c,b,function(j,l,k){if(j.length){j.forEach(function(m){(m._updateProperties||[]).forEach(function(o){var n=a.getColumnForDataIndex(o);if(n){Ext.Function.defer(a.highlightRecord,100,a,[m,n,f.updatedColor,{duration:5000}])}})})}if(l.length){l.forEach(function(m){Ext.Function.defer(a.highlightRecord,500,a,[m,undefined,f.insertedColor])})}if(k.length){k.forEach(function(m){Ext.Function.defer(a.highlightRecord,500,a,[m,undefined,f.deletedColor,{callback:Ext.Function.pass(i.remove,[m],i)}])})}a.view.refresh();a.fireEvent("uiupdate",a,j,l,k);g.call(d,a,j,l,k);delete a._isUpdatingUI},d,f)){delete a._isUpdatingUI}}}},addStewartsRendererToColumns:function(b){var a=this,c=function(d){if(d._stewartsRendererAttached&&!Ext.isFunction(d.renderer)){delete d._stewartsRendererAttached}if(!d.disableStewartsRenderer&&!d._stewartsRendererAttached){a.addStewartsRendererToColumn(d)}return d};Ext.Array.forEach((b||a.getColumns(false,true)),function(e,d,f){if(e.columns){e.columns.forEach(function(g){c(g)})}else{c(e)}})},addStewartsRendererToColumn:function(a){var c=this,b=(Ext.isFunction(a.renderer)?a.renderer:(Ext.isFunction(a.defaultRenderer)?a.defaultRenderer:false));if(!a.renderer&&Ext.isSimpleObject(a)){b=c.getRendererForSimpleColumnObject(a)}a.renderer=function(o,e,g,k,q,p,l){var j=this,n=o,m,h,d,f;try{m=((arguments||{}).callee||{}).caller;if(sl.utils.isInstanceOf(j,Ext.grid.Panel)){d=j;f=a}else{if(sl.utils.isInstanceOf(j,Ext.grid.column.Column)){f=j;d=((f.ownerCt.isColumn?f.ownerCt.ownerCt:f.ownerCt)||{}).grid;k=k===0?p.indexOf(g):k;q=q===0?f.getIndex():q}else{console.error("["+d.$className+": col.renderer] Unknown Scope",{args:arguments,scopeClassName:this.$className,scope:this})}}if(b&&m!==b){h=f.usingDefaultRenderer?f:f.scope||d||j;o=b.apply(h,[o,e,g,k,q,p,l])}o=d.stewartsRenderer.apply(d,[o,e,g,k,q,p,l])}catch(i){o=n;console.error("["+d.$className+"] Default Renderer Error",{error:i,args:arguments,scopeClassName:this.$className,scope:this})}return o};a._stewartsRendererAttached=true;a.hasCustomRenderer=true},getRendererForSimpleColumnObject:function(e){var d=e.xtype,a=false,f,c;try{if(d&&"gridcolumn"!==d){if(d.indexOf(".")<0){d="widget."+d}f=Ext.ClassManager.getByAlias(d);if(f){c=f.prototype;if(Ext.isFunction(c.renderer)){a=c.renderer}else{if(Ext.isFunction(c.defaultRenderer)){a=c.defaultRenderer;e.usingDefaultRenderer=true}}}}}catch(b){a=false;console.error("[getRendererForSimpleColumnObject] Error",{error:b,args:arguments})}return a},initKeyNav:function(){var b=this,a=[{key:"rR",alt:true,ctrl:true,scope:b,stopEvent:true,fn:function(){var c=b.getRefreshButton(false);if(c){c.fireEvent("click",c)}}},{key:"eE",alt:true,ctrl:true,scope:b,stopEvent:true,fn:function(){var c=b.getExcelButton(false);if(c){c.fireEvent("click",c)}}}];b.keyNav=new Ext.util.KeyMap(b.el,a)},getButtonByType:function(f,g,a,b){var d=this,c,e;g=Ext.Array.from(g);e=g.map(function(h){return"toolbar "+h}).join(",");c=d[f]||d.down(e);a=Ext.valueFrom(a,true);if(Ext.isEmpty(c)&&a){c=Ext.widget(g[0],b)}d[f]=c;return c},configureStateful:function(){var a=this,b;if(a.enableLocking||(!a.isLocked&&a.getColumnIndexByProperty("locked",undefined,true)>=0)){a.stateful=false}else{a.stateId=a.stateId||a.name||a.itemId||a.id;if(!a.includeStateViewPanel){b=Ext.state.Manager.getProvider();if(b&&!(b instanceof Ext.state.LocalStorageProvider)){Ext.state.Manager.setProvider(new Ext.state.LocalStorageProvider())}}}},configureColumns:function(b){var a=this,c=(Ext.isObject(a.columnDefaults)&&!Ext.Object.isEmpty(a.columnDefaults));Ext.Array.forEach(b,function(e,d,f){if(c){Ext.applyIf(e,a.columnDefaults)}if(a.stateful&&Ext.isEmpty(e.stateId)){e.stateId=e.dataIndex+"-"+a.stateId}if(!a.disableCellWrappedColumns&&!(Ext.isFunction(e.getColumnEditor)?e.getColumnEditor():(e.editor||e.field))){e.cellWrap=true}})},onResizeKeepSelectedInView:function(b,c,a){b=(b.ownerGrid?b.ownerGrid:b);var d=b.getSelection()[0];if(d){b.scrollToRecord(d)}},highlightRecord:function(a,e,b,f){var c=this,d;f=Ext.apply({},f);if(c.rendered&&!c.isCollapsed()&&c.isVisible(true)){c.bufferedScollToRecord(a,function(){if(e){d=c.getView().getCellByPosition({record:a,column:e},true)}else{d=c.getView().getRow(a)}if(Ext.isElement(d)){Ext.fly(d,Date.now().toString()).select(".x-grid-cell-inner").highlight(b,f)}})}},showLockedGridError:function(){console.error("["+this.$className+"] `Lockable` Stewarts grids are not supported.  Please remove any `locked` columns.")}},function(a){a.createAlias({buildRefreshButton:"configureRefreshButton",buildExcelButton:"configureExcelButton"})});Ext.define("sl.panel.grid.EditorGrid",{extend:"sl.panel.grid.DisplayGrid",alias:["widget.editorgrid"],requires:["sl.field.button.SaveButton","sl.field.button.NewButton","sl.field.button.DeleteButton"],uses:["Ext.event.Event","Ext.grid.plugin.RowEditing","Ext.grid.plugin.CellEditing"],isEditable:true,editType:"cell",autoCancel:true,clicksToEdit:2,clicksToMoveEditor:undefined,errorSummary:true,includeRefreshBtn:true,useDefaultButtons:true,useDefaultSaveConfig:true,useDefaultDeleteConfig:true,useDefaultUndoDeleteConfig:true,useDefaultNewConfig:true,neverShowToast:false,moveEditorOnEnter:true,useDefaultEnterKeyHandler:true,includeValidationStatus:true,showEditCursor:true,disableBeforeEditValidation:false,initComponent:function(){var b=this,a={plugins:b.getEditorGridPlugins(),features:b.getEditorGridFeatures()};Ext.apply(b,a);b.callParent(arguments);if(!b.ownerLockable){if(b.useDefaultButtons||!Ext.Object.isEmpty(b.useDefaultButtons)){b.configureDefaultButtons();b.addDefaultButtonsToToolbar()}b.configureEditingPlugin();if(b.useDefaultEnterKeyHandler){b.on({render:b.handleEnterKeyInEditor,reconfigure:b.handleEnterKeyInEditor})}}},getEditorGridPlugins:function(){var c=this,a=Ext.Array.from(c.plugins);for(var b=0;b<a.length;b++){var d=a[b];if(["cellediting","rowediting"].indexOf(d.ptype)===0){c.editingPlugin=d;break}}c.editingPlugin=c.getEditingPlugin()||c.createEditingPlugin();if(c.editingPlugin){a=Ext.Array.merge(a,[c.editingPlugin])}return a},createEditingPlugin:function(b){var c=this,a;b=(b||c.editType||"CELL").toUpperCase();switch(b){case"CELL":a=Ext.create(Ext.apply({xclass:"Ext.grid.plugin.CellEditing",clicksToEdit:c.clicksToEdit},c.editConfig));break;case"ROW":a=Ext.create(Ext.apply({xclass:"Ext.grid.plugin.RowEditing",autoCancel:c.autoCancel,clicksToEdit:c.clicksToEdit,clicksToMoveEditor:c.clicksToMoveEditor,errorSummary:c.errorSummary},c.editConfig));break;default:console.error("sl Editor Grid not configured to work with <b>"+c.editType+"</b>");break}return a},configureEditingPlugin:function(){var b=this,a=b.getEditingPlugin();if(!Ext.isFunction(a.on)){b.on({single:true,beforerender:function(){b.configureEditingPlugin.apply(b,arguments)}})}else{if(a&&!a._editEventsAttached&&a.ptype==="cellediting"){a.setActiveEditor=Ext.Function.createSequence(function(g){var e=this.activeEditor,c=this.context,f="has-editor-focus",h=e?"removeCls":"addCls",d=((e||g)?c.view.getCellByPosition({row:c.rowIdx,column:c.colIdx},false):false);if(d){d[h](f)}},a.setActiveEditor);a.showEditor=Ext.Function.createSequence(a.showEditor,function(){var c=a.getLastActiveEditor(),d=a.getActiveEditor();a.setLastActiveColumn(a.getActiveColumn());a.setLastActiveEditor(a.getActiveEditor());a.setLastActiveRecord(a.getActiveRecord());if(c===d){Ext.defer(function(){d.fireEvent("focus",d)},5)}});b.on({beforeedit:b.beforeEditHandling,beforerecordcreated:function(f,d,e){var c=f.getStore();if(!c.isEmptyStore){c.removeSorters()}},priority:-100});a._editEventsAttached=true}}},getEditorGridFeatures:function(){var a=this,b=Ext.Array.from(a.features);return b},handleEnterKeyInEditor:function(){var a=this,b=a.getEditors();Ext.Array.forEach(b,function(d,c,e){if(a.getEditingPlugin().ptype==="rowediting"){if(d.name===d.getInputId()){d.name=d.column.dataIndex}}if(Ext.isFunction(d.on)&&!d._enterKeyEventsAttached){d.on({scope:a,specialkey:function(i,h,g){var f=i.getParentGrid();if(h.keyCode===h.ENTER){if(Ext.isFunction(i.onEnterKeyInGrid)){i.onEnterKeyInGrid(i,h,g)}else{if(!i.isXType("checkbox")){f.getSelectionModel().onKeyEnter(f.getEditingPlugin(),h,g)}}}}});d._enterKeyEventsAttached=true}})},getEditorRecord:function(a){var b,c=a.getXType()||a.xtype;switch(c){case"gridsearchfield":b=a.recordSelected;break;case"combo":case"slcombo":b=a.findRecordByValue(a.getValue());break;default:break}return b},setAllColumnErrorsByRecords:function(b){var c=this,a=c.getStore();b=b||a.getRecords(true);b=Ext.Array.from(b);Ext.Array.forEach(b,function(e,d,h){var g=c.getIndexForRecord(e),f=e.getValidation().getErrors();c.setAllColumnErrors(g,f)})},setAllColumnErrors:function(d,c){var a=this,b=a.getDataIndexes();c=Ext.Array.from(c);Ext.Array.forEach(b,function(g,f,h){var e=c.filter(function(i){return i.id===g});a.setCellError(f,d,e)})},setCellError:function(c,h,g){var d=this,b=d.getView(),a=b.getCellByPosition({row:h,column:c}),f="x-form-invalid-field";if(!Ext.isEmpty(g)){var e=[];Ext.Array.forEach(g,function(j,i,k){e.push(j.msg)});if(a){a.addCls(f);a.set({"data-errorqtip":Ext.String.format('<ul><li class="last">{0}</li></ul>',e.join("<br/>"))})}}else{if(a){a.set({"data-errorqtip":""});a.removeCls(f)}}return a||false},editRow:function(k,f){f=f||{};var a=this,i=a.getStore(),j=f.colIndex||0,e=false,d,b,c,h,g;if(a.lockable){g=a.getLockingViewConfig();c=g.locked.getIndexOfNextEditor(j);if(c<0){c=g.normal.getIndexOfNextEditor(j);a=g.normal}else{a=g.locked}if(c<0){c=0}}else{c=a.getIndexOfNextEditor(j)||0}d=a.getEditingPlugin();b=d.getEditStyle()||"cell";if(Ext.isNumber(k)){h=k}else{if(sl.utils.isRecord(k)){h=i.indexOf(k)}}if(h>=0&&c>=0&&d){a.getSelectionModel().select(h);switch(b){case"row":e=d.startEdit(h,c);break;case"cell":e=d.startEditByPosition({row:h,column:c});break;default:sl.consoleWarn("["+a.$className+"] Grid's startEdit handler for grid->editingPlugin->editStyle has not been defined yet",{grid:a,style:b,plugin:d});e=false}}return e},stewartsRenderer:function(h,e,b,d,j,i,f){var a=this,g=h;i=i.isFeatureStore?i.store:i;try{h=a.callParent(arguments);if(i&&i.isRecordChangeValidated&&!Ext.isEmpty(j)){a.addVisualErrorDuringRender(h,e,b,d,j,i,f)}}catch(c){h=g;console.error("["+a.$className+"] Renderer Error",{error:c,args:arguments,scopeClassName:this.$className,scope:this})}return h},addVisualErrorDuringRender:function(n,l,c,j,m,f,k){var h=false;if(!Ext.isEmpty(c)&&!Ext.isEmpty(m)){var a=this,d=l.column,u=d.dataIndex,i=c.getValidation().getErrors(),p=i.length===0,s=[];if(!p){s=i.filter(function(v){return v.id===u})}if(s.length>0){var r=[],g=(s.length>1?"<li class=&quot;last&quot;>{0}</li>":"{0}"),q=(s.length>1?"<ul>{0}</ul>":"{0}"),t="error-cell",e='data-errorqtip="{0}"',o;Ext.Array.forEach(s,function(w,v,x){r.push(Ext.String.format(g,w.msg))});o=Ext.String.format(q,r.join(""));l=l||{};l.tdAttr=Ext.String.format(e,o);l.tdCls=String(l.tdCls||"")+" "+t;h=true}}if(!h){var b=k.getCellByPosition({record:c,column:d});if(b){b.set({"data-errorqtip":""})}}},addDefaultButtonsToToolbar:function(){var c=this,d=Ext.apply({},c.useDefaultButtons),h=d.toolbarId,e=d.toolbarPosition||"top",b=c.getMatchingToolbar(h,e),g=c.useDefaultNewConfig,f=c.useDefaultSaveConfig,a=c.useDefaultDeleteConfig;if(g||f||a){if(!b){b=c.addDocked({xtype:"toolbar",dock:"top",enableOverflow:true,items:[]})[0]}if(f){b.insert(0,c.getSaveButton())}if(g){b.insert(1,c.getNewButton())}if(a){b.insert(2,c.getDeleteButton())}}},getSaveButton:function(b){var a=Ext.String.format("<b>Save Changes{0}</b>",this.enableKeyNav?" (<kbd>Ctrl</kbd> + <kbd>Alt</kbd> + <kbd>S</kbd>)":"");return this.getButtonByType("saveButton","savebutton",b,{tooltip:a})},getNewButton:function(b){var a=Ext.String.format("<b>Create New Row{0}</b>",this.enableKeyNav?" (<kbd>Ctrl</kbd> + <kbd>Alt</kbd> + <kbd>N</kbd>)":"");return this.getButtonByType("newButton","newbutton",b,{tooltip:a})},getDeleteButton:function(a){var b=this,c=b.getButtonByType("deleteButton",["deletewithundobutton","deletebutton"],a);if(c&&!Ext.isFunction(c.setDisabledConditionally)){c.setDisabledConditionally=function(){var j=b.getSelectionModel().getSelection(),g=Ext.String.format("<b>Delete Selection{0}</b><br/><br/>{1} record{2} will be deleted.",b.enableKeyNav?" (<kbd>Ctrl</kbd> + <kbd>Alt</kbd> + <kbd>D</kbd>)":"",j.length,j.length===1?"":"s"),h=false,i=[],f=b.getUndoDeleteButton(),e="",d=true;if(f){i=Ext.isFunction(b.getStore().getDeletedRecords)?b.getStore().getDeletedRecords():[];d=Ext.isFunction(f.setDisabledConditionally)?f.setDisabledConditionally():f.isDisabled();h=(j.length===0&&d);if(!d){e=Ext.String.format("<hr/><b>Undo Delete Submenu{0}</b><br/><br/>{1} deleted record{2} can be restored",b.enableKeyNav?" (<kbd>Ctrl</kbd> + <kbd>Alt</kbd> + <kbd>U</kbd>)":"",i.length,i.length===1?"":"s")}}else{h=(j.length===0)}c.setDisabled(h);c.setTooltip(g+e);return h}}return c},getUndoDeleteButton:function(b){var c=this,d=c.getDeleteButton(b),a=c.undoDeleteButton||(Ext.isDefined(d)?(d.undoDeleteButton||(Ext.isFunction(d.down)?d.down("#undodeletebutton"):undefined)):undefined);c.undoDeleteButton=a;if(a&&!Ext.isFunction(a.setDisabledConditionally)){a.setDisabledConditionally=function(){var g=Ext.isFunction(c.getStore().getDeletedRecords)?c.getStore().getDeletedRecords():[],f=g.length===0,e=Ext.String.format("<b>Undo Delete{0}</b><br/><br/>{1} deleted record{2} can be restored",c.enableKeyNav?" (<kbd>Ctrl</kbd> + <kbd>Alt</kbd> + <kbd>U</kbd>)":"",g.length,g.length===1?"":"s");a.setDisabled(f);a.setTooltip(f?"":e);return f}}return a},configureDefaultButtons:function(){var a=this;if(a.useDefaultSaveConfig){a.configureSaveButton()}if(a.useDefaultNewConfig){a.configureNewButton()}if(a.useDefaultUndoDeleteConfig){a.configureUndoDeleteButton()}if(a.useDefaultDeleteConfig){a.configureDeleteButton()}},configureSaveButton:function(){var a=this,i=a.getStore(),j=a.saveOptions||{},b=Ext.Object.merge({},j,(j.saveBtnOptions||{})),c=Ext.Object.merge({},j,(j.updateOptions||{}));if(!a._saveEventsAttached){a.getSaveButton().on({click:function(m,l,n){Ext.apply(b,n);a.saveButtonClicked(m,l,b)}});var k=function(l){a.beforeStoreSave(l)},g=function(m,l){a.afterStoreSave(m)},h=function(){},d=function(n,l,m){if(n.saveIndividually){n.onRecordCommit(l,m,c)}},f=function(o,l,n){var m=a.getSelectionModel(),p=m.isSelected(l);if(p){a.fireEvent("selectionchange",m,m.getSelection())}},e=function(l,m){m=m||l;if(m){m.un({scope:a,saving:k,save:g,load:h,update:d,newrecordsaved:f})}if(l){l.on({scope:a,saving:k,save:g,load:h,update:d,newrecordsaved:f})}};e(i);a.on("reconfigure",function(o,m,q,p,l,n){e(m,p)},a);a._saveEventsAttached=true}else{}},configureNewButton:function(){var b=this,a=b.newOptions||{};if(!b._newEventsAttached){b.getNewButton().on({click:function(f,c,e){var d={};Ext.apply(d,a,e);b.newButtonClicked(f,c,d)}});b._newEventsAttached=true}else{}},configureDeleteButton:function(){var c=this,a=c.getStore(),b=c.deleteOptions||{};if(!c._deleteEventsAttached){c.getDeleteButton().on({click:function(h,e,g){var f=Ext.Object.merge({},b,g);c.deleteButtonClicked(h,e,f)}});var d=function(e,f){f=f||e;if(f){f.un({scope:c,deleting:c.beforeStoreDelete,"delete":c.afterStoreDelete,load:c.getDeleteButton().setDisabledConditionally})}if(e){e.on({scope:c,deleting:c.beforeStoreDelete,"delete":c.afterStoreDelete,load:c.getDeleteButton().setDisabledConditionally})}};d(a);c.on("reconfigure",function(h,f,j,i,e,g){d(f,i)},c);c.on({scope:c,selectionchange:function(e,g,f){c.getDeleteButton().setDisabledConditionally()}});c.getDeleteButton().setDisabledConditionally();c._deleteEventsAttached=true}else{}},configureUndoDeleteButton:function(){var d=this,c=d.getStore(),a=d.getUndoDeleteButton(),b=d.undoDeleteOptions||{};if(!a){}else{if(!d._undoDeleteEventsAttached){a.on({click:function(i,f,h){var g=Ext.Object.merge({},b,h);d.undoDeleteButtonClicked(i,f,g)}});var e=function(f,g){g=g||f;if(g){g.un({scope:d,undodelete:d.afterStoreUndoDelete})}if(f){f.on({scope:d,undodelete:d.afterStoreUndoDelete})}};e(c);d.on("reconfigure",function(i,g,k,j,f,h){e(g,j)},d);d._undoDeleteEventsAttached=true}else{}}},saveButtonClicked:function(e,a,d){d=d||{};var c=this,b=c.getStore();b.saveModifiedRecords(undefined,d)},newButtonClicked:function(f,l,h){h=h||{};var a=this,i=a.getStore(),g=h.newRowIndex||0,b=h.dontStartEdit||false,k=h.defaultProperties||{},e=a.findFeature("grouping"),d,c,j;f.grid=f.grid||a;Ext.apply(h,{grid:a,store:i,newButton:f,newRowIndex:g});Ext.Array.forEach(a.getEditors(),function(o,n,p){var m=Ext.isFunction(o.getColumn)?o.getColumn():false;if(m&&o.initExpr&&Ext.isEmpty(k[m.dataIndex])){k[m.dataIndex]=o.initExpr}});if(a.fireEvent("beforerecordcreated",a,k,h)!==false){c=i.createNewRecord(k,h);d=i.canRecordBeAdded(c,h);if(d){i.setAutoSort(false);j=i.insert(g,c);if(j&&i.indexOf(c)<0&&i.isFiltered()){i.fireEvent("needfilterremoval",i);if(i.indexOf(c)<0&&i.isFiltered()){i.getFilters().removeAll()}}}if(i.isGrouped()&&e){Ext.suspendLayouts();e.dataSource.onRefresh();Ext.resumeLayouts(true)}if(!b){a.scrollToRecord(c,function(){a.editRow(c,h)})}}},deleteButtonClicked:function(g,l,i){i=i||{};var a=this,k=a.getStore(),e,d,h,c,f,b;if(a.fireEvent("beforedelete",a,i)!==false){e=Ext.Array.from(i.records||a.getSelectionModel().getSelection());d=i.delName||a.singleName||a.defaultTitle||a.title||"item";h=i.delNamePlural||a.pluralName||"";c=e.length;f=Ext.String.format("Delete {0} <b>{1}</b>?<br/>",(c===1?"this ":"these "),Ext.util.Format.plural(c,d,h));b=i.noConfirmation||false;if(b||e.length===0){k.deleteRecords(e,i)}else{Ext.Msg.defaultButton="no";Ext.Msg.show({title:"Confirm Delete?",msg:"<br>"+f,buttons:Ext.Msg.YESNO,scope:k,icon:Ext.MessageBox.QUESTION,fn:function(m){if(m==="yes"){k.deleteRecords(e,i)}}});var j=Ext.isFunction(((g||{}).el||{}).getXY)?g.el.getXY():undefined;sl.utils.alignMessageBoxToParent(j)}}},undoDeleteButtonClicked:function(f,a,e){e=e||{};var d=this,c=d.getStore(),b;if(d.fireEvent("beforeundodelete",d,e)!==false){b=Ext.Array.from(e.records||c.getDeletedRecords());c.undoDeleteRecords(b,e)}},editCell:function(g,e,d){d=d||{};var c=this,b,f,a=false;if(Ext.isNumber(e)){b=e}else{if(e instanceof Ext.grid.column.Column){b=c.getColumnIndex(e)}}if(Ext.isNumber(b)){f=c.getIndexOfNextEditor(b);if(b!==f){sl.utils.consoleWarningWithTrace("The to-be-edited cell does not have an editor",{grid:c,col:e,colIndex:b,row:g});a=false}else{Ext.apply(d,{colIndex:b});a=c.editRow(g,d)}}return a},beforeStoreSave:function(a){if(a._showSaveMask){this.mask("Saving...","x-mask-loading")}},afterStoreSave:function(a){var b=this,c=Ext.Array.from(a.getUnsavedRecords());b.setAllColumnErrorsByRecords(c);if(a._showSaveMask){b.el.unmask();delete a._showSaveMask}},beforeStoreDelete:function(a){if(a._showDeleteMask){this.mask("Deleting...","x-mask-loading")}},afterStoreDelete:function(a,c){var b=this,d=Ext.Array.from(a.getNotDeletedRecords());if(a._showDeleteMask){b.unmask();delete a._showDeleteMask}b.setAllColumnErrorsByRecords(d);if(Ext.isFunction(b.getDeleteButton().setDisabledConditionally)){b.getDeleteButton().setDisabledConditionally()}},afterStoreUndoDelete:function(c,e,b,a){var d=this;Ext.Array.forEach(e,function(g,f,h){d.highlightRecord(g)});if(Ext.isFunction(d.getDeleteButton().setDisabledConditionally)){d.getDeleteButton().setDisabledConditionally()}else{}},afterNewRecord:Ext.emptyFn,initKeyNav:function(){var b=this,a=[{key:"sS",alt:true,ctrl:true,scope:b,stopEvent:true,fn:function(){var c=b.getSaveButton(false);if(c){c.fireEvent("click",c)}}},{key:"dD",alt:true,ctrl:true,scope:b,stopEvent:true,fn:function(){var c=b.getDeleteButton(false);if(c){c.fireEvent("click",c)}}},{key:"nN",alt:true,ctrl:true,scope:b,stopEvent:true,fn:function(){var c=b.getNewButton(false);if(c){c.fireEvent("click",c)}}},{key:"uU",alt:true,ctrl:true,scope:b,stopEvent:true,fn:function(){var c=b.getUndoDeleteButton(false);if(c){c.fireEvent("click",c)}}}];b.callParent(arguments);b.keyNav.addBinding(a)},beforeEditHandling:function(g,b){var a=this,i=a.getStore(),f=(b||{}).record,c=(b||{}).column,j=c?c.dataIndex:false,h=c?c.text:"",k=true,e,d;if(!a.disableBeforeEditValidation&&c){e=a.isColumnEditable(c,f);k=(e===true);if(!k&&!a.disableFailedBeforeEditWarning){sl.utils.Toast.showWarningToast(h+" Cell Is Not Editable",e)}}if(k&&j){d=i.getSorters().removeAtKey(j);if(d){i.fireEvent("refresh",i)}}return k}});Ext.define("sl.panel.grid.GridRenderers",{singleton:true,uses:["sl.utils.Utilities"],tooltipRenderer:function(j,h,e,g,m,k,i){h=(Ext.isDefined(h)&&!Ext.isEmpty(h))?h:{};var l=j,a="",d="",c=h.tdAttr||"",b=h.column||false,n;try{j=String(Ext.isDefined(j)&&!Ext.isEmpty(j)?j:"");if(h){if(!Ext.isEmpty(sl.utils.AllTrim(j))){a=Ext.String.htmlEncode(Ext.String.htmlDecode(Ext.util.Format.stripTags(j)))}if(b){n=b._isColumnEditable;if(Ext.isDefined(n)&&n!==true){d=Ext.String.format("<div class=&quot;cannot-edit-cell-msg&quot;>Cell Is Not Editable{0}</div>",(Ext.isString(n)?":<ul><li>"+n+"</li></ul>":""));a+=(a.length?"<hr>":"")+d}}}if(!Ext.isEmpty(c)){if(Ext.isString(c)&&c.indexOf('data-qtip="')>=0){c=c.match(/"(.*?)"/)[1];a+=(a.length>0?"<hr>":"")+c}else{sl.consoleWarn("[tooltip] Has Existing Tooltip, but Cannot Strip Its Text",{existing:c,tooltipValue:a,value:j})}}h.tdAttr='data-qtip="'+a+'"';if(Ext.versions.extjs.getMajor()===4&&Ext.versions.extjs.getMinor()<2){j=j||" "}}catch(f){console.error("[tooltip] Renderer Error",{error:f,value:j,originalValue:l,args:arguments,scopeClassName:this.$className,scope:this});j=l}return j},comboRenderer:function(l,i,f,h,n,m,j){var c=this,o=c.getStore(),k=l;if(!Ext.isEmpty(l)){if(!m){m=c.getParentGrid().getStore()}try{c.rendererValueNotFoundText=c.rendererValueNotFoundText||"";c.valueNotFoundFn=c.valueNotFoundFn||Ext.emptyFn;l=String(l||"");var e=Ext.isFunction(c.getValueToDisplayHash)?c.getValueToDisplayHash():undefined,b="",d;if(o.isFiltered()){var a=c.queryFilter;if(a&&!a.disabled&&c.queryMode==="local"){a.disabled=true;o.filter();if(!c.clearFilterOnBlur){console.warning("[combo renderer] combo store's filter has been reset.  Renderer may not work if the combo's store is filtered",{combo:c,args:arguments,scopeClassName:this.$className,scope:this})}}}d=o.findRecord(c.valueField,l,0,false,true,true);if(d){b=d.get(c.displayField)}else{if(e&&c.gridDisplayField){if(!Ext.isEmpty(l)&&m.getCount()>0&&Ext.isFunction(m.getRecords)&&(e.getCount()===0||Ext.isEmpty(e.get(l),true))){e.addRecords(m.getRecords(),c.column.dataIndex,c.gridDisplayField)}b=e.get(l)}}if(Ext.isEmpty(b)){if(Ext.isString(l)&&!Ext.isNumeric(l)){b=l}else{if(l&&c.valueNotFoundFn!==Ext.emptyFn){b=c.valueNotFoundFn.call(this.valueNotFoundFnScope||this,c,l)}else{if(l&&c.rendererValueNotFoundText){b=c.rendererValueNotFoundText+" ("+l+")"}}}}l=b}catch(g){console.error("[combo] Renderer Error",{error:g,value:l,originalValue:k,args:arguments,scopeClassName:this.$className,scope:this});l=k}}return l},highlightMatchesRenderer:function(o,l,d,h,m,f,k){var u=this,t=String(Ext.isDefined(o)&&!Ext.isEmpty(o)?o:""),j=t,g="",c="x-search-match",n="x-filter-match",s=[],i=false,e,r;if(!Ext.isEmpty(j)){try{r=Ext.isFunction(f.getSearchedText)?sl.utils.AllTrim(f.getSearchedText()):"";e=Ext.isFunction(f.getFilteredTextArray)?f.getFilteredTextArray():[];hasSearchText=!Ext.isEmpty(r);hasFilteredTextArray=Boolean((e||[]).length>0);if(hasSearchText||hasFilteredTextArray){s=j.split("").map(function(v){return{character:v,cls:""}});if(Ext.isFunction(f.getExtraParam)){i=f.getExtraParam("searchAnyOrder")||false}var b=function(x,w,v){w=String(Ext.isDefined(w)?w:"");x=Ext.Array.from(x)||[];Ext.Array.forEach(x,function(B,z,y){var A=sl.utils.getAllMatchesInString(B,w,true);Ext.Array.forEach(A,function(C,G,E){for(var D=0;D<C.toString().length;D++){var F=s[C.index+D];F.cls+=v+" "}})})};if(hasSearchText){if(i){if(sl.utils.doesStringContainAllPieces(j,r,false)){var a=sl.utils.convertToIgnoreNonAlphanumericInRegEx(Ext.String.splitWords(r));if(Ext.isArray(a)&&a.length>0){b(a,j,c)}}}else{b(r,j,c)}}if(hasFilteredTextArray){Ext.Array.forEach(e,function(v,w,x){if(sl.utils.doesStringContainAllPieces(j,v,false)){b(v,j,n)}})}var p="";Ext.Array.forEach(s,function(z,x,A){var w=String(z.cls||"").trim(),y=!Ext.isEmpty(w),v=z.character;if(y){if(p&&p!==w){g+="</mark>"}if(p!==w){g+='<mark class="'+w+'">';p=w}}else{if(p){g+="</mark>";p=""}}g+=v});if(p){g+="</mark>";p=""}o=g}}catch(q){console.error("[highlightMatches] Renderer Error",{error:q,value:o,originalValue:t,markupValue:j,formattedValue:g,args:arguments,scopeClassName:this.$className,scope:this});o=t}}return o}});Ext.define("sl.panel.grid.ParentChildGridPairing",{extend:"Ext.AbstractPlugin",alias:"plugin.parentchild",pluginId:"parentchild",mixins:["Ext.mixin.Observable"],uses:["Ext.tree.Panel","sl.utils.Utilities"],config:{parentGridReference:null,childGridReference:null,parentFieldName:"ID",cacheParamName:null,childForeignKeyFieldName:null,childGridTitleSyncDisabled:false,parentRecord:null,parentGrid:null,childGrid:null,childMaskText:null,directionArrow:null,parentFieldsForChildGridTitle:[],monitorUIUpdate:true,baseAndParentDivider:": "},hasMaskedChild:false,selectionChangeBuffer:500,constructor:function(a){var b=this;b.mixins.observable.constructor.call(b,a);b.selectionTask=new Ext.util.DelayedTask(b.setParentRecordFromSelection,b);b.childVisualsTask=new Ext.util.DelayedTask(b.updateChildPanelVisuals,b)},init:function(a){var d=this,c=d.getParentGridReference(),e=d.getChildGridReference(),f,b;d.panel=a;d.setParentGrid(f=d.getPanelForReference(c,a));d.setChildGrid(b=d.getPanelForReference(e,a));if(f&&b){d.forceChildSync()}},syncChildPanelToParentRecord:function(){var a=this;a.updateChildPanelData();a.updateChildPanelVisuals()},bindParentGridListeners:function(){var a=this,b=a.getParentGrid();a.parentGridListeners=Ext.apply({},a.parentGridListeners,{scope:a,destroy:a.destroyParentChildRelationship,reconfigure:a.onParentGridReconfigure,selectionchange:a.setParentRecordAfterSelectionChange,resetparentchild:a.onResetParentChild,updatechild:a.updateChildPanelData,uiupdate:a.monitorUIUpdate?a.updateChildGridUI:Ext.emptyFn,updatechildpendingmask:a.updateChildPendingMask});b.on(a.parentGridListeners)},bindChildGridListeners:function(){var b=this,a=b.getChildGrid();b.childGridListeners=Ext.apply({},b.childGridListeners,{scope:b,destroy:b.destroyParentChildRelationship,reconfigure:b.onChildGridReconfigure,boxready:b.useDelayedChildPanelVisualUpdate,resize:b.useDelayedChildPanelVisualUpdate,ancestorresize:b.useDelayedChildPanelVisualUpdate});a.on(b.childGridListeners)},useDelayedChildPanelVisualUpdate:function(){var a=this;a.childVisualsTask.delay(50)},bindParentStoreListeners:function(){var b=this,c=b.getParentGrid(),a=c.getStore();b.parentStoreListeners=Ext.apply({},b.parentStoreListeners,{scope:b,load:b.setParentRecordAfterEvent,"delete":b.setParentRecordAfterEvent,clear:b.setParentRecordAfterEvent,undodelete:b.setParentRecordAfterEvent,newrecordsaved:b.onParentStoreNewRecordSaved});a.on(b.parentStoreListeners)},bindChildStoreListeners:function(){var b=this,a=b.getChildGrid(),c=a.getStore();b.childStoreListeners=Ext.apply({},b.childStoreListeners,{scope:b,beforerecordcreated:b.onChildStoreBeforeRecordCreated,beforesave:{priority:1,fn:b.onChildGridBeforeSave}});c.on(b.childStoreListeners)},unbindListeners:function(b,a){if(a&&b){b.removeListener(a)}},updateParentRecord:function(a,b){if(!sl.utils.areValuesEquivalent(a,b)){this.syncChildPanelToParentRecord()}},getPanelForReference:function(a,c){var d=this,b;if(a){b=sl.utils.findByReference(a,c);if(!b){}}return b},updateParentGrid:function(a,c){var b=this,d;if(c){d=c.getStore();if(d){b.unbindListeners(d,b.parentStoreListeners)}b.unbindListeners(c,b.parentGridListeners);delete c.parentToChildPlugin}if(a){a.parentToChildPlugin=b;b.bindParentStoreListeners();b.bindParentGridListeners()}},updateChildGrid:function(a,c){var b=this,d;if(c){d=c.getStore();if(d){b.unbindListeners(d,b.childStoreListeners)}b.unbindListeners(c,b.childGridListeners);delete c.childToParentPlugin}if(a){a.childToParentPlugin=b;b.bindChildStoreListeners();b.bindChildGridListeners()}},onParentGridReconfigure:function(e,b,a,c){var d=this;if(b&&c!==b){d.unbindListeners(c,d.parentStoreListeners);d.bindParentStoreListeners()}},onChildGridReconfigure:function(b,e,c,a){var d=this;if(e&&a!==e){d.unbindListeners(a,d.childStoreListeners);d.bindChildStoreListeners();if(!a.isEmptyStore&&!e.isEmptyStore){d.forceChildSync()}}},onChildStoreBeforeRecordCreated:function(f,a){var c=this,b=c.getChildForeignKeyFieldName(),e=c.getParentRecord(),d=c.getParentFieldName();if(e&&b&&d){a[b]=e.get(d)}},onChildGridBeforeSave:function(g,a,b){var d=this,c=d.getChildForeignKeyFieldName(),e,f;a=Ext.Array.from(a)||[];Ext.Array.forEach(a,function(h,i,j){d.setChildRecordPropertiesBeforeSave(g,h,b);if(c&&Ext.isEmpty(h.get(c))){e=d.getParentFieldName();f=d.getParentRecord();if(f&&e){h.set(c,f.get(e))}}});return true},setParentRecordAfterEvent:function(){this.selectionTask.delay(50)},setParentRecordAfterSelectionChange:function(a,b){var c=this,e=Ext.valueFrom(c.getParentRecord(),false),f=(Ext.isArray(b)?(b.length===1?b[0]:-1):b),d=e&&e===f;c.updateChildPendingMask(c.getParentGrid(),!d);c.selectionTask.delay(c.selectionChangeBuffer)},setParentRecordFromSelection:function(){var b=this,a=b.getParentGrid().getSelection(),c=(a.length===1?a[0]:null);return b.changeParentRecord(c)},changeParentRecord:function(b){var c=this,a=c.getParentRecord();c.setParentRecord(b);return !sl.utils.areValuesEquivalent(a,c.getParentRecord())},onParentStoreNewRecordSaved:function(a,d){var b=this,c=b.getParentRecord();if(d===c){b.syncChildPanelToParentRecord()}},onResetParentChild:function(){return this.forceChildSync()},forceChildSync:function(a){var b=this,c=true;if(a){c=!b.changeParentRecord(a)}if(c){c=!b.setParentRecordFromSelection()}if(c){b.syncChildPanelToParentRecord()}},getDirectionArrow:function(){var a=this.directionArrow;if(a){switch(a.toLowerCase()){case"n":case"north":case"t":case"top":case"u":case"up":a="up";break;case"s":case"south":case"b":case"bottom":case"d":case"down":a="down";break;case"e":case"east":case"left":case"l":a="left";break;case"w":case"west":case"r":case"right":a="right";break;case"tl":case"t-l":case"topleft":case"top-left":a="topleft";break;case"tr":case"t-r":case"topright":case"top-right":a="topright";break;case"bl":case"b-l":case"bottomleft":case"bottom-left":a="bottomleft";break;case"br":case"b-r":case"bottomright":case"bottom-right":a="bottomright";break}}return a},getChildMaskMessage:function(){var h=this,c=h.getParentGrid(),d=h.getParentRecord(),g=h.getDirectionArrow(),f="Please choose 1 {0} row",a="Please save the {0} row",i='<div class="arrow-{0}-mask">{1}</div>',e=h.getChildMaskText()||c.getSingleName()||c.getDefaultTitle()||c.getTitle(),b;if(d){b=Ext.String.format(a,e)}else{b=Ext.String.format(f,e)}if(g){b=Ext.String.format(i,g,b)}return b},enableChildPanel:function(){var a=this,b=Ext.valueFrom(a.getParentRecord(),false);return(b&&!(b||{}).phantom)},updateChildPanelData:function(){var a=this;if(a.enableChildPanel()){a.loadChildPanelData()}else{a.clearChildPanelData()}},loadChildPanelData:function(){var c=this,f=c.getParentRecord(),e=c.getChildGrid(),g=f._useUpdateUITemp&&Ext.isFunction(e.updateUI),b=c.getCacheParamName(),d=c.getParentFieldName(),a={};if(g){e.updateUI(undefined,false,false,false);delete f._useUpdateUITemp}else{if(f&&d&&b){a[b]=f.get(d)}a=Ext.apply({},c.getChildStoreParams(),a);if(sl.utils.matchesComponent(e,Ext.tree.Panel)){c.loadChildTreeData(a)}else{c.loadChildGridData(a)}}},loadChildTreeData:function(a){var d=this,h=d.getChildGrid(),b=h.getRootNode(),g=b.getTreeStore(),c=d.getChildForeignKeyFieldName(),e=d.getParentFieldName(),f;if(c){e=d.getParentFieldName();f=d.getParentRecord();if(f&&e){b.set(c,f.get(e),{dirty:false})}}g.load({node:b,params:a,callback:function(){b.expand()}})},loadChildGridData:function(a){var b=this,c=b.getChildGrid(),d=c.getStore();d.abortPreviousRequests();if(Ext.isFunction(c.refreshGridData)){c.refreshGridData(a)}else{d.load({params:a})}},reloadChildGridStore:function(){var b=this,a=b.getChildGrid();a.refreshGridData()},clearChildPanelData:function(){var a=this,b=a.getChildGrid();if(sl.utils.matchesComponent(b,Ext.tree.Panel)){a.clearChildTreeData()}else{a.clearChildGridData()}b.fireEvent("resetparentchild")},updateChildPanelVisuals:function(){var a=this;a.updateChildPanelMaskMessage();a.updateChildPanelTitle()},updateChildPanelMaskMessage:function(){var a=this,b=a.getChildGrid();if(b.rendered){if(a.enableChildPanel()){if(a.hasMaskedChild){b.unmask();a.hasMaskedChild=false}}else{b.mask(a.getChildMaskMessage());a.hasMaskedChild=true}b.fireEvent("maskchanged",b,a.hasMaskedChild)}},clearChildGridData:function(b){var a=this.getChildGrid().getStore();a.abortPreviousRequests();a.removeAll()},clearChildTreeData:function(){var a=this,b=a.getChildGrid();b.getRootNode().removeAll()},updateChildGridUI:function(a,e,h,d){var j=this,b=j.getParentGrid(),i=b.getStore(),f=i.getIDProperty(),c=j.getParentRecord(),g;if(c){g=i.findByValue(c.get(f),f);if(g){g._useUpdateUITemp=true;j.forceChildSync(g)}}},updateChildPanelTitle:function(){var f=this,h=f.getChildGrid(),i=Ext.Array.from(f.parentFieldsForChildGridTitle),g=String(h.getDefaultTitle()||""),b=g,a=" - ",e=f.getBaseAndParentDivider(),d="",c;if(!f.childGridTitleSyncDisabled&&h.rendered){if(f.enableChildPanel()){c=f.getParentRecord();if(c){Ext.Array.forEach(i,function(l,k,m){var j=c.get(l)||"";if(Ext.isFunction(j.toLocaleDateString)){j=j.toLocaleDateString()}j=String(j||"");if(j[0]==="-"){j="("+j+")"}d+=(d.length>0&&j.length>0?a:"")+j});b+=(b.length>0&&d.length>0?e:"")+d}}h.setTitle(b);h.fireEvent("parentchildtitlechange",h,b,g,e,d)}},updateChildPendingMask:function(a,c){var d=this,b=d.getChildGrid();if(b.rendered){if(c){if(!b.isMasked()){b.mask();d.hasMaskedChild=true}}else{if(d.hasMaskedChild){b.unmask();d.hasMaskedChild=false}}if(c){b.fireEvent("updatechildpendingmask",b,c)}}},getChildStoreParams:Ext.emptyFn,setChildRecordPropertiesBeforeSave:Ext.emptyFn,destroyParentChildRelationship:function(){var a=this;a.unbindListeners(a.getParentGrid(),a.parentGridListeners);a.unbindListeners(a.getChildGrid(),a.childGridListeners);a.unbindListeners(a.getParentGrid().getStore(),a.parentStoreListeners);a.unbindListeners(a.getChildGrid().getStore(),a.childStoreListeners);a.setParentGrid(null);a.setChildGrid(null);a.panel=null}});Ext.define("sl.panel.grid.column.Cost",{extend:"Ext.grid.column.Number",alias:["widget.costcolumn"],formatAsSupplierCost:true,formatAsShopCost:false,formatAsRetail:false,showZeroIfEmpty:false,supplierMaxDecimals:5,shopMaxDecimals:3,retailMaxDecimals:2,defaultMinDecimals:2,initComponent:function(){var d=this,c=d.getColumnEditor(),a=2,b;if(c&&sl.utils.matchesComponent(c,Ext.form.field.Number)){b=d.getMaxDecimalPrecision();if(Ext.isFunction(c.setDecimalPrecision)){a=Ext.valueFrom(c.getMaxDecimalPrecision(),a);c.setDecimalPrecision(Math.max(b,a))}else{a=Ext.valueFrom(c.decimalPrecision,a);c.decimalPrecision=Math.max(b,a)}}d.callParent()},getMaxDecimalPrecision:function(){var a=this,b=2;if(a.formatAsRetail){b=a.retailMaxDecimals}else{if(a.formatAsShopCost){b=a.shopMaxDecimals}else{if(a.formatAsSupplierCost){b=a.supplierMaxDecimals}}}return b},roundForPricing:function(g,c,h,f){var d=this,a=d.getMaxDecimalPrecision(),e,b,i;if(c.isSummary&&h){b=h.getModel();if(b&&Ext.isFunction(b.getField)){e=b.getField(f)}}else{e=Ext.isFunction(c||{}.getField)?c.getField(f):false}if(e&&"int"===e.getType()){i=0}else{i=d.defaultMinDecimals}return sl.utils.roundForPricingRendering(g,a,i,d.showZeroIfEmpty)},defaultRenderer:function(g,a,b,d,i,h,e){var c=this,f=(a.column||{}).dataIndex;if(Ext.isObject(a)){a.align="right"}return c.roundForPricing(g,b,h,f)},summaryRenderer:function(g,b,e,a){var f=a.column,d=f?f.up("tablepanel[isLocked=undefined]"):false,c=d?d.getStore():false;return this.defaultRenderer(g,a,a.record,a.rowIndex,a.columnIndex,c)}});Ext.define("sl.panel.grid.plugin.GridFilterField",{extend:"Ext.AbstractPlugin",alias:"plugin.gridfilterfield",mixins:["Ext.util.Observable"],uses:["Ext.util.KeyMap","sl.utils.Utilities"],constructor:function(a){this.callParent(arguments);this.mixins.observable.constructor.call(this,a)},emptyText:"Filter (Ctrl + Alt + F)",selectAllText:"Select All",toolbarPosition:"bottom",showSelectAll:true,menuStyle:"checkbox",mode:"local",fieldWidth:200,paramNames:{fields:"fields",query:"query"},shortcutKey:"f",searchOnClear:true,align:"right",init:function(a){var b=this,c=function(d,e){if(e){e.un({scope:b,needfilterremoval:b.onTriggerClear.bind(b,false)})}if(d){d.on({scope:b,needfilterremoval:b.onTriggerClear.bind(b,false)})}b.buildFilterMenu()};if(a){b.grid=a;a.onRender=Ext.Function.createSequence(a.onRender,b.onRender,b);c(a.getStore());a.on("reconfigure",function(g,e,i,h,d,f){c(e,h)});if(Ext.isEmpty(a.includeSearch)&&Ext.isFunction(a.setIncludeSearch)){a.setIncludeSearch(true)}}else{sl.consoleWarn("["+b.$className+"] Required `grid` is not defined")}},onRender:function(){var a=this;if(!a.grid.useStatusBar||!a.grid.includeSearch){a.addItemsToToolbar()}a.buildFilterMenu();a.setupKeyMap();a.grid.on({scope:a,search:function(){a.field.focus(false)}})},setupKeyMap:function(){var b=this,c,a;if(b.shortcutKey){c=b.grid.getEl();a=[{key:b.shortcutKey,ctrl:true,alt:true,scope:b,stopEvent:true,fn:function(){if(Ext.isFunction(b.field.focusInput)){b.field.focusInput()}else{b.field.focus()}}}];a[0][b.shortcutModifier]=true;b.keymap=new Ext.util.KeyMap(c,a)}},addItemsToToolbar:function(){var e=this,d=e.getItemsForToolbar(),b=e.insertLoc||0,a=e.toolbar=e.grid.getMatchingToolbar(e.toolbarId,e.toolbarPosition);for(var c=d.length-1;c>=0;c--){a.insert(b,d[c])}return d},getItemsForToolbar:function(){var b=this,a=[];if("right"===b.align){a.push({xtype:"tbspacer",flex:1})}a.push(b.getField());return a},getMenu:function(){var a=this;a.menu=Ext.isDefined(a.menu)?a.menu:Ext.create("Ext.menu.Menu");return a.menu},getField:function(){var c=this,a={},b;if(!c.field){a.clear={cls:"x-form-clear-trigger",handler:c.onTriggerClear,scope:c};if(!Ext.isDefined(c.minChars)){a.search={cls:"x-form-search-trigger",handler:c.goToSearchOrClear,scope:c}}a.options={cls:"x-form-options-trigger",scope:c,handler:function(g,d,f){var h=c.getMenu();if(!h.isVisible()){h.showBy(d.getEl(),"tl-bl?")}else{h.hide()}}};b={width:c.fieldWidth,emptyText:c.emptyText,selectOnFocus:!Ext.isDefined(c.selectOnFocus)?true:c.selectOnFocus,triggers:a,listeners:{scope:c,single:true,render:function(){var e=c.getField(),d;if(c.minChars){e.el.on({scope:c,buffer:300,keyup:c.onKeyUp})}d=new Ext.util.KeyMap(e.el,[{key:Ext.event.Event.ENTER,scope:c,fn:c.goToSearchOrClear},{key:Ext.event.Event.ESC,scope:c,fn:c.onTriggerClear}]);d.stopEvent=true}}};if((c.grid.searchConfig||{}).height){b.height=c.grid.searchConfig.height}c.field=Ext.create("Ext.form.field.Text",b)}return c.field},onKeyUp:function(){var b=this,a=b.getField().getValue().toString().length;if(0===a||b.minChars<=a){b.goToSearchOrClear()}},goToSearchOrClear:function(){return(!Ext.isEmpty(this.getField().getValue())?this.onTriggerSearch():this.onTriggerClear(true))},onTriggerClear:function(d){var b=this,c=b.getField(),a=b.grid.getView().findFeature("filters");d=d||false;if(Ext.isFunction(b.grid.store.setFilteredText)){b.grid.store.setFilteredText()}if(c.getValue()||d){c.setValue("");c.focus();if(b.searchOnClear){b.onTriggerSearch()}}if(a){a.clearFilters()}},onTriggerSearch:function(){var c=this,b=c.grid,a=b.getStore(),e=c.getField(),d=b.getEl(),f;if(!e.isValid()){return}f=e.getValue();if(c.fireEvent("beforefilter",c,a,f)!==false){if(d){d.mask("Filtering...")}if(Ext.isFunction(a.setFilteredText)){a.setFilteredText(f)}if("local"===c.mode){new Ext.util.DelayedTask(function(){c.doLocalFilter()}).delay(1)}else{c.doRemoteFilter()}}},removeExistingSearchFilter:function(){var e=this,d=e.grid,b=d.getStore(),g=b.getFilters(),a=g?g.getCount():false,f;if(a){for(var c=a-1;c>=0;c--){f=g.getAt(c);if(f.getFilterFn()===e.doLocalRecordFilter){g.remove(f)}}}},doLocalFilter:function(){var c=this,b=c.grid,a=b.getStore(),d=b.getEl();c.removeExistingSearchFilter();if(Ext.isFunction(a.getFilteredText)){a.filterBy(c.doLocalRecordFilter,c);a.sortRankedRecords()}else{sl.consoleWarn("["+c.$className+"] Filtering does not work with this store. Only works with Cach store",{store:a})}if(d){d.unmask()}c.fireEvent("filtered",c)},doLocalRecordFilter:function(d){var g=this,a=g.grid,i=a.getStore(),c=g.getCheckedMenuItems(),h=i.getFilteredText().indexOf('"')>=0,e=i.getFilteredTextArray(),f=[],b;if(e.length){b=false;Ext.Array.forEach(c,function(n,k,o){var l,m=n.column,j=false;if(m){if(((m||{}).xtypesMap||{}).checkcolumn){l=d.get(m.dataIndex).toString()}else{l=a.getTextInCell(m,d);if(l instanceof Date){l=Ext.Date.format(l,g.dateFormat||d.fields.get(m.dataIndex).dateFormat)}else{if(Ext.isBoolean(l)){l=l.toString()}}}j=sl.utils.doesStringContainAllPieces(l,e,false,!h);f.push(j?l:undefined);b=b||j}})}else{b=true}d.setSortRanking(e,undefined,f);return b},doRemoteFilter:function(){var d=this,c=d.grid,b=c.getStore(),f=b.getFilteredText(),a=[],e;if(b.lastOptions&&b.lastOptions.params&&b.proxy&&b.proxy.startParam){b.lastOptions.params[b.proxy.startParam]=0}d.menu.items.each(function(h){var g;if(h.checked&&h.dataIndex){a.push(h.dataIndex);if(h.column&&Ext.isFunction(h.column.getEditor)){g=h.column.getEditor();if(g.gridDisplayField){a.push(g.gridDisplayField)}if(sl.utils.isComboBox(g)){sl.consoleWarn("["+d.$className+"] Combo's Display Field is not included in Search")}}}});b.proxy.originalExtraParams=Ext.encode(b.proxy.extraParams);if(b.proxy&&b.proxy.extraParams){delete (b.proxy.extraParams[d.paramNames.fields]);delete (b.proxy.extraParams[d.paramNames.query])}if(b.lastOptions&&b.lastOptions.params){delete (b.lastOptions.params[d.paramNames.fields]);delete (b.lastOptions.params[d.paramNames.query])}if(a.length&&b.proxy&&b.proxy.extraParams){b.proxy.extraParams[d.paramNames.fields]=Ext.encode(a);b.proxy.extraParams[d.paramNames.query]=f;b.setFilteredText(f);b.usingSearchFilter=true}if(b.lastOptions&&b.lastOptions.params){e=b.lastOptions.params}b.load({params:e,callback:function(){b.extraParams=Ext.decode(b.originalExtraParams);b.usingSearchFilter=false;d.fireEvent("filtered",d)},scope:d})},enable:function(){this.setDisabled(false)},disable:function(){this.setDisabled(true)},setDisabled:function(a){var b=this.getField();b.setDisabled.apply(b,arguments)},buildFilterMenu:function(){var d=this,f=d.getMenu(),g=(Ext.isArray(d.excludedDataIndexes)&&(d.excludedDataIndexes||[]).length>0),b=(Ext.isArray(d.readonlyIndexes)&&(d.readonlyIndexes||[]).length>0),e=(Ext.isArray(d.preCheckedIndexes)&&(d.preCheckedIndexes||[]).length>0),c,a;if(f){f.removeAll();if(d.showSelectAll&&"radio"!==d.menuStyle){f.add({xtype:"menucheckitem",text:d.selectAllText,checked:false,hideOnClick:false,handler:function(i){var h=i.checked;i.parentMenu.items.each(function(j){if(i!==j&&j.setChecked&&!j.disabled){j.setChecked(h)}})}},"-")}c=d.grid.getColumns();if("radio"===d.menuStyle){a="g"+(new Date()).getTime()}Ext.Array.forEach(c,function(j,i,m){var h=false,k=false,l=!j.hidden;if(j.text&&j.dataIndex){if(g){h=(Ext.Array.indexOf(d.excludedDataIndexes,j.dataIndex)>=0)}if(b){k=(Ext.Array.indexOf(d.readonlyIndexes,j.dataIndex)>=0)}if(e){l=(Ext.Array.indexOf(d.preCheckedIndexes,j.dataIndex)>=0)}if(!h){f.add({xtype:"menucheckitem",text:j.text.replace(Ext.util.Format.stripTagsRe," "),hideOnClick:false,group:a,disabled:k,checked:l,dataIndex:j.dataIndex,column:j})}}})}},rankAndSortRecords:function(b){var i=this,a=i.grid,j=a.getStore(),c=j.getRecords(),k=c.length,h=j.getSorters()||{},e=(0===h.length),d=[],g,f;if(k){if(!e){e=Ext.isFunction(h.containsKey)&&h.containsKey("sort_character_index")}if(e){b=sl.utils.stripNonAlphanumericChars(b||"");f=i.getCheckedMenuItems();Ext.Array.forEach(f,function(m,l,n){if(m&&m.column&&m.column.dataIndex){d.push(m.column.dataIndex)}});if(!Ext.isEmpty(b)){g=j.sortRecordsForRevelency(b,d,c)}}}},getCheckedMenuItems:function(){var b=this,c=b.getMenu(),a=[];c.items.each(function(d){if(d.checked){a.push(d)}});return a}});Ext.define("sl.panel.grid.plugin.GridRowCount",{extend:"Ext.AbstractPlugin",mixins:["Ext.util.Observable"],alias:"plugin.gridrowcount",requires:["Ext.form.Label","Ext.toolbar.Separator","Ext.toolbar.Spacer","Ext.util.Format"],constructor:function(a){this.callParent(arguments);this.mixins.observable.constructor.call(this,a)},defaultCls:"gridrowcount",rowCountMsg:"{0}",hiddenRowsCls:"hiddenrows",hiddenRowsCountMsg:"Showing {0} of {1}",hiddenRowsCountMsgMini:"{0} of {1}",widthForUsingMiniText:500,selectedCountMsg:"{0} selected",selectedCountMsgMini:"{0} sel.",refreshTimeMsg:" Refreshed @ {0}",rowName:"",toolbarPosition:"bottom",config:{totalCount:0,visibleCount:0,selectionCount:0,refreshTime:"",visible:false},align:"left",updateBuffer:250,init:function(a){var b=this,c=function(d,e){if(e){a.un({scope:b,uiupdate:b.onUpdatedUI,statusupdated:b.updateDetails});e.un({scope:b,load:b.onStoreLoad,clear:b.updateDetails,add:b.updateDetails,remove:b.updateDetails})}if(d){a.on({scope:b,uiupdate:b.onUpdatedUI,statusupdated:b.updateDetails});d.on({scope:b,load:b.onStoreLoad,clear:b.updateDetails,add:b.updateDetails,remove:b.updateDetails})}};b.grid=a;b.rowName=b.rowName||a.singleName||"row";b.rowNamePlural=b.rowNamePlural||a.pluralName||"";if(!Ext.isDefined(b.includeLoadTime)){b.includeLoadTime=b.grid.includeLoadTime}c(a.getStore());a.on("reconfigure",function(g,e,i,h,d,f){c(e,h)});if(a.getView()){a.getView().on({scope:b,refresh:b.updateDetails})}if(a.getSelectionModel()){a.getSelectionModel().on({scope:b,selectionchange:b.updateDetails})}b.updateRowCountLabel=Ext.Function.createBuffered(b.updateRowCountLabel,b.updateBuffer,b);b.updateSelectionCountLabel=Ext.Function.createBuffered(b.updateSelectionCountLabel,b.updateBuffer,b);b.updateRefreshTimeLabel=Ext.Function.createBuffered(b.updateRefreshTimeLabel,b.updateBuffer,b);a.onRender=Ext.Function.createSequence(a.onRender,b.onRender,b)},onRender:function(){var a=this;if(!a.grid.useStatusBar){a.addItemsToToolbar()}},onStoreLoad:function(){var a=this;a.updateDetails();if(a.includeLoadTime){a.setRefreshTime(new Date().toLocaleTimeString())}},onUpdatedUI:function(){var a=this;a.updateDetails();if(a.includeLoadTime){a.setRefreshTime(new Date().toLocaleTimeString())}},getToolbar:function(){var a=this;a.toolbar=Ext.isDefined(a.toolbar)?a.toolbar:a.grid.getMatchingToolbar(a.toolbarId,a.toolbarPosition);return a.toolbar},addItemsToToolbar:function(){var e=this,d=e.getItemsForToolbar(),b=e.insertLoc||0,a=e.getToolbar();for(var c=d.length-1;c>=0;c--){a.insert(b,d[c])}return d},getRowCountLabel:function(){var a=this;a.rowCountLabel=Ext.isDefined(a.rowCountLabel)?a.rowCountLabel:Ext.create("Ext.form.Label",{hidden:true});return a.rowCountLabel},setVisiblitiyOfPrevSeparator:function(a){var e=this,c=e.getToolbar(),d=c.items.indexOf(e.getRowCountLabel()),b=c.items.getAt(d-1);if(b&&sl.utils.isTBSeparator(b)){b.setVisible(a)}},getSelectionCountSeparator:function(){var a=this;a.selectionCountSeparator=Ext.isDefined(a.selectionCountSeparator)?a.selectionCountSeparator:Ext.create("Ext.toolbar.Separator",{hidden:true,cls:"selectionCountSeparator"});return a.selectionCountSeparator},getSelectionCountLabel:function(){var a=this;a.selectionCountLabel=Ext.isDefined(a.selectionCountLabel)?a.selectionCountLabel:Ext.create("Ext.form.Label",{hidden:true,cls:a.selectedCountCls||a.defaultCls,listeners:{beforeshow:function(){a.selectionCountSeparator.setVisible(true)},beforehide:function(){a.selectionCountSeparator.setVisible(false)}}});return a.selectionCountLabel},getRefreshTimeSeparator:function(){var a=this;a.refreshTimeSeparator=Ext.isDefined(a.refreshTimeSeparator)?a.refreshTimeSeparator:Ext.create("Ext.toolbar.Separator",{hidden:true,cls:"refreshTimeSeparator"});return a.refreshTimeSeparator},getRefreshTimeLabel:function(){var a=this;a.refreshTimeLabel=Ext.isDefined(a.refreshTimeLabel)?a.refreshTimeLabel:Ext.create("Ext.form.Label",{hidden:true,cls:a.refreshTimeCls||a.defaultCls,listeners:{beforeshow:function(){a.refreshTimeSeparator.setVisible(true)},beforehide:function(){a.refreshTimeSeparator.setVisible(false)}}});return a.refreshTimeLabel},getItemsForToolbar:function(){var b=this,a=[];if(b.align==="right"){a.push({xtype:"tbspacer",flex:1})}a.push(b.getRowCountLabel());a.push(b.getSelectionCountSeparator());a.push(b.getSelectionCountLabel());a.push(b.getRefreshTimeSeparator());a.push(b.getRefreshTimeLabel());return a},updateDetails:function(){var e=this,d=e.grid,b=d.getStore(),a=d.getSelectionModel(),c=b.getRecords(true).length,f=b.getRecords(false).length;e.setTotalCount(f);e.setVisibleCount(c);if(a){e.setSelectionCount(a.getSelection().length)}},updateTotalCount:function(b,a){var c=this;c.updateRowCountLabel()},updateVisibleCount:function(b,a){var c=this;c.updateRowCountLabel()},updateSelectionCount:function(b,a){var c=this;c.updateSelectionCountLabel()},updateRefreshTime:function(b,a){var c=this;c.updateRefreshTimeLabel()},updateSelectionCountLabel:function(){var d=this,c=d.selectionCountLabel,e="",b=d.getSelectionCount(),a=false;if(c){if(!d.waitToRun(c,this.updateSelectionCountLabel)){if(!d.grid.hasListeners.beforeupdateselectioncountererlabel||d.grid.fireEvent("beforeupdateselectioncountererlabel",d)!==false){if(b===0){c.hide();c.setText(e)}else{e=Ext.String.format((d.grid.getWidth()<=(d.widthForUsingMiniText||0)?d.selectedCountMsgMini:d.selectedCountMsg),b);c.setText(e);c.show()}d.grid.fireEvent("updateselectioncountererlabel",d,e)}a=!c.isHidden();Ext.Component.updateLayout(d.getToolbar())}}return a},updateRefreshTimeLabel:function(){var c=this,e=c.refreshTimeLabel,b="",d=c.getRefreshTime(),a=false;if(e){if(!c.waitToRun(e,this.updateRefreshTimeLabel)){if(!c.grid.hasListeners.beforeupdaterefreshtimelabel||c.grid.fireEvent("beforeupdaterefreshtimelabel",c)!==false){if(Ext.isEmpty(d)){e.hide();e.setText(b)}else{b=Ext.String.format(c.refreshTimeMsg,d);e.setText(b);e.show()}c.grid.fireEvent("updaterefreshtimelabel",c,b)}a=!e.isHidden();Ext.Component.updateLayout(c.getToolbar())}}return a},updateRowCountLabel:function(){var g=this,i=g.rowCountLabel,c="",d=false,b=g.grid,e,f,h,a;if(i){if(!g.waitToRun(i,this.updateRowCountLabel)){if(!b.hasListeners.beforeupdaterowcounterlabel||b.fireEvent("beforeupdaterowcounterlabel",g)!==false){e=g.getTotalCount();f=g.getVisibleCount();h=g.hasHiddenRows=(e!==f);a=Ext.util.Format.plural(e,g.rowName,g.rowNamePlural);if(e===0){i.hide()}else{if(h){c=Ext.String.format((b.getWidth()<=(g.widthForUsingMiniText||0)?g.hiddenRowsCountMsgMini:g.hiddenRowsCountMsg),f,a);i.getEl().removeCls(g.rowCountCls);i.getEl().removeCls(g.defaultCls);i.getEl().addCls(g.hiddenRowsCls||g.defaultCls)}else{c=Ext.String.format(g.rowCountMsg,a);i.getEl().removeCls(g.hiddenRowsCls);i.getEl().removeCls(g.defaultCls);i.getEl().addCls(g.rowCountCls||g.defaultCls)}i.setText(c);i.show()}b.fireEvent("updaterowcounterlabel",g,c)}d=!i.isHidden();Ext.Component.updateLayout(g.getToolbar())}}return d},hide:function(){var b=this,a=b.getItemsForToolbar();Ext.Array.forEach(a,function(d,c,e){d.hide()});b.hidden=true;return b},show:function(){var b=this,a=false;a=b.updateRowCountLabel()||a;a=b.updateSelectionCountLabel()||a;a=b.updateRefreshTimeLabel()||a;b.hidden=!a;return b},isGridCollapsed:function(){var a=this.grid;return Ext.isFunction(a.isCollapsed)?a.isCollapsed():a.collapsed},waitToRun:function(c,e){var d=this,a={scope:d,single:true,delay:250},b=false;if(!c.rendered){c.on(Ext.apply(a,{afterrender:e}));b=true}else{if(this.isGridCollapsed()){d.grid.on(Ext.apply(a,{expand:e}));b=true}}return b}});Ext.define("sl.state.CacheProvider",{extend:"Ext.state.Provider",alias:"state.cacheprovider",uses:["sl.utils.Utilities"],async:true,flushCache:false,saveSuccessText:"[CacheProvider] Saved",saveFailureText:"[CacheProvider] Save Failure",readSuccessText:"[CacheProvider] Read",readFailureText:"[CacheProvider] Read Failure",deleteSuccessText:"[CacheProvider] Deleted",deleteFailureText:"[CacheProvider] Delete Failure",dataErrorText:"Data Error",constructor:function(a){var b=this,c=b.uid;if(Ext.isString(c)){c=c.toLowerCase()}b.callParent(arguments);Ext.apply(b,a,{delay:750,dirty:false,started:false,autoStart:true,autoRead:true,user:"user",id:1,session:"session",logFailure:false,logSuccess:false,queue:[],url:".",readUrl:undefined,saveUrl:undefined,method:"POST",saveBaseParams:{},readBaseParams:{},type:"cache",paramNames:{id:"ID",name:"ObjectID",value:"JSONState",data:"records",defaultDesc:c?(c+"'s initial view"):"Initial View",defaultUser:"Everyone",indexPrefix:1}});if(b.autoRead){b.readState()}b.dt=Ext.create("Ext.util.DelayedTask",b.submitState,b);if(b.autoStart){b.start()}},initState:function(b){var a=this;if(Ext.isArray(b)){Ext.Array.forEach(b,function(d,c,e){a.state[d[a.paramNames.name]]=Ext.decode(d[a.paramNames.value])})}else{a.state=(b?b:{})}},set:function(a,c,b){if(!a){return}this.queueChange(a,c,b)},start:function(){var a=this;a.dt.delay(a.delay);a.started=true},stop:function(){var a=this;a.dt.cancel();a.started=false},queueChange:function(b,g,h){var f=this,c={},i=false,a=f.state[b],e,d;h=h||f.paramNames.defaultDesc;Ext.Array.forEach(f.queue,function(k,j,l){if(k.name===b){a=Ext.decode(Ext.decode(k).Properties[f.paramNames.value])}});e=(Ext.isEmpty(a)||undefined===a||(a!==g&&Ext.encode(a)!==Ext.encode(g)));if(e||(h!==f.paramNames.defaultDesc)){d=f.getuprofile(h);c={CacheClassName:"App.State",Properties:{uprofile:d,AppPath:f.AppPath,ObjectID:b,Description:h,ID:f.getAppStateID(b,h,d),JSONState:Ext.encode(g)}};Ext.Array.forEach(f.queue,function(k,j,l){if(Ext.decode(k).Properties[f.paramNames.name]===b){k=Ext.encode(c);i=true}});if(false===i){f.queue.push(Ext.encode(c))}f.dirty=true}if(f.started){f.start()}return e},getuprofile:function(b){var a=this;return(b===a.paramNames.defaultDesc)?a.uprofile:a.paramNames.defaultUser},getAppStateID:function(a,d,b){var c=this;b=b||c.getuprofile(d);return c.paramNames.indexPrefix+"||"+b+"||"+c.AppPath+"||"+a+"||"+d},submitState:function(){if(!this.dirty){this.dt.delay(this.delay);return}this.dt.cancel();Ext.Ajax.request({scope:this,url:"../Ext.JsonRequest.cls",timeout:900000,success:this.onSaveSuccess,failure:this.onSaveFailure,params:{CacheClassName:"JSON.Adapter",CacheMethodName:"SaveObjects",CacheCommandType:1,JSONObject:Ext.encode(this.queue)},callback:function(b,c,a){this.fireEvent("save",this,b,c,a)}});this.dirty=false},deleteState:function(){},readState:function(){var a=this;Ext.Ajax.request({scope:a,url:"../Ext.JsonRequest.cls",success:a.onReadSuccess,failure:a.onReadFailure,params:{CacheClassName:"App.State",CacheQueryName:"GetUserStateForApp",CacheCommandType:2,ucorp:a.ucorp,udivision:a.udivision,uid:a.uid,uprocgroup:a.uprocgroup,uprofile:a.uprofile,AppPath:a.AppPath}})},clear:function(a){this.set(a,undefined)},onSaveSuccess:function(c,n){var b={};try{b=Ext.decode(c.responseText)}catch(h){if(true===this.logFailure){this.log(this.saveFailureText,h,c,n)}this.dirty=true;return}if(true!==b.success){if(true===this.logFailure){this.log(this.saveFailureText,b,c,n)}this.dirty=true}else{var k=Ext.decode(n.params.JSONObject)||[];Ext.each(k,function(j){if(!j){return}j=Ext.decode(j);var e=j.Properties[this.paramNames.name];var i=j.Properties[this.paramNames.value];if(Ext.isEmpty(i)){sl.state.CacheProvider.superclass.clear.call(this,e)}else{sl.state.CacheProvider.superclass.set.call(this,e,i)}},this);if(false===this.dirty){this.queue=[]}else{var f,d,m;for(f=0;f<k.length;f++){m=false;var a=k[f],g;for(d=0;d<this.queue.length;d++){g=this.queue[f];Ext.Array.remove(this.queue,a)}}}if(true===this.logSuccess){var l;try{l=' "'+Ext.decode(k[0]).Properties.Description+'"'+(this.panelName?' in "'+this.panelName+'"':"")}catch(h){l=' "'+this.panelName||""}sl.utils.consoleLogWithTrace(this.saveSuccessText+l,{o:b,response:c,options:n})}this.fireEvent("savesuccess",this,c,n)}},onSaveFailure:function(a,b){if(true===this.logFailure){var c=': "'+this.panelName+'"';console.error(this.saveFailureText+c,{response:a,options:b})}this.dirty=true;this.fireEvent("savefailure",this)},onDeleteFailure:function(a,b){if(true===this.logFailure){this.log(this.deleteFailureText,a)}this.fireEvent("deletefailure",this)},onDeleteSuccess:function(b,d){var k={};try{k=Ext.decode(b.responseText)}catch(h){if(true===this.logFailure){this.log(this.deleteFailureText,h,b,d)}return}if(true!==k.success){if(true===this.logFailure){this.log(this.deleteFailureText,k,b,d)}}else{var a=Ext.decode(d.params.JSONObject)||[];Ext.each(a,function(i){if(!i){return}i=Ext.decode(i);var e=i.Properties[this.paramNames.name];sl.state.CacheProvider.superclass.clear.call(this,e)},this);if(false===this.dirty){this.queue=[]}else{var f,c,g;for(f=0;f<a.length;f++){g=false;for(c=0;c<this.queue.length;c++){if(a[f].name===this.queue[c].name){g=true;break}}if(true===g&&Ext.encode(a[f].value)===Ext.encode(this.queue[c].value)){this.queue.remove(this.queue[c])}}}if(true===this.logSuccess){this.log(this.deleteSuccessText,k,b,d)}this.fireEvent("deletesuccess",this,b,d)}},onReadFailure:function(a,b){if(true===this.logFailure){this.log(this.readFailureText,a)}this.fireEvent("readfailure",this)},onReadSuccess:function(a,b){var f={},c;try{f=Ext.decode(a.responseText)}catch(d){if(true===this.logFailure){this.log(this.readFailureText,d,a)}return}if(true!==f.success){if(true===this.logFailure){this.log(this.readFailureText,f,a)}}else{c=f[this.paramNames.data];if(!(c instanceof Array)&&true===this.logFailure){this.log(this.dataErrorText,c,a);return}if(this.flushCache){this.state={}}Ext.each(c,function(e){this.state[e[this.paramNames.name]]=Ext.decode(e[this.paramNames.value])},this);Ext.state.Manager.getProvider().initState(c);this.queue=[];this.dirty=false;if(true===this.logSuccess){this.log(this.readSuccessText,c,a)}this.fireEvent("readsuccess",this)}},log:function(){sl.utils.consoleLogWithTrace.apply(this,arguments)}});Ext.define("sl.panel.grid.plugin.GridStateViewPanel",{extend:"Ext.util.Observable",alias:"plugin.gridstateviewpanel",requires:["Ext.button.Button","Ext.form.Label","Ext.form.field.ComboBox","Ext.state.LocalStorageProvider","Ext.state.Manager","Ext.toolbar.Spacer","Ext.util.DelayedTask","sl.state.CacheProvider"],uses:["sl.utils.Toast","sl.data.CacheStore"],providerType:"local",displayAsButton:true,buttonText:"Saved Views",includeViewPanel:true,toolbarPosition:"bottom",align:"right",init:function(a){var b=this;b.grid=a;Ext.state.Manager.setProvider(b.getProvider(b.providerType));b.saveInitialGridColumnLayout();a.onRender=Ext.Function.createSequence(a.onRender,b.onRender,b)},onRender:function(){var a=this,b=a.getProvider();if(a.includeViewPanel){a.createViewPanel();if(!a.grid.useStatusBar){a.addItemsToToolbar()}}if(b.loadedAppStates===true||b.type==="local"){a.applyGridState()}else{b.on("loadedappstates",function(){a.applyGridState()},a,{single:true})}},saveInitialGridColumnLayout:function(){var c=this,b=c.grid,a,d;if(!b._initialColumnLayout){a=[];d=b.columns;a=c.getCurrentStateOfColumnsArray(d);b._initialColumnLayout=Ext.encode(a)}},getCurrentStateOfColumnsArray:function(b){var c=this,a=c.grid,f=[],e,d;b=Ext.isDefined(b)?b:a.getColumns(false,true);Ext.Array.forEach(b,function(j,h,i){var g=j.getStateId();if(Ext.isNumber(j.getId())){j.setId(j.dataIndex)}if((Ext.isEmpty(g))||(Ext.isString(g)&&(g.substring(0,1)==="h"&&Ext.isNumeric(g.substring(1)))||(g.split("-")[0]==="header"&&Ext.isNumeric(g.split("-")[1])))){d=Ext.valueFrom(Ext.valueFrom(a.getDefaultTitle(),a.getTitle()),a.getId());if(j.isGroupHeader||j.columns){d+=" Grouped";Ext.Array.forEach(j.items.items,function(l,k,m){d+="~"+l.dataIndex})}else{d+=j.dataIndex}j.stateId=sl.utils.stripNonAlphanumericChars(d,true)}e={id:String(j.getStateId()||j.getId()).substr(0,75),isGroupHeader:j.isGroupHeader,columns:j.isGroupHeader?c.getCurrentStateOfColumnsArray(j.items.items):undefined,dataIndex:j.dataIndex,flex:j.flex,width:j.width,locked:j.locked,hidden:j.hidden?true:false};Ext.Object.each(e,function(k,m,l){if(Ext.isEmpty(m)){delete e[k]}});f.push(e)});return f},getProvider:function(b){var a=this,c;b=Ext.isString(b)?b:a.providerType;if(b==="cache"){c=a.getCacheProvider()}else{if(b==="local"){c=a.getLocalProvider()}else{c=Ext.state.Manager.getProvider()}}if(!c){}return c},getLocalProvider:function(b){var a=this,c=Ext.state.Manager.getProvider();if(Ext.isEmpty(c)||((c.alias||[]).indexOf("state.localstorage")<0)&&(c.type!=="local")){c=a.createLocalProvider(b)}if(c){c.type="local"}return c},getCacheProvider:function(b){var a=this,c=Ext.state.Manager.getProvider();if(Ext.isEmpty(c)||c.type!=="cache"){c=a.createCacheProvider(b)}return c},createLocalProvider:function(b){var a=Ext.create("Ext.state.LocalStorageProvider",{type:"local"});Ext.state.Manager.setProvider(a);return a},createCacheProvider:function(e){var c=this,b=c.grid,f=Ext.Object.fromQueryString(window.location.search.substring(1)),a,d;if(Ext.isEmpty(e)){d=window.location.pathname.split("/");if(d.length>=2){e=d[d.length-2]+"/"+d[d.length-1]}else{}}a=Ext.create("sl.state.CacheProvider",{autoRead:false,uprofile:f.uprofile,uid:f.uid,AppPath:e,loadedAppStates:"inprogress",panelName:b.defaultTitle||b.title||b.getItemId(),logSuccess:!Ext.isEmpty(f.debug),logFailure:true});c.initCacheProvider(a);return a},initCacheProvider:function(a){var b=this;Ext.state.Manager.setProvider(a);Ext.Ajax.request({scope:b,url:"../Ext.JsonRequest.cls",params:{CacheClassName:"App.State",CacheMethodName:"BuildAppStatesForUser",CacheCommandType:1,uprofile:a.uprofile,AppPath:a.AppPath},callback:function(d,g,c){var e=Ext.decode(c.responseText),f;if(e.result){f=Ext.decode(e.result);a.initState(f.records);a.loadedAppStates=true;sl.MsgQ.subscribe(a,"FullScreen-Close",{fn:function(){a.loadedAppStates=false;Ext.state.Manager.setProvider()},scope:a});a.fireEvent("loadedappstates",a,f.records)}}})},applyGridState:function(f,a,h){var e=this,c=e.grid,d=c.down("combo#savedViewsCombo"),g=e.getProvider(),b=c.getStateId();a=a||(h?g.paramNames.defaultDesc:undefined);f=f||g.state[c.getStateId()]||{columns:Ext.decode(c._initialColumnLayout)};if(Ext.isEmpty(f)){Ext.Msg.alert("Error",g.paramNames.defaultDesc+" Columns Config Not Defined.  Needs to be defined before grid is rendered")}else{c.suspendLayout=true;c.applyState(f);if(!sl.utils.IsObjEmpty(c.filters)&&Ext.isFunction(c.filters.applyState)){c.filters.applyState(c,f)}if(h){sl.utils.Toast.showToast("View Refreshed","The <b>"+a+"</b> View has been applied.",3000,"b")}e.getProvider().set(b,f);c.suspendLayout=false;c.updateLayout();if(a){if(Ext.isObject(c.viewPanel)){d.setRawValue(a);if(!e.displayAsButton){d.focus(false,true)}}else{c.on("viewpanelcreated",function(){d.setRawValue(a)},e,{single:true})}}}},createViewPanel:function(){var c=this,b=c.grid,g=c.getProvider(),d={iconCls:"TableRefreshButton",icon:"/resources/icons/fam/table_refresh.png",text:"Reset Columns",tooltip:"<b>Resets the following Column Configurations:</b><ul><li>Width</li><li>Order</li><li>Sorting</li></ul>",listeners:{scope:c,click:c.resetColumnsButton_click}},f,e,a,h;c.viewPanel={align:c.align,grid:b};if(g.type==="local"||c.providerType==="local"){c.viewPanel=Ext.apply({resetColumnsButton:d},c.viewPanel)}else{if(g.type==="cache"||c.providerType==="cache"){f={iconCls:"TableSaveButton",icon:"/resources/icons/fam/table_save.png",text:c.displayAsButton?"Save Current View":"Save View",tooltip:c.displayAsButton?"":"Save Current View",listeners:{scope:c,click:c.saveViewButton_click}};e={iconCls:"TableDeleteButton",icon:"/resources/icons/fam/table_delete.png",text:c.displayAsButton?"Delete Current View":"Delete View",tooltip:c.displayAsButton?"":"Delete Current View",listeners:{scope:c,click:c.deleteViewButton_click}};a={xtype:"combo",width:250,valueField:"ID",displayField:"Description",minChars:0,itemId:"savedViewsCombo",value:((g||{}).paramNames||{}).defaultDesc,store:Ext.create("sl.data.CacheStore",{autoLoad:true,proxy:{extraParams:{CacheClassName:"App.State",CacheQueryName:"GetObjectState",CacheCommandType:2,uprofile:g.uprofile,AppPath:g.AppPath,ObjectID:b.getStateId()}},fields:["ID","Description","JSONState"]}),listeners:{scope:c,select:c.savedViewsCombo_select}};h={xtype:"label",html:"<b>View: </b>"};c.viewPanel=Ext.apply({displayAsButton:c.displayAsButton,saveViewButton:f,deleteViewButton:e,resetColumnsButton:d,savedViewsCombo:a,viewLabel:h},c.viewPanel);if(c.displayAsButton){c.viewPanel.viewButton=Ext.create("Ext.Button",{icon:"/resources/icons/fam/table.png",text:c.buttonText,menu:[c.viewPanel.saveViewButton,c.viewPanel.deleteViewButton,"-",c.viewPanel.resetColumnsButton,"-",c.viewPanel.savedViewsCombo]})}}}b.viewPanel=c.viewPanel;b.fireEvent("viewpanelcreated",c.viewPanel);return c.viewPanel},addItemsToToolbar:function(){var e=this,d=e.getItemsForToolbar(),b=b||e.viewPanel.insertLoc||0,a=e.toolbar=e.grid.getMatchingToolbar(e.toolbarId,e.toolbarPosition);for(var c=d.length-1;c>=0;c--){a.insert(b,d[c])}return d},getItemsForToolbar:function(){var a=this.viewPanel,b=[],c=a.align||"right";if(c==="right"){b.push({xtype:"tbspacer",flex:1})}if(a.displayAsButton){b.push(a.viewButton)}else{b.push(a.viewLabel);b.push(a.savedViewsCombo);b.push(a.saveViewButton);b.push(a.deleteViewButton);b.push(a.resetColumnsButton)}return b},savedViewsCombo_select:function(e,a){var b=this,d=b.grid,f,c,g;if(a){f=a.get("Description");c=a.get("JSONState");g=Ext.decode(c);d.mask("Updating View...","x-mask-loading");new Ext.util.DelayedTask(function(){b.applyGridState(g,f,true);d.unmask()}).delay(100)}},resetColumnsButton_click:function(){var b=this,c=b.grid,d=b.getProvider(),f,a,e;c.mask("Updating View...","x-mask-loading");b.grid.getStore().sorters.clear();Ext.Array.forEach(b.grid.getColumns(false,false),function(h,g,i){h.setSortState(null,true)});new Ext.util.DelayedTask(function(){e=Ext.decode(c._initialColumnLayout);f=d.state[c.getStateId()]={columns:e};a=d.type==="cache"?d.paramNames.defaultDesc:undefined;b.applyGridState(f,a,!Ext.isEmpty(a));c.unmask()}).delay(25)},saveViewButton_click:function(){var c=this,d=c.grid,f=c.getProvider(),b=d.getStateId(),g=d.getState(),a="",e=d.down("combo#savedViewsCombo");if((e.getRawValue()!==f.paramNames.defaultDesc)&&(e.getValue()!==f.paramNames.defaultDesc)){a=e.getRawValue()}Ext.Msg.prompt("Name your Public View","Please enter a <b>Description</b> for your view:",function(h,i){if(h==="ok"){f.on("save",function(q,u,s,n){if(s){var j=Ext.decode(n.responseText),m="",k={},o,l,t,p;if(j.result&&u.params){t=Ext.decode(u.params.JSONObject);if(Ext.isArray(t)&&t.length>0){p=Ext.decode(t[0]);if(p&&p.Properties){o=p.Properties.Description;l=p.Properties.ID}}}if(o){m="<b>"+o+"</b> "}k[e.getStore().getIDProperty()]=l;e.getStore().load({scope:c,params:k,callback:function(){e.suspendEvent("select");e.setValue(l);e.resumeEvent("select");e.focus(false,true)}});sl.utils.Toast.showToast("Save Success","The custom "+m+"View was Saved.",3000)}},this,{single:true});f.set(b,g,i)}},this,false,a)},deleteViewButton_click:function(){Ext.Msg.alert("Delete not configured yet...")}});Ext.define("sl.panel.grid.plugin.GridStatusBar",{extend:"sl.panel.StatusBar",alias:["widget.slgridstatusbar","widget.gridstatusbar"],uses:["sl.utils.Utilities"],grid:undefined,initComponent:function(){var a=this;a.grid=(a.grid||a.initOwnerCt||a.up("grid[isLocked=undefined]")||a.up("treepanel[isLocked=undefined]")||a.up("panel[isLocked=undefined]"));if(a.grid&&a.grid.getStore()){a.grid.getStore().on({scope:a,priority:-1,clear:function(){a.showValid()},saving:function(){a.showSaving()},save:function(b){var d=b.getUnsavedRecords()||[],c=b.getLastSavedRecords()||[];if(d.length===0){a.showValid(c.length+" Saved")}else{if(a.status!=="error"){if(Ext.isDefined(a.validationStatus)){if(!a.validationStatus.updateStatusText()){a.showError()}}}}},"delete":function(b){var d=b.getNotDeletedRecords()||[],c=b.getDeletedRecords()||[];if(d.length===0){a.showValid(c.length+" Deleted")}else{if(a.status!=="error"){if(Ext.isDefined(a.validationStatus)){if(!a.validationStatus.updateStatusText()){a.showError()}}}}}})}else{}a.on({statusupdated:function(c,b){c.grid.fireEvent("statusupdated",c.grid,c,b)}});a.callParent()}});Ext.define("sl.panel.grid.plugin.GridValidationStatus",{extend:"Ext.ux.statusbar.ValidationStatus",alias:"plugin.gridvalidationstatus",requires:["sl.panel.grid.plugin.GridStatusBar"],errorIconCls:"x-status-error",errorListCls:"x-status-error-list",validIconCls:"x-status-valid",showText:"{0} Error{1} (click for details)",showTextMini:"{0} Error{1}",hideText:"Click again to hide the error list",hideTextMini:"Click to hide",widthForUsingMiniText:500,submitText:"Saving...",maxErrorCount:30,updateBuffer:500,init:function(b){var a=this;a.statusBar=b;a.statusBar.validationStatus=a;a.statusBar.hasValidation=true;a.updateStatusText=Ext.Function.createBuffered(a.updateStatusText,a.updateBuffer,a);b.on({single:true,scope:a,render:a.onStatusbarRender,beforedestroy:a.destroy});b.statusMsg.on({dblclick:{element:"el",fn:a.onStatusDblClick,scope:a,buffer:100},click:{element:"el",fn:a.onStatusClick,scope:a,buffer:100}})},onStatusbarRender:function(c){var a=this,b=function(d,e){if(d){if(e){a.stopMonitoring();a.stopMonitoringStore(e)}d.errorHash=Ext.create("Ext.util.HashMap");if(d.isRecordChangeValidated){a.startMonitoring();a.startMonitoringStore(d)}}};a.errors=Ext.create("Ext.util.MixedCollection");a.listAlign=(c.statusAlign==="right"?"br-tr?":"bl-tl?");a.grid=(a.grid||c.ownerCt||c.up("grid[isLocked=undefined]")||c.up("treepanel[isLocked=undefined]")||c.up("panel[isLocked=undefined]"));if(a.grid){b(a.grid.getStore());a.grid.on("reconfigure",function(g,e,i,h,d,f){b(e,h)})}},startMonitoring:function(){var a=this;if(!a.monitor){a.grid.on({scope:a,uiupdate:a.onUpdatedUI});if(a.grid.store.isLoaded()===true){a.updateStatusText()}a.monitor=true}},stopMonitoring:function(){var a=this;if(a.monitor){a.grid.un("updateui",a.onUpdatedUI,a);a.monitor=false}},startMonitoringStore:function(a){var b=this;a=Ext.isDefined(a)?a:b.grid.getStore();if(!a.monitor){a.on({scope:b,beforeload:b.onBeforeStoreLoad,load:b.onStoreChange,clear:b.onStoreChange,save:b.onStoreChange,"delete":b.onStoreDelete,recordvalidated:b.onRecordValidated,recordfailedsave:b.updateErrorFromRecord,recordfaileddelete:b.updateErrorFromRecord});a.monitor=true}},stopMonitoringStore:function(a){var b=this;a=Ext.isDefined(a)?a:b.grid.getStore();if(a.monitor){a.un("beforeload",b.onBeforeStoreLoad,b);a.un("load",b.onStoreChange,b);a.un("clear",b.onStoreChange,b);a.un("save",b.onStoreChange,b);a.un("delete",b.onStoreDelete,b);a.un("recordvalidated",b.onRecordValidated,b);a.un("recordfailedsave",b.updateErrorFromRecord,b);a.un("recordfaileddelete",b.updateErrorFromRecord,b);a.monitor=false}},onDestroy:function(){var a=this;a.stopMonitoring();a.stopMonitoringStore();a.statusBar.statusEl.un("click",a.onStatusClick,a);a.callParent(arguments)},onBeforeStoreLoad:function(){var a=this;a.errors.clear();a.statusBar.showBusy()},onStoreChange:function(){this.updateStatusText()},onStoreDelete:function(b,a){var c=this;a=Ext.isArray(a)?a:b.getDeletedRecords();Ext.Array.forEach(a,function(e,d,f){c.errors.removeAtKey(e.id)});c.updateStatusText()},onUpdatedUI:function(c,a,d,b){var e=this,f=Ext.Array.merge(a,d);c.store.validateRecords(f);e.onStoreDelete(c.getStore(),b)},updateErrorFromRecord:function(b,a){var e=this,d=e.grid,c=a.getValidation(),f=c.isValid(),g;if(!e.monitor){return false}if(!f){g=e.getRecordErrorMsg(a,d);e.errors.add(a.id,{record:a,msg:g})}else{e.errors.removeAtKey(a.id)}e.updateStatusText();return f},onRecordValidated:function(b,a){var d=this,c=d.grid,e=a.isValid(),f;if(!d.monitor){return false}if(!e){f=d.getRecordErrorMsg(a,c);d.errors.add(a.getId(),{record:a,msg:f})}else{d.errors.removeAtKey(a.getId())}d.updateStatusText();return e},updateStatusText:function(){var c=this,a=false;if(c.errors.getCount()>0){var f=c.grid.getWidth()<=(c.widthForUsingMiniText||0)?c.showTextMini:c.showText,b=Ext.String.format(f,c.errors.getCount(),(c.errors.getCount()!==1?"s":""));if(c.statusBar.getText()!==b){c.statusBar.showError(b);a=true}}else{var e=c.grid.store.getUnsavedRecords(undefined,false),d=c.grid.store.getInvalidRecords();if(d.length===0){if(e.length>0){c.statusBar.showWarning(e.length+" unsaved row"+(e.length!==1?"s":""));a=true}else{c.statusBar.showValid();a=true}}}},getRecordErrorMsg:function(g,a,f){f=f||false;var e=Ext.create("Ext.util.HashMap"),i=Ext.create("Ext.util.HashMap"),c=g.getValidation().getErrors()||[],h="";Ext.Array.forEach(c,function(k,j,l){e.add(k.id,k)});var d=e.getArray();Ext.Array.forEach(d,function(m,l,n){var k=m.msg;if(f){var j=Ext.isDefined(i.get(k))?i.get(k):"";j+=(j.length?", ":"")+m.id;i.add(k,j,false)}else{h+=(h.length?", ":"")+m.id}});if(f){c=i.getArray();for(var b in c){if(Object.prototype.hasOwnProperty.call(c,b)){h+=(h.length?"; ":"")+b+": "+c[b]}}}return h},updateErrorList:function(){var j=this,a=j.grid,e,f=j.getMsgEl();if(j.errors.getCount()>0){var b={};e=["<ul>"];if(j.errors&&j.errors.items){var d=Math.min(j.errors.getCount(),j.maxErrorCount);for(var h=0;h<d;h++){var g=j.errors.getAt(h),k=a.getStore().indexOf(g.record);if(k>=0){b[k]='<li id="x-err-'+g.record.id+'"><a href="#">Row #'+(k+1)+": "+g.msg+"</a></li>"}}}for(var c in b){if(Object.prototype.hasOwnProperty.call(b,c)){e.push(b[c])}}e.push("</ul>");f.update(e.join(""))}else{f.update("")}f.setSize("auto","auto")},getMsgEl:function(){var c=this,a=c.msgEl,b;if(!a){a=c.msgEl=Ext.DomHelper.append(Ext.getBody(),{cls:c.errorListCls,style:"z-index:99999999"},true);a.hide();a.on("click",function(k){b=k.getTarget("li");if(b){var m=b.id.split("x-err-")[1];var h=c.grid.store.findBy(function(i,e){return(i.id===m)});var l=c.grid.store.getAt(h),j=l.getValidation().getErrors();c.grid.getSelectionModel().select(l);c.grid.getView().focusRow(l);var f=false;for(var g=0;g<j.length;g++){var d=c.grid.getColumnForDataIndex(j[g].id);if(d){f=c.grid.getEditingPlugin().startEdit(l,d);if(f){break}}}c.hideErrors()}},null,{stopEvent:true})}return a},showErrors:function(){var a=this;a.updateErrorList();a.getMsgEl().alignTo(a.statusBar.getEl(),a.listAlign).slideIn("b",{duration:100,easing:"easeOut"});a.statusBar.setText(a.grid.getWidth()<=(a.widthForUsingMiniText||0)?a.hideTextMini:a.hideText);a.grid.body.on("click",a.hideErrors,a,{single:true})},hideErrors:function(){var b=this,a=b.getMsgEl();if(a.isVisible()){a.slideOut("b",{duration:50,easing:"easeIn"});b.updateStatusText()}b.grid.body.un("click",b.hideErrors,this)},onStatusClick:function(){var a=this;if(a.getMsgEl().isVisible()){a.hideErrors()}else{if(a.errors.getCount()>0){a.showErrors()}else{if(a.statusBar.status==="warning"){a.selectUnsavedRecords()}}}},onStatusDblClick:function(){this.grid.store.validateRecords()},selectUnsavedRecords:function(){var b=this,a=b.grid.store.getUnsavedRecords()||[];if(a.length>0){b.grid.getSelectionModel().select(a);b.grid.getView().focusRow(a[0])}}});Ext.define("sl.panel.tree.TreePanel",{extend:"Ext.tree.Panel",mixins:{panel:"sl.panel.Panel"},alias:["widget.sltreepanel"],uses:["sl.utils.Utilities"],includeTreeFilter:false,treeFilterConfig:{},includeRefreshBtn:false,editable:false,editingPluginID:"treeRowEditor",editConfig:{},enableSort:false,useArrows:true,rootVisible:true,singleExpand:false,selModel:{},viewConfig:{},root:{},clicksToEdit:2,autoCancel:false,clicksToMoveEditor:1,includeNodeDelete:false,useRootAsNew:false,constructor:function(b){var a=this;b=b||{};a=Ext.applyIf(a,a.mixins.panel);a.callParent(arguments)},initComponent:function(){var a=this,b={plugins:a.createPlugins(),features:[]};a.defaultTitle=a.defaultTitle||a.title;a.selModel=Ext.applyIf(a.selModel,{mode:"SINGLE"});a.viewConfig=Ext.applyIf(a.viewConfig,{markDirty:false,listeners:{beforedrop:a.onBeforedrop,drop:a.onDrop,beforerefresh:a.onBeforerefresh,refresh:a.onRefresh,scope:a}});a.root=Ext.applyIf(a.rootConfig,{type:"async",Type:"root",nodeId:"root",nodeType:"root"});if(a.includeNodeDelete){a.on({scope:a,select:function(f,d,c,e){a.showTreeButton.call(a,f,d,c,Ext.apply({tree:a,actionFn:sl.tree.DeleteButtonClicked,actionParams:{tree:a},buttonType:"delete",actionScope:a,elementID:d.get(a.store.nodeParam)+"-delBtn",eventAttribute:"deleteEventAdded"},e))},deselect:function(f,d,c,e){a.hideTreeButton.call(a,f,d,c,Ext.apply({delay:600,elementID:d.get(a.store.nodeParam)+"-delBtn",buttonType:"delete"},e))}})}if(a.useRootForNew&&a.editable){a.root.iconCls=a.root.iconCls||"newNodeIconCls";a.on("beforeedit",function(c,f){var d=false;if(f.record.isRoot()&&!a.useRootForNew){d=false}return d},a)}a.on({scope:a,beforerender:function(e){if(Ext.isFunction(a.getColumnIndexByDataIndex)){var c=a.getColumnIndexByDataIndex(a.store.proxy.extraParams.textField);var f=function(m,g,k,h,j,n,l,o){if(!a.hasListeners.beforeButtonAdd||a.fireEvent("beforeButtonAdd",a,m,g,k,h,j,n,l,o)!==false){var i=document.createElement("input");i.setAttribute("type","button");i.setAttribute("class","nodeDeleteButton");i.setAttribute("id",k.get("nodeId")+"-delBtn");o+="&nbsp"+i.outerHTML}return o};var d=function(h,i,g){if(!i){return h}else{return function(){var j=h.apply(a,arguments);if(!Ext.isArray(j)){if(Ext.isIterable(j)){j=Ext.Array.clone(j)}else{j=j!==undefined?[j]:[]}}var k=[].concat(j);k.push.apply(arguments,k);j=i.apply(g||a,arguments);return j}}};a.getColumns()[c].renderer=d(a.getColumns()[c].renderer,f,a)}}});Ext.apply(a,b);a.callParent()},createPlugins:function(){var a=this,b=[];if(a.includeTreeFilter){b.push(Ext.apply({ptype:"treefilter",includeRefresh:true,pluginID:a.editingPluginID},a.treeFilterConfig))}if(a.editable){b.push(Ext.create(Ext.apply({xclass:"Ext.grid.plugin.RowEditing",autoCancel:a.autoCancel,clicksToEdit:a.clicksToEdit,clicksToMoveEditor:a.clicksToMoveEditor,errorSummary:a.errorSummary},a.rowEditorConfig)))}Ext.iterate(a.plugins,function(c){b.push(c)},this);return b},showTreeButton:function(g,e,j,h){if(!this.hasListeners.beforeButtonShow||this.fireEvent("beforeButtonShow",this,g,e,j,h)!==false){var k=h.tree||this,d=h.actionFn||Ext.emptyFn,c=h.actionParams||{},b=h.actionScope||h.tree||this,i=h.elementID||"nodeButton",f=h.eventAttribute||"eventAdded";c.cacheClassName=h.cacheClassName||this.store.proxy.extraParams.CacheClassName;var a=Ext.getElementById(i);if(!Ext.isEmpty(a)){if(Ext.isEmpty(a.getAttribute(f))){a.addEventListener("click",function(){k.suspendEvents(false);d(a,e,c,b);k.resumeEvents()}.bind(this));a.setAttribute(f,true)}Ext.fly(a,i+"in").fadeIn({duration:600,scope:this,callback:function(){this.fireEvent("afterButtonShow",this,g,e,j,h)}})}}},hideTreeButton:function(f,b,a,e){if(!this.hasListeners.beforeButtonHide||this.fireEvent("beforeButtonHide",this,f,b,a,e)!==false){var d=e.elementID||"nodeButton";var c=Ext.getElementById(d);if(!Ext.isEmpty(c)){Ext.fly(c,d+"out").fadeOut({duration:600,callback:function(){this.fireEvent("afterButtonHide",this,f,b,a,e)},scope:this})}}},deselectNode:function(d,b,a,c){switch(this.itemId){case"accountingGrid":Accounting.HideTreeButton(d,b,a,{elementID:b.get("nodeId")+"-delBtn"});break;case"acctSetParmTree":Accounting.HideTreeButton(d,b,a,{elementID:b.get("nodeId")+"-delBtn"});Accounting.HideTreeButton(d,b,a,{elementID:b.get("nodeId")+"-editBtn"});break;default:break}},onBeforedrop:function(d,f,e,b,a,c){Ext.suspendLayouts();var g=this.view.getRecord(d);return g.data.validDrop},onDrop:function(c,e,d,a,b){Ext.resumeLayouts()},onBeforerefresh:function(a){a.scrollTop=a.container.dom.firstChild.scrollTop},onRefresh:function(a){a.container.dom.firstChild.scrollTop=a.scrollTop},deleteButtonClicked:function(h,c,d,j){d=d||{};var l=d.tree||this,b=d.delName||l.defaultTitle||l.title||"item",e=d.records||c||l.getSelectionModel().getSelection()||[],k=e.length,g=k===1?"Delete this <b>"+b+"</b>?":"Delete these "+k+" <b>"+b+"s</b>?",a=d.noConfirmation||false,i=d.deleteRecordsFn||sl.tree.DeleteRecords,f=l.deleteBtn;if(k>0){if(a){i(l,e,d)}else{Ext.Msg.show({title:"Confirm Delete?",msg:"<br>"+g,buttons:Ext.Msg.YESNO,scope:l,animEl:f.id,icon:Ext.MessageBox.QUESTION,fn:function(m){if(m==="yes"){i(l,e,d)}}})}}else{if(!a){sl.utils.Toast.showToast("Delete Error","Please select a node of the tree first.",2000)}Ext.get(document.body).unmask();l.store.fireEvent("delete",l,e,[],false)}},deleteRecords:function(h,m,f){f=f||{};h=h||this;h.store.removed=[];var r=f.forceReload||false,n=f.updateUI||false,t=f.refreshCollapsed||false,p=f.dontShowToast||false,s=f.cacheClassName||h.store.proxy.extraParams.CacheClassName,e=f.fnScope||h,j=f.callbackFn.bind(e)||Ext.emptyFn,a=[],q=[],c="",o=true,b={madeAjaxRequest:false};if(!p){Ext.get(document.body).mask("Deleting...","x-mask-loading")}if(!Ext.isEmpty(m)){for(var l=0;l<m.length;l++){var d=m[l];q.push(d);c=f.idField||d.idProperty||h.store.model.prototype.idProperty||"ID";if(!Ext.isEmpty(d.data[c])){a.push(d.data[c])}else{h.store.removed.push(d)}}h.lastDeleteCount=q.length;o=h.store.fireEvent("beforedelete",h,q,a,s,b,f);if(o!==false){if(a.length>0){b.madeAjaxRequest=true;Ext.Ajax.request({url:"../Ext.JsonRequest.cls",scope:h,params:{CacheClassName:"JSON.Adapter",CacheMethodName:"DeleteObjects",CacheCommandType:1,JSONObject:Ext.encode({CacheClassName:s,Properties:a})},callback:function(v,z,u){var y=Ext.decode(u.responseText);Ext.get(document.body).unmask();if(!y.success){h.lastDeleteCount="";h.suspendLayouts();h.getRootNode().removeAll();h.store.load(h.getRootNode());h.store.resumeLayouts();Ext.Msg.alert("Error",y.error.Msg);console.error("DeleteRecords Errors",{tree:h,itemArr:q,idArr:a,error:y.error.Msg,options:v,success:z,response:u});h.store.fireEvent("delete",h,q,a,false,{error:y.error.Msg,options:v,success:z,response:u})}else{if(f.undoButton){f.undoButton.setDisabled(false)}if(r){h.suspendLayouts();h.getRootNode().removeAll();h.store.load(h.getRootNode());h.store.resumeLayouts()}else{if(n){var x=Ext.decode(h.store.proxy.extraParams.nodeParams);sl.utils.UpdateTreeUI(h,h.getRootNode().get(x.nodeType),this.tree.getRootNode().get(x.nodeId),"",Ext.emptyFn,h,{refreshCollapsed:t})}else{h.suspendLayout=true;for(var w=0;w<q.length;w++){q[w].remove()}h.suspendLayout=false;h.doLayout()}}h.store.fireEvent("delete",h,q,a,true);if(!p&&h.lastDeleteCount>0){h.prepareToast("delete",h.lastDeleteCount)}}}})}}}if(!b.madeAjaxRequest&&o){h.suspendLayout=true;Ext.get(document.body).unmask();for(var g=0;g<q.length;g++){q[g].remove()}h.suspendLayout=false;h.doLayout();if(f.undoButton){var k=!Ext.isArray(h.store.removed)||h.store.removed.length===0;f.undoButton.setDisabled(k)}h.store.fireEvent("delete",h,q,a,false);if(!p&&h.lastDeleteCount>0){h.prepareToast("delete",h.lastDeleteCount)}}if(!o){Ext.get(document.body).unmask()}},prepareToast:function(a,g,d,b,c){d=d||1000;b=b||"";c=c||false;if(!Ext.isEmpty(g)&&(c||Number(g)>0)&&!Ext.isEmpty(a)){var f=g===1?"record was":"records were",h=Ext.util.Format.capitalize(a)+" Successful",e=g+" "+f+" "+a+"d."+b;sl.utils.Toast.showToast(h,e,d)}}});Ext.define("sl.panel.tree.plugin.TreeFilterField",{extend:"sl.panel.grid.plugin.GridFilterField",alias:"plugin.treefilterfield",init:function(a){var b=this;if(!sl.utils.matchesComponent(a,Ext.tree.Panel)){a=a.up("treepanel")}b.tree=a;b.callParent(arguments)},doLocalFilter:function(){var c=this,a=c.tree||c.grid,b=a.getStore(),d=function(){var e=[];if(Ext.isFunction(b.getFilteredText)){b.getData().items.forEach(function(g){var f=c.doesRecordHaveTextToFind(g);g.set("showAfterFilter",f);if(f&&g.isLeaf()){e.push(g)}});e.forEach(function(g){var f=g.parentNode;while(f){f.set("showAfterFilter",true);f=f.parentNode}});b.filter("showAfterFilter",true)}else{sl.consoleWarn("["+c.$className+"] Filtering does not work with this store. Only works with Cach store",{store:b})}Ext.resumeLayouts();a.unmask();c.fireEvent("filtered",c)};a.mask("Loading & Filtering...");Ext.suspendLayouts();b.getFilters().removeAll();Ext.defer(function(){a.expandAll(function(){if(b.getLoadingRecords().length===0){d()}else{b.on("loadcomplete",function(){d()},b,{single:true})}})},100,a)},doesRecordHaveTextToFind:function(d){var g=this,a=g.grid,i=a.getStore(),c=g.getCheckedMenuItems(),h=i.getFilteredText().indexOf('"')>=0,e=i.getFilteredTextArray(),f=[],b;if(e.length){Ext.Array.forEach(c,function(n,k,o){var l,m=n.column,j=false;if(m){l=d.get(m.dataIndex);if(l instanceof Date){l=Ext.Date.format(l,g.dateFormat||d.fields.get(m.dataIndex).dateFormat)}else{l=Ext.valueFrom(l,"").toString()}j=sl.utils.doesStringContainAllPieces(l,e,false,!h);f.push(j?l:undefined);b=b||j}})}else{b=true}return b}});Ext.define("sl.panel.tree.plugin.TreeStateful",{extend:"Ext.AbstractPlugin",alias:"plugin.treestateful",uses:["Ext.state.Manager"],init:function(a){var b=this;a.addStateEvents("afteritemcollapse","afteritemexpand");a.getState=b.getState;a.saveState=b.saveState;if(a.getTreeStore().isLoading()){a.getTreeStore().on("load",b.applyState,a)}else{Ext.callback(b.applyState,a)}},saveState:function(){var a=this,c=a.stateful&&a.getStateId(),b;if(c&&a.getStore().getCount()>0){b=a.getState()||[];Ext.state.Manager.set(c,b)}},getState:function(){var b=[];var a=Ext.Array.filter(this.getTreeStore().tree.flatten(),function(c){return c.get("expanded")===true});Ext.each(a,function(c){if(c.getId()==="root"){return}b.push(c.getId())});if(b.length===0){b=null}return b},applyState:function(){var c=this,e=c.stateful&&c.getStateId(),d,a=c.getTreeStore(),b;if(e){d=Ext.state.Manager.get(e);if(d){d=Ext.apply([],d);if(!c.hasListeners.beforeapplystate||c.fireEvent("beforeapplystate",c,e,d,a)!==false){Ext.each(d,function(f){b=a.getNodeById(f);if(b){b.bubble(function(g){g.expand()})}})}}}}});if(!Array.prototype.find){Array.prototype.find=function(a){if(this==null){throw new TypeError("Array.prototype.find called on null or undefined")}if(typeof a!=="function"){throw new TypeError("predicate must be a function")}var f=Object(this);var d=f.length>>>0;var b=arguments[1];var e;for(var c=0;c<d;c++){e=f[c];if(a.call(b,e,c,f)){return e}}return undefined}}if(!Array.prototype.includes){Array.prototype.includes=function(d){var e=Object(this);var a=parseInt(e.length,10)||0;if(a===0){return false}var f=parseInt(arguments[1],10)||0;var b;if(f>=0){b=f}else{b=a+f;if(b<0){b=0}}var c;while(b<a){c=e[b];if(d===c||(d!==d&&c!==c)){return true}b++}return false}}if(!Array.prototype.every){Array.prototype.every=function(c,d){var f,e;if(this==null){throw new TypeError("this is null or not defined")}var h=Object(this);var b=h.length>>>0;if(typeof c!=="function"){throw new TypeError()}if(arguments.length>1){f=d}e=0;while(e<b){var g;if(e in h){g=h[e];var a=c.call(f,g,e,h);if(!a){return false}}e++}return true}}if(!Array.prototype.some){Array.prototype.some=function(c){if(this==null){throw new TypeError("Array.prototype.some called on null or undefined")}if(typeof c!=="function"){throw new TypeError()}var e=Object(this);var a=e.length>>>0;var b=arguments.length>=2?arguments[1]:void 0;for(var d=0;d<a;d++){if(d in e&&c.call(b,e[d],d,e)){return true}}return false}}var sl=sl||{};Ext.define("sl.utils.ExportData",{uses:["Ext.util.DelayedTask","Ext.util.Format"],singleton:true,gridToExcel:function(d,b,c){c=c||{};var f=this,a=d.getStore(),g=c.includedDataIndexes,h=Ext.isDefined(c.onlyVisibleColumns)?c.onlyVisibleColumns:true,e=[];f.isLocalExport=Ext.valueFrom(b,true);if(g){g=Ext.Array.from(g)||[];Ext.Array.forEach(g,function(k,j,l){var i=d.getColumnForDataIndex(k);e.push(i)})}else{e=d.getColumns(h)}Ext.Object.mergeIf(c,{suggestedFilename:Ext.isFunction(d.getTitle)?d.getTitle():d.title,useCachedQuery:d.isEditable});if(f.isLocalExport){f.exportLocalGridData(d,e,c)}else{f.cacheDataToExcel(a,e,c)}},exportLocalGridData:function(e,d,c){var f=this,g=c.forcedFilename,a=Ext.isEmpty(g),b=function(h){f.doExportLocalGridData(e,d,h,c)};if(a){f.getFilename(b,c)}else{b(g)}},doExportLocalGridData:function(g,f,c,e){var b=g.getStore(),a=b.getRecords(),d=Ext.String.format("Exporting {0} to Excel",Ext.util.Format.plural(a.length,"record")),h=Ext.create("Ext.data.Store",{model:b.model.getName(),proxy:{type:"file",writer:"file.xlsx"}});a.forEach(function(j){var i=h.createNewRecord(j.getData());f.forEach(function(k){if(g){i.data[k.dataIndex]=g.getTextInCell(k,j)}});h.add(i)});Ext.get(document.body).mask(d,"x-mask-loading");h.sync({title:c,columns:f,callback:function(i){Ext.get(document.body).unmask();i.packet.save()}})},getFilename:function(a,b){var d=this,e=b.suggestedFilename||"excel_export",c=b.promptTitle||"Export to Excel";Ext.Msg.prompt(c,"Excel Filename:",function(g,f){if(g==="ok"){f=f.replace(/\s+/g,"_").toLowerCase()||e;a.call(d,f)}},d,false,e)},cacheDataToExcel:function(c,f,e){var g=this,d=g.getColumnDataForExport(f),b=d.excelDataIndexes||c.model.prototype.fields.keys||[],h=d.headers;var a=function(j){try{var m="Exporting Records to Excel",i=Ext.isDefined(e.useCachedQuery)?e.useCachedQuery:false,p=Ext.Object.fromQueryString(window.location.search.substring(1)),l=e.AuthToken||p.AuthToken,n=(i?c.getProxy().getReader().jsonData.queryID:undefined),o;if(!Ext.String.endsWith(j,".xls",true)){j+=".xls"}o=Ext.Object.mergeIf(e,c.getExtraParams(),{queryID:n,ExportFilename:j,AuthToken:l,fields:Ext.encode(b),headers:Ext.encode(h)});Ext.get(document.body).mask(m,"x-mask-loading");sl.utils.postToURL("../Data.XMLExcel.cls?",o);new Ext.util.DelayedTask(function(){Ext.get(document.body).unmask()},g).delay(4000)}catch(k){Ext.Msg.alert("Error",k);console.error("Excel Export Error",{error:k,args:arguments})}};g.getFilename(a,e)},getColumnDataForExport:function(c){var d=[],a=[],b=[];Ext.Array.forEach(c,function(g,f,k){var h=g.dataIndex,e=h,j=g.excelHeader||g.text||h,i=g.getColumnEditor();if(i){e=g.excelDataIndex||i.gridDisplayField||e}d.push(h);a.push(e);b.push(j)},this);return{dataIndexes:d,excelDataIndexes:a,headers:b}}});Ext.define("sl.utils.Utilities",{uses:["Ext.data.Model","Ext.data.Store","Ext.form.field.ComboBox","Ext.util.Format","sl.data.CacheStore","sl.field.ComboGrid","sl.field.ListCombo","sl.panel.grid.DisplayGrid","sl.panel.grid.EditorGrid"],singleton:true,Method:function(g,c,b,h,k,e){e=typeof e==="undefined"?{}:e;e.isBatch=Ext.isDefined(e.isBatch)?e.isBatch:false;e.url=Ext.isDefined(e.url)?e.url:e.isBatch?"../Ext.BatchJsonRequest.cls":"../Ext.JsonRequest.cls";e.callBackAll=Ext.isDefined(e.callBackAll)?e.callBackAll:false;e.callBackOnError=Ext.isDefined(e.callBackOnError)?e.callBackOnError:false;var j=[];var f=b||{};var a=!Ext.isEmpty(h)?h:Ext.emptyFn;var i=k||this;var d=true;if(!e.isBatch){f=Ext.applyIf(f,{CacheClassName:g,CacheMethodName:c,CacheCommandType:1})}else{f=b}Ext.Ajax.request({scope:i,timeout:300000,url:e.url,params:f,callback:function(n,p,m){if(p){var o=Ext.decode(m.responseText);var q=Ext.decode(n.params.Batch);if(!e.isBatch){if(!o.success&&!e.callBackOnError){Ext.Msg.alert("Error",o.error.Msg)}else{a.call(i,b,o)}d=false}else{for(var l=0;l<o.length;l++){if(o[l].hasOwnProperty("success")){if(!o[l].success){sl.utils.consoleWarningWithTrace("Batch operation Failure",{params:f,response:m,batchOptions:q[l],r:o[l]});j.push({Request:q[l],Response:o[l]})}else{if(e.callBackAll){a.call(i,b,o[l])}}}else{if(e.callBackAll){a.call(i,b,o[l])}}}if(!e.callBackAll){a.call(i,b,o)}}}return(e.isBatch)?j:d}})},HasListener:function(b,c,d,g,a,e,f){c=c.toLowerCase();g=(typeof g==="undefined")?this:g;a=(typeof a==="undefined")?{}:a;e=Ext.valueFrom(e,false);f=!!e?false:Ext.valueFrom(f,false);var i=false;if(b.hasListener(c)){for(var h=0;b.events[c].listeners.length>h;h++){if(b.events[c].listeners[h].fn.toString()===d.toString()){if(typeof b.events[c].listeners[h].o!=="undefined"){if(Ext.Object.equals(b.events[c].listeners[h].o,a)){if(b.events[c].listeners[h].scope===g){i=1;break}}}}}}if(!i&&e){b.on(c,d,g,a)}else{if(i&&f&&!e){b.un(c,d,g)}}return i},GetDateToday:function(){return this.getCalendarDate(new Date())},DateDayoffSet:function(f,e){var b=1000*60*60*24;var a=new Date(f);if(!isNaN(a.getTime())&&!Ext.isEmpty(e)){var d=a.getTimezoneOffset();var g=(e*b);var c=a.getTime();var h=(c+g);a.setTime(h);var i=a.getTimezoneOffset();h=(c+((i-d)*60000)+g);a.setTime(h);return this.getCalendarDate(a)}else{return false}},getCalendarDate:function(a){var d=a.getMonth()+1;d=(d<10)?"0"+d:d;var b=(a.getDate()<10)?"0"+a.getDate():a.getDate();var c=a.getFullYear();return(d+"/"+b+"/"+c)},getODBCDate:function(a){var d=a.getMonth()+1;d=(d<10)?"0"+d:d;var b=(a.getDate()<10)?"0"+a.getDate():a.getDate();var c=a.getFullYear();return(c+"-"+d+"-"+b)},getCompleteDateString:function(a){var b=a;if(Ext.isDate(a)){if(a.toLocaleTimeString()==="12:00:00 AM"){b=a.toLocaleDateString()}else{b=a.toLocaleString()}}return b},DateDiff:function(d,c){var b=new Date(d);var a=new Date(c);return this.days_between(b,a)},days_between:function(e,d){var f=1000*60*60*24;var c=e.getTime();var b=d.getTime();var a=Math.abs(c-b);return Math.round(a/f)},dollarH:function(b){var d=new Date();if(b){var c=b.split("/");d.setFullYear(c[2],c[0]-1,c[1])}var a=new Date();a.setYear(1840);a.setMonth(11);a.setDate(31);return this.days_between(d,a)},convertTime:function(c){var a=c.split(":");var b=0;var d=0;if(c){b=a[0]*3600;if(a[1]!=="00"){d=a[1]/60;d=d*3600}}return(b+d)},DisableForm:function(c){if(!Ext.isEmpty(c)){var b=c.getForm().getFields();if(!Ext.isEmpty(b)){for(var a=0;a<b.items.length;a++){if(typeof b.items[a].disable==="function"){b.items[a].disable()}}}}},ReadOnlyForm:function(c,d){d=Ext.valueFrom(d,true);if(!Ext.isEmpty(c)){var b=c.getForm().getFields();if(!Ext.isEmpty(b)){for(var a=0;a<b.items.length;a++){if(typeof b.items[a].setReadOnly==="function"){b.items[a].setReadOnly(d)}else{if(typeof b.items[a].disable==="function"){if(d){b.items[a].disable()}else{b.items[a].enable()}}}}}}},EnableForm:function(c){if(!Ext.isEmpty(c)){var b=c.getForm().getFields();if(!Ext.isEmpty(b)){for(var a=0;a<b.items.length;a++){if(typeof b.items[a].enable==="function"){b.items[a].enable()}}}}},ClearForm:function(c,e){if(!Ext.isEmpty(c)){var b=c.getForm().getFields();if(!Ext.isEmpty(b)){for(var a=0;a<b.items.length;a++){var d=b.items[a];if(c.trackResetOnLoad){if(e){c.getForm().reset();break}else{d.value="";if(d.mixins&&d.mixins.field&&typeof d.mixins.field.initValue==="function"){d.mixins.field.initValue.apply(d);if(typeof d.clearValue==="function"){d.clearValue()}d.wasDirty=false}}}else{d._tempOriginalValue=d.originalValue;d.originalValue=null;if(typeof d.clearValue==="function"){d.clearValue()}else{if(typeof d.reset==="function"){d.reset()}else{d.setValue("")}}d.originalValue=d._tempOriginalValue;delete d._tempOriginalValue}}}}},ToggleObj:function(d,c,a,b){if(!Ext.isEmpty(d)){if(a&&!Ext.isEmpty(d.el)){if(c){d.el.unmask()}else{d.el.mask()}}else{if(b){if(c){d.show()}else{d.hide()}}else{if(c){d.enable()}else{d.disable()}}}}},postToURL:function(c,g){var a=Ext.getDoc().dom.createElement("iframe");a.src="about:blank";a.className="stw-hidden-iframe";Ext.getBody().dom.appendChild(a);var f=a.contentWindow.document;var e=f.createElement("form");a.appendChild(e);e.action=c;e.method="POST";for(var d in g){var b=f.createElement("input");b.type="hidden";b.name=d;b.value=g[d];e.appendChild(b)}e.submit();Ext.getBody().dom.removeChild(a)},injectScriptElement:function(d,g,h,f){var c=document.createElement("script"),e=document.head||document.getElementsByTagName("head")[0],b=false,a=function(){if(!b){b=true;g.call(f)}};Ext.apply(c,{type:"text/javascript",src:d,onload:a,onerror:h,onreadystatechange:function(){if(this.readyState==="loaded"||this.readyState==="complete"){a()}}});e.appendChild(c);return c},injectLinkElement:function(d,g,h,f){g=g||Ext.emptyFn;var c=document.createElement("link"),e=document.head||document.getElementsByTagName("head")[0],b=false,a=function(){if(!b){b=true;g.call(f)}};Ext.apply(c,{type:"text/css",href:d,rel:"stylesheet",onload:a,onerror:h,onreadystatechange:function(){if(this.readyState==="loaded"||this.readyState==="complete"){a()}}});e.appendChild(c);return c},loadScriptFile:function(b,g,j,a,c){g=Ext.isFunction(g)?g:Ext.emptyFn;j=j||this;a=Ext.isDefined(a)?a:true;c=c||false;var f=this,k=b+(c?"?"+Date.now():""),e=b.split("/").pop(),i,d,h;f.isLoading=true;if(!a){h=function(){f.onFileLoadError.call(f,{message:"Failed loading '"+b+"', please verify that it exists",url:b,synchronous:false})};if(!Ext.isReady){Ext.onDocumentReady(function(){f.injectScriptElement(k,g,h,j)})}else{f.injectScriptElement(k,g,h,j)}}else{if(typeof XMLHttpRequest!=="undefined"){i=new XMLHttpRequest()}else{i=new ActiveXObject("Microsoft.XMLHTTP")}i.open("GET",k,false);i.send(null);d=(i.status===1223)?204:i.status;if(d>=200&&d<300){new Function(i.responseText+"\n//@ sourceURL="+e)();g.call(j)}else{f.onFileLoadError.call(this,{message:"Failed loading synchronously via XHR: '"+b+"'; please verify that the file exists. XHR status code: "+d,url:b,synchronous:true})}}},onFileLoadError:function(a){throw new Error("[Ext.Loader] "+a.message)},convertToExtArray:function(a){var c=[];for(var b=0;b<a.length;b++){var d=[];d[0]=a[b];c[b]=d}return c},convertToCacheList:function(c){var a=[];for(var b=0;b<c.length;b++){a[b]=c[b][0]}return a},adjHeight:function(c,a,d){d=d||sl.utils.getBrowserHeight();var b=d*c;if(b<0){return false}if(!Ext.isEmpty(a)&&a<b){return a}return b},adjWidth:function(c,a,b){b=b||sl.utils.getBrowserWidth();var d=b*c;if(d<0){return false}if(!Ext.isEmpty(a)&&a<d){return a}return d},getViewport:function(){return Ext.ComponentQuery.query("viewport")[0]},FormatPhoneNumber:function(c){c=c.toString();var b=/^[0-9]+$/;var a=b.test(c);if(c.length===7&&a){c=c.slice(0,3)+"-"+c.slice(3,7)}else{if(c.length===10&&a){c="("+c.slice(0,3)+") "+c.slice(3,6)+"-"+c.slice(6,10)}else{if(c.length===12&&c.indexOf("-",0)===3&&c.indexOf("-",4)===7&&c.indexOf("-",8)<0){c="("+c.slice(0,3)+") "+c.slice(4,7)+"-"+c.slice(8,12)}}}return c},IsObjectChainDefined:function(d,a){var c=a.split(".");var b=d[c.shift()];while(b&&c.length){b=b[c.shift()]}return b},FormatFloat:function(d){if(!Ext.isEmpty(d)){if(typeof d==="string"){d=d.replace(/0*$/,"")}else{d=d.toString()}var c=d.split("."),b=c[0],a=c[1]?"."+c[1]:"";if(!Ext.isEmpty(a)){d=b+a}else{d=b}return d}},capitalizeEachWord:function(a){a=Ext.valueFrom(a,"").toString();return Ext.String.splitWords(a).reduce(function(c,d,b,e){return c+(c.length>0?" ":"")+Ext.String.capitalize(d)},"")},Securitize:function(c,b,d,a,e){b=(b===undefined)?1:b;d=(d===undefined)?0:d;if((!Ext.isEmpty(window.parent.AppMenu))&&(!Ext.isEmpty(c))){var f=[];Ext.each(c,function(i,g,h){if(!Ext.isEmpty(i.itemId)){f.push(i.itemId)}});Ext.Ajax.request({url:"../Ext.JsonRequest.cls",scope:e,params:{CacheClassName:"App.Security.JsComponent",CacheMethodName:"CanUse",CacheCommandType:1,ProfileId:window.parent.AppMenu.CompanySelect.getValue(),componentId:Ext.encode(f),app:window.location.pathname},callback:function(i,j,g){var h=Ext.decode(g.responseText);if(h.success){Ext.each(f,function(m,k,l){if(Ext.isEmpty(a)){sl.utils.ToggleObj(c[k],parseInt(h.result[m],10),b,d)}else{a.call(this,m,k,l,h)}},this)}}})}},BtnLockDown:function(d,c,l,h,i){var g=l||false;var k=c||false;var b=h||[];var j=i||false;if(!j){var a=[];a=d.getEl().dom.getElementsByClassName("x-grid-panel");if((a.length===0)&&(d.getEl().dom.className.indexOf("x-grid-panel")!==-1)){a=[d.getEl().dom]}var f="";Ext.each(a,function(o,n,p){f=Ext.getCmp(o.id);if(!Ext.isEmpty(f)&&!Ext.isEmpty(f.searchPlugin)){if(!Ext.isEmpty(f.searchPlugin.field)&&!Ext.isEmpty(f.searchPlugin.field.ownerCt)){var m=f.searchPlugin.field.ownerCt;Ext.each(m.getEl().dom.getElementsByClassName("x-btn"),function(r,q,s){var t=Ext.getCmp(r.id);b.push(t)},this)}}},this)}if(!Ext.isEmpty(d.getEl())){var e=d.getEl().dom.getElementsByClassName("x-btn");if(Ext.isEmpty(e)&&!Ext.isEmpty(d.disable)&&Ext.isEmpty(b.filter(function(m){return(!Ext.isEmpty(m))?(m.id===d.id):false}))){d.disable();if(g){d.hide()}}else{Ext.each(e,function(o,n,p){var m=Ext.getCmp(o.id);if(!Ext.isEmpty(m)&&Ext.type(m)==="object"&&Ext.isEmpty(b.filter(function(q){return(!Ext.isEmpty(q))?(q.id===o.id):false}))){if(k){m.disable();if(g){m.hide()}}else{if(m.disabled){m.enable()}if(m.hidden){m.show()}}}},this)}}},HasResource:function(b,h,d,a,c){var e=c||window.parent.AppMenu.CompanySelect.getValue();var g=a||"U";var f=d||this;sl.utils.Method("App.Security.UserProfile","CheckPermissionByName",{ProfileId:e,ResourceName:b,Permission:g},function(j,i){h.call(this,parseInt(i.result,10))},f)},LockApp:function(b,c,f,g,j){var h="";var i=[];var k=g||false;var a=c||false;var e=f||false;var l=j||[];var d=[];d=b.getEl().dom.getElementsByClassName("x-grid-panel");if((d.length===0)&&(b.getEl().dom.className.indexOf("x-grid-panel")!==-1)){d=[b.getEl().dom]}Ext.each(d,function(o,n,p){h=Ext.getCmp(o.id);if(!Ext.isEmpty(h)&&!Ext.isEmpty(h.searchPlugin)){if(!Ext.isEmpty(h.searchPlugin.field)){l.push(h.searchPlugin.field);if(!Ext.isEmpty(h.searchPlugin.field.ownerCt)){var m=h.searchPlugin.field.ownerCt;Ext.each(m.getEl().dom.getElementsByClassName("x-btn"),function(r,q,s){var t=Ext.getCmp(r.id);if(!Ext.isEmpty(t)){l.push(t)}},this)}}}},this);if(a){h="";i=[];i=b.getEl().dom.getElementsByClassName("x-form-field");if((b.getEl().dom.className.indexOf("x-form-field")!==-1)&&(!i.length)){i=[];i.push(b.getEl())}Ext.each(i,function(n,m,o){h=Ext.getCmp(n.id);if(!Ext.isEmpty(h)&&Ext.isEmpty(l.filter(function(p){return(!Ext.isEmpty(p))?(p.id===n.id):false}))){if(typeof(h.setReadOnly)==="function"){h.setReadOnly(true)}else{h.disable()}}},this)}if(e){h="";i=[];i=b.getEl().dom.getElementsByClassName("x-grid-panel");if((b.getEl().dom.className.indexOf("x-grid-panel")!==-1)&&(!i.length)){i=[];i.push(b.getEl())}Ext.each(i,function(o,m,n){h=Ext.getCmp(o.id);if(!Ext.isEmpty(h)&&Ext.isEmpty(l.filter(function(p){return(!Ext.isEmpty(p))?(p.id===o.id):false}))){if(!Ext.isEmpty(h.getView)){if(!Ext.isEmpty(h.getView().dragZone)){h.getView().dragZone.lock()}}h.setColumnsAsEditable(false)}},this)}if(k){sl.utils.BtnLockDown(b,true,false,l,true)}},HasPermission:function(d,e,i,b,g,h){var f=b||window.parent.AppMenu.CompanySelect.getValue();var a=i||"U";var c=h||this;sl.utils.Method("App.Security.JsComponent","CanUse",{ProfileId:f,componentId:d,permission:a,app:e},function(k,j){g.call(this,parseInt(j.result[k.componentId],10))},c)},ToggleItems:function(a,d,c){for(var b=0;b<a.length;b++){this.ToggleObj(a[b],d,c)}},roundForPricingRendering:function(f,b,j,d,h){j=Ext.valueFrom(j,2);b=Math.max(Ext.valueFrom(b,2)-j,0);h=Ext.valueFrom(h,false);var i="0,000.",g=new Array(j+1).join("0"),e=new Array(b+1).join("#"),c=i+g+e,a;if(d&&Ext.isEmpty(f)&&!Ext.isNumeric(f)){f=0}a=Ext.util.Format.number(f,c);if(h&&!Ext.isEmpty(a)){a="$"+a}return a},InArray:function(f,d,c){var b=d||this;var e=false;var a="";if(Ext.isDefined(b.get)){a=Ext.isDefined(c)?b.get(c):b}else{a=Ext.isDefined(c)?b[c]:b}if(!Ext.isEmpty(a)){if(!Ext.isEmpty(f.filter(function(g){return(!Ext.isEmpty(g))?(g===a):false}))){e=true}}return e},UpdateTreeUI:function(l,f,i,r,j,a,e){l=l||this;r=Ext.isEmpty(r)?{}:r;f=Ext.isEmpty(f)?"root":f;i=Ext.isEmpty(i)?"":i;j=j||Ext.emptyFn;a=a||this;e=e||{};if(!l.getStore()._tempBeforeLoadAdded){l.getStore().on("beforeload",function(t,s,u){if(s.node.isRoot()){t._cancelUpdate=true}},this,{single:true});l.getStore()._tempBeforeLoadAdded=true}var m,q=Ext.isDefined(e.refreshCollapsed)?e.refreshCollapsed:false,d,o,c,b,k=false,g=function(t,w,u,x){var s=this,v;x=Ext.apply({},x);s.getView().scrollRowIntoView(t);if(w){v=s.getView().getCellByPosition({record:t,column:w},true)}else{v=s.getView().getRow(t)}if(Ext.isElement(v)){Ext.fly(v,Date.now().toString()).select(".x-grid-cell-inner").highlight(u,x)}};if(f==="root"){m=l.getRootNode()}else{var n=l.getRootNode();n.cascadeBy(function(s){if(s.get(l.store.nodeParam)===i){m=s;return false}})}if(!Ext.isEmpty(m)){if(l.fireEvent("beforeuiupdate",l,m)!==false){for(var h in r){c=!Ext.isEmpty(m.get(h))?m.get(h):"";o=!Ext.isEmpty(r[h])?r[h]:"";d=l.columns[l.getColumnIndexByDataIndex(h)];b=m.getField(h);if(b&&Ext.isFunction(b.convert)){o=b.convert(o,m)}if(!sl.utils.areValuesEquivalent(o,c)){k=(l.getStore().leafField===b);m.set(h,o,{dirty:false});if(k){m.set("loaded",false);d=l.store.textField}if(!Ext.isEmpty(d)){Ext.Function.defer(g,100,l,[m,d,undefined,{duration:5000}])}}}var p={nodeId:i,nodeType:f,walkTree:0};p=Ext.applyIf(p,l.store.proxy.extraParams);if((!Ext.isEmpty(m))&&((m.isExpanded()&&(m._visible||!Ext.isDefined(m._visible)))||(q&&m.hasChildNodes()))&&(!m.updated)&&(!l.getStore()._cancelUpdate)){m.updated=true;Ext.Ajax.request({url:"../Ext.TreeLoader.cls",params:p,timeout:3600000,callback:function(t,E,x){var u=Ext.decode(x.responseText);var y,F,G="";var v=[];if(t.params.nodeType==="root"){y=l.getRootNode()}else{var A=l.getRootNode();A.cascadeBy(function(H){if(H.get(l.store.nodeParam)===t.params.nodeId){y=H;return false}})}if(!Ext.isEmpty(y)){var s=false;var z=function(){if(!s){s=true;Ext.Function.defer(g,500,l,[D])}};if(u.length===0){y.set("loaded",true);y.set("expanded",true)}else{for(var B=0;B<u.length;B++){G=u[B];F=y.findChild(l.store.nodeParam,G[l.store.nodeParam],true);if(!Ext.isEmpty(F)){v.push(G[l.store.nodeParam]);sl.utils.UpdateTreeUI(l,F.get(l.store.nodeParams.nodeType),F.get(l.store.nodeParams.nodeId),G,Ext.emptyFn,this,e)}else{var D=y.appendChild(G);v.push(G[l.store.nodeParam]);if(!D.isLeaf()){D.set("loaded",false)}if(!l.getStore()._cancelUpdate){D.set("expanded",true);sl.utils.UpdateTreeUI(l,D.get(l.store.nodeParams.nodeType),D.get(l.store.nodeParams.nodeId),G,Ext.emptyFn,this,e)}else{return false}}}}if(y.childNodes.length>0){var w=function(){Ext.Function.defer(g,500,l,[this,undefined,"#D80000",{callback:Ext.Function.pass(l.getStore().remove,[this],l.getStore())}])};for(var C=y.childNodes.length;C>=0;C--){if(!Ext.isEmpty(y.childNodes[C])){if(!sl.utils.InArray(v,y.childNodes[C],l.getStore().nodeParam)){y.childNodes[C].collapse(true,w,y.childNodes[C])}}}}}},scope:a})}j.call(a,l);sl.utils.treeRefresh(l)}}},treeRefresh:Ext.Function.createThrottled(function(a){delete a.getStore()._cancelUpdate;delete a.getStore()._tempBeforeLoadAdded;a.getRootNode().cascadeBy(function(b){if(b.updated){b.updated=false}})},1200),ReplaceCharAt:function(a,c,b){return c.substr(0,a)+b+c.substr(a+1)},AllTrim:function(a){a=String(a||"");return a.trim().replace(/\s+/g," ").replace(/^\s+|\s+$/,"")},getComponentNamespace:function(b){var a=Ext.getDisplayName(b),c=a.split(".");return c[0]},getXTypesByNamespace:function(e){e=e.prototype||e;var d=e.self||e.prototype.self,g,b,a,f,c;if(!d.xtypesByNamespace){g={};b=e;f="";while(b){a=b.xtypes;if(a!==undefined){f=this.getComponentNamespace(b);c=g[f]||[];c.unshift.apply(c,[a]);g[f]=c}b=b.superclass}d.xtypesByNamespace=g}return d.xtypesByNamespace},hasAlias:function(a,k,f){var i=this,m=false,b,l,g,e,j,c=function(q){if(!f){return q.isXType(b,f)}else{var p=i.getXTypesByNamespace(q),r=i.getComponentNamespace(q),o=[],n;if(["sl","Ext"].indexOf(r)<0){n=(p.sl||[]).length?"sl":"Ext";o=p[n]}else{o=p[r]}o=o[o.length-1];return Boolean((o||[]).indexOf(b)>=0)}};a=(a||{}).prototype||a||{};f=Ext.isDefined(f)?f:false;if(Ext.isString(k)){b=k}else{l=((k||{}).prototype||k);b=Ext.isFunction(l.getXType)?l.getXType():false}if(b){if(Ext.isFunction(a.isXType)){m=c.call(this,a)}else{if(a.isStore){if(b.indexOf("store.")!==0){b="store."+b}if(!f){var h=a;do{m=Boolean(h.alias.indexOf(b)>=0);if(m){break}h=h.superclass}while(h.isStore)}else{m=Boolean(a.alias.indexOf(b)>=0)}}else{if(a.isPlugin){m=(a.ptype===b)||(a.alias.indexOf(b)>=0);if(!f){var d=a;do{m=Boolean(d.alias.indexOf(b)>=0);if(m){break}d=d.superclass}while(d.isPlugin)}else{m=Boolean(a.alias.indexOf(b)>=0)}}else{if(!f&&Ext.isObject(a.xtypesMap)&&!Ext.Object.isEmpty(a.xtypesMap)){m=a.xtypesMap[b]||false}else{if(!f&&Ext.isFunction(a.getXTypes)&&((g=a.getXTypes())&&(g.length>0))){m=Boolean(g.indexOf(b)>=0)}else{e=a.xtype;j=(Ext.ClassManager.getByAlias("widget."+e)||{}).prototype;if(j){m=c.call(this,j)}else{m=((e&&e===b)||(a.ptype&&a.ptype===b))}}}}}}}else{sl.consoleWarn("["+this.$className+":hasAlias] Required `desiredAlias` is undefined")}return m},isInstanceOf:function(b,a){return b instanceof a},matchesComponent:function(c,b,a){a=a||false;c=((c||{}).prototype||c);var d=false;if(!a){d=this.isInstanceOf(c,b)}if(!d){d=this.hasAlias(c,b,a)}return d},isComboBox:function(b,a){return this.matchesComponent(b,Ext.form.ComboBox,a)},isListComboBox:function(b,a){return this.matchesComponent(b,sl.field.ListCombo,a)},isGridSearchField:function(b,a){return this.matchesComponent(b,sl.panel.grid.plugin.GridSearchField,a)},isComboGrid:function(b,a){return this.matchesComponent(b,sl.field.ComboGrid,a)},isDisplayGrid:function(b,a){return this.matchesComponent(b,sl.panel.grid.DisplayGrid,a)},isEditorGrid:function(b,a){return this.matchesComponent(b,sl.panel.grid.EditorGrid,a)},isSearchField:function(b,a){return this.matchesComponent(b,sl.field.SearchField,a)},isCacheStore:function(b,a){return this.matchesComponent(b,sl.data.CacheStore,a)},isStore:function(b,a){return this.matchesComponent(b,Ext.data.Store,a)},isRecord:function(a){return this.isInstanceOf((a||(a||{}).prototype),Ext.data.Model)},isTBFill:function(a){return(a==="->"||(Ext.isObject(a)&&["tbfill","tbspacer"].indexOf((Ext.isFunction(a.getXType)?a.getXType():a.xtype))>=0))},isTBSeparator:function(a){return(a==="-"||(Ext.isObject(a)&&"tbseparator"===(Ext.isFunction(a.getXType)?a.getXType():a.xtype)))},areValuesEquivalent:function(d,c){var b=this,a=function(e){if(Ext.isDate(e)){e=b.getCompleteDateString(e)}else{if(Ext.isNumeric(e)){e=Number(e)}else{if(e===null){e=undefined}}}return e};d=a(d);c=a(c);return(((Ext.coerce(d,c)===c)||(Ext.coerce(c,d)===d))||(Ext.isEmpty(d)&&Ext.isEmpty(c)))},doesStringContainAllPieces:function(g,e,h,c){var d=this,i=false,a,b,f;h=Ext.valueFrom(h,false);c=Ext.valueFrom(c,true);if(Ext.isDate(g)&&Ext.isFunction(g.toLocaleDateString)){g=g.toLocaleDateString()}a=sl.utils.stripNonAlphanumericChars(g,c);e=Ext.isArray(e)?e:Ext.String.splitWords(e);b=d.generateMatchAllPiecesRegexPattern(e,h)||"";if(b.length){f=new RegExp(b,"g"+(h?"":"i"));i=f.test(a)}return i},generateMatchAllPiecesRegexPattern:function(f,b){var a="(?=.*{0})",d=".+",e="",c;f=Ext.isArray(f)?f:Ext.String.splitWords(f);Ext.Array.forEach(f,function(h,g,i){c=sl.utils.stripNonAlphanumericChars(h);if(!b){c=c.toUpperCase()}e+=Ext.String.format(a,c)});if(e.length){e+=d}return e},convertToIgnoreNonAlphanumericInRegEx:function(b){var d,a,e="[^0-9a-zA-Z]*",c=function(i){var h=sl.utils.stripNonAlphanumericChars(i,true).split("")||[],g="";for(var f=0;f<h.length;f++){g+=h[f];if(f<h.length-1){g+=e}}return g};if(Ext.isArray(b)){d=[];Ext.Array.forEach(b,function(g,f,h){g=sl.utils.AllTrim(g);if(!Ext.isEmpty(g)){a=c(g);if(!Ext.isEmpty(a)){d.push(a)}}})}else{if(Ext.isString(b)){d=c(sl.utils.AllTrim(b))}}return d},stripNonAlphanumericChars:function(a,b){var c;a=String(a||"");b=Ext.valueFrom(b,false);if(b){c=a.replace(/\W/g,"")}else{c=sl.utils.AllTrim(a.replace(/[^\w\s]/g,""))}return c},getAllMatchesInString:function(d,e,f){var c=new RegExp(d,"gi"),b=[],a;f=Ext.valueFrom(f,false);while((a=c.exec(e))){b.push(a);if(!f){c.lastIndex=a.index+1}}return b},splitStringOnWordsAndQuotes:function(c){var a=String(c||"").match(/\w+|"[^"]+"/g)||[],b=a.length-1;for(b;b>=0;b--){a[b]=a[b].replace(/"/g,"").trim()}return a},alignMessageBoxToParent:function(f){try{var c=Ext.MessageBox,b,a,g,e;f=Ext.isDefined(f)?f:[c.x,c.y-30];if(c.rendered){b=c.getHeight();a=c.getWidth();g=sl.utils.adjWidth(0.95,f[0]+a)-a;e=sl.utils.adjHeight(0.95,f[1]+30+b)-b;c.el.setXY([g,e])}}catch(d){console.error("[alignMessageBoxToParent] MsgBox Window Positioning Error",{error:d,args:arguments,scope:this})}},getAllComponentsWithReference:function(){var a=Ext.ComponentManager;if(a.referencesDirty){a.fixReferences()}return a.references},getAllReferences:function(){var b=this,a={},c=[];Ext.Object.eachValue(sl.utils.getAllComponentsWithReference(),function(d){var e=d.reference;if(!Ext.isEmpty(e)){if(Ext.isEmpty(a[e])){a[e]=d}else{c.push({existing:a[e],duplicate:d})}}});return a},findByReference:function(b,e){var d=this,c=[],a;Ext.Object.eachValue(sl.utils.getAllComponentsWithReference(),function(f){if(f.reference===b){c.push(f)}});if(c.length>1){if(e){if(Ext.isString(e)){e=d.findByReference(e)}if(e){c=e.query("[reference="+b+"]")}}if(c.length>1){sl.consoleWarn("["+d.$className+"] Multiple Matches for Reference: "+b,{matching_components:c})}}a=c[0];return c[0]},fixBadBinding:function(b){var a=true;if(Ext.isObject(b)){Ext.Object.each(b,function(c,d){if(Ext.isString(d)&&d.indexOf("{")===0){console.error("Binding Value Not Configured Correctly for property `"+c+"` whose value is `"+d+"`\n\nBinds must be in the `bind` config object, not directly under the `config`.\nIf using Architect, make sure Magnet icon is red for this property\n\n",b);delete b[c];a=false}})}return a},consoleLogWithTrace:function(j,g){var a=Ext.global.console,e=arguments.length,f=(new Error()).stack.split(/\n/),b=1,d;if(f[0].indexOf("Error")===0){f=f.slice(1)}if(f[1].indexOf("consoleWarningWithTrace")>0){b=2}d=f[b];j=arguments[0];a.groupCollapsed(j);a.log("%cCalled From:","font-weight:bold;",(Ext.isFunction(d.trim)?d.trim().replace("at ",""):d));if(e>1){a.groupCollapsed("Values:");for(var c=1;c<arguments.length;c++){var h=arguments[c];if(Ext.isObject(h)){Ext.Object.each(h,function(i,l,k){a.log(i,l)})}else{a.log(h)}}a.groupEnd()}a.groupCollapsed("Full Trace:");a.trace();a.groupEnd();a.groupEnd()},consoleWarningWithTrace:function(d,b){var a=Ext.global.console,c=arguments;d=c[0];a.warn(d);c[0]="[Details for Above Warning]";sl.utils.consoleLogWithTrace.apply(this,c)},compareTwoClasses:function(k,j,p){var h={},f={},n=(!Ext.isDefined(p)||p.toLowerCase()==="different"),o=(!Ext.isDefined(p)||p.toLowerCase()==="same");if(!k||!Ext.isDefined(k.prototype)){console.error("cls1 does not work. Must have prototype");return}if(!j||!Ext.isDefined(j.prototype)){console.error("cls2 does not work. Must have prototype");return}var b=k.prototype,g=j.prototype;for(var c in b){if(Object.prototype.hasOwnProperty.call(b,c)){h[c]=Ext.emptyFn();f[c]=Ext.emptyFn()}}for(c in g){if(Object.prototype.hasOwnProperty.call(g,c)){h[c]=Ext.emptyFn();f[c]=Ext.emptyFn()}}for(c in b){if(Object.prototype.hasOwnProperty.call(b,c)){h[c]=b[c]}}for(c in g){if(Object.prototype.hasOwnProperty.call(g,c)){f[c]=g[c]}}var l=k.$className+(n&&!o?" Differences":(o&&!n?" Similarities":"")),e=l+"\n\n",d=j.$className+(n&&!o?" Differences":(o&&!n?" Similarities":"")),a=d+"\n\n";for(c in h){if(Object.prototype.hasOwnProperty.call(h,c)){var i=(""+h[c])===(""+f[c]);if((i&&o)||(!i&&n)){e+="\n"+c+":"+h[c]+"\n\\\\End of "+c+"\n"}}}for(c in f){if(Object.prototype.hasOwnProperty.call(f,c)){var m=(""+h[c])===(""+f[c]);if((m&&o)||(!m&&n)){a+="\n"+c+":"+f[c]+"\n\\\\End of "+c+"\n"}}}console.log({cls1:e,cls2:a})}},function(a){sl.consoleLog=a.consoleLogWithTrace;sl.consoleWarn=a.consoleWarningWithTrace;a.Round=Ext.util.Format.round;a.RoundStr=Ext.util.Format.number;a.getBrowserHeight=Ext.dom.Element.getViewportHeight;a.getBrowserWidth=Ext.dom.Element.getViewportWidth;a.IsObjEmpty=Ext.Object.isEmpty;a.FormatMoney=a.roundForPricingRendering;Ext.applyIf(sl.utils,a)});